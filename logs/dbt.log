2020-10-08 04:52:36.684606 (MainThread): Got an exception trying to initialize tracking
2020-10-08 04:52:36.684828 (MainThread): Running with dbt=0.16.0
2020-10-08 04:52:36.795588 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='/usr/local/airflow/dbt', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-08 04:52:36.798028 (MainThread): Tracking: do not track
2020-10-08 04:52:36.832665 (MainThread): Partial parsing not enabled
2020-10-08 04:52:36.835003 (MainThread): Parsing macros/core.sql
2020-10-08 04:52:36.843651 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-08 04:52:36.860047 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-08 04:52:36.873706 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-08 04:52:36.902418 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-08 04:52:36.914549 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-08 04:52:36.937273 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-08 04:52:37.051438 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-08 04:52:37.086532 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-08 04:52:37.089808 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-08 04:52:37.102350 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-08 04:52:37.105902 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-08 04:52:37.151928 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-08 04:52:37.154070 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-08 04:52:37.157753 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-08 04:52:37.159256 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-08 04:52:37.161420 (MainThread): Parsing macros/etc/query.sql
2020-10-08 04:52:37.163302 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-08 04:52:37.167144 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-08 04:52:37.169004 (MainThread): Parsing macros/etc/datetime.sql
2020-10-08 04:52:37.187644 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-08 04:52:37.191371 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-08 04:52:37.194341 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-08 04:52:37.196024 (MainThread): Parsing macros/adapters/common.sql
2020-10-08 04:52:37.298548 (MainThread): Parsing macros/relations.sql
2020-10-08 04:52:37.301755 (MainThread): Parsing macros/adapters.sql
2020-10-08 04:52:37.340234 (MainThread): Parsing macros/catalog.sql
2020-10-08 04:52:37.345113 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-08 04:52:37.376394 (MainThread): Partial parsing not enabled
2020-10-08 04:52:37.429128 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 04:52:37.429339 (MainThread): Opening a new connection, currently in state init
2020-10-08 04:52:37.460620 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 04:52:37.460839 (MainThread): Opening a new connection, currently in state init
2020-10-08 04:52:37.471146 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 04:52:37.471288 (MainThread): Opening a new connection, currently in state init
2020-10-08 04:52:37.481414 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 04:52:37.481590 (MainThread): Opening a new connection, currently in state init
2020-10-08 04:52:38.067802 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-08 04:52:38.072549 (MainThread): 
2020-10-08 04:52:38.072930 (MainThread): Acquiring new postgres connection "master".
2020-10-08 04:52:38.073042 (MainThread): Opening a new connection, currently in state init
2020-10-08 04:52:38.099762 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-08 04:52:38.100042 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-08 04:52:38.257651 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-08 04:52:38.257811 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-08 04:52:38.262265 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-08 04:52:38.288630 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-08 04:52:38.288790 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-08 04:52:38.290952 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-08 04:52:38.291071 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-08 04:52:38.291516 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-08 04:52:38.291661 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-08 04:52:38.291760 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-08 04:52:38.294874 (ThreadPoolExecutor-1_0): SQL status: SELECT 25 in 0.00 seconds
2020-10-08 04:52:38.322422 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-08 04:52:38.346792 (MainThread): Using postgres connection "master".
2020-10-08 04:52:38.346896 (MainThread): On master: BEGIN
2020-10-08 04:52:38.349618 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 04:52:38.349734 (MainThread): Using postgres connection "master".
2020-10-08 04:52:38.349820 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-08 04:52:38.355972 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-10-08 04:52:38.356977 (MainThread): On master: ROLLBACK
2020-10-08 04:52:38.357241 (MainThread): Using postgres connection "master".
2020-10-08 04:52:38.357342 (MainThread): On master: BEGIN
2020-10-08 04:52:38.357753 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 04:52:38.357870 (MainThread): On master: COMMIT
2020-10-08 04:52:38.357961 (MainThread): Using postgres connection "master".
2020-10-08 04:52:38.358042 (MainThread): On master: COMMIT
2020-10-08 04:52:38.358293 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-08 04:52:38.358592 (MainThread): 04:52:38 | Concurrency: 1 threads (target='dev')
2020-10-08 04:52:38.358722 (MainThread): 04:52:38 | 
2020-10-08 04:52:38.364320 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-08 04:52:38.364490 (Thread-1): 04:52:38 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-08 04:52:38.364779 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 04:52:38.364864 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-08 04:52:38.364957 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-08 04:52:38.385378 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 04:52:38.385682 (Thread-1): finished collecting timing info
2020-10-08 04:52:38.428215 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 04:52:38.428327 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-08 04:52:38.428834 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.431247 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 04:52:38.431343 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-08 04:52:38.431603 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.433592 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 04:52:38.433897 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 04:52:38.433983 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-08 04:52:38.434228 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 04:52:38.434333 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 04:52:38.434412 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-08 04:52:38.435930 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 04:52:38.438485 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 04:52:38.438577 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-08 04:52:38.438888 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 04:52:38.439949 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-08 04:52:38.440070 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 04:52:38.440173 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-08 04:52:38.441134 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 04:52:38.443002 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 04:52:38.443094 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-08 04:52:38.443338 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.445836 (Thread-1): finished collecting timing info
2020-10-08 04:52:38.446766 (Thread-1): 04:52:38 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.08s]
2020-10-08 04:52:38.446937 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-08 04:52:38.447111 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 04:52:38.447273 (Thread-1): 04:52:38 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-08 04:52:38.447613 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 04:52:38.447725 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-08 04:52:38.447830 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-08 04:52:38.456072 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 04:52:38.456266 (Thread-1): finished collecting timing info
2020-10-08 04:52:38.464977 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 04:52:38.465075 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-08 04:52:38.465409 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.467750 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 04:52:38.467871 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-08 04:52:38.468146 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.469925 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 04:52:38.470133 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 04:52:38.470215 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-08 04:52:38.470396 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 04:52:38.470475 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 04:52:38.470545 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-08 04:52:38.471119 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 04:52:38.473475 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 04:52:38.473562 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-08 04:52:38.473842 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 04:52:38.474606 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-08 04:52:38.474692 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 04:52:38.474767 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-08 04:52:38.475737 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 04:52:38.477728 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 04:52:38.477814 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-08 04:52:38.478035 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.480436 (Thread-1): finished collecting timing info
2020-10-08 04:52:38.481046 (Thread-1): 04:52:38 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.03s]
2020-10-08 04:52:38.481164 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 04:52:38.481497 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-08 04:52:38.481613 (Thread-1): 04:52:38 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-08 04:52:38.481834 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 04:52:38.481908 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-08 04:52:38.482008 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-08 04:52:38.491497 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 04:52:38.491684 (Thread-1): finished collecting timing info
2020-10-08 04:52:38.499498 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 04:52:38.499593 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-08 04:52:38.499872 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.502354 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 04:52:38.502443 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-08 04:52:38.502700 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.504408 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 04:52:38.504691 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 04:52:38.504806 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-08 04:52:38.505026 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 04:52:38.505116 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 04:52:38.505194 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-08 04:52:38.506226 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 04:52:38.509783 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 04:52:38.509874 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-08 04:52:38.510186 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 04:52:38.511102 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-08 04:52:38.511220 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 04:52:38.511334 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-08 04:52:38.512301 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 04:52:38.514093 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 04:52:38.514178 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-08 04:52:38.514409 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.516811 (Thread-1): finished collecting timing info
2020-10-08 04:52:38.517423 (Thread-1): 04:52:38 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.04s]
2020-10-08 04:52:38.517542 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-08 04:52:38.517900 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-08 04:52:38.518034 (Thread-1): 04:52:38 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-08 04:52:38.518301 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 04:52:38.518389 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-08 04:52:38.518478 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-08 04:52:38.526383 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 04:52:38.526609 (Thread-1): finished collecting timing info
2020-10-08 04:52:38.534392 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 04:52:38.534490 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-08 04:52:38.534792 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.537315 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 04:52:38.537416 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-08 04:52:38.537702 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.539545 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 04:52:38.539846 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 04:52:38.539956 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-08 04:52:38.540277 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 04:52:38.540406 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 04:52:38.540515 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-08 04:52:38.541910 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 04:52:38.545229 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 04:52:38.545373 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-08 04:52:38.545878 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 04:52:38.547063 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-08 04:52:38.547190 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 04:52:38.547298 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-08 04:52:38.548415 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 04:52:38.551626 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 04:52:38.551788 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-08 04:52:38.552212 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.556396 (Thread-1): finished collecting timing info
2020-10-08 04:52:38.557337 (Thread-1): 04:52:38 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.04s]
2020-10-08 04:52:38.557556 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-08 04:52:38.566106 (MainThread): Using postgres connection "master".
2020-10-08 04:52:38.566363 (MainThread): On master: BEGIN
2020-10-08 04:52:38.566774 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 04:52:38.566974 (MainThread): On master: COMMIT
2020-10-08 04:52:38.567144 (MainThread): Using postgres connection "master".
2020-10-08 04:52:38.567323 (MainThread): On master: COMMIT
2020-10-08 04:52:38.567646 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-08 04:52:38.568187 (MainThread): 04:52:38 | 
2020-10-08 04:52:38.568422 (MainThread): 04:52:38 | Finished running 4 view models in 0.50s.
2020-10-08 04:52:38.568629 (MainThread): Connection 'master' was left open.
2020-10-08 04:52:38.568797 (MainThread): On master: Close
2020-10-08 04:52:38.569022 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-08 04:52:38.569188 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-08 04:52:38.597873 (MainThread): 
2020-10-08 04:52:38.598189 (MainThread): Completed successfully
2020-10-08 04:52:38.598440 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-08 04:52:38.598785 (MainThread): Flushing usage events
2020-10-08 05:11:57.691262 (MainThread): Got an exception trying to initialize tracking
2020-10-08 05:11:57.691414 (MainThread): Running with dbt=0.16.0
2020-10-08 05:11:57.766781 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='/usr/local/airflow/dbt', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-08 05:11:57.767166 (MainThread): Tracking: do not track
2020-10-08 05:11:57.797899 (MainThread): Partial parsing not enabled
2020-10-08 05:11:57.800820 (MainThread): Parsing macros/core.sql
2020-10-08 05:11:57.808006 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-08 05:11:57.820986 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-08 05:11:57.831851 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-08 05:11:57.854052 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-08 05:11:57.861806 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-08 05:11:57.872143 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-08 05:11:57.930223 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-08 05:11:57.956660 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-08 05:11:57.959296 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-08 05:11:57.968885 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-08 05:11:57.971724 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-08 05:11:58.007095 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-08 05:11:58.008802 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-08 05:11:58.011857 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-08 05:11:58.013145 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-08 05:11:58.014731 (MainThread): Parsing macros/etc/query.sql
2020-10-08 05:11:58.016255 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-08 05:11:58.019241 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-08 05:11:58.020779 (MainThread): Parsing macros/etc/datetime.sql
2020-10-08 05:11:58.035728 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-08 05:11:58.038731 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-08 05:11:58.041177 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-08 05:11:58.042604 (MainThread): Parsing macros/adapters/common.sql
2020-10-08 05:11:58.121066 (MainThread): Parsing macros/relations.sql
2020-10-08 05:11:58.123708 (MainThread): Parsing macros/adapters.sql
2020-10-08 05:11:58.155211 (MainThread): Parsing macros/catalog.sql
2020-10-08 05:11:58.159442 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-08 05:11:58.189257 (MainThread): Partial parsing not enabled
2020-10-08 05:11:58.237659 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:11:58.237829 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:11:58.267583 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:11:58.267771 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:11:58.278741 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:11:58.278959 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:11:58.289697 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:11:58.289870 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:11:58.754131 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-08 05:11:58.759084 (MainThread): 
2020-10-08 05:11:58.759532 (MainThread): Acquiring new postgres connection "master".
2020-10-08 05:11:58.759708 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:11:58.784478 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-08 05:11:58.784746 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-08 05:11:58.913132 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-08 05:11:58.913275 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-08 05:11:58.916723 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-08 05:11:58.939451 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-08 05:11:58.939602 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-08 05:11:58.941517 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-08 05:11:58.941628 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-08 05:11:58.941987 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:11:58.942093 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-08 05:11:58.942175 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-08 05:11:58.944410 (ThreadPoolExecutor-1_0): SQL status: SELECT 25 in 0.00 seconds
2020-10-08 05:11:58.969652 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-08 05:11:58.995541 (MainThread): Using postgres connection "master".
2020-10-08 05:11:58.995690 (MainThread): On master: BEGIN
2020-10-08 05:11:58.998767 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:11:58.998914 (MainThread): Using postgres connection "master".
2020-10-08 05:11:58.999006 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-08 05:11:59.004571 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-10-08 05:11:59.005687 (MainThread): On master: ROLLBACK
2020-10-08 05:11:59.005987 (MainThread): Using postgres connection "master".
2020-10-08 05:11:59.006097 (MainThread): On master: BEGIN
2020-10-08 05:11:59.006550 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:11:59.006672 (MainThread): On master: COMMIT
2020-10-08 05:11:59.006770 (MainThread): Using postgres connection "master".
2020-10-08 05:11:59.006857 (MainThread): On master: COMMIT
2020-10-08 05:11:59.007110 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:11:59.007432 (MainThread): 05:11:59 | Concurrency: 1 threads (target='dev')
2020-10-08 05:11:59.007566 (MainThread): 05:11:59 | 
2020-10-08 05:11:59.013817 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-08 05:11:59.014011 (Thread-1): 05:11:59 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-08 05:11:59.014348 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:11:59.014439 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-08 05:11:59.014539 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-08 05:11:59.046437 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 05:11:59.046885 (Thread-1): finished collecting timing info
2020-10-08 05:11:59.125449 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:11:59.125677 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-08 05:11:59.126259 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.130745 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:11:59.130904 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-08 05:11:59.131254 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.134072 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 05:11:59.134499 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:11:59.134639 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-08 05:11:59.134930 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:11:59.135263 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:11:59.135405 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-08 05:11:59.137420 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 05:11:59.142779 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:11:59.142964 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-08 05:11:59.145323 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 05:11:59.147097 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-08 05:11:59.147266 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:11:59.147407 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-08 05:11:59.148473 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:11:59.151979 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:11:59.152131 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-08 05:11:59.152466 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.157396 (Thread-1): finished collecting timing info
2020-10-08 05:11:59.158930 (Thread-1): 05:11:59 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.14s]
2020-10-08 05:11:59.159167 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-08 05:11:59.159413 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 05:11:59.159628 (Thread-1): 05:11:59 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-08 05:11:59.160138 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:11:59.160278 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-08 05:11:59.160421 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-08 05:11:59.169606 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 05:11:59.169899 (Thread-1): finished collecting timing info
2020-10-08 05:11:59.180045 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:11:59.180183 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-08 05:11:59.180563 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.183470 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:11:59.183597 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-08 05:11:59.183951 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.185790 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 05:11:59.186101 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:11:59.186204 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-08 05:11:59.186492 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:11:59.186605 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:11:59.186697 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-08 05:11:59.187423 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 05:11:59.191920 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:11:59.192090 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-08 05:11:59.192543 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 05:11:59.193958 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-08 05:11:59.194108 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:11:59.194243 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-08 05:11:59.195268 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:11:59.198558 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:11:59.198720 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-08 05:11:59.199104 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.203486 (Thread-1): finished collecting timing info
2020-10-08 05:11:59.204581 (Thread-1): 05:11:59 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.04s]
2020-10-08 05:11:59.204781 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 05:11:59.205275 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-08 05:11:59.205479 (Thread-1): 05:11:59 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-08 05:11:59.205860 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:11:59.205987 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-08 05:11:59.206115 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-08 05:11:59.219295 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 05:11:59.219669 (Thread-1): finished collecting timing info
2020-10-08 05:11:59.228842 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:11:59.228986 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-08 05:11:59.229382 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.232388 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:11:59.232501 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-08 05:11:59.232809 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.234698 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 05:11:59.235008 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:11:59.235109 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-08 05:11:59.235360 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:11:59.235459 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:11:59.235544 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-08 05:11:59.236671 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 05:11:59.241493 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:11:59.241649 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-08 05:11:59.242223 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 05:11:59.243345 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-08 05:11:59.243458 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:11:59.243553 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-08 05:11:59.244722 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:11:59.247135 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:11:59.247263 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-08 05:11:59.247629 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.250762 (Thread-1): finished collecting timing info
2020-10-08 05:11:59.251612 (Thread-1): 05:11:59 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.05s]
2020-10-08 05:11:59.251767 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-08 05:11:59.252203 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-08 05:11:59.252364 (Thread-1): 05:11:59 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-08 05:11:59.252666 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:11:59.252759 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-08 05:11:59.252854 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-08 05:11:59.262277 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 05:11:59.262617 (Thread-1): finished collecting timing info
2020-10-08 05:11:59.272602 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:11:59.272774 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-08 05:11:59.273197 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.276654 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:11:59.276822 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-08 05:11:59.277236 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.279497 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 05:11:59.279905 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:11:59.280027 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-08 05:11:59.280376 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:11:59.280514 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:11:59.280624 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-08 05:11:59.282550 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 05:11:59.286709 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:11:59.286906 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-08 05:11:59.287564 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 05:11:59.288936 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-08 05:11:59.289082 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:11:59.289200 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-08 05:11:59.290303 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:11:59.293417 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:11:59.293597 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-08 05:11:59.294021 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.297996 (Thread-1): finished collecting timing info
2020-10-08 05:11:59.299028 (Thread-1): 05:11:59 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.05s]
2020-10-08 05:11:59.299223 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-08 05:11:59.320394 (MainThread): Using postgres connection "master".
2020-10-08 05:11:59.320638 (MainThread): On master: BEGIN
2020-10-08 05:11:59.321025 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:11:59.321219 (MainThread): On master: COMMIT
2020-10-08 05:11:59.321380 (MainThread): Using postgres connection "master".
2020-10-08 05:11:59.321533 (MainThread): On master: COMMIT
2020-10-08 05:11:59.321836 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:11:59.322372 (MainThread): 05:11:59 | 
2020-10-08 05:11:59.322600 (MainThread): 05:11:59 | Finished running 4 view models in 0.56s.
2020-10-08 05:11:59.322799 (MainThread): Connection 'master' was left open.
2020-10-08 05:11:59.322967 (MainThread): On master: Close
2020-10-08 05:11:59.323188 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-08 05:11:59.323361 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-08 05:11:59.349994 (MainThread): 
2020-10-08 05:11:59.350209 (MainThread): Completed successfully
2020-10-08 05:11:59.350367 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-08 05:11:59.350587 (MainThread): Flushing usage events
2020-10-08 05:36:38.747465 (MainThread): Got an exception trying to initialize tracking
2020-10-08 05:36:38.747620 (MainThread): Running with dbt=0.16.0
2020-10-08 05:36:38.920311 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='/usr/local/airflow/dbt', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-08 05:36:38.920699 (MainThread): Tracking: do not track
2020-10-08 05:36:38.966100 (MainThread): Partial parsing not enabled
2020-10-08 05:36:38.968857 (MainThread): Parsing macros/core.sql
2020-10-08 05:36:38.979255 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-08 05:36:38.997871 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-08 05:36:39.013512 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-08 05:36:39.043054 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-08 05:36:39.052472 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-08 05:36:39.065085 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-08 05:36:39.133798 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-08 05:36:39.167461 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-08 05:36:39.170766 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-08 05:36:39.182936 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-08 05:36:39.186528 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-08 05:36:39.235236 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-08 05:36:39.238021 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-08 05:36:39.242077 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-08 05:36:39.243784 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-08 05:36:39.245708 (MainThread): Parsing macros/etc/query.sql
2020-10-08 05:36:39.247450 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-08 05:36:39.250960 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-08 05:36:39.252706 (MainThread): Parsing macros/etc/datetime.sql
2020-10-08 05:36:39.270374 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-08 05:36:39.273746 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-08 05:36:39.276403 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-08 05:36:39.277776 (MainThread): Parsing macros/adapters/common.sql
2020-10-08 05:36:39.360146 (MainThread): Parsing macros/relations.sql
2020-10-08 05:36:39.362954 (MainThread): Parsing macros/adapters.sql
2020-10-08 05:36:39.394071 (MainThread): Parsing macros/catalog.sql
2020-10-08 05:36:39.398079 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-08 05:36:39.426044 (MainThread): Partial parsing not enabled
2020-10-08 05:36:39.473129 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:36:39.473292 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:36:39.501378 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:36:39.501551 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:36:39.511366 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:36:39.511544 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:36:39.522111 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:36:39.522292 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:36:40.108965 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-08 05:36:40.114067 (MainThread): 
2020-10-08 05:36:40.114516 (MainThread): Acquiring new postgres connection "master".
2020-10-08 05:36:40.114642 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:36:40.139921 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-08 05:36:40.140098 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-08 05:36:40.267658 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-08 05:36:40.267800 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-08 05:36:40.272426 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-08 05:36:40.298049 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-08 05:36:40.298206 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-08 05:36:40.300351 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-08 05:36:40.300471 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-08 05:36:40.300794 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:36:40.300915 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-08 05:36:40.301010 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-08 05:36:40.303327 (ThreadPoolExecutor-1_0): SQL status: SELECT 25 in 0.00 seconds
2020-10-08 05:36:40.333939 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-08 05:36:40.369555 (MainThread): Using postgres connection "master".
2020-10-08 05:36:40.369838 (MainThread): On master: BEGIN
2020-10-08 05:36:40.373576 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:36:40.373814 (MainThread): Using postgres connection "master".
2020-10-08 05:36:40.373945 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-08 05:36:40.380844 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-10-08 05:36:40.382232 (MainThread): On master: ROLLBACK
2020-10-08 05:36:40.382524 (MainThread): Using postgres connection "master".
2020-10-08 05:36:40.382666 (MainThread): On master: BEGIN
2020-10-08 05:36:40.383129 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:36:40.383287 (MainThread): On master: COMMIT
2020-10-08 05:36:40.383434 (MainThread): Using postgres connection "master".
2020-10-08 05:36:40.383548 (MainThread): On master: COMMIT
2020-10-08 05:36:40.383850 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:36:40.384244 (MainThread): 05:36:40 | Concurrency: 1 threads (target='dev')
2020-10-08 05:36:40.384421 (MainThread): 05:36:40 | 
2020-10-08 05:36:40.392183 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-08 05:36:40.392435 (Thread-1): 05:36:40 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-08 05:36:40.392903 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:36:40.393025 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-08 05:36:40.393155 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-08 05:36:40.419062 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 05:36:40.419405 (Thread-1): finished collecting timing info
2020-10-08 05:36:40.470604 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:36:40.470772 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-08 05:36:40.471378 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.475091 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:36:40.475204 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-08 05:36:40.475527 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.477356 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 05:36:40.477674 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:36:40.477777 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-08 05:36:40.478063 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:36:40.478184 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:36:40.478279 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-08 05:36:40.479620 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 05:36:40.482783 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:36:40.482898 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-08 05:36:40.483335 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 05:36:40.484336 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-08 05:36:40.484445 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:36:40.484540 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-08 05:36:40.488189 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:36:40.490543 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:36:40.490670 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-08 05:36:40.491026 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.494180 (Thread-1): finished collecting timing info
2020-10-08 05:36:40.494978 (Thread-1): 05:36:40 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.10s]
2020-10-08 05:36:40.495152 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-08 05:36:40.495357 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 05:36:40.495513 (Thread-1): 05:36:40 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-08 05:36:40.495826 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:36:40.495929 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-08 05:36:40.496030 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-08 05:36:40.506109 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 05:36:40.506421 (Thread-1): finished collecting timing info
2020-10-08 05:36:40.516493 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:36:40.516688 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-08 05:36:40.517163 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.520694 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:36:40.520870 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-08 05:36:40.521352 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.523975 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 05:36:40.524516 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:36:40.524700 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-08 05:36:40.524975 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:36:40.525124 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:36:40.525258 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-08 05:36:40.526248 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 05:36:40.530263 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:36:40.530425 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-08 05:36:40.530893 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 05:36:40.532010 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-08 05:36:40.532124 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:36:40.532217 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-08 05:36:40.533182 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:36:40.536315 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:36:40.536537 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-08 05:36:40.536937 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.543077 (Thread-1): finished collecting timing info
2020-10-08 05:36:40.543986 (Thread-1): 05:36:40 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.05s]
2020-10-08 05:36:40.544167 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 05:36:40.544616 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-08 05:36:40.544787 (Thread-1): 05:36:40 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-08 05:36:40.545137 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:36:40.545241 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-08 05:36:40.545343 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-08 05:36:40.557299 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 05:36:40.557641 (Thread-1): finished collecting timing info
2020-10-08 05:36:40.567418 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:36:40.567585 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-08 05:36:40.568004 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.572219 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:36:40.572377 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-08 05:36:40.572899 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.575042 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 05:36:40.575417 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:36:40.575533 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-08 05:36:40.575837 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:36:40.575959 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:36:40.576065 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-08 05:36:40.577226 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 05:36:40.580434 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:36:40.580550 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-08 05:36:40.580980 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 05:36:40.582015 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-08 05:36:40.582126 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:36:40.582221 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-08 05:36:40.583223 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:36:40.585692 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:36:40.585815 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-08 05:36:40.586133 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.590121 (Thread-1): finished collecting timing info
2020-10-08 05:36:40.590998 (Thread-1): 05:36:40 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.05s]
2020-10-08 05:36:40.591175 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-08 05:36:40.591709 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-08 05:36:40.591876 (Thread-1): 05:36:40 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-08 05:36:40.592210 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:36:40.592311 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-08 05:36:40.592410 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-08 05:36:40.601682 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 05:36:40.602245 (Thread-1): finished collecting timing info
2020-10-08 05:36:40.613109 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:36:40.613280 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-08 05:36:40.613646 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.616681 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:36:40.616798 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-08 05:36:40.617143 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.620947 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 05:36:40.621388 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:36:40.621542 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-08 05:36:40.621897 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:36:40.622041 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:36:40.622141 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-08 05:36:40.623542 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 05:36:40.626909 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:36:40.627046 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-08 05:36:40.627522 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 05:36:40.628624 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-08 05:36:40.628739 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:36:40.628835 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-08 05:36:40.629838 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:36:40.632258 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:36:40.632370 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-08 05:36:40.632643 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.636092 (Thread-1): finished collecting timing info
2020-10-08 05:36:40.637131 (Thread-1): 05:36:40 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.04s]
2020-10-08 05:36:40.637318 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-08 05:36:40.702675 (MainThread): Using postgres connection "master".
2020-10-08 05:36:40.702850 (MainThread): On master: BEGIN
2020-10-08 05:36:40.703169 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:36:40.703304 (MainThread): On master: COMMIT
2020-10-08 05:36:40.703419 (MainThread): Using postgres connection "master".
2020-10-08 05:36:40.703519 (MainThread): On master: COMMIT
2020-10-08 05:36:40.703717 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:36:40.704062 (MainThread): 05:36:40 | 
2020-10-08 05:36:40.704199 (MainThread): 05:36:40 | Finished running 4 view models in 0.59s.
2020-10-08 05:36:40.704318 (MainThread): Connection 'master' was left open.
2020-10-08 05:36:40.704428 (MainThread): On master: Close
2020-10-08 05:36:40.704574 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-08 05:36:40.704694 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-08 05:36:40.721874 (MainThread): 
2020-10-08 05:36:40.722079 (MainThread): Completed successfully
2020-10-08 05:36:40.722229 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-08 05:36:40.722487 (MainThread): Flushing usage events
2020-10-08 20:12:08.601906 (MainThread): Got an exception trying to initialize tracking
2020-10-08 20:12:08.602056 (MainThread): Running with dbt=0.16.0
2020-10-08 20:12:08.677343 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='/usr/local/airflow/dbt', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-08 20:12:08.677667 (MainThread): Tracking: do not track
2020-10-08 20:12:08.710802 (MainThread): Partial parsing not enabled
2020-10-08 20:12:08.712821 (MainThread): Parsing macros/core.sql
2020-10-08 20:12:08.720448 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-08 20:12:08.734254 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-08 20:12:08.746468 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-08 20:12:08.773249 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-08 20:12:08.782664 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-08 20:12:08.795555 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-08 20:12:08.915479 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-08 20:12:08.954582 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-08 20:12:08.959295 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-08 20:12:08.978650 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-08 20:12:08.983576 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-08 20:12:09.030646 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-08 20:12:09.032672 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-08 20:12:09.036131 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-08 20:12:09.037538 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-08 20:12:09.039296 (MainThread): Parsing macros/etc/query.sql
2020-10-08 20:12:09.040962 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-08 20:12:09.044361 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-08 20:12:09.046079 (MainThread): Parsing macros/etc/datetime.sql
2020-10-08 20:12:09.065618 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-08 20:12:09.070148 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-08 20:12:09.073458 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-08 20:12:09.075174 (MainThread): Parsing macros/adapters/common.sql
2020-10-08 20:12:09.164213 (MainThread): Parsing macros/relations.sql
2020-10-08 20:12:09.166885 (MainThread): Parsing macros/adapters.sql
2020-10-08 20:12:09.201806 (MainThread): Parsing macros/catalog.sql
2020-10-08 20:12:09.206302 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-08 20:12:09.231972 (MainThread): Partial parsing not enabled
2020-10-08 20:12:09.270213 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 20:12:09.270333 (MainThread): Opening a new connection, currently in state init
2020-10-08 20:12:09.291691 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 20:12:09.291783 (MainThread): Opening a new connection, currently in state init
2020-10-08 20:12:09.298160 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 20:12:09.298247 (MainThread): Opening a new connection, currently in state init
2020-10-08 20:12:09.304675 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 20:12:09.304762 (MainThread): Opening a new connection, currently in state init
2020-10-08 20:12:09.696087 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-08 20:12:09.700605 (MainThread): 
2020-10-08 20:12:09.700979 (MainThread): Acquiring new postgres connection "master".
2020-10-08 20:12:09.701089 (MainThread): Opening a new connection, currently in state init
2020-10-08 20:12:09.723886 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-08 20:12:09.724012 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-08 20:12:09.873535 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-08 20:12:09.873723 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-08 20:12:09.878321 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-08 20:12:09.907183 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-08 20:12:09.907422 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-08 20:12:09.909740 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-08 20:12:09.909876 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-08 20:12:09.910235 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-08 20:12:09.910350 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-08 20:12:09.910445 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-08 20:12:09.913527 (ThreadPoolExecutor-1_0): SQL status: SELECT 27 in 0.00 seconds
2020-10-08 20:12:09.945437 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-08 20:12:09.973118 (MainThread): Using postgres connection "master".
2020-10-08 20:12:09.973268 (MainThread): On master: BEGIN
2020-10-08 20:12:09.975961 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 20:12:09.976121 (MainThread): Using postgres connection "master".
2020-10-08 20:12:09.976218 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-08 20:12:09.981869 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-10-08 20:12:09.983008 (MainThread): On master: ROLLBACK
2020-10-08 20:12:09.983242 (MainThread): Using postgres connection "master".
2020-10-08 20:12:09.983347 (MainThread): On master: BEGIN
2020-10-08 20:12:09.983634 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 20:12:09.983763 (MainThread): On master: COMMIT
2020-10-08 20:12:09.983854 (MainThread): Using postgres connection "master".
2020-10-08 20:12:09.983940 (MainThread): On master: COMMIT
2020-10-08 20:12:09.984118 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-08 20:12:09.984423 (MainThread): 20:12:09 | Concurrency: 1 threads (target='dev')
2020-10-08 20:12:09.984557 (MainThread): 20:12:09 | 
2020-10-08 20:12:09.990836 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-08 20:12:09.991040 (Thread-1): 20:12:09 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-08 20:12:09.991537 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 20:12:09.991636 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-08 20:12:09.991741 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-08 20:12:10.014610 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 20:12:10.014959 (Thread-1): finished collecting timing info
2020-10-08 20:12:10.066864 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 20:12:10.067035 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-08 20:12:10.067592 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.071175 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 20:12:10.071330 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-08 20:12:10.071718 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.073644 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 20:12:10.073945 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 20:12:10.074047 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-08 20:12:10.074316 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 20:12:10.074437 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 20:12:10.074532 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-08 20:12:10.075790 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 20:12:10.078938 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 20:12:10.079053 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-08 20:12:10.079474 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 20:12:10.080507 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-08 20:12:10.080645 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 20:12:10.080742 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-08 20:12:10.081782 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 20:12:10.084161 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 20:12:10.084279 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-08 20:12:10.084595 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.087681 (Thread-1): finished collecting timing info
2020-10-08 20:12:10.089683 (Thread-1): 20:12:10 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.10s]
2020-10-08 20:12:10.089835 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-08 20:12:10.089993 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 20:12:10.090231 (Thread-1): 20:12:10 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-08 20:12:10.090513 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 20:12:10.090607 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-08 20:12:10.090704 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-08 20:12:10.100144 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 20:12:10.100441 (Thread-1): finished collecting timing info
2020-10-08 20:12:10.109491 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 20:12:10.109628 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-08 20:12:10.110023 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.112911 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 20:12:10.113021 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-08 20:12:10.113346 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.115152 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 20:12:10.115448 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 20:12:10.115547 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-08 20:12:10.115818 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 20:12:10.115929 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 20:12:10.116021 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-08 20:12:10.116757 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 20:12:10.119710 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 20:12:10.119818 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-08 20:12:10.120216 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 20:12:10.121181 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-08 20:12:10.121284 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 20:12:10.121372 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-08 20:12:10.122382 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 20:12:10.124623 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 20:12:10.124727 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-08 20:12:10.125037 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.128031 (Thread-1): finished collecting timing info
2020-10-08 20:12:10.128793 (Thread-1): 20:12:10 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.04s]
2020-10-08 20:12:10.128936 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 20:12:10.129326 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-08 20:12:10.129477 (Thread-1): 20:12:10 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-08 20:12:10.129764 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 20:12:10.129854 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-08 20:12:10.129946 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-08 20:12:10.140415 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 20:12:10.140697 (Thread-1): finished collecting timing info
2020-10-08 20:12:10.149832 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 20:12:10.149957 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-08 20:12:10.150367 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.154725 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 20:12:10.154852 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-08 20:12:10.155221 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.156908 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 20:12:10.157225 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 20:12:10.157323 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-08 20:12:10.157581 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 20:12:10.157693 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 20:12:10.157783 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-08 20:12:10.158998 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 20:12:10.162224 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 20:12:10.162331 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-08 20:12:10.162766 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 20:12:10.163737 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-08 20:12:10.163844 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 20:12:10.163932 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-08 20:12:10.164934 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 20:12:10.167175 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 20:12:10.167284 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-08 20:12:10.167616 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.170617 (Thread-1): finished collecting timing info
2020-10-08 20:12:10.171371 (Thread-1): 20:12:10 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.04s]
2020-10-08 20:12:10.171513 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-08 20:12:10.171903 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-08 20:12:10.172055 (Thread-1): 20:12:10 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-08 20:12:10.172327 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 20:12:10.172415 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-08 20:12:10.172583 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-08 20:12:10.181307 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 20:12:10.181569 (Thread-1): finished collecting timing info
2020-10-08 20:12:10.190463 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 20:12:10.190585 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-08 20:12:10.190977 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.193830 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 20:12:10.193933 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-08 20:12:10.194257 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.196013 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 20:12:10.196388 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 20:12:10.196488 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-08 20:12:10.196731 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 20:12:10.196825 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 20:12:10.196907 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-08 20:12:10.198055 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 20:12:10.201118 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 20:12:10.201228 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-08 20:12:10.201636 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 20:12:10.202618 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-08 20:12:10.202722 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 20:12:10.202810 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-08 20:12:10.207146 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 20:12:10.209356 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 20:12:10.209459 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-08 20:12:10.209778 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.212693 (Thread-1): finished collecting timing info
2020-10-08 20:12:10.213419 (Thread-1): 20:12:10 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.04s]
2020-10-08 20:12:10.213556 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-08 20:12:10.296924 (MainThread): Using postgres connection "master".
2020-10-08 20:12:10.297155 (MainThread): On master: BEGIN
2020-10-08 20:12:10.297526 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 20:12:10.297684 (MainThread): On master: COMMIT
2020-10-08 20:12:10.297799 (MainThread): Using postgres connection "master".
2020-10-08 20:12:10.297905 (MainThread): On master: COMMIT
2020-10-08 20:12:10.298156 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-08 20:12:10.298530 (MainThread): 20:12:10 | 
2020-10-08 20:12:10.298685 (MainThread): 20:12:10 | Finished running 4 view models in 0.60s.
2020-10-08 20:12:10.298812 (MainThread): Connection 'master' was left open.
2020-10-08 20:12:10.298914 (MainThread): On master: Close
2020-10-08 20:12:10.299069 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-08 20:12:10.299175 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-08 20:12:10.317091 (MainThread): 
2020-10-08 20:12:10.317285 (MainThread): Completed successfully
2020-10-08 20:12:10.317424 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-08 20:12:10.317645 (MainThread): Flushing usage events
2020-10-08 21:11:00.846095 (MainThread): Got an exception trying to initialize tracking
2020-10-08 21:11:00.846250 (MainThread): Running with dbt=0.16.0
2020-10-08 21:11:00.943083 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-08 21:11:00.943574 (MainThread): Tracking: do not track
2020-10-08 21:11:00.978756 (MainThread): Partial parsing not enabled
2020-10-08 21:11:00.982012 (MainThread): Parsing macros/core.sql
2020-10-08 21:11:00.989948 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-08 21:11:01.004232 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-08 21:11:01.015720 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-08 21:11:01.038651 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-08 21:11:01.048061 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-08 21:11:01.060744 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-08 21:11:01.142519 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-08 21:11:01.177251 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-08 21:11:01.180650 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-08 21:11:01.192694 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-08 21:11:01.196430 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-08 21:11:01.239971 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-08 21:11:01.242078 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-08 21:11:01.245694 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-08 21:11:01.247181 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-08 21:11:01.249029 (MainThread): Parsing macros/etc/query.sql
2020-10-08 21:11:01.250830 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-08 21:11:01.254321 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-08 21:11:01.256108 (MainThread): Parsing macros/etc/datetime.sql
2020-10-08 21:11:01.274249 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-08 21:11:01.277954 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-08 21:11:01.280951 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-08 21:11:01.282696 (MainThread): Parsing macros/adapters/common.sql
2020-10-08 21:11:01.377048 (MainThread): Parsing macros/relations.sql
2020-10-08 21:11:01.379940 (MainThread): Parsing macros/adapters.sql
2020-10-08 21:11:01.413698 (MainThread): Parsing macros/catalog.sql
2020-10-08 21:11:01.417863 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-08 21:11:01.444494 (MainThread): Partial parsing not enabled
2020-10-08 21:11:01.491543 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 21:11:01.491736 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:11:01.525019 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 21:11:01.525189 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:11:01.535255 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 21:11:01.535414 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:11:01.544519 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 21:11:01.544663 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:11:02.003631 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-08 21:11:02.011975 (MainThread): 
2020-10-08 21:11:02.012656 (MainThread): 21:11:02 | Concurrency: 1 threads (target='dev')
2020-10-08 21:11:02.013349 (MainThread): 21:11:02 | 
2020-10-08 21:11:02.027208 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-08 21:11:02.027777 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 21:11:02.027943 (Thread-1): Opening a new connection, currently in state init
2020-10-08 21:11:02.028100 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-08 21:11:02.060233 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 21:11:02.060560 (Thread-1): finished collecting timing info
2020-10-08 21:11:02.060883 (Thread-1): finished collecting timing info
2020-10-08 21:11:02.061379 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-08 21:11:02.061556 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 21:11:02.061948 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 21:11:02.062055 (Thread-1): Opening a new connection, currently in state init
2020-10-08 21:11:02.062175 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-08 21:11:02.072061 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 21:11:02.072391 (Thread-1): finished collecting timing info
2020-10-08 21:11:02.072702 (Thread-1): finished collecting timing info
2020-10-08 21:11:02.073196 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 21:11:02.073614 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-08 21:11:02.073936 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 21:11:02.074045 (Thread-1): Opening a new connection, currently in state init
2020-10-08 21:11:02.074160 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-08 21:11:02.085519 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 21:11:02.085868 (Thread-1): finished collecting timing info
2020-10-08 21:11:02.086196 (Thread-1): finished collecting timing info
2020-10-08 21:11:02.086700 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-08 21:11:02.087183 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-08 21:11:02.087506 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 21:11:02.087615 (Thread-1): Opening a new connection, currently in state init
2020-10-08 21:11:02.087717 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-08 21:11:02.097290 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 21:11:02.097646 (Thread-1): finished collecting timing info
2020-10-08 21:11:02.097951 (Thread-1): finished collecting timing info
2020-10-08 21:11:02.098459 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-08 21:11:02.127132 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-08 21:11:02.127315 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was properly closed.
2020-10-08 21:11:02.144911 (MainThread): 21:11:02 | Done.
2020-10-08 21:11:02.148516 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-08 21:11:02.148695 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:11:02.148843 (MainThread): 21:11:02 | Building catalog
2020-10-08 21:11:02.194378 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-08 21:11:02.194543 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-08 21:11:02.310205 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-08 21:11:02.310366 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-08 21:11:02.313927 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-08 21:11:02.314093 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-08 21:11:02.314218 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-08 21:11:02.319079 (ThreadPoolExecutor-0_0): SQL status: SELECT 197 in 0.00 seconds
2020-10-08 21:11:02.340683 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-08 21:11:02.471334 (MainThread): 21:11:02 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-08 21:11:02.471663 (MainThread): Flushing usage events
2020-10-08 21:11:02.471824 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-08 21:11:02.471903 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-08 21:11:02.471974 (MainThread): On airflow.information_schema: Close
2020-10-08 21:50:25.001746 (MainThread): Got an exception trying to initialize tracking
2020-10-08 21:50:25.001893 (MainThread): Running with dbt=0.16.0
2020-10-08 21:50:25.085105 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-08 21:50:25.086220 (MainThread): Tracking: do not track
2020-10-08 21:50:25.120209 (MainThread): Partial parsing not enabled
2020-10-08 21:50:25.122357 (MainThread): Parsing macros/core.sql
2020-10-08 21:50:25.130557 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-08 21:50:25.145891 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-08 21:50:25.158924 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-08 21:50:25.184720 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-08 21:50:25.193506 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-08 21:50:25.205267 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-08 21:50:25.303526 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-08 21:50:25.373410 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-08 21:50:25.376725 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-08 21:50:25.388562 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-08 21:50:25.392186 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-08 21:50:25.440808 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-08 21:50:25.443469 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-08 21:50:25.448171 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-08 21:50:25.450103 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-08 21:50:25.452497 (MainThread): Parsing macros/etc/query.sql
2020-10-08 21:50:25.454822 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-08 21:50:25.459316 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-08 21:50:25.461511 (MainThread): Parsing macros/etc/datetime.sql
2020-10-08 21:50:25.482313 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-08 21:50:25.486246 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-08 21:50:25.489385 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-08 21:50:25.491179 (MainThread): Parsing macros/adapters/common.sql
2020-10-08 21:50:25.588874 (MainThread): Parsing macros/relations.sql
2020-10-08 21:50:25.591899 (MainThread): Parsing macros/adapters.sql
2020-10-08 21:50:25.629996 (MainThread): Parsing macros/catalog.sql
2020-10-08 21:50:25.634741 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-08 21:50:25.665602 (MainThread): Partial parsing not enabled
2020-10-08 21:50:25.720461 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 21:50:25.720624 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:50:25.748921 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 21:50:25.749075 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:50:25.757520 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 21:50:25.757671 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:50:25.766327 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 21:50:25.766476 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:50:26.240500 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-08 21:50:26.244999 (MainThread): 
2020-10-08 21:50:26.245222 (MainThread): 21:50:26 | Concurrency: 1 threads (target='dev')
2020-10-08 21:50:26.245398 (MainThread): 21:50:26 | 
2020-10-08 21:50:26.252697 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-08 21:50:26.253276 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 21:50:26.253420 (Thread-1): Opening a new connection, currently in state init
2020-10-08 21:50:26.253549 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-08 21:50:26.286413 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 21:50:26.286886 (Thread-1): finished collecting timing info
2020-10-08 21:50:26.287380 (Thread-1): finished collecting timing info
2020-10-08 21:50:26.288137 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-08 21:50:26.288379 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 21:50:26.288951 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 21:50:26.289112 (Thread-1): Opening a new connection, currently in state init
2020-10-08 21:50:26.289261 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-08 21:50:26.304176 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 21:50:26.304640 (Thread-1): finished collecting timing info
2020-10-08 21:50:26.305093 (Thread-1): finished collecting timing info
2020-10-08 21:50:26.305833 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 21:50:26.306338 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-08 21:50:26.306780 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 21:50:26.306934 (Thread-1): Opening a new connection, currently in state init
2020-10-08 21:50:26.307082 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-08 21:50:26.323953 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 21:50:26.324413 (Thread-1): finished collecting timing info
2020-10-08 21:50:26.324861 (Thread-1): finished collecting timing info
2020-10-08 21:50:26.325606 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-08 21:50:26.326122 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-08 21:50:26.326557 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 21:50:26.326707 (Thread-1): Opening a new connection, currently in state init
2020-10-08 21:50:26.326851 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-08 21:50:26.340988 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 21:50:26.341452 (Thread-1): finished collecting timing info
2020-10-08 21:50:26.341882 (Thread-1): finished collecting timing info
2020-10-08 21:50:26.342626 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-08 21:50:26.362418 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-08 21:50:26.362699 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was properly closed.
2020-10-08 21:50:26.393994 (MainThread): 21:50:26 | Done.
2020-10-08 21:50:26.396445 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-08 21:50:26.396608 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:50:26.396789 (MainThread): 21:50:26 | Building catalog
2020-10-08 21:50:26.440380 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-08 21:50:26.440727 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-08 21:50:26.627902 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-08 21:50:26.628054 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-08 21:50:26.631344 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-08 21:50:26.631486 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-08 21:50:26.631572 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-08 21:50:26.634945 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.00 seconds
2020-10-08 21:50:26.651585 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-08 21:50:26.789547 (MainThread): 21:50:26 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-08 21:50:26.790080 (MainThread): Flushing usage events
2020-10-08 21:50:26.790277 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-08 21:50:26.790376 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-08 21:50:26.790468 (MainThread): On airflow.information_schema: Close
2020-10-08 21:50:50.078732 (MainThread): Got an exception trying to initialize tracking
2020-10-08 21:50:50.078888 (MainThread): Running with dbt=0.16.0
2020-10-08 21:50:50.162561 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-08 21:50:50.162891 (MainThread): Tracking: do not track
2020-10-08 21:50:50.171281 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-08 21:50:50.171559 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-08 21:50:50.171683 (MainThread): Press Ctrl+C to exit.


2020-10-08 22:16:01.981827 (MainThread): Flushing usage events
2020-10-08 22:16:01.982196 (MainThread): ctrl-c
2020-10-08 22:16:46.228802 (MainThread): Got an exception trying to initialize tracking
2020-10-08 22:16:46.228961 (MainThread): Running with dbt=0.16.0
2020-10-08 22:16:46.318970 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8080, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-08 22:16:46.319396 (MainThread): Tracking: do not track
2020-10-08 22:16:46.328110 (MainThread): Serving docs at 0.0.0.0:8080
2020-10-08 22:16:46.328401 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2020-10-08 22:16:46.328634 (MainThread): Press Ctrl+C to exit.


2020-10-08 22:16:46.329083 (MainThread): Flushing usage events
2020-10-08 22:16:46.329341 (MainThread): Encountered an error:
2020-10-08 22:16:46.329455 (MainThread): [Errno 98] Address already in use
2020-10-08 22:16:46.330541 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/serve.py", line 31, in run
    SimpleHTTPRequestHandler  # type: ignore
  File "/usr/local/lib/python3.7/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/usr/local/lib/python3.7/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

2020-10-08 22:17:39.653198 (MainThread): Got an exception trying to initialize tracking
2020-10-08 22:17:39.653345 (MainThread): Running with dbt=0.16.0
2020-10-08 22:17:39.733574 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8080, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-08 22:17:39.733897 (MainThread): Tracking: do not track
2020-10-08 22:17:39.742019 (MainThread): Serving docs at 0.0.0.0:8080
2020-10-08 22:17:39.742299 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2020-10-08 22:17:39.742431 (MainThread): Press Ctrl+C to exit.


2020-10-08 22:17:39.742857 (MainThread): Flushing usage events
2020-10-08 22:17:39.743111 (MainThread): Encountered an error:
2020-10-08 22:17:39.743224 (MainThread): [Errno 98] Address already in use
2020-10-08 22:17:39.744082 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/serve.py", line 31, in run
    SimpleHTTPRequestHandler  # type: ignore
  File "/usr/local/lib/python3.7/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/usr/local/lib/python3.7/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

2020-10-08 22:17:44.248396 (MainThread): Got an exception trying to initialize tracking
2020-10-08 22:17:44.248589 (MainThread): Running with dbt=0.16.0
2020-10-08 22:17:44.340428 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-08 22:17:44.340783 (MainThread): Tracking: do not track
2020-10-08 22:17:44.348664 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-08 22:17:44.348928 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-08 22:17:44.349059 (MainThread): Press Ctrl+C to exit.


2020-10-08 22:17:59.255577 (MainThread): Flushing usage events
2020-10-08 22:17:59.256091 (MainThread): ctrl-c
2020-10-09 01:50:47.092529 (MainThread): Got an exception trying to initialize tracking
2020-10-09 01:50:47.092681 (MainThread): Running with dbt=0.16.0
2020-10-09 01:50:47.175429 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-09 01:50:47.177822 (MainThread): Tracking: do not track
2020-10-09 01:50:47.210770 (MainThread): Partial parsing not enabled
2020-10-09 01:50:47.213018 (MainThread): Parsing macros/core.sql
2020-10-09 01:50:47.221890 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-09 01:50:47.240065 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-09 01:50:47.257372 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-09 01:50:47.289031 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-09 01:50:47.298916 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-09 01:50:47.311683 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-09 01:50:47.378790 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-09 01:50:47.408100 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-09 01:50:47.410925 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-09 01:50:47.421202 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-09 01:50:47.424026 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-09 01:50:47.460408 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-09 01:50:47.462107 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-09 01:50:47.465130 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-09 01:50:47.466355 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-09 01:50:47.467882 (MainThread): Parsing macros/etc/query.sql
2020-10-09 01:50:47.469329 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-09 01:50:47.472296 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-09 01:50:47.473767 (MainThread): Parsing macros/etc/datetime.sql
2020-10-09 01:50:47.489692 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-09 01:50:47.492904 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-09 01:50:47.495481 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-09 01:50:47.496907 (MainThread): Parsing macros/adapters/common.sql
2020-10-09 01:50:47.578841 (MainThread): Parsing macros/relations.sql
2020-10-09 01:50:47.581496 (MainThread): Parsing macros/adapters.sql
2020-10-09 01:50:47.636718 (MainThread): Parsing macros/catalog.sql
2020-10-09 01:50:47.644215 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-09 01:50:47.701707 (MainThread): Partial parsing not enabled
2020-10-09 01:50:47.758053 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 01:50:47.758248 (MainThread): Opening a new connection, currently in state init
2020-10-09 01:50:47.793076 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 01:50:47.793269 (MainThread): Opening a new connection, currently in state init
2020-10-09 01:50:47.804172 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 01:50:47.804355 (MainThread): Opening a new connection, currently in state init
2020-10-09 01:50:47.815171 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 01:50:47.815335 (MainThread): Opening a new connection, currently in state init
2020-10-09 01:50:48.256482 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-09 01:50:48.261359 (MainThread): 
2020-10-09 01:50:48.261561 (MainThread): 01:50:48 | Concurrency: 1 threads (target='dev')
2020-10-09 01:50:48.261734 (MainThread): 01:50:48 | 
2020-10-09 01:50:48.269519 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-09 01:50:48.270067 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 01:50:48.270230 (Thread-1): Opening a new connection, currently in state init
2020-10-09 01:50:48.270358 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-09 01:50:48.295155 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-09 01:50:48.295489 (Thread-1): finished collecting timing info
2020-10-09 01:50:48.295806 (Thread-1): finished collecting timing info
2020-10-09 01:50:48.296280 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-09 01:50:48.296435 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 01:50:48.296720 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 01:50:48.296827 (Thread-1): Opening a new connection, currently in state init
2020-10-09 01:50:48.296929 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-09 01:50:48.306633 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-09 01:50:48.306877 (Thread-1): finished collecting timing info
2020-10-09 01:50:48.307172 (Thread-1): finished collecting timing info
2020-10-09 01:50:48.307596 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 01:50:48.308000 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-09 01:50:48.308271 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 01:50:48.308370 (Thread-1): Opening a new connection, currently in state init
2020-10-09 01:50:48.308463 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-09 01:50:48.318903 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-09 01:50:48.319139 (Thread-1): finished collecting timing info
2020-10-09 01:50:48.319404 (Thread-1): finished collecting timing info
2020-10-09 01:50:48.319810 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-09 01:50:48.320244 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-09 01:50:48.320528 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 01:50:48.320625 (Thread-1): Opening a new connection, currently in state init
2020-10-09 01:50:48.320715 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-09 01:50:48.329273 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-09 01:50:48.329492 (Thread-1): finished collecting timing info
2020-10-09 01:50:48.329757 (Thread-1): finished collecting timing info
2020-10-09 01:50:48.330170 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-09 01:50:48.369746 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-09 01:50:48.369988 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was properly closed.
2020-10-09 01:50:48.389336 (MainThread): 01:50:48 | Done.
2020-10-09 01:50:48.391740 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-09 01:50:48.391861 (MainThread): Opening a new connection, currently in state init
2020-10-09 01:50:48.391966 (MainThread): 01:50:48 | Building catalog
2020-10-09 01:50:48.428596 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-09 01:50:48.428753 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-09 01:50:48.528698 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-09 01:50:48.528842 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-09 01:50:48.532083 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-09 01:50:48.532216 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-09 01:50:48.532300 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-09 01:50:48.537128 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.00 seconds
2020-10-09 01:50:48.553896 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-09 01:50:48.668229 (MainThread): 01:50:48 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-09 01:50:48.668586 (MainThread): Flushing usage events
2020-10-09 01:50:48.668743 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-09 01:50:48.668820 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-09 01:50:48.668893 (MainThread): On airflow.information_schema: Close
2020-10-09 01:50:57.823147 (MainThread): Got an exception trying to initialize tracking
2020-10-09 01:50:57.823402 (MainThread): Running with dbt=0.16.0
2020-10-09 01:50:57.956089 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-09 01:50:57.956537 (MainThread): Tracking: do not track
2020-10-09 01:50:57.966354 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-09 01:50:57.966731 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-09 01:50:57.966909 (MainThread): Press Ctrl+C to exit.


2020-10-09 02:01:56.230607 (MainThread): Flushing usage events
2020-10-09 02:01:56.231622 (MainThread): ctrl-c
2020-10-09 02:59:26.657298 (MainThread): Got an exception trying to initialize tracking
2020-10-09 02:59:26.657442 (MainThread): Running with dbt=0.16.0
2020-10-09 02:59:26.742750 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-09 02:59:26.743148 (MainThread): Tracking: do not track
2020-10-09 02:59:26.778908 (MainThread): Partial parsing not enabled
2020-10-09 02:59:26.781129 (MainThread): Parsing macros/core.sql
2020-10-09 02:59:26.789654 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-09 02:59:26.805241 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-09 02:59:26.818880 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-09 02:59:26.845024 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-09 02:59:26.854021 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-09 02:59:26.865674 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-09 02:59:26.994471 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-09 02:59:27.034703 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-09 02:59:27.037731 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-09 02:59:27.048274 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-09 02:59:27.051436 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-09 02:59:27.090426 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-09 02:59:27.092274 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-09 02:59:27.095531 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-09 02:59:27.096857 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-09 02:59:27.098564 (MainThread): Parsing macros/etc/query.sql
2020-10-09 02:59:27.100129 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-09 02:59:27.103364 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-09 02:59:27.104927 (MainThread): Parsing macros/etc/datetime.sql
2020-10-09 02:59:27.126314 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-09 02:59:27.129872 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-09 02:59:27.133016 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-09 02:59:27.135047 (MainThread): Parsing macros/adapters/common.sql
2020-10-09 02:59:27.248791 (MainThread): Parsing macros/relations.sql
2020-10-09 02:59:27.252901 (MainThread): Parsing macros/adapters.sql
2020-10-09 02:59:27.303355 (MainThread): Parsing macros/catalog.sql
2020-10-09 02:59:27.309530 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-09 02:59:27.345927 (MainThread): Partial parsing not enabled
2020-10-09 02:59:27.398906 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 02:59:27.399063 (MainThread): Opening a new connection, currently in state init
2020-10-09 02:59:27.427589 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 02:59:27.427760 (MainThread): Opening a new connection, currently in state init
2020-10-09 02:59:27.436745 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 02:59:27.436909 (MainThread): Opening a new connection, currently in state init
2020-10-09 02:59:27.446574 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 02:59:27.446775 (MainThread): Opening a new connection, currently in state init
2020-10-09 02:59:27.956550 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-09 02:59:27.961793 (MainThread): 
2020-10-09 02:59:27.962032 (MainThread): 02:59:27 | Concurrency: 1 threads (target='dev')
2020-10-09 02:59:27.962221 (MainThread): 02:59:27 | 
2020-10-09 02:59:27.970580 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-09 02:59:27.971096 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 02:59:27.971227 (Thread-1): Opening a new connection, currently in state init
2020-10-09 02:59:27.971369 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-09 02:59:28.000077 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-09 02:59:28.000427 (Thread-1): finished collecting timing info
2020-10-09 02:59:28.000759 (Thread-1): finished collecting timing info
2020-10-09 02:59:28.001266 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-09 02:59:28.001430 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 02:59:28.001889 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 02:59:28.002007 (Thread-1): Opening a new connection, currently in state init
2020-10-09 02:59:28.002127 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-09 02:59:28.011830 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-09 02:59:28.012107 (Thread-1): finished collecting timing info
2020-10-09 02:59:28.012399 (Thread-1): finished collecting timing info
2020-10-09 02:59:28.012870 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 02:59:28.013311 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-09 02:59:28.013639 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 02:59:28.013745 (Thread-1): Opening a new connection, currently in state init
2020-10-09 02:59:28.013844 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-09 02:59:28.024953 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-09 02:59:28.025281 (Thread-1): finished collecting timing info
2020-10-09 02:59:28.025583 (Thread-1): finished collecting timing info
2020-10-09 02:59:28.026061 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-09 02:59:28.026492 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-09 02:59:28.026807 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 02:59:28.026913 (Thread-1): Opening a new connection, currently in state init
2020-10-09 02:59:28.027013 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-09 02:59:28.036215 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-09 02:59:28.036473 (Thread-1): finished collecting timing info
2020-10-09 02:59:28.036752 (Thread-1): finished collecting timing info
2020-10-09 02:59:28.037190 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-09 02:59:28.070493 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-09 02:59:28.070653 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was properly closed.
2020-10-09 02:59:28.085867 (MainThread): 02:59:28 | Done.
2020-10-09 02:59:28.087780 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-09 02:59:28.087896 (MainThread): Opening a new connection, currently in state init
2020-10-09 02:59:28.087999 (MainThread): 02:59:28 | Building catalog
2020-10-09 02:59:28.123721 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-09 02:59:28.123877 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-09 02:59:28.233838 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-09 02:59:28.234004 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-09 02:59:28.237651 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-09 02:59:28.237820 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-09 02:59:28.237919 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-09 02:59:28.241101 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.00 seconds
2020-10-09 02:59:28.260384 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-09 02:59:28.448603 (MainThread): 02:59:28 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-09 02:59:28.449076 (MainThread): Flushing usage events
2020-10-09 02:59:28.449305 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-09 02:59:28.449399 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-09 02:59:28.449486 (MainThread): On airflow.information_schema: Close
2020-10-09 02:59:29.828873 (MainThread): Got an exception trying to initialize tracking
2020-10-09 02:59:29.829033 (MainThread): Running with dbt=0.16.0
2020-10-09 02:59:29.913509 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-09 02:59:29.913930 (MainThread): Tracking: do not track
2020-10-09 02:59:29.925815 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-09 02:59:29.926430 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-09 02:59:29.926647 (MainThread): Press Ctrl+C to exit.


2020-10-09 03:09:10.198500 (MainThread): Got an exception trying to initialize tracking
2020-10-09 03:09:10.198686 (MainThread): Running with dbt=0.16.0
2020-10-09 03:09:10.287000 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='/usr/local/airflow/dbt', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-09 03:09:10.289154 (MainThread): Tracking: do not track
2020-10-09 03:09:10.323100 (MainThread): Partial parsing not enabled
2020-10-09 03:09:10.325280 (MainThread): Parsing macros/core.sql
2020-10-09 03:09:10.333624 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-09 03:09:10.349580 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-09 03:09:10.363332 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-09 03:09:10.390771 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-09 03:09:10.400232 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-09 03:09:10.412234 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-09 03:09:10.476584 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-09 03:09:10.506607 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-09 03:09:10.509560 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-09 03:09:10.520320 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-09 03:09:10.523476 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-09 03:09:10.568689 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-09 03:09:10.571231 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-09 03:09:10.575805 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-09 03:09:10.577599 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-09 03:09:10.579839 (MainThread): Parsing macros/etc/query.sql
2020-10-09 03:09:10.581888 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-09 03:09:10.586005 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-09 03:09:10.587968 (MainThread): Parsing macros/etc/datetime.sql
2020-10-09 03:09:10.606990 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-09 03:09:10.610695 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-09 03:09:10.613655 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-09 03:09:10.615291 (MainThread): Parsing macros/adapters/common.sql
2020-10-09 03:09:10.703954 (MainThread): Parsing macros/relations.sql
2020-10-09 03:09:10.706476 (MainThread): Parsing macros/adapters.sql
2020-10-09 03:09:10.739366 (MainThread): Parsing macros/catalog.sql
2020-10-09 03:09:10.743591 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-09 03:09:10.770592 (MainThread): Partial parsing not enabled
2020-10-09 03:09:10.814515 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:10.814657 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:10.839337 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:10.839484 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:10.847250 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:10.847381 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:10.854979 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:10.855097 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:11.399954 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-09 03:09:11.404399 (MainThread): 
2020-10-09 03:09:11.404754 (MainThread): Acquiring new postgres connection "master".
2020-10-09 03:09:11.404859 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:11.427426 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-09 03:09:11.427551 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-09 03:09:11.544239 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-09 03:09:11.544369 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-09 03:09:11.547900 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-09 03:09:11.568599 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-09 03:09:11.568708 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-09 03:09:11.570481 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-09 03:09:11.570576 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-09 03:09:11.570833 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:11.570940 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-09 03:09:11.571017 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-09 03:09:11.573047 (ThreadPoolExecutor-1_0): SQL status: SELECT 27 in 0.00 seconds
2020-10-09 03:09:11.598655 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-09 03:09:11.621628 (MainThread): Using postgres connection "master".
2020-10-09 03:09:11.621725 (MainThread): On master: BEGIN
2020-10-09 03:09:11.624444 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:11.624553 (MainThread): Using postgres connection "master".
2020-10-09 03:09:11.624631 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-09 03:09:11.629353 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2020-10-09 03:09:11.630306 (MainThread): On master: ROLLBACK
2020-10-09 03:09:11.630555 (MainThread): Using postgres connection "master".
2020-10-09 03:09:11.630646 (MainThread): On master: BEGIN
2020-10-09 03:09:11.631039 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:11.631144 (MainThread): On master: COMMIT
2020-10-09 03:09:11.631224 (MainThread): Using postgres connection "master".
2020-10-09 03:09:11.631297 (MainThread): On master: COMMIT
2020-10-09 03:09:11.631530 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:11.631807 (MainThread): 03:09:11 | Concurrency: 1 threads (target='dev')
2020-10-09 03:09:11.631924 (MainThread): 03:09:11 | 
2020-10-09 03:09:11.637275 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-09 03:09:11.637434 (Thread-1): 03:09:11 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-09 03:09:11.637904 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:11.637989 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-09 03:09:11.638080 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-09 03:09:11.659513 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-09 03:09:11.659868 (Thread-1): finished collecting timing info
2020-10-09 03:09:11.703838 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:11.703975 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-09 03:09:11.704501 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.706935 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:11.707024 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-09 03:09:11.707284 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.708825 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-09 03:09:11.709098 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:11.709182 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-09 03:09:11.709446 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:11.709546 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:11.709638 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-09 03:09:11.710756 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-09 03:09:11.713312 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:11.713399 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-09 03:09:11.713750 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-09 03:09:11.714618 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-09 03:09:11.714720 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:11.714798 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-09 03:09:11.716018 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:11.717885 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:11.717976 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-09 03:09:11.718239 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.720769 (Thread-1): finished collecting timing info
2020-10-09 03:09:11.722445 (Thread-1): 03:09:11 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.08s]
2020-10-09 03:09:11.722568 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-09 03:09:11.722688 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 03:09:11.722803 (Thread-1): 03:09:11 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-09 03:09:11.723024 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:11.723099 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-09 03:09:11.723198 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-09 03:09:11.730999 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-09 03:09:11.731229 (Thread-1): finished collecting timing info
2020-10-09 03:09:11.738831 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:11.738967 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-09 03:09:11.739299 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.741702 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:11.741790 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-09 03:09:11.742037 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.743526 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-09 03:09:11.743760 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:11.743844 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-09 03:09:11.744023 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:11.744103 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:11.744185 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-09 03:09:11.744751 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-09 03:09:11.747196 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:11.747285 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-09 03:09:11.747571 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-09 03:09:11.748361 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-09 03:09:11.748448 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:11.748534 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-09 03:09:11.749652 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:11.754721 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:11.754911 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-09 03:09:11.755364 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.760424 (Thread-1): finished collecting timing info
2020-10-09 03:09:11.761541 (Thread-1): 03:09:11 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.04s]
2020-10-09 03:09:11.761746 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 03:09:11.762335 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-09 03:09:11.762561 (Thread-1): 03:09:11 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-09 03:09:11.762956 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:11.763085 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-09 03:09:11.763216 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-09 03:09:11.775130 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-09 03:09:11.775366 (Thread-1): finished collecting timing info
2020-10-09 03:09:11.783344 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:11.783436 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-09 03:09:11.783741 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.787167 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:11.787256 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-09 03:09:11.787524 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.788879 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-09 03:09:11.789113 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:11.789194 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-09 03:09:11.789413 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:11.789505 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:11.789580 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-09 03:09:11.790590 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-09 03:09:11.793198 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:11.793300 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-09 03:09:11.793655 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-09 03:09:11.794480 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-09 03:09:11.794567 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:11.794641 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-09 03:09:11.795910 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:11.797702 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:11.797787 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-09 03:09:11.798034 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.800477 (Thread-1): finished collecting timing info
2020-10-09 03:09:11.801100 (Thread-1): 03:09:11 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.04s]
2020-10-09 03:09:11.801218 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-09 03:09:11.801602 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-09 03:09:11.801730 (Thread-1): 03:09:11 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-09 03:09:11.801953 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:11.802026 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-09 03:09:11.802101 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-09 03:09:11.809611 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-09 03:09:11.809832 (Thread-1): finished collecting timing info
2020-10-09 03:09:11.817328 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:11.817418 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-09 03:09:11.817724 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.820070 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:11.820155 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-09 03:09:11.820415 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.821908 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-09 03:09:11.822143 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:11.822227 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-09 03:09:11.822444 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:11.822535 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:11.822610 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-09 03:09:11.823564 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-09 03:09:11.825964 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:11.826048 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-09 03:09:11.826373 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-09 03:09:11.827160 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-09 03:09:11.827246 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:11.827319 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-09 03:09:11.828551 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:11.830352 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:11.830438 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-09 03:09:11.830696 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.833130 (Thread-1): finished collecting timing info
2020-10-09 03:09:11.833738 (Thread-1): 03:09:11 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.03s]
2020-10-09 03:09:11.833853 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-09 03:09:11.839813 (MainThread): Using postgres connection "master".
2020-10-09 03:09:11.839909 (MainThread): On master: BEGIN
2020-10-09 03:09:11.840165 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:11.840265 (MainThread): On master: COMMIT
2020-10-09 03:09:11.840342 (MainThread): Using postgres connection "master".
2020-10-09 03:09:11.840414 (MainThread): On master: COMMIT
2020-10-09 03:09:11.840643 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:11.840900 (MainThread): 03:09:11 | 
2020-10-09 03:09:11.841008 (MainThread): 03:09:11 | Finished running 4 view models in 0.44s.
2020-10-09 03:09:11.841098 (MainThread): Connection 'master' was left open.
2020-10-09 03:09:11.841170 (MainThread): On master: Close
2020-10-09 03:09:11.841280 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-09 03:09:11.841354 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-09 03:09:11.855601 (MainThread): 
2020-10-09 03:09:11.855758 (MainThread): Completed successfully
2020-10-09 03:09:11.855869 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-09 03:09:11.856040 (MainThread): Flushing usage events
2020-10-09 03:09:45.161273 (MainThread): Got an exception trying to initialize tracking
2020-10-09 03:09:45.161421 (MainThread): Running with dbt=0.16.0
2020-10-09 03:09:45.241670 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='/usr/local/airflow/dbt', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-09 03:09:45.241981 (MainThread): Tracking: do not track
2020-10-09 03:09:45.273346 (MainThread): Partial parsing not enabled
2020-10-09 03:09:45.275218 (MainThread): Parsing macros/core.sql
2020-10-09 03:09:45.282412 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-09 03:09:45.296077 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-09 03:09:45.307451 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-09 03:09:45.332196 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-09 03:09:45.341076 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-09 03:09:45.352994 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-09 03:09:45.420337 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-09 03:09:45.455386 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-09 03:09:45.458723 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-09 03:09:45.476233 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-09 03:09:45.481338 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-09 03:09:45.544687 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-09 03:09:45.547612 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-09 03:09:45.552665 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-09 03:09:45.554925 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-09 03:09:45.557681 (MainThread): Parsing macros/etc/query.sql
2020-10-09 03:09:45.560357 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-09 03:09:45.565703 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-09 03:09:45.568468 (MainThread): Parsing macros/etc/datetime.sql
2020-10-09 03:09:45.599079 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-09 03:09:45.605800 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-09 03:09:45.609691 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-09 03:09:45.611783 (MainThread): Parsing macros/adapters/common.sql
2020-10-09 03:09:45.712776 (MainThread): Parsing macros/relations.sql
2020-10-09 03:09:45.715459 (MainThread): Parsing macros/adapters.sql
2020-10-09 03:09:45.748681 (MainThread): Parsing macros/catalog.sql
2020-10-09 03:09:45.753217 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-09 03:09:45.789077 (MainThread): Partial parsing not enabled
2020-10-09 03:09:45.841157 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:45.841295 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:45.864312 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:45.864422 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:45.871558 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:45.871659 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:45.878873 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:45.878970 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:46.303171 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-09 03:09:46.307781 (MainThread): 
2020-10-09 03:09:46.308156 (MainThread): Acquiring new postgres connection "master".
2020-10-09 03:09:46.308265 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:46.331703 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-09 03:09:46.331833 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-09 03:09:46.451605 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-09 03:09:46.451756 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-09 03:09:46.455632 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-09 03:09:46.481890 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-09 03:09:46.482122 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-09 03:09:46.484304 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-09 03:09:46.484426 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-09 03:09:46.484795 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:46.484913 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-09 03:09:46.485003 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-09 03:09:46.487131 (ThreadPoolExecutor-1_0): SQL status: SELECT 27 in 0.00 seconds
2020-10-09 03:09:46.519764 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-09 03:09:46.554851 (MainThread): Using postgres connection "master".
2020-10-09 03:09:46.555031 (MainThread): On master: BEGIN
2020-10-09 03:09:46.558442 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:46.558628 (MainThread): Using postgres connection "master".
2020-10-09 03:09:46.558749 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-09 03:09:46.565493 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-10-09 03:09:46.566905 (MainThread): On master: ROLLBACK
2020-10-09 03:09:46.567186 (MainThread): Using postgres connection "master".
2020-10-09 03:09:46.567310 (MainThread): On master: BEGIN
2020-10-09 03:09:46.567657 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:46.567812 (MainThread): On master: COMMIT
2020-10-09 03:09:46.567925 (MainThread): Using postgres connection "master".
2020-10-09 03:09:46.568029 (MainThread): On master: COMMIT
2020-10-09 03:09:46.568245 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:46.568618 (MainThread): 03:09:46 | Concurrency: 1 threads (target='dev')
2020-10-09 03:09:46.568779 (MainThread): 03:09:46 | 
2020-10-09 03:09:46.576250 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-09 03:09:46.576489 (Thread-1): 03:09:46 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-09 03:09:46.577064 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:46.577181 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-09 03:09:46.577304 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-09 03:09:46.612831 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-09 03:09:46.613259 (Thread-1): finished collecting timing info
2020-10-09 03:09:46.665796 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:46.665989 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-09 03:09:46.666512 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.671680 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:46.671903 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-09 03:09:46.672379 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.675397 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-09 03:09:46.675903 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:46.676125 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-09 03:09:46.676584 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:46.676764 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:46.676916 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-09 03:09:46.678802 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-09 03:09:46.683688 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:46.683887 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-09 03:09:46.684485 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-09 03:09:46.686089 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-09 03:09:46.686275 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:46.686421 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-09 03:09:46.688047 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:46.691576 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:46.691779 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-09 03:09:46.692186 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.696983 (Thread-1): finished collecting timing info
2020-10-09 03:09:46.700042 (Thread-1): 03:09:46 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.12s]
2020-10-09 03:09:46.700297 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-09 03:09:46.700529 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 03:09:46.700851 (Thread-1): 03:09:46 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-09 03:09:46.701272 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:46.701399 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-09 03:09:46.701544 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-09 03:09:46.715761 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-09 03:09:46.716166 (Thread-1): finished collecting timing info
2020-10-09 03:09:46.726668 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:46.726823 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-09 03:09:46.727106 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.730192 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:46.730328 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-09 03:09:46.730603 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.732533 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-09 03:09:46.732878 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:46.732984 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-09 03:09:46.733177 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:46.733280 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:46.733366 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-09 03:09:46.734011 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-09 03:09:46.739162 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:46.739415 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-09 03:09:46.740057 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-09 03:09:46.742002 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-09 03:09:46.742223 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:46.742391 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-09 03:09:46.743442 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:46.747930 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:46.748153 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-09 03:09:46.748595 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.754488 (Thread-1): finished collecting timing info
2020-10-09 03:09:46.755988 (Thread-1): 03:09:46 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.05s]
2020-10-09 03:09:46.756234 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 03:09:46.760350 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-09 03:09:46.760649 (Thread-1): 03:09:46 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-09 03:09:46.761193 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:46.761356 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-09 03:09:46.761524 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-09 03:09:46.792488 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-09 03:09:46.793001 (Thread-1): finished collecting timing info
2020-10-09 03:09:46.808891 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:46.809073 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-09 03:09:46.809524 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.817086 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:46.817294 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-09 03:09:46.817806 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.820892 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-09 03:09:46.821426 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:46.821591 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-09 03:09:46.821921 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:46.822086 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:46.822244 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-09 03:09:46.824350 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-09 03:09:46.830231 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:46.830433 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-09 03:09:46.831086 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-09 03:09:46.832907 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-09 03:09:46.833072 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:46.833212 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-09 03:09:46.834315 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:46.838475 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:46.838649 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-09 03:09:46.839068 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.844550 (Thread-1): finished collecting timing info
2020-10-09 03:09:46.845898 (Thread-1): 03:09:46 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.08s]
2020-10-09 03:09:46.846418 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-09 03:09:46.846946 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-09 03:09:46.847194 (Thread-1): 03:09:46 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-09 03:09:46.847850 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:46.848000 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-09 03:09:46.848154 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-09 03:09:46.865200 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-09 03:09:46.865659 (Thread-1): finished collecting timing info
2020-10-09 03:09:46.877710 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:46.877872 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-09 03:09:46.878318 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.881647 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:46.881919 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-09 03:09:46.882283 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.884323 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-09 03:09:46.884647 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:46.884756 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-09 03:09:46.885020 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:46.885145 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:46.885252 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-09 03:09:46.886374 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-09 03:09:46.889734 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:46.889862 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-09 03:09:46.890304 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-09 03:09:46.891407 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-09 03:09:46.891526 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:46.891626 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-09 03:09:46.892661 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:46.895394 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:46.895544 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-09 03:09:46.895949 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.899269 (Thread-1): finished collecting timing info
2020-10-09 03:09:46.900046 (Thread-1): 03:09:46 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.05s]
2020-10-09 03:09:46.900193 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-09 03:09:46.982534 (MainThread): Using postgres connection "master".
2020-10-09 03:09:46.982690 (MainThread): On master: BEGIN
2020-10-09 03:09:46.982957 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:46.983076 (MainThread): On master: COMMIT
2020-10-09 03:09:46.983168 (MainThread): Using postgres connection "master".
2020-10-09 03:09:46.983255 (MainThread): On master: COMMIT
2020-10-09 03:09:46.983435 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:46.983767 (MainThread): 03:09:46 | 
2020-10-09 03:09:46.983903 (MainThread): 03:09:46 | Finished running 4 view models in 0.68s.
2020-10-09 03:09:46.984013 (MainThread): Connection 'master' was left open.
2020-10-09 03:09:46.984102 (MainThread): On master: Close
2020-10-09 03:09:46.984247 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-09 03:09:46.984377 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-09 03:09:47.002466 (MainThread): 
2020-10-09 03:09:47.002665 (MainThread): Completed successfully
2020-10-09 03:09:47.002810 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-09 03:09:47.003018 (MainThread): Flushing usage events
2020-10-09 13:55:59.544685 (MainThread): Got an exception trying to initialize tracking
2020-10-09 13:55:59.544840 (MainThread): Running with dbt=0.16.0
2020-10-09 13:55:59.626896 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-09 13:55:59.627253 (MainThread): Tracking: do not track
2020-10-09 13:55:59.667117 (MainThread): Partial parsing not enabled
2020-10-09 13:55:59.672155 (MainThread): Parsing macros/core.sql
2020-10-09 13:55:59.685734 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-09 13:55:59.711006 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-09 13:55:59.733074 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-09 13:55:59.780115 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-09 13:55:59.790947 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-09 13:55:59.801993 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-09 13:55:59.864676 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-09 13:55:59.893900 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-09 13:55:59.897072 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-09 13:55:59.908327 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-09 13:55:59.911696 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-09 13:55:59.959653 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-09 13:55:59.962552 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-09 13:55:59.967231 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-09 13:55:59.969278 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-09 13:55:59.971537 (MainThread): Parsing macros/etc/query.sql
2020-10-09 13:55:59.973701 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-09 13:55:59.977951 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-09 13:55:59.980294 (MainThread): Parsing macros/etc/datetime.sql
2020-10-09 13:56:00.002917 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-09 13:56:00.007597 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-09 13:56:00.011468 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-09 13:56:00.013890 (MainThread): Parsing macros/adapters/common.sql
2020-10-09 13:56:00.112916 (MainThread): Parsing macros/relations.sql
2020-10-09 13:56:00.116003 (MainThread): Parsing macros/adapters.sql
2020-10-09 13:56:00.154958 (MainThread): Parsing macros/catalog.sql
2020-10-09 13:56:00.160865 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-09 13:56:00.197994 (MainThread): Partial parsing not enabled
2020-10-09 13:56:00.248994 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 13:56:00.249146 (MainThread): Opening a new connection, currently in state init
2020-10-09 13:56:00.276207 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 13:56:00.276356 (MainThread): Opening a new connection, currently in state init
2020-10-09 13:56:00.284386 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 13:56:00.284527 (MainThread): Opening a new connection, currently in state init
2020-10-09 13:56:00.292929 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 13:56:00.293071 (MainThread): Opening a new connection, currently in state init
2020-10-09 13:56:00.750056 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-09 13:56:00.754324 (MainThread): 
2020-10-09 13:56:00.754525 (MainThread): 13:56:00 | Concurrency: 1 threads (target='dev')
2020-10-09 13:56:00.754669 (MainThread): 13:56:00 | 
2020-10-09 13:56:00.761596 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-09 13:56:00.762021 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 13:56:00.762129 (Thread-1): Opening a new connection, currently in state init
2020-10-09 13:56:00.762250 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-09 13:56:00.784786 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-09 13:56:00.785077 (Thread-1): finished collecting timing info
2020-10-09 13:56:00.785380 (Thread-1): finished collecting timing info
2020-10-09 13:56:00.785841 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-09 13:56:00.785994 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 13:56:00.786274 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 13:56:00.786376 (Thread-1): Opening a new connection, currently in state init
2020-10-09 13:56:00.786606 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-09 13:56:00.795958 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-09 13:56:00.796249 (Thread-1): finished collecting timing info
2020-10-09 13:56:00.796536 (Thread-1): finished collecting timing info
2020-10-09 13:56:00.796990 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 13:56:00.797446 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-09 13:56:00.797747 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 13:56:00.797849 (Thread-1): Opening a new connection, currently in state init
2020-10-09 13:56:00.797945 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-09 13:56:00.808436 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-09 13:56:00.808680 (Thread-1): finished collecting timing info
2020-10-09 13:56:00.808950 (Thread-1): finished collecting timing info
2020-10-09 13:56:00.809364 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-09 13:56:00.809779 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-09 13:56:00.810069 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 13:56:00.810167 (Thread-1): Opening a new connection, currently in state init
2020-10-09 13:56:00.810257 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-09 13:56:00.818782 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-09 13:56:00.819063 (Thread-1): finished collecting timing info
2020-10-09 13:56:00.819343 (Thread-1): finished collecting timing info
2020-10-09 13:56:00.819785 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-09 13:56:00.861627 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-09 13:56:00.861787 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was properly closed.
2020-10-09 13:56:00.875289 (MainThread): 13:56:00 | Done.
2020-10-09 13:56:00.878027 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-09 13:56:00.878135 (MainThread): Opening a new connection, currently in state init
2020-10-09 13:56:00.878223 (MainThread): 13:56:00 | Building catalog
2020-10-09 13:56:00.910311 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-09 13:56:00.910483 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-09 13:56:01.069907 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-09 13:56:01.070139 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-09 13:56:01.074818 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-09 13:56:01.075010 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-09 13:56:01.075137 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-09 13:56:01.080900 (ThreadPoolExecutor-0_0): SQL status: SELECT 197 in 0.01 seconds
2020-10-09 13:56:01.106548 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-09 13:56:01.281472 (MainThread): 13:56:01 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-09 13:56:01.282001 (MainThread): Flushing usage events
2020-10-09 13:56:01.282170 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-09 13:56:01.282260 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-09 13:56:01.282361 (MainThread): On airflow.information_schema: Close
2020-10-09 13:56:02.565593 (MainThread): Got an exception trying to initialize tracking
2020-10-09 13:56:02.565781 (MainThread): Running with dbt=0.16.0
2020-10-09 13:56:02.650590 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-09 13:56:02.650938 (MainThread): Tracking: do not track
2020-10-09 13:56:02.658172 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-09 13:56:02.658550 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-09 13:56:02.658690 (MainThread): Press Ctrl+C to exit.


2020-10-10 02:56:06.604279 (MainThread): Got an exception trying to initialize tracking
2020-10-10 02:56:06.604455 (MainThread): Running with dbt=0.16.0
2020-10-10 02:56:06.690493 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-10 02:56:06.690847 (MainThread): Tracking: do not track
2020-10-10 02:56:06.726202 (MainThread): Partial parsing not enabled
2020-10-10 02:56:06.728276 (MainThread): Parsing macros/core.sql
2020-10-10 02:56:06.736089 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-10 02:56:06.750770 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-10 02:56:06.762895 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-10 02:56:06.803634 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-10 02:56:06.819407 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-10 02:56:06.840302 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-10 02:56:06.944215 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-10 02:56:06.975977 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-10 02:56:06.979019 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-10 02:56:06.990066 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-10 02:56:06.993671 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-10 02:56:07.035636 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-10 02:56:07.037631 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-10 02:56:07.041527 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-10 02:56:07.042995 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-10 02:56:07.044759 (MainThread): Parsing macros/etc/query.sql
2020-10-10 02:56:07.046412 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-10 02:56:07.049860 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-10 02:56:07.051571 (MainThread): Parsing macros/etc/datetime.sql
2020-10-10 02:56:07.069083 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-10 02:56:07.072502 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-10 02:56:07.075266 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-10 02:56:07.076823 (MainThread): Parsing macros/adapters/common.sql
2020-10-10 02:56:07.204319 (MainThread): Parsing macros/relations.sql
2020-10-10 02:56:07.207874 (MainThread): Parsing macros/adapters.sql
2020-10-10 02:56:07.247809 (MainThread): Parsing macros/catalog.sql
2020-10-10 02:56:07.252960 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-10 02:56:07.284309 (MainThread): Partial parsing not enabled
2020-10-10 02:56:07.333596 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-10 02:56:07.333771 (MainThread): Opening a new connection, currently in state init
2020-10-10 02:56:07.367296 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-10 02:56:07.367465 (MainThread): Opening a new connection, currently in state init
2020-10-10 02:56:07.377744 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-10 02:56:07.377917 (MainThread): Opening a new connection, currently in state init
2020-10-10 02:56:07.388458 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-10 02:56:07.388637 (MainThread): Opening a new connection, currently in state init
2020-10-10 02:56:07.857599 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-10 02:56:07.862051 (MainThread): 
2020-10-10 02:56:07.862259 (MainThread): 02:56:07 | Concurrency: 1 threads (target='dev')
2020-10-10 02:56:07.862414 (MainThread): 02:56:07 | 
2020-10-10 02:56:07.869610 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-10 02:56:07.870060 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-10 02:56:07.870173 (Thread-1): Opening a new connection, currently in state init
2020-10-10 02:56:07.870281 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-10 02:56:07.893358 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-10 02:56:07.893745 (Thread-1): finished collecting timing info
2020-10-10 02:56:07.894074 (Thread-1): finished collecting timing info
2020-10-10 02:56:07.894564 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-10 02:56:07.894717 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-10 02:56:07.894997 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-10 02:56:07.895109 (Thread-1): Opening a new connection, currently in state init
2020-10-10 02:56:07.895212 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-10 02:56:07.905359 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-10 02:56:07.905687 (Thread-1): finished collecting timing info
2020-10-10 02:56:07.905991 (Thread-1): finished collecting timing info
2020-10-10 02:56:07.906473 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-10 02:56:07.906894 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-10 02:56:07.907210 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-10 02:56:07.907317 (Thread-1): Opening a new connection, currently in state init
2020-10-10 02:56:07.907417 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-10 02:56:07.918191 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-10 02:56:07.918481 (Thread-1): finished collecting timing info
2020-10-10 02:56:07.918769 (Thread-1): finished collecting timing info
2020-10-10 02:56:07.919214 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-10 02:56:07.919655 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-10 02:56:07.919956 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-10 02:56:07.920059 (Thread-1): Opening a new connection, currently in state init
2020-10-10 02:56:07.920154 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-10 02:56:07.929057 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-10 02:56:07.929295 (Thread-1): finished collecting timing info
2020-10-10 02:56:07.929564 (Thread-1): finished collecting timing info
2020-10-10 02:56:07.929976 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-10 02:56:07.969501 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-10 02:56:07.969651 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was properly closed.
2020-10-10 02:56:07.982808 (MainThread): 02:56:07 | Done.
2020-10-10 02:56:07.984540 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-10 02:56:07.984654 (MainThread): Opening a new connection, currently in state init
2020-10-10 02:56:07.984746 (MainThread): 02:56:07 | Building catalog
2020-10-10 02:56:08.015700 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-10 02:56:08.015852 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-10 02:56:08.118661 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-10 02:56:08.118812 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-10 02:56:08.122050 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-10 02:56:08.122275 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-10 02:56:08.122426 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-10 02:56:08.130311 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.01 seconds
2020-10-10 02:56:08.162323 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-10 02:56:08.353162 (MainThread): 02:56:08 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-10 02:56:08.353752 (MainThread): Flushing usage events
2020-10-10 02:56:08.353965 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-10 02:56:08.354083 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-10 02:56:08.354193 (MainThread): On airflow.information_schema: Close
2020-10-10 02:56:09.676569 (MainThread): Got an exception trying to initialize tracking
2020-10-10 02:56:09.676733 (MainThread): Running with dbt=0.16.0
2020-10-10 02:56:09.767662 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-10 02:56:09.768055 (MainThread): Tracking: do not track
2020-10-10 02:56:09.777509 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-10 02:56:09.777839 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-10 02:56:09.777993 (MainThread): Press Ctrl+C to exit.


2020-10-10 03:03:47.521172 (MainThread): Got an exception trying to initialize tracking
2020-10-10 03:03:47.521316 (MainThread): Running with dbt=0.16.0
2020-10-10 03:03:47.605024 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-10 03:03:47.605385 (MainThread): Tracking: do not track
2020-10-10 03:03:47.640819 (MainThread): Partial parsing not enabled
2020-10-10 03:03:47.642936 (MainThread): Parsing macros/core.sql
2020-10-10 03:03:47.651069 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-10 03:03:47.666645 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-10 03:03:47.679586 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-10 03:03:47.705227 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-10 03:03:47.713956 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-10 03:03:47.725667 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-10 03:03:47.833969 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-10 03:03:47.880050 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-10 03:03:47.883149 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-10 03:03:47.894635 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-10 03:03:47.898211 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-10 03:03:47.942156 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-10 03:03:47.944011 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-10 03:03:47.947246 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-10 03:03:47.948575 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-10 03:03:47.950216 (MainThread): Parsing macros/etc/query.sql
2020-10-10 03:03:47.951760 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-10 03:03:47.954960 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-10 03:03:47.956565 (MainThread): Parsing macros/etc/datetime.sql
2020-10-10 03:03:47.973055 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-10 03:03:47.976277 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-10 03:03:47.978923 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-10 03:03:47.980467 (MainThread): Parsing macros/adapters/common.sql
2020-10-10 03:03:48.086645 (MainThread): Parsing macros/relations.sql
2020-10-10 03:03:48.091263 (MainThread): Parsing macros/adapters.sql
2020-10-10 03:03:48.143578 (MainThread): Parsing macros/catalog.sql
2020-10-10 03:03:48.148740 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-10 03:03:48.180124 (MainThread): Partial parsing not enabled
2020-10-10 03:03:48.239063 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-10 03:03:48.239231 (MainThread): Opening a new connection, currently in state init
2020-10-10 03:03:48.268147 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-10 03:03:48.268329 (MainThread): Opening a new connection, currently in state init
2020-10-10 03:03:48.278049 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-10 03:03:48.278226 (MainThread): Opening a new connection, currently in state init
2020-10-10 03:03:48.289147 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-10 03:03:48.289349 (MainThread): Opening a new connection, currently in state init
2020-10-10 03:03:48.766088 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-10 03:03:48.770931 (MainThread): 
2020-10-10 03:03:48.771134 (MainThread): 03:03:48 | Concurrency: 1 threads (target='dev')
2020-10-10 03:03:48.771275 (MainThread): 03:03:48 | 
2020-10-10 03:03:48.778874 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-10 03:03:48.779327 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-10 03:03:48.779448 (Thread-1): Opening a new connection, currently in state init
2020-10-10 03:03:48.779560 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-10 03:03:48.803050 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-10 03:03:48.803382 (Thread-1): finished collecting timing info
2020-10-10 03:03:48.803689 (Thread-1): finished collecting timing info
2020-10-10 03:03:48.804163 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-10 03:03:48.804325 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-10 03:03:48.804610 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-10 03:03:48.804740 (Thread-1): Opening a new connection, currently in state init
2020-10-10 03:03:48.804987 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-10 03:03:48.814446 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-10 03:03:48.814755 (Thread-1): finished collecting timing info
2020-10-10 03:03:48.815052 (Thread-1): finished collecting timing info
2020-10-10 03:03:48.815529 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-10 03:03:48.816005 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-10 03:03:48.816339 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-10 03:03:48.816446 (Thread-1): Opening a new connection, currently in state init
2020-10-10 03:03:48.816543 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-10 03:03:48.827265 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-10 03:03:48.827550 (Thread-1): finished collecting timing info
2020-10-10 03:03:48.827834 (Thread-1): finished collecting timing info
2020-10-10 03:03:48.828296 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-10 03:03:48.828758 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-10 03:03:48.829077 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-10 03:03:48.829182 (Thread-1): Opening a new connection, currently in state init
2020-10-10 03:03:48.829280 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-10 03:03:48.838439 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-10 03:03:48.838744 (Thread-1): finished collecting timing info
2020-10-10 03:03:48.839038 (Thread-1): finished collecting timing info
2020-10-10 03:03:48.839506 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-10 03:03:48.878824 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-10 03:03:48.878974 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was properly closed.
2020-10-10 03:03:48.892848 (MainThread): 03:03:48 | Done.
2020-10-10 03:03:48.894637 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-10 03:03:48.894739 (MainThread): Opening a new connection, currently in state init
2020-10-10 03:03:48.894829 (MainThread): 03:03:48 | Building catalog
2020-10-10 03:03:48.925631 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-10 03:03:48.925770 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-10 03:03:49.029475 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-10 03:03:49.029630 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-10 03:03:49.032998 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-10 03:03:49.033168 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-10 03:03:49.033266 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-10 03:03:49.036525 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.00 seconds
2020-10-10 03:03:49.055153 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-10 03:03:49.296477 (MainThread): 03:03:49 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-10 03:03:49.297093 (MainThread): Flushing usage events
2020-10-10 03:03:49.297308 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-10 03:03:49.297428 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-10 03:03:49.297540 (MainThread): On airflow.information_schema: Close
2020-10-10 03:03:50.646865 (MainThread): Got an exception trying to initialize tracking
2020-10-10 03:03:50.647015 (MainThread): Running with dbt=0.16.0
2020-10-10 03:03:50.731172 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-10 03:03:50.731527 (MainThread): Tracking: do not track
2020-10-10 03:03:50.741115 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-10 03:03:50.741417 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-10 03:03:50.741556 (MainThread): Press Ctrl+C to exit.


2020-10-12 16:26:17.410706 (MainThread): Got an exception trying to initialize tracking
2020-10-12 16:26:17.410888 (MainThread): Running with dbt=0.16.0
2020-10-12 16:26:17.522796 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-12 16:26:17.525262 (MainThread): Tracking: do not track
2020-10-12 16:26:17.572847 (MainThread): Partial parsing not enabled
2020-10-12 16:26:17.575983 (MainThread): Parsing macros/core.sql
2020-10-12 16:26:17.587144 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 16:26:17.607436 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 16:26:17.624496 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 16:26:17.655138 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 16:26:17.665499 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 16:26:17.679940 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 16:26:17.815316 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 16:26:17.865994 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 16:26:17.869841 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 16:26:17.882661 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 16:26:17.886801 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 16:26:17.936460 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 16:26:17.939103 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 16:26:17.943807 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 16:26:17.945923 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 16:26:17.948469 (MainThread): Parsing macros/etc/query.sql
2020-10-12 16:26:17.951219 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 16:26:17.956910 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 16:26:17.959386 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 16:26:17.985969 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 16:26:17.991374 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 16:26:17.995165 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 16:26:17.997238 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 16:26:18.109010 (MainThread): Parsing macros/relations.sql
2020-10-12 16:26:18.112310 (MainThread): Parsing macros/adapters.sql
2020-10-12 16:26:18.162053 (MainThread): Parsing macros/catalog.sql
2020-10-12 16:26:18.170207 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 16:26:18.220402 (MainThread): Partial parsing not enabled
2020-10-12 16:26:18.287702 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:26:18.287883 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:26:18.321363 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:26:18.321518 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:26:18.330836 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:26:18.330988 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:26:18.342393 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:26:18.342625 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:26:18.857145 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 16:26:18.862452 (MainThread): 
2020-10-12 16:26:18.862773 (MainThread): 16:26:18 | Concurrency: 1 threads (target='dev')
2020-10-12 16:26:18.862954 (MainThread): 16:26:18 | 
2020-10-12 16:26:18.871768 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-12 16:26:18.872289 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:26:18.872424 (Thread-1): Opening a new connection, currently in state init
2020-10-12 16:26:18.872552 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-12 16:26:18.900815 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:26:18.901609 (Thread-1): finished collecting timing info
2020-10-12 16:26:18.902012 (Thread-1): finished collecting timing info
2020-10-12 16:26:18.902595 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-12 16:26:18.902795 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:26:18.903144 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:26:18.903271 (Thread-1): Opening a new connection, currently in state init
2020-10-12 16:26:18.903394 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:26:18.915174 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:26:18.915559 (Thread-1): finished collecting timing info
2020-10-12 16:26:18.915930 (Thread-1): finished collecting timing info
2020-10-12 16:26:18.916521 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:26:18.916969 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-12 16:26:18.917301 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:26:18.917419 (Thread-1): Opening a new connection, currently in state init
2020-10-12 16:26:18.917534 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-12 16:26:18.930095 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 16:26:18.930422 (Thread-1): finished collecting timing info
2020-10-12 16:26:18.930747 (Thread-1): finished collecting timing info
2020-10-12 16:26:18.931264 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-12 16:26:18.931737 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:26:18.932072 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:26:18.932185 (Thread-1): Opening a new connection, currently in state init
2020-10-12 16:26:18.932293 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-12 16:26:18.942527 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 16:26:18.942869 (Thread-1): finished collecting timing info
2020-10-12 16:26:18.943181 (Thread-1): finished collecting timing info
2020-10-12 16:26:18.943670 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:26:18.971719 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-12 16:26:18.971891 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was properly closed.
2020-10-12 16:26:18.987749 (MainThread): 16:26:18 | Done.
2020-10-12 16:26:18.989631 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-12 16:26:18.989749 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:26:18.989848 (MainThread): 16:26:18 | Building catalog
2020-10-12 16:26:19.025585 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-12 16:26:19.025746 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-12 16:26:19.141987 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-12 16:26:19.142142 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-12 16:26:19.145587 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:26:19.145734 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-12 16:26:19.145830 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-12 16:26:19.149201 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.00 seconds
2020-10-12 16:26:19.167939 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-12 16:26:19.344163 (MainThread): 16:26:19 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-12 16:26:19.345055 (MainThread): Flushing usage events
2020-10-12 16:26:19.345328 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-12 16:26:19.345481 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-12 16:26:19.345640 (MainThread): On airflow.information_schema: Close
2020-10-12 16:26:20.729892 (MainThread): Got an exception trying to initialize tracking
2020-10-12 16:26:20.730045 (MainThread): Running with dbt=0.16.0
2020-10-12 16:26:20.813905 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-12 16:26:20.814267 (MainThread): Tracking: do not track
2020-10-12 16:26:20.822761 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-12 16:26:20.823066 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-12 16:26:20.823228 (MainThread): Press Ctrl+C to exit.


2020-10-12 16:34:47.919355 (MainThread): Got an exception trying to initialize tracking
2020-10-12 16:34:47.919534 (MainThread): Running with dbt=0.16.0
2020-10-12 16:34:48.014566 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 16:34:48.014988 (MainThread): Tracking: do not track
2020-10-12 16:34:48.053575 (MainThread): Partial parsing not enabled
2020-10-12 16:34:48.055758 (MainThread): Parsing macros/core.sql
2020-10-12 16:34:48.064161 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 16:34:48.080156 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 16:34:48.093814 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 16:34:48.121424 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 16:34:48.130719 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 16:34:48.143042 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 16:34:48.212015 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 16:34:48.241522 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 16:34:48.244450 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 16:34:48.255254 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 16:34:48.258510 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 16:34:48.299104 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 16:34:48.301008 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 16:34:48.304551 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 16:34:48.306067 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 16:34:48.307855 (MainThread): Parsing macros/etc/query.sql
2020-10-12 16:34:48.309510 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 16:34:48.312877 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 16:34:48.314533 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 16:34:48.332021 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 16:34:48.335497 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 16:34:48.338334 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 16:34:48.339908 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 16:34:48.466704 (MainThread): Parsing macros/relations.sql
2020-10-12 16:34:48.471451 (MainThread): Parsing macros/adapters.sql
2020-10-12 16:34:48.527077 (MainThread): Parsing macros/catalog.sql
2020-10-12 16:34:48.532420 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 16:34:48.568428 (MainThread): Partial parsing not enabled
2020-10-12 16:34:48.620001 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:34:48.620164 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:34:48.646455 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:34:48.646597 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:34:48.654331 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:34:48.654464 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:34:48.662692 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:34:48.662811 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:34:49.113347 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 16:34:49.118268 (MainThread): 
2020-10-12 16:34:49.118719 (MainThread): Acquiring new postgres connection "master".
2020-10-12 16:34:49.118856 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:34:49.145238 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-12 16:34:49.145520 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-12 16:34:49.280046 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-12 16:34:49.280190 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-12 16:34:49.286614 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2020-10-12 16:34:49.311068 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-12 16:34:49.311214 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-12 16:34:49.313361 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:34:49.313479 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-12 16:34:49.313835 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:34:49.313958 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:34:49.314052 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-12 16:34:49.316274 (ThreadPoolExecutor-1_0): SQL status: SELECT 25 in 0.00 seconds
2020-10-12 16:34:49.345078 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-12 16:34:49.372835 (MainThread): Using postgres connection "master".
2020-10-12 16:34:49.372985 (MainThread): On master: BEGIN
2020-10-12 16:34:49.375721 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:34:49.375902 (MainThread): Using postgres connection "master".
2020-10-12 16:34:49.376003 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-12 16:34:49.381849 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-10-12 16:34:49.383017 (MainThread): On master: ROLLBACK
2020-10-12 16:34:49.383262 (MainThread): Using postgres connection "master".
2020-10-12 16:34:49.383371 (MainThread): On master: BEGIN
2020-10-12 16:34:49.383666 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:34:49.383788 (MainThread): On master: COMMIT
2020-10-12 16:34:49.383884 (MainThread): Using postgres connection "master".
2020-10-12 16:34:49.383973 (MainThread): On master: COMMIT
2020-10-12 16:34:49.384158 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:34:49.384478 (MainThread): 16:34:49 | Concurrency: 1 threads (target='dev')
2020-10-12 16:34:49.384625 (MainThread): 16:34:49 | 
2020-10-12 16:34:49.395105 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-12 16:34:49.395326 (Thread-1): 16:34:49 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-12 16:34:49.395722 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:34:49.395837 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-12 16:34:49.395944 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-12 16:34:49.420760 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:34:49.421133 (Thread-1): finished collecting timing info
2020-10-12 16:34:49.476633 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:34:49.476847 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-12 16:34:49.477360 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:34:49.481235 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:34:49.481442 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 16:34:49.481881 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:34:49.484373 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:34:49.485287 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:34:49.485453 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-12 16:34:49.485894 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:34:49.486123 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:34:49.486297 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-12 16:34:49.486764 (Thread-1): Postgres error: relation "public.npi_small" does not exist
LINE 12:   from "airflow"."public"."npi_small"
                ^

2020-10-12 16:34:49.486956 (Thread-1): On model.ge_tutorials.stg_npi: ROLLBACK
2020-10-12 16:34:49.487325 (Thread-1): finished collecting timing info
2020-10-12 16:34:49.488190 (Thread-1): Database Error in model stg_npi (models/staging/stg_npi.sql)
  relation "public.npi_small" does not exist
  LINE 12:   from "airflow"."public"."npi_small"
                  ^
  compiled SQL at target/run/ge_tutorials/staging/stg_npi.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "public.npi_small" does not exist
LINE 12:   from "airflow"."public"."npi_small"
                ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 220, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model stg_npi (models/staging/stg_npi.sql)
  relation "public.npi_small" does not exist
  LINE 12:   from "airflow"."public"."npi_small"
                  ^
  compiled SQL at target/run/ge_tutorials/staging/stg_npi.sql
2020-10-12 16:34:49.491410 (Thread-1): 16:34:49 | 1 of 4 ERROR creating view model public.stg_npi...................... [ERROR in 0.10s]
2020-10-12 16:34:49.491688 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-12 16:34:49.491959 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:34:49.492208 (Thread-1): 16:34:49 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-12 16:34:49.492770 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:34:49.493098 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-12 16:34:49.493274 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:34:49.511787 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:34:49.512337 (Thread-1): finished collecting timing info
2020-10-12 16:34:49.533294 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:34:49.533551 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-12 16:34:49.534183 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:34:49.539589 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:34:49.539774 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 16:34:49.540227 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:34:49.542630 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:34:49.543055 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:34:49.543188 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-12 16:34:49.543572 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:34:49.543778 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:34:49.543959 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-12 16:34:49.544428 (Thread-1): Postgres error: relation "public.state_abbreviations" does not exist
LINE 7:   from "airflow"."public"."state_abbreviations"
               ^

2020-10-12 16:34:49.544623 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: ROLLBACK
2020-10-12 16:34:49.545031 (Thread-1): finished collecting timing info
2020-10-12 16:34:49.545864 (Thread-1): Database Error in model stg_state_abbreviations (models/staging/stg_state_abbreviations.sql)
  relation "public.state_abbreviations" does not exist
  LINE 7:   from "airflow"."public"."state_abbreviations"
                 ^
  compiled SQL at target/run/ge_tutorials/staging/stg_state_abbreviations.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "public.state_abbreviations" does not exist
LINE 7:   from "airflow"."public"."state_abbreviations"
               ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 220, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model stg_state_abbreviations (models/staging/stg_state_abbreviations.sql)
  relation "public.state_abbreviations" does not exist
  LINE 7:   from "airflow"."public"."state_abbreviations"
                 ^
  compiled SQL at target/run/ge_tutorials/staging/stg_state_abbreviations.sql
2020-10-12 16:34:49.546894 (Thread-1): 16:34:49 | 2 of 4 ERROR creating view model public.stg_state_abbreviations...... [ERROR in 0.05s]
2020-10-12 16:34:49.547135 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:34:49.547686 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-12 16:34:49.547922 (Thread-1): 16:34:49 | 3 of 4 SKIP relation public.npi_with_state........................... [SKIP]
2020-10-12 16:34:49.548145 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-12 16:34:49.548599 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:34:49.548852 (Thread-1): 16:34:49 | 4 of 4 SKIP relation public.count_providers_by_state................. [SKIP]
2020-10-12 16:34:49.549073 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:34:49.592055 (MainThread): Using postgres connection "master".
2020-10-12 16:34:49.592306 (MainThread): On master: BEGIN
2020-10-12 16:34:49.592682 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:34:49.592864 (MainThread): On master: COMMIT
2020-10-12 16:34:49.593018 (MainThread): Using postgres connection "master".
2020-10-12 16:34:49.593167 (MainThread): On master: COMMIT
2020-10-12 16:34:49.593447 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:34:49.593927 (MainThread): 16:34:49 | 
2020-10-12 16:34:49.594117 (MainThread): 16:34:49 | Finished running 4 view models in 0.48s.
2020-10-12 16:34:49.594286 (MainThread): Connection 'master' was left open.
2020-10-12 16:34:49.594414 (MainThread): On master: Close
2020-10-12 16:34:49.594594 (MainThread): Connection 'model.ge_tutorials.stg_state_abbreviations' was left open.
2020-10-12 16:34:49.594729 (MainThread): On model.ge_tutorials.stg_state_abbreviations: Close
2020-10-12 16:34:49.616512 (MainThread): 
2020-10-12 16:34:49.616776 (MainThread): Completed with 2 errors and 0 warnings:
2020-10-12 16:34:49.616969 (MainThread): 
2020-10-12 16:34:49.617152 (MainThread): Database Error in model stg_npi (models/staging/stg_npi.sql)
2020-10-12 16:34:49.617321 (MainThread):   relation "public.npi_small" does not exist
2020-10-12 16:34:49.617480 (MainThread):   LINE 12:   from "airflow"."public"."npi_small"
2020-10-12 16:34:49.617642 (MainThread):                   ^
2020-10-12 16:34:49.617800 (MainThread):   compiled SQL at target/run/ge_tutorials/staging/stg_npi.sql
2020-10-12 16:34:49.617972 (MainThread): 
2020-10-12 16:34:49.618147 (MainThread): Database Error in model stg_state_abbreviations (models/staging/stg_state_abbreviations.sql)
2020-10-12 16:34:49.618305 (MainThread):   relation "public.state_abbreviations" does not exist
2020-10-12 16:34:49.618454 (MainThread):   LINE 7:   from "airflow"."public"."state_abbreviations"
2020-10-12 16:34:49.618598 (MainThread):                  ^
2020-10-12 16:34:49.618758 (MainThread):   compiled SQL at target/run/ge_tutorials/staging/stg_state_abbreviations.sql
2020-10-12 16:34:49.618950 (MainThread): 
Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
2020-10-12 16:34:49.619348 (MainThread): Flushing usage events
2020-10-12 16:39:54.649640 (MainThread): Got an exception trying to initialize tracking
2020-10-12 16:39:54.649803 (MainThread): Running with dbt=0.16.0
2020-10-12 16:39:54.736466 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 16:39:54.736812 (MainThread): Tracking: do not track
2020-10-12 16:39:54.772003 (MainThread): Partial parsing not enabled
2020-10-12 16:39:54.774507 (MainThread): Parsing macros/core.sql
2020-10-12 16:39:54.784770 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 16:39:54.801021 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 16:39:54.814581 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 16:39:54.842239 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 16:39:54.851815 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 16:39:54.864603 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 16:39:54.935213 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 16:39:54.966972 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 16:39:54.970105 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 16:39:54.981667 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 16:39:54.985352 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 16:39:55.037927 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 16:39:55.040423 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 16:39:55.044839 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 16:39:55.046577 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 16:39:55.048729 (MainThread): Parsing macros/etc/query.sql
2020-10-12 16:39:55.050720 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 16:39:55.054586 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 16:39:55.056473 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 16:39:55.075719 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 16:39:55.079570 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 16:39:55.082601 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 16:39:55.084252 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 16:39:55.177695 (MainThread): Parsing macros/relations.sql
2020-10-12 16:39:55.180618 (MainThread): Parsing macros/adapters.sql
2020-10-12 16:39:55.216794 (MainThread): Parsing macros/catalog.sql
2020-10-12 16:39:55.221246 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 16:39:55.250528 (MainThread): Partial parsing not enabled
2020-10-12 16:39:55.297595 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:39:55.297750 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:39:55.324850 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:39:55.325010 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:39:55.333323 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:39:55.333464 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:39:55.342134 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:39:55.342273 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:39:55.886561 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 16:39:55.891677 (MainThread): 
2020-10-12 16:39:55.892120 (MainThread): Acquiring new postgres connection "master".
2020-10-12 16:39:55.892246 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:39:55.919001 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-12 16:39:55.919169 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-12 16:39:56.053857 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-12 16:39:56.054001 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-12 16:39:56.057876 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-12 16:39:56.082070 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-12 16:39:56.082207 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-12 16:39:56.084281 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:39:56.084392 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-12 16:39:56.084738 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:39:56.084861 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:39:56.084952 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-12 16:39:56.087004 (ThreadPoolExecutor-1_0): SQL status: SELECT 25 in 0.00 seconds
2020-10-12 16:39:56.115411 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-12 16:39:56.143330 (MainThread): Using postgres connection "master".
2020-10-12 16:39:56.143479 (MainThread): On master: BEGIN
2020-10-12 16:39:56.146573 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:39:56.146697 (MainThread): Using postgres connection "master".
2020-10-12 16:39:56.146800 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-12 16:39:56.152127 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-10-12 16:39:56.153188 (MainThread): On master: ROLLBACK
2020-10-12 16:39:56.153461 (MainThread): Using postgres connection "master".
2020-10-12 16:39:56.153567 (MainThread): On master: BEGIN
2020-10-12 16:39:56.154020 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:39:56.154138 (MainThread): On master: COMMIT
2020-10-12 16:39:56.154231 (MainThread): Using postgres connection "master".
2020-10-12 16:39:56.154316 (MainThread): On master: COMMIT
2020-10-12 16:39:56.154559 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:39:56.154876 (MainThread): 16:39:56 | Concurrency: 1 threads (target='dev')
2020-10-12 16:39:56.155018 (MainThread): 16:39:56 | 
2020-10-12 16:39:56.161363 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-12 16:39:56.161565 (Thread-1): 16:39:56 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-12 16:39:56.161911 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:39:56.162005 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-12 16:39:56.162105 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-12 16:39:56.188271 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:39:56.188625 (Thread-1): finished collecting timing info
2020-10-12 16:39:56.240345 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:39:56.240515 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-12 16:39:56.241088 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:39:56.244075 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:39:56.244185 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 16:39:56.244488 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:39:56.246344 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:39:56.246661 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:39:56.246775 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-12 16:39:56.247058 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:39:56.247177 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:39:56.247270 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-12 16:39:56.247607 (Thread-1): Postgres error: relation "public.npi_small" does not exist
LINE 12:   from "airflow"."public"."npi_small"
                ^

2020-10-12 16:39:56.247722 (Thread-1): On model.ge_tutorials.stg_npi: ROLLBACK
2020-10-12 16:39:56.248040 (Thread-1): finished collecting timing info
2020-10-12 16:39:56.248513 (Thread-1): Database Error in model stg_npi (models/staging/stg_npi.sql)
  relation "public.npi_small" does not exist
  LINE 12:   from "airflow"."public"."npi_small"
                  ^
  compiled SQL at target/run/ge_tutorials/staging/stg_npi.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "public.npi_small" does not exist
LINE 12:   from "airflow"."public"."npi_small"
                ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 220, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model stg_npi (models/staging/stg_npi.sql)
  relation "public.npi_small" does not exist
  LINE 12:   from "airflow"."public"."npi_small"
                  ^
  compiled SQL at target/run/ge_tutorials/staging/stg_npi.sql
2020-10-12 16:39:56.250235 (Thread-1): 16:39:56 | 1 of 4 ERROR creating view model public.stg_npi...................... [ERROR in 0.09s]
2020-10-12 16:39:56.250388 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-12 16:39:56.250547 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:39:56.250858 (Thread-1): 16:39:56 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-12 16:39:56.251155 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:39:56.251246 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-12 16:39:56.251339 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:39:56.260838 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:39:56.261161 (Thread-1): finished collecting timing info
2020-10-12 16:39:56.272648 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:39:56.272822 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-12 16:39:56.273253 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:39:56.276419 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:39:56.276536 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 16:39:56.276822 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:39:56.278728 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:39:56.279098 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:39:56.279212 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-12 16:39:56.279539 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:39:56.279654 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:39:56.279745 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-12 16:39:56.280065 (Thread-1): Postgres error: relation "public.state_abbreviations" does not exist
LINE 7:   from "airflow"."public"."state_abbreviations"
               ^

2020-10-12 16:39:56.280171 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: ROLLBACK
2020-10-12 16:39:56.280490 (Thread-1): finished collecting timing info
2020-10-12 16:39:56.281018 (Thread-1): Database Error in model stg_state_abbreviations (models/staging/stg_state_abbreviations.sql)
  relation "public.state_abbreviations" does not exist
  LINE 7:   from "airflow"."public"."state_abbreviations"
                 ^
  compiled SQL at target/run/ge_tutorials/staging/stg_state_abbreviations.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "public.state_abbreviations" does not exist
LINE 7:   from "airflow"."public"."state_abbreviations"
               ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 220, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model stg_state_abbreviations (models/staging/stg_state_abbreviations.sql)
  relation "public.state_abbreviations" does not exist
  LINE 7:   from "airflow"."public"."state_abbreviations"
                 ^
  compiled SQL at target/run/ge_tutorials/staging/stg_state_abbreviations.sql
2020-10-12 16:39:56.281649 (Thread-1): 16:39:56 | 2 of 4 ERROR creating view model public.stg_state_abbreviations...... [ERROR in 0.03s]
2020-10-12 16:39:56.281798 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:39:56.282296 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-12 16:39:56.282465 (Thread-1): 16:39:56 | 3 of 4 SKIP relation public.npi_with_state........................... [SKIP]
2020-10-12 16:39:56.282610 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-12 16:39:56.283018 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:39:56.283206 (Thread-1): 16:39:56 | 4 of 4 SKIP relation public.count_providers_by_state................. [SKIP]
2020-10-12 16:39:56.283368 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:39:56.363096 (MainThread): Using postgres connection "master".
2020-10-12 16:39:56.363563 (MainThread): On master: BEGIN
2020-10-12 16:39:56.364375 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:39:56.364803 (MainThread): On master: COMMIT
2020-10-12 16:39:56.365129 (MainThread): Using postgres connection "master".
2020-10-12 16:39:56.365432 (MainThread): On master: COMMIT
2020-10-12 16:39:56.366141 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:39:56.367280 (MainThread): 16:39:56 | 
2020-10-12 16:39:56.367775 (MainThread): 16:39:56 | Finished running 4 view models in 0.48s.
2020-10-12 16:39:56.368260 (MainThread): Connection 'master' was left open.
2020-10-12 16:39:56.368627 (MainThread): On master: Close
2020-10-12 16:39:56.369085 (MainThread): Connection 'model.ge_tutorials.stg_state_abbreviations' was left open.
2020-10-12 16:39:56.369403 (MainThread): On model.ge_tutorials.stg_state_abbreviations: Close
2020-10-12 16:39:56.406104 (MainThread): 
2020-10-12 16:39:56.406333 (MainThread): Completed with 2 errors and 0 warnings:
2020-10-12 16:39:56.406518 (MainThread): 
2020-10-12 16:39:56.406690 (MainThread): Database Error in model stg_npi (models/staging/stg_npi.sql)
2020-10-12 16:39:56.406861 (MainThread):   relation "public.npi_small" does not exist
2020-10-12 16:39:56.407031 (MainThread):   LINE 12:   from "airflow"."public"."npi_small"
2020-10-12 16:39:56.407198 (MainThread):                   ^
2020-10-12 16:39:56.407326 (MainThread):   compiled SQL at target/run/ge_tutorials/staging/stg_npi.sql
2020-10-12 16:39:56.407481 (MainThread): 
2020-10-12 16:39:56.407639 (MainThread): Database Error in model stg_state_abbreviations (models/staging/stg_state_abbreviations.sql)
2020-10-12 16:39:56.407795 (MainThread):   relation "public.state_abbreviations" does not exist
2020-10-12 16:39:56.407942 (MainThread):   LINE 7:   from "airflow"."public"."state_abbreviations"
2020-10-12 16:39:56.408072 (MainThread):                  ^
2020-10-12 16:39:56.408205 (MainThread):   compiled SQL at target/run/ge_tutorials/staging/stg_state_abbreviations.sql
2020-10-12 16:39:56.408354 (MainThread): 
Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
2020-10-12 16:39:56.408595 (MainThread): Flushing usage events
2020-10-12 16:45:20.235369 (MainThread): Got an exception trying to initialize tracking
2020-10-12 16:45:20.235520 (MainThread): Running with dbt=0.16.0
2020-10-12 16:45:20.335034 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 16:45:20.335403 (MainThread): Tracking: do not track
2020-10-12 16:45:20.370717 (MainThread): Partial parsing not enabled
2020-10-12 16:45:20.372797 (MainThread): Parsing macros/core.sql
2020-10-12 16:45:20.380985 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 16:45:20.396708 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 16:45:20.410170 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 16:45:20.439297 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 16:45:20.450439 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 16:45:20.464532 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 16:45:20.539107 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 16:45:20.571348 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 16:45:20.574695 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 16:45:20.586883 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 16:45:20.590526 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 16:45:20.635058 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 16:45:20.637143 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 16:45:20.640961 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 16:45:20.642501 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 16:45:20.644408 (MainThread): Parsing macros/etc/query.sql
2020-10-12 16:45:20.646210 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 16:45:20.649851 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 16:45:20.651650 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 16:45:20.669947 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 16:45:20.673682 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 16:45:20.676764 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 16:45:20.678468 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 16:45:20.826347 (MainThread): Parsing macros/relations.sql
2020-10-12 16:45:20.829404 (MainThread): Parsing macros/adapters.sql
2020-10-12 16:45:20.870703 (MainThread): Parsing macros/catalog.sql
2020-10-12 16:45:20.875723 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 16:45:20.906584 (MainThread): Partial parsing not enabled
2020-10-12 16:45:20.955800 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:20.955969 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:45:20.986878 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:20.987032 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:45:20.995462 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:20.995597 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:45:21.004445 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:21.004581 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:45:21.505029 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 16:45:21.510414 (MainThread): 
2020-10-12 16:45:21.510949 (MainThread): Acquiring new postgres connection "master".
2020-10-12 16:45:21.511088 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:45:21.541184 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-12 16:45:21.541519 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-12 16:45:21.704664 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-12 16:45:21.704845 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-12 16:45:21.710079 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2020-10-12 16:45:21.737302 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-12 16:45:21.737539 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-12 16:45:21.739811 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:45:21.739935 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-12 16:45:21.740317 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:21.740445 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:45:21.740541 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-12 16:45:21.743703 (ThreadPoolExecutor-1_0): SQL status: SELECT 27 in 0.00 seconds
2020-10-12 16:45:21.778524 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-12 16:45:21.806980 (MainThread): Using postgres connection "master".
2020-10-12 16:45:21.807138 (MainThread): On master: BEGIN
2020-10-12 16:45:21.810410 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:21.810552 (MainThread): Using postgres connection "master".
2020-10-12 16:45:21.810646 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-12 16:45:21.816323 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-10-12 16:45:21.817522 (MainThread): On master: ROLLBACK
2020-10-12 16:45:21.817848 (MainThread): Using postgres connection "master".
2020-10-12 16:45:21.817966 (MainThread): On master: BEGIN
2020-10-12 16:45:21.818381 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:21.818507 (MainThread): On master: COMMIT
2020-10-12 16:45:21.818605 (MainThread): Using postgres connection "master".
2020-10-12 16:45:21.818694 (MainThread): On master: COMMIT
2020-10-12 16:45:21.818987 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:45:21.819345 (MainThread): 16:45:21 | Concurrency: 1 threads (target='dev')
2020-10-12 16:45:21.819500 (MainThread): 16:45:21 | 
2020-10-12 16:45:21.825865 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-12 16:45:21.826155 (Thread-1): 16:45:21 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-12 16:45:21.826855 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:21.826991 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-12 16:45:21.827129 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-12 16:45:21.862925 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:45:21.863496 (Thread-1): finished collecting timing info
2020-10-12 16:45:21.921689 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:21.921861 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-12 16:45:21.922315 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:21.925366 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:21.925487 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 16:45:21.925813 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:21.927735 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:45:21.928057 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:21.928160 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-12 16:45:21.928384 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:21.928488 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:21.928576 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-12 16:45:21.929841 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:45:21.933031 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:21.933150 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-12 16:45:21.933499 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:45:21.934504 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-12 16:45:21.934612 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:21.934705 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-12 16:45:21.935801 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:45:21.938152 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:21.938269 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 16:45:21.938520 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:21.941655 (Thread-1): finished collecting timing info
2020-10-12 16:45:21.943718 (Thread-1): 16:45:21 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.12s]
2020-10-12 16:45:21.943876 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-12 16:45:21.944047 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:45:21.944348 (Thread-1): 16:45:21 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-12 16:45:21.944673 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:21.944770 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-12 16:45:21.944866 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:45:21.954250 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:45:21.954551 (Thread-1): finished collecting timing info
2020-10-12 16:45:21.965522 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:21.965688 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-12 16:45:21.966024 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:21.969145 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:21.969263 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 16:45:21.969526 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:21.971575 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:45:21.971976 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:21.972101 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-12 16:45:21.972418 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:21.972539 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:21.972636 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-12 16:45:21.973416 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:45:21.976855 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:21.977051 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-12 16:45:21.977869 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:45:21.979538 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-12 16:45:21.979717 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:21.979821 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-12 16:45:21.981001 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:45:21.983644 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:21.983762 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 16:45:21.984100 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:21.987418 (Thread-1): finished collecting timing info
2020-10-12 16:45:21.988238 (Thread-1): 16:45:21 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.04s]
2020-10-12 16:45:21.988392 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:45:21.988844 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-12 16:45:21.989009 (Thread-1): 16:45:21 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-12 16:45:21.989332 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:21.989433 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-12 16:45:21.989530 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-12 16:45:22.000890 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 16:45:22.001207 (Thread-1): finished collecting timing info
2020-10-12 16:45:22.012915 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:22.013082 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-12 16:45:22.013458 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:22.018044 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:22.018168 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 16:45:22.018480 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:22.020257 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 16:45:22.020584 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:22.020689 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-12 16:45:22.020946 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:22.021066 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:22.021163 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-12 16:45:22.022385 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:45:22.025897 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:22.026079 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-12 16:45:22.026550 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:45:22.027603 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-12 16:45:22.027716 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:22.027811 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-12 16:45:22.028891 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:45:22.031273 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:22.031386 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 16:45:22.031688 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:22.034854 (Thread-1): finished collecting timing info
2020-10-12 16:45:22.035691 (Thread-1): 16:45:22 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.05s]
2020-10-12 16:45:22.035847 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-12 16:45:22.036310 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:45:22.036474 (Thread-1): 16:45:22 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-12 16:45:22.036784 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:22.036899 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-12 16:45:22.036998 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-12 16:45:22.046313 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 16:45:22.046594 (Thread-1): finished collecting timing info
2020-10-12 16:45:22.057430 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:22.057591 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-12 16:45:22.058028 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:22.061516 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:22.061714 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 16:45:22.062168 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:22.064587 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 16:45:22.064961 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:22.065076 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-12 16:45:22.065396 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:22.065522 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:22.065620 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-12 16:45:22.066837 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:45:22.070461 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:22.070622 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-12 16:45:22.071107 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:45:22.072233 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-12 16:45:22.072345 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:22.072439 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-12 16:45:22.073461 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:45:22.075945 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:22.076059 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 16:45:22.076371 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:22.079788 (Thread-1): finished collecting timing info
2020-10-12 16:45:22.080662 (Thread-1): 16:45:22 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.04s]
2020-10-12 16:45:22.080823 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:45:22.126947 (MainThread): Using postgres connection "master".
2020-10-12 16:45:22.127149 (MainThread): On master: BEGIN
2020-10-12 16:45:22.127518 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:22.127683 (MainThread): On master: COMMIT
2020-10-12 16:45:22.127806 (MainThread): Using postgres connection "master".
2020-10-12 16:45:22.127921 (MainThread): On master: COMMIT
2020-10-12 16:45:22.128212 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:45:22.128642 (MainThread): 16:45:22 | 
2020-10-12 16:45:22.128831 (MainThread): 16:45:22 | Finished running 4 view models in 0.62s.
2020-10-12 16:45:22.128993 (MainThread): Connection 'master' was left open.
2020-10-12 16:45:22.129146 (MainThread): On master: Close
2020-10-12 16:45:22.129324 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-12 16:45:22.129474 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-12 16:45:22.150628 (MainThread): 
2020-10-12 16:45:22.150867 (MainThread): Completed successfully
2020-10-12 16:45:22.151049 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-12 16:45:22.151337 (MainThread): Flushing usage events
2020-10-12 16:45:55.102798 (MainThread): Got an exception trying to initialize tracking
2020-10-12 16:45:55.102962 (MainThread): Running with dbt=0.16.0
2020-10-12 16:45:55.197036 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 16:45:55.197390 (MainThread): Tracking: do not track
2020-10-12 16:45:55.230917 (MainThread): Partial parsing not enabled
2020-10-12 16:45:55.232899 (MainThread): Parsing macros/core.sql
2020-10-12 16:45:55.240636 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 16:45:55.255090 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 16:45:55.266716 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 16:45:55.290949 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 16:45:55.299390 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 16:45:55.311862 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 16:45:55.382234 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 16:45:55.409681 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 16:45:55.412304 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 16:45:55.422014 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 16:45:55.424756 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 16:45:55.459976 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 16:45:55.461577 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 16:45:55.464521 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 16:45:55.465714 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 16:45:55.467209 (MainThread): Parsing macros/etc/query.sql
2020-10-12 16:45:55.468622 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 16:45:55.471511 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 16:45:55.472941 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 16:45:55.487706 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 16:45:55.490615 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 16:45:55.492961 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 16:45:55.494269 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 16:45:55.570942 (MainThread): Parsing macros/relations.sql
2020-10-12 16:45:55.573381 (MainThread): Parsing macros/adapters.sql
2020-10-12 16:45:55.604098 (MainThread): Parsing macros/catalog.sql
2020-10-12 16:45:55.607886 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 16:45:55.632209 (MainThread): Partial parsing not enabled
2020-10-12 16:45:55.671294 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:55.671398 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:45:55.695237 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:55.695376 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:45:55.702592 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:55.702686 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:45:55.709523 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:55.709614 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:45:56.149778 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 16:45:56.154166 (MainThread): 
2020-10-12 16:45:56.154617 (MainThread): Acquiring new postgres connection "master".
2020-10-12 16:45:56.154729 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:45:56.180235 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-12 16:45:56.180524 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-12 16:45:56.326235 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-12 16:45:56.326391 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-12 16:45:56.330036 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-12 16:45:56.354686 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-12 16:45:56.354968 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-12 16:45:56.357116 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:45:56.357226 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-12 16:45:56.357595 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:56.357725 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:45:56.357818 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-12 16:45:56.359964 (ThreadPoolExecutor-1_0): SQL status: SELECT 31 in 0.00 seconds
2020-10-12 16:45:56.394226 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-12 16:45:56.421750 (MainThread): Using postgres connection "master".
2020-10-12 16:45:56.421916 (MainThread): On master: BEGIN
2020-10-12 16:45:56.425221 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:56.425399 (MainThread): Using postgres connection "master".
2020-10-12 16:45:56.425507 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-12 16:45:56.432016 (MainThread): SQL status: SELECT 5 in 0.01 seconds
2020-10-12 16:45:56.442861 (MainThread): On master: ROLLBACK
2020-10-12 16:45:56.443299 (MainThread): Using postgres connection "master".
2020-10-12 16:45:56.443445 (MainThread): On master: BEGIN
2020-10-12 16:45:56.443943 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:56.444096 (MainThread): On master: COMMIT
2020-10-12 16:45:56.444215 (MainThread): Using postgres connection "master".
2020-10-12 16:45:56.444322 (MainThread): On master: COMMIT
2020-10-12 16:45:56.444615 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:45:56.445051 (MainThread): 16:45:56 | Concurrency: 1 threads (target='dev')
2020-10-12 16:45:56.445232 (MainThread): 16:45:56 | 
2020-10-12 16:45:56.452976 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-12 16:45:56.453228 (Thread-1): 16:45:56 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-12 16:45:56.453665 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:56.453785 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-12 16:45:56.453909 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-12 16:45:56.483837 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:45:56.484214 (Thread-1): finished collecting timing info
2020-10-12 16:45:56.538722 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:56.538909 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-12 16:45:56.539508 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:56.542592 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:56.542703 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 16:45:56.543034 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:56.544863 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:45:56.545178 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:56.545280 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-12 16:45:56.545593 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:56.545717 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:56.545814 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-12 16:45:56.547079 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:45:56.552238 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:56.552357 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi" rename to "stg_npi__dbt_backup"
2020-10-12 16:45:56.552821 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:45:56.556924 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:56.557054 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-12 16:45:56.557536 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:45:56.558569 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-12 16:45:56.558678 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:56.558789 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-12 16:45:56.559970 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:45:56.562392 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:56.562518 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 16:45:56.564515 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:56.567664 (Thread-1): finished collecting timing info
2020-10-12 16:45:56.568458 (Thread-1): 16:45:56 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.11s]
2020-10-12 16:45:56.568615 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-12 16:45:56.568775 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:45:56.568930 (Thread-1): 16:45:56 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-12 16:45:56.569416 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:56.569657 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-12 16:45:56.569771 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:45:56.579090 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:45:56.579378 (Thread-1): finished collecting timing info
2020-10-12 16:45:56.589574 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:56.589754 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-12 16:45:56.590168 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:56.593330 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:56.593450 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 16:45:56.593757 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:56.595703 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:45:56.596056 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:56.596168 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-12 16:45:56.596468 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:56.596591 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:56.596689 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-12 16:45:56.597435 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:45:56.603367 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:56.603582 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations" rename to "stg_state_abbreviations__dbt_backup"
2020-10-12 16:45:56.604220 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:45:56.607642 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:56.607776 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-12 16:45:56.608201 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:45:56.609270 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-12 16:45:56.609382 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:56.609476 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-12 16:45:56.610398 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:45:56.612905 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:56.613019 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 16:45:56.614282 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:56.617661 (Thread-1): finished collecting timing info
2020-10-12 16:45:56.618463 (Thread-1): 16:45:56 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.05s]
2020-10-12 16:45:56.618624 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:45:56.619039 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-12 16:45:56.619203 (Thread-1): 16:45:56 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-12 16:45:56.619534 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:56.619633 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-12 16:45:56.619733 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-12 16:45:56.632228 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 16:45:56.632599 (Thread-1): finished collecting timing info
2020-10-12 16:45:56.643033 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:56.643181 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-12 16:45:56.643559 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:56.646556 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:56.646680 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 16:45:56.646994 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:56.648807 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 16:45:56.649120 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:56.649222 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-12 16:45:56.649464 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:56.649563 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:56.649650 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-12 16:45:56.650757 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:45:56.653714 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:56.653827 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-12 16:45:56.654264 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:45:56.655253 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-12 16:45:56.655362 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:56.655455 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-12 16:45:56.656560 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:45:56.658799 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:56.658907 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 16:45:56.659213 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:56.662196 (Thread-1): finished collecting timing info
2020-10-12 16:45:56.662973 (Thread-1): 16:45:56 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.04s]
2020-10-12 16:45:56.663127 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-12 16:45:56.663536 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:45:56.663694 (Thread-1): 16:45:56 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-12 16:45:56.663993 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:56.664090 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-12 16:45:56.664186 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-12 16:45:56.673188 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 16:45:56.673463 (Thread-1): finished collecting timing info
2020-10-12 16:45:56.682944 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:56.683122 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-12 16:45:56.683719 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:56.687399 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:56.687549 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 16:45:56.687933 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:56.689891 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 16:45:56.690226 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:56.690333 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-12 16:45:56.690560 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:56.690665 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:56.690772 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-12 16:45:56.691883 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:45:56.696964 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:56.697157 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-12 16:45:56.697848 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:45:56.699089 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-12 16:45:56.699223 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:56.699321 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-12 16:45:56.700371 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:45:56.702833 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:56.702946 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 16:45:56.703248 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:56.706358 (Thread-1): finished collecting timing info
2020-10-12 16:45:56.707159 (Thread-1): 16:45:56 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.04s]
2020-10-12 16:45:56.707314 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:45:56.754740 (MainThread): Using postgres connection "master".
2020-10-12 16:45:56.754910 (MainThread): On master: BEGIN
2020-10-12 16:45:56.755211 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:56.755321 (MainThread): On master: COMMIT
2020-10-12 16:45:56.755409 (MainThread): Using postgres connection "master".
2020-10-12 16:45:56.755494 (MainThread): On master: COMMIT
2020-10-12 16:45:56.755699 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:45:56.756020 (MainThread): 16:45:56 | 
2020-10-12 16:45:56.756152 (MainThread): 16:45:56 | Finished running 4 view models in 0.60s.
2020-10-12 16:45:56.756265 (MainThread): Connection 'master' was left open.
2020-10-12 16:45:56.756373 (MainThread): On master: Close
2020-10-12 16:45:56.756550 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-12 16:45:56.756656 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-12 16:45:56.772660 (MainThread): 
2020-10-12 16:45:56.772866 (MainThread): Completed successfully
2020-10-12 16:45:56.773016 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-12 16:45:56.773295 (MainThread): Flushing usage events
2020-10-12 16:46:50.292605 (MainThread): Got an exception trying to initialize tracking
2020-10-12 16:46:50.292749 (MainThread): Running with dbt=0.16.0
2020-10-12 16:46:50.375624 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 16:46:50.375972 (MainThread): Tracking: do not track
2020-10-12 16:46:50.411292 (MainThread): Partial parsing not enabled
2020-10-12 16:46:50.413353 (MainThread): Parsing macros/core.sql
2020-10-12 16:46:50.421457 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 16:46:50.437617 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 16:46:50.451483 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 16:46:50.479373 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 16:46:50.489195 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 16:46:50.502728 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 16:46:50.587592 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 16:46:50.622062 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 16:46:50.625320 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 16:46:50.637194 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 16:46:50.640682 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 16:46:50.683612 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 16:46:50.685643 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 16:46:50.689242 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 16:46:50.690750 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 16:46:50.692608 (MainThread): Parsing macros/etc/query.sql
2020-10-12 16:46:50.694409 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 16:46:50.698105 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 16:46:50.699988 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 16:46:50.718901 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 16:46:50.722675 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 16:46:50.725847 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 16:46:50.727628 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 16:46:50.818987 (MainThread): Parsing macros/relations.sql
2020-10-12 16:46:50.821585 (MainThread): Parsing macros/adapters.sql
2020-10-12 16:46:50.853759 (MainThread): Parsing macros/catalog.sql
2020-10-12 16:46:50.857802 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 16:46:50.883903 (MainThread): Partial parsing not enabled
2020-10-12 16:46:50.938705 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:46:50.938904 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:46:50.971507 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:46:50.971668 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:46:50.980268 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:46:50.980402 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:46:50.989166 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:46:50.989298 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:46:51.498312 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 16:46:51.503871 (MainThread): 
2020-10-12 16:46:51.504378 (MainThread): Acquiring new postgres connection "master".
2020-10-12 16:46:51.504522 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:46:51.530729 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-12 16:46:51.530911 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-12 16:46:51.668902 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-12 16:46:51.669073 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-12 16:46:51.673118 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-12 16:46:51.698605 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-12 16:46:51.698759 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-12 16:46:51.700905 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:46:51.701022 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-12 16:46:51.701369 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:46:51.701494 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:46:51.701589 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-12 16:46:51.703761 (ThreadPoolExecutor-1_0): SQL status: SELECT 31 in 0.00 seconds
2020-10-12 16:46:51.737102 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-12 16:46:51.761028 (MainThread): Using postgres connection "master".
2020-10-12 16:46:51.761132 (MainThread): On master: BEGIN
2020-10-12 16:46:51.763911 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:46:51.764029 (MainThread): Using postgres connection "master".
2020-10-12 16:46:51.764112 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-12 16:46:51.769100 (MainThread): SQL status: SELECT 5 in 0.00 seconds
2020-10-12 16:46:51.777228 (MainThread): On master: ROLLBACK
2020-10-12 16:46:51.777496 (MainThread): Using postgres connection "master".
2020-10-12 16:46:51.777596 (MainThread): On master: BEGIN
2020-10-12 16:46:51.778013 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:46:51.778129 (MainThread): On master: COMMIT
2020-10-12 16:46:51.778218 (MainThread): Using postgres connection "master".
2020-10-12 16:46:51.778298 (MainThread): On master: COMMIT
2020-10-12 16:46:51.778513 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:46:51.778804 (MainThread): 16:46:51 | Concurrency: 1 threads (target='dev')
2020-10-12 16:46:51.778935 (MainThread): 16:46:51 | 
2020-10-12 16:46:51.784518 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-12 16:46:51.784688 (Thread-1): 16:46:51 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-12 16:46:51.784989 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:46:51.785076 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-12 16:46:51.785170 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-12 16:46:51.807148 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:46:51.807466 (Thread-1): finished collecting timing info
2020-10-12 16:46:51.855792 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:46:51.855947 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-12 16:46:51.856522 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:46:51.859251 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:46:51.859350 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 16:46:51.859632 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:46:51.861287 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:46:51.861575 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:46:51.861667 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-12 16:46:51.861969 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:46:51.862075 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:46:51.862161 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-12 16:46:51.863405 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:46:51.867982 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:46:51.868082 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi" rename to "stg_npi__dbt_backup"
2020-10-12 16:46:51.868482 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:46:51.872065 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:46:51.872164 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-12 16:46:51.872550 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:46:51.873435 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-12 16:46:51.873532 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:46:51.873615 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-12 16:46:51.875014 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:46:51.877131 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:46:51.877233 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 16:46:51.879221 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:46:51.881936 (Thread-1): finished collecting timing info
2020-10-12 16:46:51.882633 (Thread-1): 16:46:51 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.10s]
2020-10-12 16:46:51.882786 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-12 16:46:51.882926 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:46:51.883063 (Thread-1): 16:46:51 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-12 16:46:51.883460 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:46:51.883551 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-12 16:46:51.883641 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:46:51.892507 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:46:51.892796 (Thread-1): finished collecting timing info
2020-10-12 16:46:51.903270 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:46:51.903454 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-12 16:46:51.903990 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:46:51.908025 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:46:51.908188 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 16:46:51.908590 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:46:51.910795 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:46:51.911204 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:46:51.911327 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-12 16:46:51.911636 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:46:51.911774 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:46:51.911877 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-12 16:46:51.912645 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:46:51.918668 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:46:51.918845 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations" rename to "stg_state_abbreviations__dbt_backup"
2020-10-12 16:46:51.919392 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:46:51.922718 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:46:51.922845 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-12 16:46:51.923258 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:46:51.924405 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-12 16:46:51.924519 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:46:51.924615 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-12 16:46:51.925595 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:46:51.928096 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:46:51.928208 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 16:46:51.929379 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:46:51.932688 (Thread-1): finished collecting timing info
2020-10-12 16:46:51.933481 (Thread-1): 16:46:51 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.05s]
2020-10-12 16:46:51.933639 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:46:51.934120 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-12 16:46:51.934288 (Thread-1): 16:46:51 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-12 16:46:51.934621 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:46:51.934723 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-12 16:46:51.934841 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-12 16:46:51.948432 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 16:46:51.948885 (Thread-1): finished collecting timing info
2020-10-12 16:46:51.959125 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:46:51.959281 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-12 16:46:51.959669 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:46:51.962781 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:46:51.962901 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 16:46:51.963220 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:46:51.965146 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 16:46:51.965452 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:46:51.965557 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-12 16:46:51.965781 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:46:51.965884 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:46:51.965974 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-12 16:46:51.967045 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:46:51.970203 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:46:51.970318 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-12 16:46:51.970723 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:46:51.971780 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-12 16:46:51.971891 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:46:51.971985 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-12 16:46:51.972989 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:46:51.975396 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:46:51.975509 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 16:46:51.975820 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:46:51.979023 (Thread-1): finished collecting timing info
2020-10-12 16:46:51.979830 (Thread-1): 16:46:51 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.05s]
2020-10-12 16:46:51.979990 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-12 16:46:51.980476 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:46:51.980643 (Thread-1): 16:46:51 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-12 16:46:51.980965 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:46:51.981072 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-12 16:46:51.981173 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-12 16:46:51.990390 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 16:46:51.990787 (Thread-1): finished collecting timing info
2020-10-12 16:46:52.001536 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:46:52.001759 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-12 16:46:52.002357 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:46:52.005861 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:46:52.006013 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 16:46:52.006418 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:46:52.008661 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 16:46:52.009026 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:46:52.009139 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-12 16:46:52.009435 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:46:52.009544 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:46:52.009635 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-12 16:46:52.010850 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:46:52.016545 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:46:52.016704 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-12 16:46:52.017208 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:46:52.018334 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-12 16:46:52.018449 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:46:52.018548 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-12 16:46:52.019623 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:46:52.022119 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:46:52.022232 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 16:46:52.022529 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:46:52.025759 (Thread-1): finished collecting timing info
2020-10-12 16:46:52.026560 (Thread-1): 16:46:52 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.05s]
2020-10-12 16:46:52.026720 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:46:52.091538 (MainThread): Using postgres connection "master".
2020-10-12 16:46:52.091803 (MainThread): On master: BEGIN
2020-10-12 16:46:52.092221 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:46:52.092427 (MainThread): On master: COMMIT
2020-10-12 16:46:52.092587 (MainThread): Using postgres connection "master".
2020-10-12 16:46:52.092738 (MainThread): On master: COMMIT
2020-10-12 16:46:52.093011 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:46:52.093529 (MainThread): 16:46:52 | 
2020-10-12 16:46:52.093755 (MainThread): 16:46:52 | Finished running 4 view models in 0.59s.
2020-10-12 16:46:52.093945 (MainThread): Connection 'master' was left open.
2020-10-12 16:46:52.094092 (MainThread): On master: Close
2020-10-12 16:46:52.094297 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-12 16:46:52.094445 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-12 16:46:52.134153 (MainThread): 
2020-10-12 16:46:52.134450 (MainThread): Completed successfully
2020-10-12 16:46:52.134672 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-12 16:46:52.134999 (MainThread): Flushing usage events
2020-10-12 16:48:49.585217 (MainThread): Got an exception trying to initialize tracking
2020-10-12 16:48:49.585395 (MainThread): Running with dbt=0.16.0
2020-10-12 16:48:49.691030 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 16:48:49.691470 (MainThread): Tracking: do not track
2020-10-12 16:48:49.730028 (MainThread): Partial parsing not enabled
2020-10-12 16:48:49.732206 (MainThread): Parsing macros/core.sql
2020-10-12 16:48:49.740853 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 16:48:49.757051 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 16:48:49.774090 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 16:48:49.806243 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 16:48:49.815904 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 16:48:49.828889 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 16:48:49.902152 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 16:48:49.933234 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 16:48:49.936289 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 16:48:49.947171 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 16:48:49.950335 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 16:48:49.989395 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 16:48:49.991235 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 16:48:49.994460 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 16:48:49.995777 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 16:48:49.997410 (MainThread): Parsing macros/etc/query.sql
2020-10-12 16:48:49.998966 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 16:48:50.002130 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 16:48:50.003696 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 16:48:50.020108 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 16:48:50.023371 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 16:48:50.025959 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 16:48:50.027411 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 16:48:50.133665 (MainThread): Parsing macros/relations.sql
2020-10-12 16:48:50.136617 (MainThread): Parsing macros/adapters.sql
2020-10-12 16:48:50.172943 (MainThread): Parsing macros/catalog.sql
2020-10-12 16:48:50.177395 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 16:48:50.205779 (MainThread): Partial parsing not enabled
2020-10-12 16:48:50.251020 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:48:50.251165 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:48:50.276957 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:48:50.277097 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:48:50.284987 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:48:50.285104 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:48:50.293112 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:48:50.293243 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:48:50.817663 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 16:48:50.822657 (MainThread): 
2020-10-12 16:48:50.823116 (MainThread): Acquiring new postgres connection "master".
2020-10-12 16:48:50.823239 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:48:50.848356 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-12 16:48:50.848519 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-12 16:48:50.976781 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-12 16:48:50.976922 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-12 16:48:50.980547 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-12 16:48:51.003382 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-12 16:48:51.003497 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-12 16:48:51.005518 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:48:51.005624 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-12 16:48:51.005929 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:48:51.006037 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:48:51.006123 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-12 16:48:51.008061 (ThreadPoolExecutor-1_0): SQL status: SELECT 31 in 0.00 seconds
2020-10-12 16:48:51.039332 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-12 16:48:51.062810 (MainThread): Using postgres connection "master".
2020-10-12 16:48:51.062908 (MainThread): On master: BEGIN
2020-10-12 16:48:51.065747 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:48:51.065857 (MainThread): Using postgres connection "master".
2020-10-12 16:48:51.065938 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-12 16:48:51.071175 (MainThread): SQL status: SELECT 5 in 0.01 seconds
2020-10-12 16:48:51.079354 (MainThread): On master: ROLLBACK
2020-10-12 16:48:51.079629 (MainThread): Using postgres connection "master".
2020-10-12 16:48:51.079734 (MainThread): On master: BEGIN
2020-10-12 16:48:51.080165 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:48:51.080280 (MainThread): On master: COMMIT
2020-10-12 16:48:51.080370 (MainThread): Using postgres connection "master".
2020-10-12 16:48:51.080452 (MainThread): On master: COMMIT
2020-10-12 16:48:51.080715 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:48:51.081020 (MainThread): 16:48:51 | Concurrency: 1 threads (target='dev')
2020-10-12 16:48:51.081158 (MainThread): 16:48:51 | 
2020-10-12 16:48:51.087028 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-12 16:48:51.087205 (Thread-1): 16:48:51 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-12 16:48:51.087528 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:48:51.087622 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-12 16:48:51.087723 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-12 16:48:51.112094 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:48:51.112478 (Thread-1): finished collecting timing info
2020-10-12 16:48:51.162776 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:48:51.162929 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-12 16:48:51.163478 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:48:51.166184 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:48:51.166279 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 16:48:51.166573 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:48:51.168225 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:48:51.168534 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:48:51.168625 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-12 16:48:51.168877 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:48:51.168986 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:48:51.169071 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-12 16:48:51.170374 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:48:51.175504 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:48:51.175619 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi" rename to "stg_npi__dbt_backup"
2020-10-12 16:48:51.176072 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:48:51.180052 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:48:51.180160 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-12 16:48:51.180570 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:48:51.181540 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-12 16:48:51.181645 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:48:51.181735 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-12 16:48:51.185523 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:48:51.188259 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:48:51.188399 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 16:48:51.190489 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:48:51.193661 (Thread-1): finished collecting timing info
2020-10-12 16:48:51.194429 (Thread-1): 16:48:51 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.11s]
2020-10-12 16:48:51.194582 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-12 16:48:51.194761 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:48:51.195057 (Thread-1): 16:48:51 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-12 16:48:51.195367 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:48:51.195463 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-12 16:48:51.195556 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:48:51.204906 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:48:51.205145 (Thread-1): finished collecting timing info
2020-10-12 16:48:51.215149 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:48:51.215521 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-12 16:48:51.216243 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:48:51.219560 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:48:51.219677 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 16:48:51.220007 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:48:51.221914 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:48:51.222189 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:48:51.222296 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-12 16:48:51.222573 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:48:51.222695 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:48:51.222807 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-12 16:48:51.223586 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:48:51.229440 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:48:51.229641 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations" rename to "stg_state_abbreviations__dbt_backup"
2020-10-12 16:48:51.230175 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:48:51.233554 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:48:51.233667 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-12 16:48:51.234095 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:48:51.235164 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-12 16:48:51.235277 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:48:51.235370 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-12 16:48:51.236959 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:48:51.239397 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:48:51.239506 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 16:48:51.241040 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:48:51.244286 (Thread-1): finished collecting timing info
2020-10-12 16:48:51.245069 (Thread-1): 16:48:51 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.05s]
2020-10-12 16:48:51.245229 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:48:51.245661 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-12 16:48:51.245820 (Thread-1): 16:48:51 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-12 16:48:51.246141 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:48:51.246241 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-12 16:48:51.246345 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-12 16:48:51.258890 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 16:48:51.259206 (Thread-1): finished collecting timing info
2020-10-12 16:48:51.269734 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:48:51.269892 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-12 16:48:51.270276 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:48:51.273366 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:48:51.273476 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 16:48:51.273801 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:48:51.275709 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 16:48:51.275992 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:48:51.276093 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-12 16:48:51.276351 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:48:51.276470 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:48:51.276567 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-12 16:48:51.277773 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:48:51.280810 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:48:51.280916 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-12 16:48:51.281324 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:48:51.282290 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-12 16:48:51.282394 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:48:51.282484 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-12 16:48:51.283722 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:48:51.285921 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:48:51.286025 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 16:48:51.286327 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:48:51.289328 (Thread-1): finished collecting timing info
2020-10-12 16:48:51.290099 (Thread-1): 16:48:51 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.04s]
2020-10-12 16:48:51.290260 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-12 16:48:51.290648 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:48:51.290812 (Thread-1): 16:48:51 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-12 16:48:51.291123 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:48:51.291221 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-12 16:48:51.291323 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-12 16:48:51.300536 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 16:48:51.300771 (Thread-1): finished collecting timing info
2020-10-12 16:48:51.310450 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:48:51.310614 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-12 16:48:51.311066 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:48:51.314712 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:48:51.314884 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 16:48:51.315269 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:48:51.317258 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 16:48:51.317533 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:48:51.317635 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-12 16:48:51.317884 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:48:51.318002 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:48:51.318098 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-12 16:48:51.319234 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:48:51.324204 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:48:51.324451 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-12 16:48:51.325043 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:48:51.326208 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-12 16:48:51.326331 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:48:51.326427 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-12 16:48:51.327795 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:48:51.330449 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:48:51.330569 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 16:48:51.330931 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:48:51.334093 (Thread-1): finished collecting timing info
2020-10-12 16:48:51.334885 (Thread-1): 16:48:51 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.04s]
2020-10-12 16:48:51.335043 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:48:51.392475 (MainThread): Using postgres connection "master".
2020-10-12 16:48:51.392939 (MainThread): On master: BEGIN
2020-10-12 16:48:51.393807 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:48:51.394234 (MainThread): On master: COMMIT
2020-10-12 16:48:51.394562 (MainThread): Using postgres connection "master".
2020-10-12 16:48:51.394911 (MainThread): On master: COMMIT
2020-10-12 16:48:51.395642 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:48:51.396720 (MainThread): 16:48:51 | 
2020-10-12 16:48:51.397186 (MainThread): 16:48:51 | Finished running 4 view models in 0.57s.
2020-10-12 16:48:51.397636 (MainThread): Connection 'master' was left open.
2020-10-12 16:48:51.398021 (MainThread): On master: Close
2020-10-12 16:48:51.398482 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-12 16:48:51.398830 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-12 16:48:51.438265 (MainThread): 
2020-10-12 16:48:51.438476 (MainThread): Completed successfully
2020-10-12 16:48:51.438654 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-12 16:48:51.438918 (MainThread): Flushing usage events
2020-10-12 16:50:42.359749 (MainThread): Got an exception trying to initialize tracking
2020-10-12 16:50:42.359897 (MainThread): Running with dbt=0.16.0
2020-10-12 16:50:42.444289 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 16:50:42.444633 (MainThread): Tracking: do not track
2020-10-12 16:50:42.478293 (MainThread): Partial parsing not enabled
2020-10-12 16:50:42.480360 (MainThread): Parsing macros/core.sql
2020-10-12 16:50:42.488468 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 16:50:42.503259 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 16:50:42.515327 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 16:50:42.538620 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 16:50:42.546508 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 16:50:42.556836 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 16:50:42.615035 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 16:50:42.644491 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 16:50:42.647804 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 16:50:42.659918 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 16:50:42.663577 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 16:50:42.710788 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 16:50:42.713585 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 16:50:42.718536 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 16:50:42.720623 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 16:50:42.723141 (MainThread): Parsing macros/etc/query.sql
2020-10-12 16:50:42.725469 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 16:50:42.730161 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 16:50:42.732550 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 16:50:42.756323 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 16:50:42.760919 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 16:50:42.764530 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 16:50:42.766505 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 16:50:42.865587 (MainThread): Parsing macros/relations.sql
2020-10-12 16:50:42.868577 (MainThread): Parsing macros/adapters.sql
2020-10-12 16:50:42.905977 (MainThread): Parsing macros/catalog.sql
2020-10-12 16:50:42.910669 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 16:50:42.941067 (MainThread): Partial parsing not enabled
2020-10-12 16:50:42.988859 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:50:42.989010 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:50:43.016760 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:50:43.016898 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:50:43.025103 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:50:43.025231 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:50:43.033464 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:50:43.033594 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:50:43.496866 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 16:50:43.501359 (MainThread): 
2020-10-12 16:50:43.501748 (MainThread): Acquiring new postgres connection "master".
2020-10-12 16:50:43.501857 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:50:43.526488 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-12 16:50:43.526771 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-12 16:50:43.763150 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-12 16:50:43.763309 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-12 16:50:43.767252 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-12 16:50:43.792923 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-12 16:50:43.793174 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-12 16:50:43.795308 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:50:43.795419 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-12 16:50:43.795765 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:50:43.795885 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:50:43.795977 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-12 16:50:43.798064 (ThreadPoolExecutor-1_0): SQL status: SELECT 31 in 0.00 seconds
2020-10-12 16:50:43.832390 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-12 16:50:43.857961 (MainThread): Using postgres connection "master".
2020-10-12 16:50:43.858099 (MainThread): On master: BEGIN
2020-10-12 16:50:43.861241 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:50:43.861384 (MainThread): Using postgres connection "master".
2020-10-12 16:50:43.861475 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-12 16:50:43.866900 (MainThread): SQL status: SELECT 5 in 0.01 seconds
2020-10-12 16:50:43.875593 (MainThread): On master: ROLLBACK
2020-10-12 16:50:43.875951 (MainThread): Using postgres connection "master".
2020-10-12 16:50:43.876066 (MainThread): On master: BEGIN
2020-10-12 16:50:43.876515 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:50:43.876636 (MainThread): On master: COMMIT
2020-10-12 16:50:43.876731 (MainThread): Using postgres connection "master".
2020-10-12 16:50:43.876816 (MainThread): On master: COMMIT
2020-10-12 16:50:43.877028 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:50:43.877331 (MainThread): 16:50:43 | Concurrency: 1 threads (target='dev')
2020-10-12 16:50:43.877465 (MainThread): 16:50:43 | 
2020-10-12 16:50:43.883498 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-12 16:50:43.883698 (Thread-1): 16:50:43 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-12 16:50:43.884084 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:50:43.884179 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-12 16:50:43.884281 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-12 16:50:43.908459 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:50:43.908836 (Thread-1): finished collecting timing info
2020-10-12 16:50:43.966543 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:50:43.966709 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-12 16:50:43.967285 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:50:43.970250 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:50:43.970358 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 16:50:43.970671 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:50:43.972487 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:50:43.972832 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:50:43.972929 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-12 16:50:43.973199 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:50:43.973316 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:50:43.973409 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-12 16:50:43.974743 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:50:43.979797 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:50:43.979911 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi" rename to "stg_npi__dbt_backup"
2020-10-12 16:50:43.980360 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:50:43.984310 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:50:43.984425 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-12 16:50:43.984823 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:50:43.985800 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-12 16:50:43.985907 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:50:43.985997 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-12 16:50:43.987134 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:50:43.989450 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:50:43.989561 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 16:50:43.991608 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:50:43.994477 (Thread-1): finished collecting timing info
2020-10-12 16:50:43.995226 (Thread-1): 16:50:43 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.11s]
2020-10-12 16:50:43.995372 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-12 16:50:43.995534 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:50:43.995691 (Thread-1): 16:50:43 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-12 16:50:43.996145 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:50:43.996244 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-12 16:50:43.996340 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:50:44.005103 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:50:44.005355 (Thread-1): finished collecting timing info
2020-10-12 16:50:44.014939 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:50:44.015240 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-12 16:50:44.015917 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:50:44.019273 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:50:44.019414 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 16:50:44.019786 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:50:44.021703 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:50:44.022022 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:50:44.022128 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-12 16:50:44.022369 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:50:44.022489 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:50:44.022589 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-12 16:50:44.023300 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:50:44.029051 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:50:44.029354 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations" rename to "stg_state_abbreviations__dbt_backup"
2020-10-12 16:50:44.030210 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:50:44.033808 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:50:44.033944 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-12 16:50:44.034379 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:50:44.035446 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-12 16:50:44.035559 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:50:44.035652 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-12 16:50:44.036854 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:50:44.039280 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:50:44.039394 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 16:50:44.040710 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:50:44.044009 (Thread-1): finished collecting timing info
2020-10-12 16:50:44.044788 (Thread-1): 16:50:44 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.05s]
2020-10-12 16:50:44.044940 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:50:44.045444 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-12 16:50:44.045608 (Thread-1): 16:50:44 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-12 16:50:44.045942 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:50:44.046044 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-12 16:50:44.046142 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-12 16:50:44.059276 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 16:50:44.059655 (Thread-1): finished collecting timing info
2020-10-12 16:50:44.069894 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:50:44.070047 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-12 16:50:44.070447 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:50:44.073490 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:50:44.073603 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 16:50:44.073956 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:50:44.075851 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 16:50:44.076164 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:50:44.076268 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-12 16:50:44.076531 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:50:44.076650 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:50:44.076746 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-12 16:50:44.077938 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:50:44.081056 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:50:44.081174 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-12 16:50:44.081622 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:50:44.082641 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-12 16:50:44.082764 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:50:44.082877 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-12 16:50:44.084168 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:50:44.086493 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:50:44.086606 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 16:50:44.087000 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:50:44.090000 (Thread-1): finished collecting timing info
2020-10-12 16:50:44.090770 (Thread-1): 16:50:44 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.04s]
2020-10-12 16:50:44.090920 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-12 16:50:44.091321 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:50:44.091483 (Thread-1): 16:50:44 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-12 16:50:44.091774 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:50:44.091884 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-12 16:50:44.091980 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-12 16:50:44.100924 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 16:50:44.101192 (Thread-1): finished collecting timing info
2020-10-12 16:50:44.111543 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:50:44.111718 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-12 16:50:44.112130 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:50:44.115837 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:50:44.115998 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 16:50:44.116373 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:50:44.118599 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 16:50:44.119007 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:50:44.119119 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-12 16:50:44.119371 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:50:44.119505 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:50:44.119604 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-12 16:50:44.120795 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:50:44.126277 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:50:44.126455 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-12 16:50:44.127181 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:50:44.128556 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-12 16:50:44.128704 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:50:44.128810 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-12 16:50:44.130085 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:50:44.136888 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:50:44.137138 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 16:50:44.137751 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:50:44.143696 (Thread-1): finished collecting timing info
2020-10-12 16:50:44.144987 (Thread-1): 16:50:44 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.05s]
2020-10-12 16:50:44.145199 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:50:44.187962 (MainThread): Using postgres connection "master".
2020-10-12 16:50:44.188168 (MainThread): On master: BEGIN
2020-10-12 16:50:44.188560 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:50:44.188721 (MainThread): On master: COMMIT
2020-10-12 16:50:44.188837 (MainThread): Using postgres connection "master".
2020-10-12 16:50:44.188946 (MainThread): On master: COMMIT
2020-10-12 16:50:44.189229 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:50:44.189651 (MainThread): 16:50:44 | 
2020-10-12 16:50:44.189824 (MainThread): 16:50:44 | Finished running 4 view models in 0.69s.
2020-10-12 16:50:44.189984 (MainThread): Connection 'master' was left open.
2020-10-12 16:50:44.190120 (MainThread): On master: Close
2020-10-12 16:50:44.190291 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-12 16:50:44.190403 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-12 16:50:44.211142 (MainThread): 
2020-10-12 16:50:44.211409 (MainThread): Completed successfully
2020-10-12 16:50:44.211603 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-12 16:50:44.211863 (MainThread): Flushing usage events
2020-10-12 16:51:12.853600 (MainThread): Got an exception trying to initialize tracking
2020-10-12 16:51:12.853745 (MainThread): Running with dbt=0.16.0
2020-10-12 16:51:12.942976 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['models.ge_tutorials.*'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 16:51:12.943472 (MainThread): Tracking: do not track
2020-10-12 16:51:12.982270 (MainThread): Partial parsing not enabled
2020-10-12 16:51:12.984480 (MainThread): Parsing macros/core.sql
2020-10-12 16:51:12.993285 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 16:51:13.011194 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 16:51:13.028421 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 16:51:13.062974 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 16:51:13.073737 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 16:51:13.087177 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 16:51:13.160362 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 16:51:13.194183 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 16:51:13.197573 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 16:51:13.209670 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 16:51:13.213241 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 16:51:13.258214 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 16:51:13.260306 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 16:51:13.263976 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 16:51:13.265458 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 16:51:13.267260 (MainThread): Parsing macros/etc/query.sql
2020-10-12 16:51:13.268968 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 16:51:13.272449 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 16:51:13.274161 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 16:51:13.291605 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 16:51:13.295090 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 16:51:13.297854 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 16:51:13.299389 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 16:51:13.383830 (MainThread): Parsing macros/relations.sql
2020-10-12 16:51:13.386438 (MainThread): Parsing macros/adapters.sql
2020-10-12 16:51:13.427783 (MainThread): Parsing macros/catalog.sql
2020-10-12 16:51:13.433493 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 16:51:13.466462 (MainThread): Partial parsing not enabled
2020-10-12 16:51:13.513961 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:51:13.514115 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:51:13.541211 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:51:13.541362 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:51:13.549447 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:51:13.549563 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:51:13.557836 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:51:13.557968 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:51:14.072747 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 16:51:14.076860 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-10-12 16:51:14.077099 (MainThread): Flushing usage events
2020-10-12 16:51:14.077266 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-12 16:52:51.279750 (MainThread): Got an exception trying to initialize tracking
2020-10-12 16:52:51.279907 (MainThread): Running with dbt=0.16.0
2020-10-12 16:52:51.363355 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['models.ge_tutorials.*'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 16:52:51.363684 (MainThread): Tracking: do not track
2020-10-12 16:52:51.396395 (MainThread): Partial parsing not enabled
2020-10-12 16:52:51.398352 (MainThread): Parsing macros/core.sql
2020-10-12 16:52:51.405901 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 16:52:51.419642 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 16:52:51.430933 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 16:52:51.453195 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 16:52:51.460804 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 16:52:51.470985 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 16:52:51.529004 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 16:52:51.555267 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 16:52:51.557800 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 16:52:51.567243 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 16:52:51.569978 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 16:52:51.605157 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 16:52:51.606761 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 16:52:51.609692 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 16:52:51.610888 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 16:52:51.612375 (MainThread): Parsing macros/etc/query.sql
2020-10-12 16:52:51.613787 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 16:52:51.616674 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 16:52:51.618094 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 16:52:51.632906 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 16:52:51.635800 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 16:52:51.638138 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 16:52:51.639448 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 16:52:51.716436 (MainThread): Parsing macros/relations.sql
2020-10-12 16:52:51.718770 (MainThread): Parsing macros/adapters.sql
2020-10-12 16:52:51.748375 (MainThread): Parsing macros/catalog.sql
2020-10-12 16:52:51.752035 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 16:52:51.775724 (MainThread): Partial parsing not enabled
2020-10-12 16:52:51.814701 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:52:51.814817 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:52:51.837471 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:52:51.837598 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:52:51.844936 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:52:51.845034 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:52:51.852314 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:52:51.852405 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:52:52.332638 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 16:52:52.336820 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-10-12 16:52:52.337051 (MainThread): Flushing usage events
2020-10-12 16:52:52.337205 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-12 16:56:49.772814 (MainThread): Got an exception trying to initialize tracking
2020-10-12 16:56:49.772957 (MainThread): Running with dbt=0.16.0
2020-10-12 16:56:49.855198 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 16:56:49.855531 (MainThread): Tracking: do not track
2020-10-12 16:56:49.888206 (MainThread): Partial parsing not enabled
2020-10-12 16:56:49.890154 (MainThread): Parsing macros/core.sql
2020-10-12 16:56:49.897583 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 16:56:49.911280 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 16:56:49.922328 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 16:56:49.944838 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 16:56:49.952481 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 16:56:49.962698 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 16:56:50.020803 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 16:56:50.047138 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 16:56:50.049674 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 16:56:50.059185 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 16:56:50.061925 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 16:56:50.103210 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 16:56:50.105318 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 16:56:50.109132 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 16:56:50.110722 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 16:56:50.112694 (MainThread): Parsing macros/etc/query.sql
2020-10-12 16:56:50.114583 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 16:56:50.118417 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 16:56:50.120401 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 16:56:50.140403 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 16:56:50.144700 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 16:56:50.148470 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 16:56:50.150715 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 16:56:50.258210 (MainThread): Parsing macros/relations.sql
2020-10-12 16:56:50.261218 (MainThread): Parsing macros/adapters.sql
2020-10-12 16:56:50.298552 (MainThread): Parsing macros/catalog.sql
2020-10-12 16:56:50.303074 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 16:56:50.332903 (MainThread): Partial parsing not enabled
2020-10-12 16:56:50.382203 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:56:50.382369 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:56:50.409512 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:56:50.409658 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:56:50.417821 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:56:50.417947 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:56:50.425919 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:56:50.426048 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:56:50.887961 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 16:56:50.892390 (MainThread): 
2020-10-12 16:56:50.892820 (MainThread): Acquiring new postgres connection "master".
2020-10-12 16:56:50.892931 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:56:50.918338 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-12 16:56:50.918510 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-12 16:56:51.128416 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-12 16:56:51.128602 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-12 16:56:51.133079 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-12 16:56:51.161196 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-12 16:56:51.161502 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-12 16:56:51.163811 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:56:51.163933 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-12 16:56:51.164303 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:56:51.164440 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:56:51.164539 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-12 16:56:51.166707 (ThreadPoolExecutor-1_0): SQL status: SELECT 31 in 0.00 seconds
2020-10-12 16:56:51.203904 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-12 16:56:51.230521 (MainThread): Using postgres connection "master".
2020-10-12 16:56:51.230662 (MainThread): On master: BEGIN
2020-10-12 16:56:51.233704 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:56:51.233835 (MainThread): Using postgres connection "master".
2020-10-12 16:56:51.233924 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-12 16:56:51.239239 (MainThread): SQL status: SELECT 5 in 0.01 seconds
2020-10-12 16:56:51.247544 (MainThread): On master: ROLLBACK
2020-10-12 16:56:51.247837 (MainThread): Using postgres connection "master".
2020-10-12 16:56:51.247940 (MainThread): On master: BEGIN
2020-10-12 16:56:51.248387 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:56:51.248501 (MainThread): On master: COMMIT
2020-10-12 16:56:51.248592 (MainThread): Using postgres connection "master".
2020-10-12 16:56:51.248673 (MainThread): On master: COMMIT
2020-10-12 16:56:51.248929 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:56:51.249239 (MainThread): 16:56:51 | Concurrency: 1 threads (target='dev')
2020-10-12 16:56:51.249378 (MainThread): 16:56:51 | 
2020-10-12 16:56:51.255195 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-12 16:56:51.255382 (Thread-1): 16:56:51 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-12 16:56:51.255731 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:56:51.255824 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-12 16:56:51.255920 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-12 16:56:51.279881 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:56:51.280202 (Thread-1): finished collecting timing info
2020-10-12 16:56:51.332593 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:56:51.332777 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-12 16:56:51.333396 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:56:51.336619 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:56:51.336743 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 16:56:51.337078 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:56:51.338991 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:56:51.339306 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:56:51.339410 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-12 16:56:51.339696 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:56:51.339821 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:56:51.339919 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-12 16:56:51.341356 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:56:51.346637 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:56:51.346768 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi" rename to "stg_npi__dbt_backup"
2020-10-12 16:56:51.347249 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:56:51.351423 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:56:51.351537 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-12 16:56:51.351965 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:56:51.352977 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-12 16:56:51.353087 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:56:51.353182 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-12 16:56:51.354359 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:56:51.356725 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:56:51.356845 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 16:56:51.358892 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:56:51.361896 (Thread-1): finished collecting timing info
2020-10-12 16:56:51.362662 (Thread-1): 16:56:51 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.11s]
2020-10-12 16:56:51.362830 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-12 16:56:51.363007 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:56:51.363302 (Thread-1): 16:56:51 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-12 16:56:51.363616 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:56:51.363719 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-12 16:56:51.363815 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:56:51.373300 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:56:51.373569 (Thread-1): finished collecting timing info
2020-10-12 16:56:51.384474 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:56:51.384649 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-12 16:56:51.385046 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:56:51.388178 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:56:51.388287 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 16:56:51.388597 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:56:51.390612 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:56:51.391002 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:56:51.391126 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-12 16:56:51.391384 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:56:51.391501 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:56:51.391596 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-12 16:56:51.392334 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:56:51.398405 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:56:51.398587 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations" rename to "stg_state_abbreviations__dbt_backup"
2020-10-12 16:56:51.399095 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:56:51.402439 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:56:51.402550 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-12 16:56:51.402972 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:56:51.404026 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-12 16:56:51.404137 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:56:51.404232 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-12 16:56:51.405398 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:56:51.407830 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:56:51.407949 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 16:56:51.409363 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:56:51.412676 (Thread-1): finished collecting timing info
2020-10-12 16:56:51.413479 (Thread-1): 16:56:51 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.05s]
2020-10-12 16:56:51.413635 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:56:51.414147 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-12 16:56:51.414314 (Thread-1): 16:56:51 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-12 16:56:51.414656 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:56:51.414769 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-12 16:56:51.414872 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-12 16:56:51.427793 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 16:56:51.428308 (Thread-1): finished collecting timing info
2020-10-12 16:56:51.438860 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:56:51.439019 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-12 16:56:51.439413 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:56:51.442505 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:56:51.442617 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 16:56:51.442941 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:56:51.444836 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 16:56:51.445158 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:56:51.445263 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-12 16:56:51.445524 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:56:51.445644 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:56:51.445741 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-12 16:56:51.446904 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:56:51.449899 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:56:51.450005 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-12 16:56:51.450424 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:56:51.451417 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-12 16:56:51.451526 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:56:51.451618 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-12 16:56:51.452857 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:56:51.455089 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:56:51.455196 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 16:56:51.455492 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:56:51.458486 (Thread-1): finished collecting timing info
2020-10-12 16:56:51.459271 (Thread-1): 16:56:51 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.04s]
2020-10-12 16:56:51.459428 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-12 16:56:51.459955 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:56:51.460124 (Thread-1): 16:56:51 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-12 16:56:51.460441 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:56:51.460543 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-12 16:56:51.460638 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-12 16:56:51.469710 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 16:56:51.469963 (Thread-1): finished collecting timing info
2020-10-12 16:56:51.480711 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:56:51.480922 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-12 16:56:51.481640 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:56:51.485176 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:56:51.485324 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 16:56:51.485705 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:56:51.487897 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 16:56:51.488280 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:56:51.488387 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-12 16:56:51.488669 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:56:51.488790 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:56:51.488887 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-12 16:56:51.490033 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:56:51.495212 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:56:51.495383 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-12 16:56:51.496109 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:56:51.497343 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-12 16:56:51.497471 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:56:51.497568 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-12 16:56:51.498806 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:56:51.501230 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:56:51.501341 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 16:56:51.501664 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:56:51.504831 (Thread-1): finished collecting timing info
2020-10-12 16:56:51.505617 (Thread-1): 16:56:51 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.05s]
2020-10-12 16:56:51.505775 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:56:51.561016 (MainThread): Using postgres connection "master".
2020-10-12 16:56:51.561289 (MainThread): On master: BEGIN
2020-10-12 16:56:51.561780 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:56:51.562004 (MainThread): On master: COMMIT
2020-10-12 16:56:51.562171 (MainThread): Using postgres connection "master".
2020-10-12 16:56:51.562326 (MainThread): On master: COMMIT
2020-10-12 16:56:51.562692 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:56:51.563270 (MainThread): 16:56:51 | 
2020-10-12 16:56:51.563504 (MainThread): 16:56:51 | Finished running 4 view models in 0.67s.
2020-10-12 16:56:51.563721 (MainThread): Connection 'master' was left open.
2020-10-12 16:56:51.563913 (MainThread): On master: Close
2020-10-12 16:56:51.564146 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-12 16:56:51.564303 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-12 16:56:51.596507 (MainThread): 
2020-10-12 16:56:51.596831 (MainThread): Completed successfully
2020-10-12 16:56:51.597204 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-12 16:56:51.597672 (MainThread): Flushing usage events
2020-10-12 17:09:20.301922 (MainThread): Got an exception trying to initialize tracking
2020-10-12 17:09:20.302074 (MainThread): Running with dbt=0.16.0
2020-10-12 17:09:20.387983 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['models.ge_tutorials.*'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 17:09:20.388344 (MainThread): Tracking: do not track
2020-10-12 17:09:20.421314 (MainThread): Partial parsing not enabled
2020-10-12 17:09:20.423298 (MainThread): Parsing macros/core.sql
2020-10-12 17:09:20.430811 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 17:09:20.444904 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 17:09:20.456226 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 17:09:20.478515 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 17:09:20.486262 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 17:09:20.496632 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 17:09:20.554683 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 17:09:20.581099 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 17:09:20.583658 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 17:09:20.593213 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 17:09:20.595966 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 17:09:20.631331 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 17:09:20.632938 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 17:09:20.635884 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 17:09:20.637080 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 17:09:20.638599 (MainThread): Parsing macros/etc/query.sql
2020-10-12 17:09:20.640026 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 17:09:20.642931 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 17:09:20.644358 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 17:09:20.659188 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 17:09:20.662113 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 17:09:20.664468 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 17:09:20.665779 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 17:09:20.742947 (MainThread): Parsing macros/relations.sql
2020-10-12 17:09:20.745295 (MainThread): Parsing macros/adapters.sql
2020-10-12 17:09:20.774952 (MainThread): Parsing macros/catalog.sql
2020-10-12 17:09:20.778591 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 17:09:20.802071 (MainThread): Partial parsing not enabled
2020-10-12 17:09:20.840130 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 17:09:20.840236 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:09:20.862025 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 17:09:20.862183 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:09:20.870208 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 17:09:20.870341 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:09:20.878692 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 17:09:20.878844 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:09:21.363864 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 17:09:21.368100 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-10-12 17:09:21.368350 (MainThread): Flushing usage events
2020-10-12 17:09:21.368526 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-12 17:09:52.072993 (MainThread): Got an exception trying to initialize tracking
2020-10-12 17:09:52.073145 (MainThread): Running with dbt=0.16.0
2020-10-12 17:09:52.159183 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['models/ge_tutorials/count_providers_by_state.sql', 'models/ge_tutorials/npi_with_state.sql', 'models/ge_tutorials/sources.yml', 'models/ge_tutorials/staging'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 17:09:52.159546 (MainThread): Tracking: do not track
2020-10-12 17:09:52.214227 (MainThread): Partial parsing not enabled
2020-10-12 17:09:52.217771 (MainThread): Parsing macros/core.sql
2020-10-12 17:09:52.230935 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 17:09:52.256267 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 17:09:52.279071 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 17:09:52.315151 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 17:09:52.325682 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 17:09:52.339139 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 17:09:52.408950 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 17:09:52.437231 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 17:09:52.439961 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 17:09:52.449775 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 17:09:52.452707 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 17:09:52.491463 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 17:09:52.493411 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 17:09:52.496948 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 17:09:52.498390 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 17:09:52.500212 (MainThread): Parsing macros/etc/query.sql
2020-10-12 17:09:52.501915 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 17:09:52.505521 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 17:09:52.507392 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 17:09:52.526097 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 17:09:52.529732 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 17:09:52.532663 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 17:09:52.534290 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 17:09:52.614652 (MainThread): Parsing macros/relations.sql
2020-10-12 17:09:52.616977 (MainThread): Parsing macros/adapters.sql
2020-10-12 17:09:52.646608 (MainThread): Parsing macros/catalog.sql
2020-10-12 17:09:52.650266 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 17:09:52.674119 (MainThread): Partial parsing not enabled
2020-10-12 17:09:52.713026 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 17:09:52.713131 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:09:52.735063 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 17:09:52.735160 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:09:52.741754 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 17:09:52.741843 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:09:52.748553 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 17:09:52.748656 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:09:53.151023 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 17:09:53.156172 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-10-12 17:09:53.156499 (MainThread): Flushing usage events
2020-10-12 17:09:53.156698 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-12 17:14:06.907775 (MainThread): Got an exception trying to initialize tracking
2020-10-12 17:14:06.907921 (MainThread): Running with dbt=0.16.0
2020-10-12 17:14:06.989165 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 17:14:06.989479 (MainThread): Tracking: do not track
2020-10-12 17:14:07.021963 (MainThread): Partial parsing not enabled
2020-10-12 17:14:07.023927 (MainThread): Parsing macros/core.sql
2020-10-12 17:14:07.031881 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 17:14:07.045933 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 17:14:07.057328 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 17:14:07.079894 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 17:14:07.087517 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 17:14:07.097698 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 17:14:07.155708 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 17:14:07.182783 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 17:14:07.185373 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 17:14:07.194821 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 17:14:07.197558 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 17:14:07.232714 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 17:14:07.234319 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 17:14:07.237261 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 17:14:07.238462 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 17:14:07.239957 (MainThread): Parsing macros/etc/query.sql
2020-10-12 17:14:07.241368 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 17:14:07.244253 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 17:14:07.245668 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 17:14:07.260454 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 17:14:07.263367 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 17:14:07.265702 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 17:14:07.267015 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 17:14:07.345421 (MainThread): Parsing macros/relations.sql
2020-10-12 17:14:07.347753 (MainThread): Parsing macros/adapters.sql
2020-10-12 17:14:07.377913 (MainThread): Parsing macros/catalog.sql
2020-10-12 17:14:07.381555 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 17:14:07.404877 (MainThread): Partial parsing not enabled
2020-10-12 17:14:07.448237 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 17:14:07.448375 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:14:07.476171 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 17:14:07.476329 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:14:07.485301 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 17:14:07.485474 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:14:07.495005 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 17:14:07.495187 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:14:07.979694 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 17:14:07.984892 (MainThread): 
2020-10-12 17:14:07.985373 (MainThread): Acquiring new postgres connection "master".
2020-10-12 17:14:07.985502 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:14:08.011410 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-12 17:14:08.011581 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-12 17:14:08.147546 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-12 17:14:08.147685 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-12 17:14:08.151173 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-12 17:14:08.174704 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-12 17:14:08.174876 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-12 17:14:08.177270 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 17:14:08.177392 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-12 17:14:08.177741 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:14:08.177863 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 17:14:08.177952 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-12 17:14:08.179952 (ThreadPoolExecutor-1_0): SQL status: SELECT 31 in 0.00 seconds
2020-10-12 17:14:08.212551 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-12 17:14:08.237709 (MainThread): Using postgres connection "master".
2020-10-12 17:14:08.237857 (MainThread): On master: BEGIN
2020-10-12 17:14:08.240917 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:14:08.241064 (MainThread): Using postgres connection "master".
2020-10-12 17:14:08.241151 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-12 17:14:08.246453 (MainThread): SQL status: SELECT 5 in 0.01 seconds
2020-10-12 17:14:08.254896 (MainThread): On master: ROLLBACK
2020-10-12 17:14:08.255272 (MainThread): Using postgres connection "master".
2020-10-12 17:14:08.255384 (MainThread): On master: BEGIN
2020-10-12 17:14:08.255856 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:14:08.255985 (MainThread): On master: COMMIT
2020-10-12 17:14:08.256083 (MainThread): Using postgres connection "master".
2020-10-12 17:14:08.256168 (MainThread): On master: COMMIT
2020-10-12 17:14:08.256447 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:14:08.256779 (MainThread): 17:14:08 | Concurrency: 1 threads (target='dev')
2020-10-12 17:14:08.256920 (MainThread): 17:14:08 | 
2020-10-12 17:14:08.262950 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-12 17:14:08.263148 (Thread-1): 17:14:08 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-12 17:14:08.263520 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 17:14:08.263617 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-12 17:14:08.263723 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-12 17:14:08.287954 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 17:14:08.288271 (Thread-1): finished collecting timing info
2020-10-12 17:14:08.344187 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 17:14:08.344462 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-12 17:14:08.345137 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:14:08.350614 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 17:14:08.350825 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 17:14:08.351278 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:14:08.354581 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 17:14:08.355105 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 17:14:08.355279 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-12 17:14:08.355612 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:14:08.355800 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 17:14:08.355966 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-12 17:14:08.358123 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:14:08.367291 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 17:14:08.367554 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi" rename to "stg_npi__dbt_backup"
2020-10-12 17:14:08.368205 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:14:08.375408 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 17:14:08.375612 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-12 17:14:08.376324 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:14:08.378077 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-12 17:14:08.378247 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 17:14:08.378399 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-12 17:14:08.379580 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:14:08.383690 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 17:14:08.383875 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 17:14:08.386545 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:14:08.391759 (Thread-1): finished collecting timing info
2020-10-12 17:14:08.393015 (Thread-1): 17:14:08 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.13s]
2020-10-12 17:14:08.393786 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-12 17:14:08.394084 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 17:14:08.394472 (Thread-1): 17:14:08 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-12 17:14:08.395329 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 17:14:08.395487 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-12 17:14:08.395647 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-12 17:14:08.412003 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 17:14:08.412586 (Thread-1): finished collecting timing info
2020-10-12 17:14:08.431081 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 17:14:08.431371 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-12 17:14:08.431936 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:14:08.437681 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 17:14:08.437938 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 17:14:08.438487 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:14:08.442146 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 17:14:08.442762 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 17:14:08.442953 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-12 17:14:08.443339 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:14:08.443528 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 17:14:08.443692 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-12 17:14:08.444977 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:14:08.454253 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 17:14:08.454518 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations" rename to "stg_state_abbreviations__dbt_backup"
2020-10-12 17:14:08.455261 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:14:08.461275 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 17:14:08.461531 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-12 17:14:08.462244 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:14:08.464236 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-12 17:14:08.464428 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 17:14:08.464588 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-12 17:14:08.465752 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:14:08.470425 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 17:14:08.470711 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 17:14:08.472286 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:14:08.475936 (Thread-1): finished collecting timing info
2020-10-12 17:14:08.476820 (Thread-1): 17:14:08 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.08s]
2020-10-12 17:14:08.476996 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 17:14:08.477436 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-12 17:14:08.477623 (Thread-1): 17:14:08 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-12 17:14:08.478004 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 17:14:08.478112 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-12 17:14:08.478218 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-12 17:14:08.493432 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 17:14:08.493790 (Thread-1): finished collecting timing info
2020-10-12 17:14:08.505107 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 17:14:08.505280 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-12 17:14:08.505725 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:14:08.509307 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 17:14:08.509469 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 17:14:08.509931 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:14:08.512513 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 17:14:08.512902 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 17:14:08.513020 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-12 17:14:08.513339 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:14:08.513472 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 17:14:08.513595 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-12 17:14:08.514836 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:14:08.518309 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 17:14:08.518441 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-12 17:14:08.518973 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:14:08.520126 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-12 17:14:08.520249 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 17:14:08.520354 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-12 17:14:08.521431 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:14:08.524001 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 17:14:08.524124 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 17:14:08.524424 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:14:08.527739 (Thread-1): finished collecting timing info
2020-10-12 17:14:08.528567 (Thread-1): 17:14:08 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.05s]
2020-10-12 17:14:08.528736 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-12 17:14:08.529157 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-12 17:14:08.529328 (Thread-1): 17:14:08 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-12 17:14:08.529671 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 17:14:08.529774 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-12 17:14:08.529876 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-12 17:14:08.539603 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 17:14:08.539982 (Thread-1): finished collecting timing info
2020-10-12 17:14:08.550336 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 17:14:08.550492 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-12 17:14:08.550847 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:14:08.553920 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 17:14:08.554033 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 17:14:08.554289 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:14:08.556244 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 17:14:08.556568 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 17:14:08.556675 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-12 17:14:08.556855 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:14:08.556961 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 17:14:08.557050 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-12 17:14:08.558091 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:14:08.562587 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 17:14:08.562717 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-12 17:14:08.563076 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:14:08.564062 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-12 17:14:08.564170 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 17:14:08.564262 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-12 17:14:08.565279 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:14:08.567602 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 17:14:08.567713 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 17:14:08.567966 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:14:08.571026 (Thread-1): finished collecting timing info
2020-10-12 17:14:08.571799 (Thread-1): 17:14:08 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.04s]
2020-10-12 17:14:08.571957 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-12 17:14:08.672881 (MainThread): Using postgres connection "master".
2020-10-12 17:14:08.673037 (MainThread): On master: BEGIN
2020-10-12 17:14:08.673370 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:14:08.673494 (MainThread): On master: COMMIT
2020-10-12 17:14:08.673586 (MainThread): Using postgres connection "master".
2020-10-12 17:14:08.673670 (MainThread): On master: COMMIT
2020-10-12 17:14:08.673933 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:14:08.674286 (MainThread): 17:14:08 | 
2020-10-12 17:14:08.674460 (MainThread): 17:14:08 | Finished running 4 view models in 0.69s.
2020-10-12 17:14:08.674621 (MainThread): Connection 'master' was left open.
2020-10-12 17:14:08.674744 (MainThread): On master: Close
2020-10-12 17:14:08.674884 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-12 17:14:08.674974 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-12 17:14:08.695709 (MainThread): 
2020-10-12 17:14:08.695946 (MainThread): Completed successfully
2020-10-12 17:14:08.696127 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-12 17:14:08.696426 (MainThread): Flushing usage events
2020-10-12 17:18:16.075115 (MainThread): Got an exception trying to initialize tracking
2020-10-12 17:18:16.075277 (MainThread): Running with dbt=0.16.0
2020-10-12 17:18:16.161323 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 17:18:16.161676 (MainThread): Tracking: do not track
2020-10-12 17:18:16.196770 (MainThread): Partial parsing not enabled
2020-10-12 17:18:16.198923 (MainThread): Parsing macros/core.sql
2020-10-12 17:18:16.207081 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 17:18:16.222371 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 17:18:16.235230 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 17:18:16.262208 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 17:18:16.272755 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 17:18:16.287976 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 17:18:16.367946 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 17:18:16.397774 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 17:18:16.400636 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 17:18:16.411243 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 17:18:16.414255 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 17:18:16.452809 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 17:18:16.454616 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 17:18:16.457822 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 17:18:16.459134 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 17:18:16.460759 (MainThread): Parsing macros/etc/query.sql
2020-10-12 17:18:16.462299 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 17:18:16.465432 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 17:18:16.466921 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 17:18:16.482111 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 17:18:16.485098 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 17:18:16.487518 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 17:18:16.488864 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 17:18:16.568644 (MainThread): Parsing macros/relations.sql
2020-10-12 17:18:16.571246 (MainThread): Parsing macros/adapters.sql
2020-10-12 17:18:16.603693 (MainThread): Parsing macros/catalog.sql
2020-10-12 17:18:16.607946 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 17:18:16.635816 (MainThread): Partial parsing not enabled
2020-10-12 17:18:16.709965 (MainThread): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:18:16.710187 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:18:16.756803 (MainThread): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:18:16.757124 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:18:16.779761 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:18:16.779906 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:18:16.788877 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:18:16.789024 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:18:16.963880 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ge_tutorials

2020-10-12 17:18:17.237236 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 17:18:17.242232 (MainThread): 
2020-10-12 17:18:17.242654 (MainThread): Acquiring new postgres connection "master".
2020-10-12 17:18:17.242787 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:18:17.268875 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-12 17:18:17.269036 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-12 17:18:17.397016 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-12 17:18:17.397240 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-12 17:18:17.401184 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-12 17:18:17.424661 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-12 17:18:17.424779 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-12 17:18:17.426815 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 17:18:17.426921 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-12 17:18:17.427233 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:18:17.427347 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 17:18:17.427433 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-12 17:18:17.429400 (ThreadPoolExecutor-1_0): SQL status: SELECT 31 in 0.00 seconds
2020-10-12 17:18:17.461047 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-12 17:18:17.484833 (MainThread): Using postgres connection "master".
2020-10-12 17:18:17.484939 (MainThread): On master: BEGIN
2020-10-12 17:18:17.487793 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:18:17.487913 (MainThread): Using postgres connection "master".
2020-10-12 17:18:17.487999 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-12 17:18:17.493160 (MainThread): SQL status: SELECT 5 in 0.01 seconds
2020-10-12 17:18:17.501394 (MainThread): On master: ROLLBACK
2020-10-12 17:18:17.501677 (MainThread): Using postgres connection "master".
2020-10-12 17:18:17.501780 (MainThread): On master: BEGIN
2020-10-12 17:18:17.502199 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:18:17.502324 (MainThread): On master: COMMIT
2020-10-12 17:18:17.502418 (MainThread): Using postgres connection "master".
2020-10-12 17:18:17.502500 (MainThread): On master: COMMIT
2020-10-12 17:18:17.502702 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:18:17.503007 (MainThread): 17:18:17 | Concurrency: 1 threads (target='dev')
2020-10-12 17:18:17.503138 (MainThread): 17:18:17 | 
2020-10-12 17:18:17.509142 (Thread-1): Began running node model.airflow_dbt.stg_npi
2020-10-12 17:18:17.509318 (Thread-1): 17:18:17 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-12 17:18:17.509648 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:18:17.509740 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-12 17:18:17.509838 (Thread-1): Compiling model.airflow_dbt.stg_npi
2020-10-12 17:18:17.533230 (Thread-1): Writing injected SQL for node "model.airflow_dbt.stg_npi"
2020-10-12 17:18:17.533600 (Thread-1): finished collecting timing info
2020-10-12 17:18:17.583574 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:18:17.583728 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-12 17:18:17.584294 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:18:17.588116 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:18:17.588265 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 17:18:17.588596 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:18:17.590833 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.stg_npi"
2020-10-12 17:18:17.591140 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:18:17.591234 (Thread-1): On model.airflow_dbt.stg_npi: BEGIN
2020-10-12 17:18:17.591525 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:18:17.591632 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:18:17.591718 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-12 17:18:17.593048 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:18:17.597957 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:18:17.598067 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
alter table "airflow"."public"."stg_npi" rename to "stg_npi__dbt_backup"
2020-10-12 17:18:17.598494 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:18:17.602244 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:18:17.602348 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-12 17:18:17.602760 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:18:17.603691 (Thread-1): On model.airflow_dbt.stg_npi: COMMIT
2020-10-12 17:18:17.603793 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:18:17.603880 (Thread-1): On model.airflow_dbt.stg_npi: COMMIT
2020-10-12 17:18:17.607851 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:18:17.610531 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:18:17.610678 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 17:18:17.613132 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:18:17.616312 (Thread-1): finished collecting timing info
2020-10-12 17:18:17.617089 (Thread-1): 17:18:17 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.11s]
2020-10-12 17:18:17.617239 (Thread-1): Finished running node model.airflow_dbt.stg_npi
2020-10-12 17:18:17.617386 (Thread-1): Began running node model.airflow_dbt.stg_state_abbreviations
2020-10-12 17:18:17.617550 (Thread-1): 17:18:17 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-12 17:18:17.618007 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:18:17.618109 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.stg_npi).
2020-10-12 17:18:17.618207 (Thread-1): Compiling model.airflow_dbt.stg_state_abbreviations
2020-10-12 17:18:17.627571 (Thread-1): Writing injected SQL for node "model.airflow_dbt.stg_state_abbreviations"
2020-10-12 17:18:17.627811 (Thread-1): finished collecting timing info
2020-10-12 17:18:17.638169 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:18:17.638346 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-12 17:18:17.638799 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:18:17.642040 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:18:17.642205 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 17:18:17.642705 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:18:17.644961 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.stg_state_abbreviations"
2020-10-12 17:18:17.645346 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:18:17.645461 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: BEGIN
2020-10-12 17:18:17.645795 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:18:17.645919 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:18:17.646016 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-12 17:18:17.646841 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:18:17.652502 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:18:17.652662 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations" rename to "stg_state_abbreviations__dbt_backup"
2020-10-12 17:18:17.653182 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:18:17.656513 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:18:17.656626 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-12 17:18:17.657040 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:18:17.658110 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: COMMIT
2020-10-12 17:18:17.658221 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:18:17.658315 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: COMMIT
2020-10-12 17:18:17.659708 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:18:17.662369 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:18:17.662485 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 17:18:17.664098 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:18:17.667399 (Thread-1): finished collecting timing info
2020-10-12 17:18:17.668168 (Thread-1): 17:18:17 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.05s]
2020-10-12 17:18:17.668320 (Thread-1): Finished running node model.airflow_dbt.stg_state_abbreviations
2020-10-12 17:18:17.668760 (Thread-1): Began running node model.airflow_dbt.npi_with_state
2020-10-12 17:18:17.668922 (Thread-1): 17:18:17 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-12 17:18:17.669234 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:18:17.669334 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.stg_state_abbreviations).
2020-10-12 17:18:17.669431 (Thread-1): Compiling model.airflow_dbt.npi_with_state
2020-10-12 17:18:17.682844 (Thread-1): Writing injected SQL for node "model.airflow_dbt.npi_with_state"
2020-10-12 17:18:17.683378 (Thread-1): finished collecting timing info
2020-10-12 17:18:17.693505 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:18:17.693657 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-12 17:18:17.694052 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:18:17.697104 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:18:17.697214 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 17:18:17.697523 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:18:17.699420 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.npi_with_state"
2020-10-12 17:18:17.699697 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:18:17.699800 (Thread-1): On model.airflow_dbt.npi_with_state: BEGIN
2020-10-12 17:18:17.700059 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:18:17.700178 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:18:17.700274 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-12 17:18:17.701435 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:18:17.704503 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:18:17.704614 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-12 17:18:17.705073 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:18:17.706074 (Thread-1): On model.airflow_dbt.npi_with_state: COMMIT
2020-10-12 17:18:17.706180 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:18:17.706270 (Thread-1): On model.airflow_dbt.npi_with_state: COMMIT
2020-10-12 17:18:17.707593 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:18:17.709807 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:18:17.709912 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 17:18:17.710208 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:18:17.713192 (Thread-1): finished collecting timing info
2020-10-12 17:18:17.713953 (Thread-1): 17:18:17 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.04s]
2020-10-12 17:18:17.714105 (Thread-1): Finished running node model.airflow_dbt.npi_with_state
2020-10-12 17:18:17.714530 (Thread-1): Began running node model.airflow_dbt.count_providers_by_state
2020-10-12 17:18:17.714680 (Thread-1): 17:18:17 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-12 17:18:17.714983 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:18:17.715078 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.npi_with_state).
2020-10-12 17:18:17.715182 (Thread-1): Compiling model.airflow_dbt.count_providers_by_state
2020-10-12 17:18:17.724127 (Thread-1): Writing injected SQL for node "model.airflow_dbt.count_providers_by_state"
2020-10-12 17:18:17.724353 (Thread-1): finished collecting timing info
2020-10-12 17:18:17.735068 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:18:17.735269 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-12 17:18:17.735896 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:18:17.739391 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:18:17.739515 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 17:18:17.739871 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:18:17.741822 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.count_providers_by_state"
2020-10-12 17:18:17.742123 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:18:17.742259 (Thread-1): On model.airflow_dbt.count_providers_by_state: BEGIN
2020-10-12 17:18:17.742571 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:18:17.742678 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:18:17.742786 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-12 17:18:17.744114 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:18:17.749114 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:18:17.749285 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-12 17:18:17.749809 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:18:17.750935 (Thread-1): On model.airflow_dbt.count_providers_by_state: COMMIT
2020-10-12 17:18:17.751046 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:18:17.751140 (Thread-1): On model.airflow_dbt.count_providers_by_state: COMMIT
2020-10-12 17:18:17.752555 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:18:17.755013 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:18:17.755123 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 17:18:17.755429 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:18:17.758592 (Thread-1): finished collecting timing info
2020-10-12 17:18:17.759493 (Thread-1): 17:18:17 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.04s]
2020-10-12 17:18:17.759675 (Thread-1): Finished running node model.airflow_dbt.count_providers_by_state
2020-10-12 17:18:17.815126 (MainThread): Using postgres connection "master".
2020-10-12 17:18:17.815316 (MainThread): On master: BEGIN
2020-10-12 17:18:17.815662 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:18:17.815802 (MainThread): On master: COMMIT
2020-10-12 17:18:17.815906 (MainThread): Using postgres connection "master".
2020-10-12 17:18:17.816002 (MainThread): On master: COMMIT
2020-10-12 17:18:17.816258 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:18:17.816650 (MainThread): 17:18:17 | 
2020-10-12 17:18:17.816806 (MainThread): 17:18:17 | Finished running 4 view models in 0.57s.
2020-10-12 17:18:17.816969 (MainThread): Connection 'master' was left open.
2020-10-12 17:18:17.817101 (MainThread): On master: Close
2020-10-12 17:18:17.817258 (MainThread): Connection 'model.airflow_dbt.count_providers_by_state' was left open.
2020-10-12 17:18:17.817357 (MainThread): On model.airflow_dbt.count_providers_by_state: Close
2020-10-12 17:18:17.836279 (MainThread): 
2020-10-12 17:18:17.836671 (MainThread): Completed successfully
2020-10-12 17:18:17.836974 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-12 17:18:17.837323 (MainThread): Flushing usage events
2020-10-12 17:23:14.922131 (MainThread): Got an exception trying to initialize tracking
2020-10-12 17:23:14.922286 (MainThread): Running with dbt=0.16.0
2020-10-12 17:23:15.014894 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 17:23:15.015415 (MainThread): Tracking: do not track
2020-10-12 17:23:15.057491 (MainThread): Partial parsing not enabled
2020-10-12 17:23:15.060217 (MainThread): Parsing macros/core.sql
2020-10-12 17:23:15.074145 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 17:23:15.099784 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 17:23:15.122188 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 17:23:15.153461 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 17:23:15.161959 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 17:23:15.173589 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 17:23:15.237834 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 17:23:15.273922 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 17:23:15.277537 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 17:23:15.290598 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 17:23:15.294727 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 17:23:15.347825 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 17:23:15.350432 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 17:23:15.354969 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 17:23:15.356816 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 17:23:15.359035 (MainThread): Parsing macros/etc/query.sql
2020-10-12 17:23:15.361046 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 17:23:15.365097 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 17:23:15.367027 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 17:23:15.386120 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 17:23:15.389791 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 17:23:15.392747 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 17:23:15.394410 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 17:23:15.483762 (MainThread): Parsing macros/relations.sql
2020-10-12 17:23:15.486332 (MainThread): Parsing macros/adapters.sql
2020-10-12 17:23:15.518916 (MainThread): Parsing macros/catalog.sql
2020-10-12 17:23:15.522996 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 17:23:15.550336 (MainThread): Partial parsing not enabled
2020-10-12 17:23:15.594408 (MainThread): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:23:15.594552 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:23:15.619302 (MainThread): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:23:15.619445 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:23:15.627099 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:23:15.627222 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:23:15.635264 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:23:15.635394 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:23:15.881943 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ge_tutorials

2020-10-12 17:23:16.161495 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 17:23:16.167945 (MainThread): 
2020-10-12 17:23:16.168493 (MainThread): Acquiring new postgres connection "master".
2020-10-12 17:23:16.168658 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:23:16.199302 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-12 17:23:16.199465 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-12 17:23:16.322490 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-12 17:23:16.322626 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-12 17:23:16.326253 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-12 17:23:16.347987 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-12 17:23:16.348096 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-12 17:23:16.350014 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 17:23:16.350115 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-12 17:23:16.350400 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:23:16.350514 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 17:23:16.350600 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-12 17:23:16.352456 (ThreadPoolExecutor-1_0): SQL status: SELECT 31 in 0.00 seconds
2020-10-12 17:23:16.381934 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-12 17:23:16.404529 (MainThread): Using postgres connection "master".
2020-10-12 17:23:16.404628 (MainThread): On master: BEGIN
2020-10-12 17:23:16.407466 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:23:16.407579 (MainThread): Using postgres connection "master".
2020-10-12 17:23:16.407660 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-12 17:23:16.412740 (MainThread): SQL status: SELECT 5 in 0.00 seconds
2020-10-12 17:23:16.420634 (MainThread): On master: ROLLBACK
2020-10-12 17:23:16.420911 (MainThread): Using postgres connection "master".
2020-10-12 17:23:16.421012 (MainThread): On master: BEGIN
2020-10-12 17:23:16.421451 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:23:16.421563 (MainThread): On master: COMMIT
2020-10-12 17:23:16.421652 (MainThread): Using postgres connection "master".
2020-10-12 17:23:16.421732 (MainThread): On master: COMMIT
2020-10-12 17:23:16.421982 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:23:16.422302 (MainThread): 17:23:16 | Concurrency: 1 threads (target='dev')
2020-10-12 17:23:16.422436 (MainThread): 17:23:16 | 
2020-10-12 17:23:16.428198 (Thread-1): Began running node model.airflow_dbt.stg_npi
2020-10-12 17:23:16.428364 (Thread-1): 17:23:16 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-12 17:23:16.428677 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:23:16.428766 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-12 17:23:16.428859 (Thread-1): Compiling model.airflow_dbt.stg_npi
2020-10-12 17:23:16.451656 (Thread-1): Writing injected SQL for node "model.airflow_dbt.stg_npi"
2020-10-12 17:23:16.452025 (Thread-1): finished collecting timing info
2020-10-12 17:23:16.501430 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:23:16.501589 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-12 17:23:16.502155 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:23:16.504900 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:23:16.505000 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 17:23:16.505292 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:23:16.506974 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.stg_npi"
2020-10-12 17:23:16.507287 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:23:16.507380 (Thread-1): On model.airflow_dbt.stg_npi: BEGIN
2020-10-12 17:23:16.507635 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:23:16.507745 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:23:16.507832 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-12 17:23:16.509021 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:23:16.513578 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:23:16.513683 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
alter table "airflow"."public"."stg_npi" rename to "stg_npi__dbt_backup"
2020-10-12 17:23:16.514083 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:23:16.517691 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:23:16.517791 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-12 17:23:16.518177 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:23:16.519068 (Thread-1): On model.airflow_dbt.stg_npi: COMMIT
2020-10-12 17:23:16.519165 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:23:16.519248 (Thread-1): On model.airflow_dbt.stg_npi: COMMIT
2020-10-12 17:23:16.522766 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:23:16.525408 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:23:16.525527 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 17:23:16.527945 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:23:16.531334 (Thread-1): finished collecting timing info
2020-10-12 17:23:16.532124 (Thread-1): 17:23:16 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.10s]
2020-10-12 17:23:16.532277 (Thread-1): Finished running node model.airflow_dbt.stg_npi
2020-10-12 17:23:16.532447 (Thread-1): Began running node model.airflow_dbt.stg_state_abbreviations
2020-10-12 17:23:16.532604 (Thread-1): 17:23:16 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-12 17:23:16.533085 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:23:16.533190 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.stg_npi).
2020-10-12 17:23:16.533298 (Thread-1): Compiling model.airflow_dbt.stg_state_abbreviations
2020-10-12 17:23:16.542913 (Thread-1): Writing injected SQL for node "model.airflow_dbt.stg_state_abbreviations"
2020-10-12 17:23:16.543159 (Thread-1): finished collecting timing info
2020-10-12 17:23:16.554150 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:23:16.554319 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-12 17:23:16.554701 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:23:16.557822 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:23:16.557936 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 17:23:16.558250 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:23:16.560475 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.stg_state_abbreviations"
2020-10-12 17:23:16.560775 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:23:16.560883 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: BEGIN
2020-10-12 17:23:16.561194 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:23:16.561344 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:23:16.561476 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-12 17:23:16.562257 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:23:16.568108 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:23:16.568274 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations" rename to "stg_state_abbreviations__dbt_backup"
2020-10-12 17:23:16.568788 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:23:16.572124 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:23:16.572257 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-12 17:23:16.572689 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:23:16.573737 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: COMMIT
2020-10-12 17:23:16.573849 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:23:16.573944 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: COMMIT
2020-10-12 17:23:16.575172 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:23:16.577599 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:23:16.577743 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 17:23:16.579105 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:23:16.587268 (Thread-1): finished collecting timing info
2020-10-12 17:23:16.588878 (Thread-1): 17:23:16 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.06s]
2020-10-12 17:23:16.589125 (Thread-1): Finished running node model.airflow_dbt.stg_state_abbreviations
2020-10-12 17:23:16.589834 (Thread-1): Began running node model.airflow_dbt.npi_with_state
2020-10-12 17:23:16.590107 (Thread-1): 17:23:16 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-12 17:23:16.590614 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:23:16.590804 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.stg_state_abbreviations).
2020-10-12 17:23:16.590987 (Thread-1): Compiling model.airflow_dbt.npi_with_state
2020-10-12 17:23:16.608254 (Thread-1): Writing injected SQL for node "model.airflow_dbt.npi_with_state"
2020-10-12 17:23:16.608540 (Thread-1): finished collecting timing info
2020-10-12 17:23:16.618115 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:23:16.618236 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-12 17:23:16.618600 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:23:16.621629 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:23:16.621743 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 17:23:16.622007 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:23:16.624699 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.npi_with_state"
2020-10-12 17:23:16.625111 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:23:16.625254 (Thread-1): On model.airflow_dbt.npi_with_state: BEGIN
2020-10-12 17:23:16.625603 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:23:16.625746 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:23:16.625868 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-12 17:23:16.627221 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:23:16.630659 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:23:16.630835 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-12 17:23:16.631453 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:23:16.632879 (Thread-1): On model.airflow_dbt.npi_with_state: COMMIT
2020-10-12 17:23:16.633049 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:23:16.633149 (Thread-1): On model.airflow_dbt.npi_with_state: COMMIT
2020-10-12 17:23:16.634458 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:23:16.636941 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:23:16.637054 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 17:23:16.637374 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:23:16.640623 (Thread-1): finished collecting timing info
2020-10-12 17:23:16.641408 (Thread-1): 17:23:16 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.05s]
2020-10-12 17:23:16.641563 (Thread-1): Finished running node model.airflow_dbt.npi_with_state
2020-10-12 17:23:16.641984 (Thread-1): Began running node model.airflow_dbt.count_providers_by_state
2020-10-12 17:23:16.642167 (Thread-1): 17:23:16 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-12 17:23:16.642500 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:23:16.642605 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.npi_with_state).
2020-10-12 17:23:16.642713 (Thread-1): Compiling model.airflow_dbt.count_providers_by_state
2020-10-12 17:23:16.653395 (Thread-1): Writing injected SQL for node "model.airflow_dbt.count_providers_by_state"
2020-10-12 17:23:16.653881 (Thread-1): finished collecting timing info
2020-10-12 17:23:16.667157 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:23:16.667362 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-12 17:23:16.667820 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:23:16.671767 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:23:16.671949 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 17:23:16.672423 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:23:16.674948 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.count_providers_by_state"
2020-10-12 17:23:16.675328 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:23:16.675461 (Thread-1): On model.airflow_dbt.count_providers_by_state: BEGIN
2020-10-12 17:23:16.675793 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:23:16.675941 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:23:16.676059 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-12 17:23:16.677482 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:23:16.683409 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:23:16.683626 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-12 17:23:16.684290 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:23:16.685681 (Thread-1): On model.airflow_dbt.count_providers_by_state: COMMIT
2020-10-12 17:23:16.685828 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:23:16.685946 (Thread-1): On model.airflow_dbt.count_providers_by_state: COMMIT
2020-10-12 17:23:16.687076 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:23:16.690119 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:23:16.690271 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 17:23:16.690653 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:23:16.694774 (Thread-1): finished collecting timing info
2020-10-12 17:23:16.695954 (Thread-1): 17:23:16 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.05s]
2020-10-12 17:23:16.696163 (Thread-1): Finished running node model.airflow_dbt.count_providers_by_state
2020-10-12 17:23:16.732078 (MainThread): Using postgres connection "master".
2020-10-12 17:23:16.732366 (MainThread): On master: BEGIN
2020-10-12 17:23:16.732824 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:23:16.733053 (MainThread): On master: COMMIT
2020-10-12 17:23:16.733242 (MainThread): Using postgres connection "master".
2020-10-12 17:23:16.733423 (MainThread): On master: COMMIT
2020-10-12 17:23:16.733773 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:23:16.734384 (MainThread): 17:23:16 | 
2020-10-12 17:23:16.734643 (MainThread): 17:23:16 | Finished running 4 view models in 0.57s.
2020-10-12 17:23:16.734885 (MainThread): Connection 'master' was left open.
2020-10-12 17:23:16.735063 (MainThread): On master: Close
2020-10-12 17:23:16.735318 (MainThread): Connection 'model.airflow_dbt.count_providers_by_state' was left open.
2020-10-12 17:23:16.735494 (MainThread): On model.airflow_dbt.count_providers_by_state: Close
2020-10-12 17:23:16.764079 (MainThread): 
2020-10-12 17:23:16.764415 (MainThread): Completed successfully
2020-10-12 17:23:16.764669 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-12 17:23:16.765016 (MainThread): Flushing usage events
2020-10-12 17:54:11.332505 (MainThread): Got an exception trying to initialize tracking
2020-10-12 17:54:11.332677 (MainThread): Running with dbt=0.16.0
2020-10-12 17:54:11.419109 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 17:54:11.419414 (MainThread): Tracking: do not track
2020-10-12 17:54:11.451894 (MainThread): Partial parsing not enabled
2020-10-12 17:54:11.453844 (MainThread): Parsing macros/core.sql
2020-10-12 17:54:11.461431 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 17:54:11.475293 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 17:54:11.486597 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 17:54:11.509237 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 17:54:11.516999 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 17:54:11.528388 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 17:54:11.588579 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 17:54:11.615034 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 17:54:11.617581 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 17:54:11.627104 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 17:54:11.629868 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 17:54:11.665306 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 17:54:11.666932 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 17:54:11.669892 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 17:54:11.671096 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 17:54:11.672599 (MainThread): Parsing macros/etc/query.sql
2020-10-12 17:54:11.674021 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 17:54:11.676933 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 17:54:11.678366 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 17:54:11.693239 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 17:54:11.696178 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 17:54:11.698535 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 17:54:11.699847 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 17:54:11.779889 (MainThread): Parsing macros/relations.sql
2020-10-12 17:54:11.782475 (MainThread): Parsing macros/adapters.sql
2020-10-12 17:54:11.813162 (MainThread): Parsing macros/catalog.sql
2020-10-12 17:54:11.816833 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 17:54:11.841149 (MainThread): Partial parsing not enabled
2020-10-12 17:54:11.879356 (MainThread): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:54:11.879462 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:54:11.901490 (MainThread): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:54:11.901622 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:54:11.908840 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:54:11.908938 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:54:11.916090 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:54:11.916184 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:54:12.090246 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airflow_dbt.ge_tutorials

2020-10-12 17:54:12.396884 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 17:54:12.401772 (MainThread): 
2020-10-12 17:54:12.402248 (MainThread): Acquiring new postgres connection "master".
2020-10-12 17:54:12.402379 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:54:12.433797 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-12 17:54:12.434110 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-12 17:54:12.583990 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-12 17:54:12.584146 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-12 17:54:12.588085 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-12 17:54:12.612738 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-12 17:54:12.612887 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-12 17:54:12.615112 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 17:54:12.615240 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-12 17:54:12.615613 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:54:12.615750 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 17:54:12.615847 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-12 17:54:12.617966 (ThreadPoolExecutor-1_0): SQL status: SELECT 31 in 0.00 seconds
2020-10-12 17:54:12.652507 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-12 17:54:12.677989 (MainThread): Using postgres connection "master".
2020-10-12 17:54:12.678117 (MainThread): On master: BEGIN
2020-10-12 17:54:12.681015 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:54:12.681137 (MainThread): Using postgres connection "master".
2020-10-12 17:54:12.681222 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-12 17:54:12.686633 (MainThread): SQL status: SELECT 5 in 0.01 seconds
2020-10-12 17:54:12.695117 (MainThread): On master: ROLLBACK
2020-10-12 17:54:12.695441 (MainThread): Using postgres connection "master".
2020-10-12 17:54:12.695554 (MainThread): On master: BEGIN
2020-10-12 17:54:12.696045 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:54:12.696167 (MainThread): On master: COMMIT
2020-10-12 17:54:12.696262 (MainThread): Using postgres connection "master".
2020-10-12 17:54:12.696357 (MainThread): On master: COMMIT
2020-10-12 17:54:12.696623 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:54:12.696945 (MainThread): 17:54:12 | Concurrency: 1 threads (target='dev')
2020-10-12 17:54:12.697085 (MainThread): 17:54:12 | 
2020-10-12 17:54:12.703232 (Thread-1): Began running node model.airflow_dbt.stg_npi
2020-10-12 17:54:12.703413 (Thread-1): 17:54:12 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-12 17:54:12.703751 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:54:12.703844 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-12 17:54:12.703944 (Thread-1): Compiling model.airflow_dbt.stg_npi
2020-10-12 17:54:12.727328 (Thread-1): Writing injected SQL for node "model.airflow_dbt.stg_npi"
2020-10-12 17:54:12.727682 (Thread-1): finished collecting timing info
2020-10-12 17:54:12.780174 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:54:12.780364 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-12 17:54:12.780904 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:54:12.784201 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:54:12.784334 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 17:54:12.784651 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:54:12.786504 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.stg_npi"
2020-10-12 17:54:12.786824 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:54:12.786930 (Thread-1): On model.airflow_dbt.stg_npi: BEGIN
2020-10-12 17:54:12.787165 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:54:12.787282 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:54:12.787372 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-12 17:54:12.788574 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:54:12.793737 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:54:12.793869 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
alter table "airflow"."public"."stg_npi" rename to "stg_npi__dbt_backup"
2020-10-12 17:54:12.794291 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:54:12.798402 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:54:12.798520 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-12 17:54:12.798908 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:54:12.799909 (Thread-1): On model.airflow_dbt.stg_npi: COMMIT
2020-10-12 17:54:12.800017 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:54:12.800108 (Thread-1): On model.airflow_dbt.stg_npi: COMMIT
2020-10-12 17:54:12.801339 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:54:12.803765 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:54:12.803887 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 17:54:12.805705 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:54:12.808922 (Thread-1): finished collecting timing info
2020-10-12 17:54:12.809756 (Thread-1): 17:54:12 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.11s]
2020-10-12 17:54:12.809915 (Thread-1): Finished running node model.airflow_dbt.stg_npi
2020-10-12 17:54:12.810074 (Thread-1): Began running node model.airflow_dbt.stg_state_abbreviations
2020-10-12 17:54:12.810362 (Thread-1): 17:54:12 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-12 17:54:12.810699 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:54:12.810816 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.stg_npi).
2020-10-12 17:54:12.810915 (Thread-1): Compiling model.airflow_dbt.stg_state_abbreviations
2020-10-12 17:54:12.820481 (Thread-1): Writing injected SQL for node "model.airflow_dbt.stg_state_abbreviations"
2020-10-12 17:54:12.820789 (Thread-1): finished collecting timing info
2020-10-12 17:54:12.832088 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:54:12.832258 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-12 17:54:12.832610 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:54:12.835737 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:54:12.835857 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 17:54:12.836122 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:54:12.838316 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.stg_state_abbreviations"
2020-10-12 17:54:12.838657 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:54:12.838791 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: BEGIN
2020-10-12 17:54:12.839055 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:54:12.839168 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:54:12.839260 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-12 17:54:12.839967 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:54:12.846149 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:54:12.846337 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations" rename to "stg_state_abbreviations__dbt_backup"
2020-10-12 17:54:12.846927 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:54:12.850444 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:54:12.850569 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-12 17:54:12.850958 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:54:12.852054 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: COMMIT
2020-10-12 17:54:12.852171 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:54:12.852270 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: COMMIT
2020-10-12 17:54:12.853182 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:54:12.855656 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:54:12.855775 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 17:54:12.856970 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:54:12.862204 (Thread-1): finished collecting timing info
2020-10-12 17:54:12.863707 (Thread-1): 17:54:12 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.05s]
2020-10-12 17:54:12.864523 (Thread-1): Finished running node model.airflow_dbt.stg_state_abbreviations
2020-10-12 17:54:12.865131 (Thread-1): Began running node model.airflow_dbt.npi_with_state
2020-10-12 17:54:12.865403 (Thread-1): 17:54:12 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-12 17:54:12.866370 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:54:12.866546 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.stg_state_abbreviations).
2020-10-12 17:54:12.866721 (Thread-1): Compiling model.airflow_dbt.npi_with_state
2020-10-12 17:54:12.890163 (Thread-1): Writing injected SQL for node "model.airflow_dbt.npi_with_state"
2020-10-12 17:54:12.890824 (Thread-1): finished collecting timing info
2020-10-12 17:54:12.908239 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:54:12.908572 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-12 17:54:12.909034 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:54:12.914701 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:54:12.914951 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 17:54:12.915393 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:54:12.918989 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.npi_with_state"
2020-10-12 17:54:12.919545 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:54:12.919725 (Thread-1): On model.airflow_dbt.npi_with_state: BEGIN
2020-10-12 17:54:12.920060 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:54:12.920251 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:54:12.920418 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-12 17:54:12.921570 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:54:12.927501 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:54:12.927744 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-12 17:54:12.928324 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:54:12.930264 (Thread-1): On model.airflow_dbt.npi_with_state: COMMIT
2020-10-12 17:54:12.930454 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:54:12.930616 (Thread-1): On model.airflow_dbt.npi_with_state: COMMIT
2020-10-12 17:54:12.931728 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:54:12.936055 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:54:12.936270 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 17:54:12.936748 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:54:12.942453 (Thread-1): finished collecting timing info
2020-10-12 17:54:12.943913 (Thread-1): 17:54:12 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.08s]
2020-10-12 17:54:12.944699 (Thread-1): Finished running node model.airflow_dbt.npi_with_state
2020-10-12 17:54:12.945244 (Thread-1): Began running node model.airflow_dbt.count_providers_by_state
2020-10-12 17:54:12.945507 (Thread-1): 17:54:12 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-12 17:54:12.946447 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:54:12.946622 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.npi_with_state).
2020-10-12 17:54:12.946803 (Thread-1): Compiling model.airflow_dbt.count_providers_by_state
2020-10-12 17:54:12.963388 (Thread-1): Writing injected SQL for node "model.airflow_dbt.count_providers_by_state"
2020-10-12 17:54:12.963961 (Thread-1): finished collecting timing info
2020-10-12 17:54:12.983798 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:54:12.984079 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-12 17:54:12.984654 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:54:12.990612 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:54:12.990938 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 17:54:12.991447 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:54:12.994381 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.count_providers_by_state"
2020-10-12 17:54:12.994722 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:54:12.994849 (Thread-1): On model.airflow_dbt.count_providers_by_state: BEGIN
2020-10-12 17:54:12.995142 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:54:12.995264 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:54:12.995361 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-12 17:54:12.996504 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:54:13.001290 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:54:13.001429 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-12 17:54:13.001914 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:54:13.003000 (Thread-1): On model.airflow_dbt.count_providers_by_state: COMMIT
2020-10-12 17:54:13.003117 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:54:13.003214 (Thread-1): On model.airflow_dbt.count_providers_by_state: COMMIT
2020-10-12 17:54:13.004319 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:54:13.006898 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:54:13.007039 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 17:54:13.007372 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:54:13.010634 (Thread-1): finished collecting timing info
2020-10-12 17:54:13.011514 (Thread-1): 17:54:13 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.07s]
2020-10-12 17:54:13.011757 (Thread-1): Finished running node model.airflow_dbt.count_providers_by_state
2020-10-12 17:54:13.112449 (MainThread): Using postgres connection "master".
2020-10-12 17:54:13.112619 (MainThread): On master: BEGIN
2020-10-12 17:54:13.112957 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:54:13.113082 (MainThread): On master: COMMIT
2020-10-12 17:54:13.113176 (MainThread): Using postgres connection "master".
2020-10-12 17:54:13.113263 (MainThread): On master: COMMIT
2020-10-12 17:54:13.113521 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:54:13.113847 (MainThread): 17:54:13 | 
2020-10-12 17:54:13.113985 (MainThread): 17:54:13 | Finished running 4 view models in 0.71s.
2020-10-12 17:54:13.114129 (MainThread): Connection 'master' was left open.
2020-10-12 17:54:13.114233 (MainThread): On master: Close
2020-10-12 17:54:13.114373 (MainThread): Connection 'model.airflow_dbt.count_providers_by_state' was left open.
2020-10-12 17:54:13.114463 (MainThread): On model.airflow_dbt.count_providers_by_state: Close
2020-10-12 17:54:13.130694 (MainThread): 
2020-10-12 17:54:13.130912 (MainThread): Completed successfully
2020-10-12 17:54:13.131081 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-12 17:54:13.131306 (MainThread): Flushing usage events
2020-10-12 18:00:43.001552 (MainThread): Got an exception trying to initialize tracking
2020-10-12 18:00:43.001699 (MainThread): Running with dbt=0.16.0
2020-10-12 18:00:43.087575 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 18:00:43.087934 (MainThread): Tracking: do not track
2020-10-12 18:00:43.131313 (MainThread): Partial parsing not enabled
2020-10-12 18:00:43.134921 (MainThread): Parsing macros/core.sql
2020-10-12 18:00:43.148878 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 18:00:43.176345 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 18:00:43.200719 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 18:00:43.248602 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 18:00:43.264655 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 18:00:43.279363 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 18:00:43.349286 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 18:00:43.377482 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 18:00:43.380129 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 18:00:43.389875 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 18:00:43.392719 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 18:00:43.429304 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 18:00:43.431069 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 18:00:43.434174 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 18:00:43.435437 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 18:00:43.437013 (MainThread): Parsing macros/etc/query.sql
2020-10-12 18:00:43.438513 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 18:00:43.441589 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 18:00:43.443103 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 18:00:43.459937 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 18:00:43.463395 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 18:00:43.466198 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 18:00:43.467791 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 18:00:43.554353 (MainThread): Parsing macros/relations.sql
2020-10-12 18:00:43.556784 (MainThread): Parsing macros/adapters.sql
2020-10-12 18:00:43.586562 (MainThread): Parsing macros/catalog.sql
2020-10-12 18:00:43.590200 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 18:00:43.613374 (MainThread): Partial parsing not enabled
2020-10-12 18:00:43.755140 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airflow_dbt.ge_tutorials

2020-10-12 18:00:43.991857 (MainThread): Found 0 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2020-10-12 18:00:43.992395 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-10-12 18:00:43.992659 (MainThread): Flushing usage events
2020-10-13 01:45:25.925489 (MainThread): Got an exception trying to initialize tracking
2020-10-13 01:45:25.925636 (MainThread): Running with dbt=0.16.0
2020-10-13 01:45:26.019816 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['models/ge_tutorials/*'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-13 01:45:26.020243 (MainThread): Tracking: do not track
2020-10-13 01:45:26.057085 (MainThread): Partial parsing not enabled
2020-10-13 01:45:26.060317 (MainThread): Parsing macros/core.sql
2020-10-13 01:45:26.067993 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 01:45:26.082535 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 01:45:26.094272 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 01:45:26.117226 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 01:45:26.125000 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 01:45:26.135321 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 01:45:26.195821 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 01:45:26.223805 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 01:45:26.226541 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 01:45:26.237384 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 01:45:26.241197 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 01:45:26.286065 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 01:45:26.288313 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 01:45:26.292185 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 01:45:26.293860 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 01:45:26.295864 (MainThread): Parsing macros/etc/query.sql
2020-10-13 01:45:26.297764 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 01:45:26.301555 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 01:45:26.303515 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 01:45:26.322346 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 01:45:26.326204 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 01:45:26.329358 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 01:45:26.331183 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 01:45:26.426141 (MainThread): Parsing macros/relations.sql
2020-10-13 01:45:26.429347 (MainThread): Parsing macros/adapters.sql
2020-10-13 01:45:26.469225 (MainThread): Parsing macros/catalog.sql
2020-10-13 01:45:26.474206 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 01:45:26.507578 (MainThread): Partial parsing not enabled
2020-10-13 01:45:26.679563 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airflow_dbt.ge_tutorials

2020-10-13 01:45:26.936768 (MainThread): Found 0 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2020-10-13 01:45:26.937218 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-10-13 01:45:26.937460 (MainThread): Flushing usage events
2020-10-13 01:46:16.152068 (MainThread): Got an exception trying to initialize tracking
2020-10-13 01:46:16.152214 (MainThread): Running with dbt=0.16.0
2020-10-13 01:46:16.236751 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['models/ge_tutorials/*'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-13 01:46:16.237083 (MainThread): Tracking: do not track
2020-10-13 01:46:16.270718 (MainThread): Partial parsing not enabled
2020-10-13 01:46:16.272636 (MainThread): Parsing macros/core.sql
2020-10-13 01:46:16.280155 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 01:46:16.293839 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 01:46:16.304917 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 01:46:16.327276 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 01:46:16.334937 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 01:46:16.345167 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 01:46:16.403261 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 01:46:16.429593 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 01:46:16.432154 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 01:46:16.441670 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 01:46:16.444440 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 01:46:16.479823 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 01:46:16.481426 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 01:46:16.484375 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 01:46:16.485566 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 01:46:16.487065 (MainThread): Parsing macros/etc/query.sql
2020-10-13 01:46:16.488478 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 01:46:16.491375 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 01:46:16.492805 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 01:46:16.507649 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 01:46:16.510562 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 01:46:16.512927 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 01:46:16.514232 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 01:46:16.591395 (MainThread): Parsing macros/relations.sql
2020-10-13 01:46:16.593707 (MainThread): Parsing macros/adapters.sql
2020-10-13 01:46:16.623466 (MainThread): Parsing macros/catalog.sql
2020-10-13 01:46:16.627123 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 01:46:16.650603 (MainThread): Partial parsing not enabled
2020-10-13 01:46:16.698950 (MainThread): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:46:16.699097 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:46:16.724689 (MainThread): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:46:16.724798 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:46:16.732058 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:46:16.732151 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:46:16.739330 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:46:16.739421 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:46:17.223034 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 01:46:17.227409 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-10-13 01:46:17.227674 (MainThread): Flushing usage events
2020-10-13 01:46:17.227844 (MainThread): Connection 'model.airflow_dbt.stg_npi' was properly closed.
2020-10-13 01:46:27.925550 (MainThread): Got an exception trying to initialize tracking
2020-10-13 01:46:27.925812 (MainThread): Running with dbt=0.16.0
2020-10-13 01:46:28.059140 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['ge_tutorials/*'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-13 01:46:28.059449 (MainThread): Tracking: do not track
2020-10-13 01:46:28.092994 (MainThread): Partial parsing not enabled
2020-10-13 01:46:28.094941 (MainThread): Parsing macros/core.sql
2020-10-13 01:46:28.102530 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 01:46:28.116766 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 01:46:28.129888 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 01:46:28.154523 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 01:46:28.162901 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 01:46:28.174926 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 01:46:28.244581 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 01:46:28.273036 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 01:46:28.275750 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 01:46:28.286092 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 01:46:28.289167 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 01:46:28.328968 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 01:46:28.330738 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 01:46:28.333965 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 01:46:28.335287 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 01:46:28.336925 (MainThread): Parsing macros/etc/query.sql
2020-10-13 01:46:28.338496 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 01:46:28.341668 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 01:46:28.343242 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 01:46:28.359725 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 01:46:28.362930 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 01:46:28.365505 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 01:46:28.366940 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 01:46:28.451891 (MainThread): Parsing macros/relations.sql
2020-10-13 01:46:28.454462 (MainThread): Parsing macros/adapters.sql
2020-10-13 01:46:28.487343 (MainThread): Parsing macros/catalog.sql
2020-10-13 01:46:28.491332 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 01:46:28.516569 (MainThread): Partial parsing not enabled
2020-10-13 01:46:28.558232 (MainThread): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:46:28.558368 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:46:28.582305 (MainThread): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:46:28.582437 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:46:28.589412 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:46:28.589503 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:46:28.596652 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:46:28.596747 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:46:29.023065 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 01:46:29.027235 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-10-13 01:46:29.027501 (MainThread): Flushing usage events
2020-10-13 01:46:29.027688 (MainThread): Connection 'model.airflow_dbt.stg_npi' was properly closed.
2020-10-13 01:47:02.481972 (MainThread): Got an exception trying to initialize tracking
2020-10-13 01:47:02.482117 (MainThread): Running with dbt=0.16.0
2020-10-13 01:47:02.561838 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['airflow_dbt.models.*'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-13 01:47:02.562145 (MainThread): Tracking: do not track
2020-10-13 01:47:02.594934 (MainThread): Partial parsing not enabled
2020-10-13 01:47:02.596844 (MainThread): Parsing macros/core.sql
2020-10-13 01:47:02.604386 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 01:47:02.618326 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 01:47:02.629739 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 01:47:02.652123 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 01:47:02.659770 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 01:47:02.669984 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 01:47:02.727980 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 01:47:02.754316 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 01:47:02.756881 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 01:47:02.766371 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 01:47:02.769128 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 01:47:02.804414 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 01:47:02.806026 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 01:47:02.808981 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 01:47:02.810174 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 01:47:02.811676 (MainThread): Parsing macros/etc/query.sql
2020-10-13 01:47:02.813091 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 01:47:02.815990 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 01:47:02.817414 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 01:47:02.832231 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 01:47:02.835162 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 01:47:02.837515 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 01:47:02.838821 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 01:47:02.915548 (MainThread): Parsing macros/relations.sql
2020-10-13 01:47:02.917859 (MainThread): Parsing macros/adapters.sql
2020-10-13 01:47:02.947500 (MainThread): Parsing macros/catalog.sql
2020-10-13 01:47:02.951160 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 01:47:02.974378 (MainThread): Partial parsing not enabled
2020-10-13 01:47:03.012495 (MainThread): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:47:03.012600 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:47:03.035155 (MainThread): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:47:03.035280 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:47:03.042081 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:47:03.042172 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:47:03.048845 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:47:03.048941 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:47:03.208774 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airflow_dbt.ge_tutorials

2020-10-13 01:47:03.506960 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 01:47:03.511490 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-10-13 01:47:03.511760 (MainThread): Flushing usage events
2020-10-13 01:47:03.511939 (MainThread): Connection 'model.airflow_dbt.stg_npi' was properly closed.
2020-10-13 01:47:24.665536 (MainThread): Got an exception trying to initialize tracking
2020-10-13 01:47:24.665678 (MainThread): Running with dbt=0.16.0
2020-10-13 01:47:24.747611 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-13 01:47:24.747947 (MainThread): Tracking: do not track
2020-10-13 01:47:24.786149 (MainThread): Partial parsing not enabled
2020-10-13 01:47:24.788340 (MainThread): Parsing macros/core.sql
2020-10-13 01:47:24.796973 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 01:47:24.812643 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 01:47:24.825190 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 01:47:24.849734 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 01:47:24.857430 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 01:47:24.868405 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 01:47:24.932512 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 01:47:24.961399 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 01:47:24.964190 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 01:47:24.974558 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 01:47:24.977575 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 01:47:25.016573 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 01:47:25.018338 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 01:47:25.021567 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 01:47:25.022880 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 01:47:25.024501 (MainThread): Parsing macros/etc/query.sql
2020-10-13 01:47:25.026011 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 01:47:25.029082 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 01:47:25.030613 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 01:47:25.046931 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 01:47:25.050171 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 01:47:25.052772 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 01:47:25.054221 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 01:47:25.139118 (MainThread): Parsing macros/relations.sql
2020-10-13 01:47:25.141620 (MainThread): Parsing macros/adapters.sql
2020-10-13 01:47:25.175367 (MainThread): Parsing macros/catalog.sql
2020-10-13 01:47:25.179804 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 01:47:25.205979 (MainThread): Partial parsing not enabled
2020-10-13 01:47:25.246726 (MainThread): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:47:25.246859 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:47:25.270202 (MainThread): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:47:25.270302 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:47:25.277268 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:47:25.277362 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:47:25.284396 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:47:25.284490 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:47:25.463244 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airflow_dbt.ge_tutorials

2020-10-13 01:47:25.767853 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 01:47:25.772383 (MainThread): 
2020-10-13 01:47:25.772807 (MainThread): Acquiring new postgres connection "master".
2020-10-13 01:47:25.772925 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:47:25.797783 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-13 01:47:25.797953 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-13 01:47:25.932320 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-13 01:47:25.932465 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-13 01:47:25.936261 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-13 01:47:25.961524 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-13 01:47:25.961671 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-13 01:47:25.963699 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-13 01:47:25.963810 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-13 01:47:25.964171 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-13 01:47:25.964286 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-13 01:47:25.964375 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-13 01:47:25.967995 (ThreadPoolExecutor-1_0): SQL status: SELECT 31 in 0.00 seconds
2020-10-13 01:47:26.000648 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-13 01:47:26.025703 (MainThread): Using postgres connection "master".
2020-10-13 01:47:26.025829 (MainThread): On master: BEGIN
2020-10-13 01:47:26.028841 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 01:47:26.028969 (MainThread): Using postgres connection "master".
2020-10-13 01:47:26.029057 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-13 01:47:26.034138 (MainThread): SQL status: SELECT 5 in 0.00 seconds
2020-10-13 01:47:26.042180 (MainThread): On master: ROLLBACK
2020-10-13 01:47:26.042459 (MainThread): Using postgres connection "master".
2020-10-13 01:47:26.042560 (MainThread): On master: BEGIN
2020-10-13 01:47:26.042972 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 01:47:26.043088 (MainThread): On master: COMMIT
2020-10-13 01:47:26.043177 (MainThread): Using postgres connection "master".
2020-10-13 01:47:26.043256 (MainThread): On master: COMMIT
2020-10-13 01:47:26.043521 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-13 01:47:26.043821 (MainThread): 01:47:26 | Concurrency: 1 threads (target='dev')
2020-10-13 01:47:26.043956 (MainThread): 01:47:26 | 
2020-10-13 01:47:26.049892 (Thread-1): Began running node model.airflow_dbt.stg_npi
2020-10-13 01:47:26.050066 (Thread-1): 01:47:26 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-13 01:47:26.050378 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:47:26.050466 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-13 01:47:26.050561 (Thread-1): Compiling model.airflow_dbt.stg_npi
2020-10-13 01:47:26.073526 (Thread-1): Writing injected SQL for node "model.airflow_dbt.stg_npi"
2020-10-13 01:47:26.074355 (Thread-1): finished collecting timing info
2020-10-13 01:47:26.125120 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:47:26.125287 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-13 01:47:26.125875 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 01:47:26.128889 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:47:26.129020 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-13 01:47:26.129390 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 01:47:26.131197 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.stg_npi"
2020-10-13 01:47:26.131810 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:47:26.131917 (Thread-1): On model.airflow_dbt.stg_npi: BEGIN
2020-10-13 01:47:26.132189 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 01:47:26.132290 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:47:26.132375 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-13 01:47:26.133613 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 01:47:26.138570 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:47:26.138695 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
alter table "airflow"."public"."stg_npi" rename to "stg_npi__dbt_backup"
2020-10-13 01:47:26.139138 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 01:47:26.143029 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:47:26.143164 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-13 01:47:26.143638 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 01:47:26.144705 (Thread-1): On model.airflow_dbt.stg_npi: COMMIT
2020-10-13 01:47:26.144815 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:47:26.144906 (Thread-1): On model.airflow_dbt.stg_npi: COMMIT
2020-10-13 01:47:26.146067 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 01:47:26.148480 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:47:26.148597 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-13 01:47:26.150430 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 01:47:26.153616 (Thread-1): finished collecting timing info
2020-10-13 01:47:26.154459 (Thread-1): 01:47:26 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.10s]
2020-10-13 01:47:26.154621 (Thread-1): Finished running node model.airflow_dbt.stg_npi
2020-10-13 01:47:26.154804 (Thread-1): Began running node model.airflow_dbt.stg_state_abbreviations
2020-10-13 01:47:26.155140 (Thread-1): 01:47:26 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-13 01:47:26.155485 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:47:26.155592 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.stg_npi).
2020-10-13 01:47:26.155698 (Thread-1): Compiling model.airflow_dbt.stg_state_abbreviations
2020-10-13 01:47:26.166465 (Thread-1): Writing injected SQL for node "model.airflow_dbt.stg_state_abbreviations"
2020-10-13 01:47:26.166838 (Thread-1): finished collecting timing info
2020-10-13 01:47:26.182153 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:47:26.182406 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-13 01:47:26.182929 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 01:47:26.187025 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:47:26.187230 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-13 01:47:26.187864 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 01:47:26.190657 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.stg_state_abbreviations"
2020-10-13 01:47:26.191135 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:47:26.191321 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: BEGIN
2020-10-13 01:47:26.191703 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 01:47:26.191885 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:47:26.192036 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-13 01:47:26.192978 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 01:47:26.199808 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:47:26.199993 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations" rename to "stg_state_abbreviations__dbt_backup"
2020-10-13 01:47:26.200555 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 01:47:26.204597 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:47:26.204755 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-13 01:47:26.205244 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 01:47:26.206603 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: COMMIT
2020-10-13 01:47:26.206769 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:47:26.206901 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: COMMIT
2020-10-13 01:47:26.208026 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 01:47:26.211178 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:47:26.211320 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-13 01:47:26.212672 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 01:47:26.216696 (Thread-1): finished collecting timing info
2020-10-13 01:47:26.217680 (Thread-1): 01:47:26 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.06s]
2020-10-13 01:47:26.217872 (Thread-1): Finished running node model.airflow_dbt.stg_state_abbreviations
2020-10-13 01:47:26.218399 (Thread-1): Began running node model.airflow_dbt.npi_with_state
2020-10-13 01:47:26.218597 (Thread-1): 01:47:26 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-13 01:47:26.219023 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:47:26.219154 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.stg_state_abbreviations).
2020-10-13 01:47:26.219279 (Thread-1): Compiling model.airflow_dbt.npi_with_state
2020-10-13 01:47:26.235586 (Thread-1): Writing injected SQL for node "model.airflow_dbt.npi_with_state"
2020-10-13 01:47:26.235950 (Thread-1): finished collecting timing info
2020-10-13 01:47:26.248370 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:47:26.248550 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-13 01:47:26.248971 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 01:47:26.252932 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:47:26.253118 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-13 01:47:26.253538 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 01:47:26.255860 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.npi_with_state"
2020-10-13 01:47:26.256172 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:47:26.256292 (Thread-1): On model.airflow_dbt.npi_with_state: BEGIN
2020-10-13 01:47:26.256571 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 01:47:26.256707 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:47:26.256818 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-13 01:47:26.258056 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 01:47:26.261946 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:47:26.262118 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-13 01:47:26.262677 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 01:47:26.263880 (Thread-1): On model.airflow_dbt.npi_with_state: COMMIT
2020-10-13 01:47:26.264005 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:47:26.264112 (Thread-1): On model.airflow_dbt.npi_with_state: COMMIT
2020-10-13 01:47:26.265223 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 01:47:26.267816 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:47:26.267941 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-13 01:47:26.268295 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 01:47:26.271696 (Thread-1): finished collecting timing info
2020-10-13 01:47:26.272588 (Thread-1): 01:47:26 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.05s]
2020-10-13 01:47:26.272763 (Thread-1): Finished running node model.airflow_dbt.npi_with_state
2020-10-13 01:47:26.273245 (Thread-1): Began running node model.airflow_dbt.count_providers_by_state
2020-10-13 01:47:26.273439 (Thread-1): 01:47:26 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-13 01:47:26.273776 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:47:26.273881 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.npi_with_state).
2020-10-13 01:47:26.273983 (Thread-1): Compiling model.airflow_dbt.count_providers_by_state
2020-10-13 01:47:26.285035 (Thread-1): Writing injected SQL for node "model.airflow_dbt.count_providers_by_state"
2020-10-13 01:47:26.285535 (Thread-1): finished collecting timing info
2020-10-13 01:47:26.300264 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:47:26.300541 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-13 01:47:26.301118 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 01:47:26.306750 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:47:26.306950 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-13 01:47:26.307374 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 01:47:26.310893 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.count_providers_by_state"
2020-10-13 01:47:26.311358 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:47:26.311537 (Thread-1): On model.airflow_dbt.count_providers_by_state: BEGIN
2020-10-13 01:47:26.311831 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 01:47:26.312012 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:47:26.312170 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-13 01:47:26.314141 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 01:47:26.322093 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:47:26.322312 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-13 01:47:26.323021 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 01:47:26.324901 (Thread-1): On model.airflow_dbt.count_providers_by_state: COMMIT
2020-10-13 01:47:26.325086 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:47:26.325254 (Thread-1): On model.airflow_dbt.count_providers_by_state: COMMIT
2020-10-13 01:47:26.326431 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 01:47:26.330632 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:47:26.330820 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-13 01:47:26.331233 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 01:47:26.336660 (Thread-1): finished collecting timing info
2020-10-13 01:47:26.337997 (Thread-1): 01:47:26 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.06s]
2020-10-13 01:47:26.338427 (Thread-1): Finished running node model.airflow_dbt.count_providers_by_state
2020-10-13 01:47:26.356980 (MainThread): Using postgres connection "master".
2020-10-13 01:47:26.357282 (MainThread): On master: BEGIN
2020-10-13 01:47:26.357787 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 01:47:26.357990 (MainThread): On master: COMMIT
2020-10-13 01:47:26.358152 (MainThread): Using postgres connection "master".
2020-10-13 01:47:26.358330 (MainThread): On master: COMMIT
2020-10-13 01:47:26.358643 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-13 01:47:26.359300 (MainThread): 01:47:26 | 
2020-10-13 01:47:26.359553 (MainThread): 01:47:26 | Finished running 4 view models in 0.59s.
2020-10-13 01:47:26.359777 (MainThread): Connection 'master' was left open.
2020-10-13 01:47:26.359966 (MainThread): On master: Close
2020-10-13 01:47:26.360222 (MainThread): Connection 'model.airflow_dbt.count_providers_by_state' was left open.
2020-10-13 01:47:26.360386 (MainThread): On model.airflow_dbt.count_providers_by_state: Close
2020-10-13 01:47:26.408441 (MainThread): 
2020-10-13 01:47:26.409421 (MainThread): Completed successfully
2020-10-13 01:47:26.409662 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-13 01:47:26.410046 (MainThread): Flushing usage events
2020-10-13 01:49:17.186995 (MainThread): Got an exception trying to initialize tracking
2020-10-13 01:49:17.187200 (MainThread): Running with dbt=0.16.0
2020-10-13 01:49:17.273384 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['ge_tutorials'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-13 01:49:17.273714 (MainThread): Tracking: do not track
2020-10-13 01:49:17.309305 (MainThread): Partial parsing not enabled
2020-10-13 01:49:17.311782 (MainThread): Parsing macros/core.sql
2020-10-13 01:49:17.322054 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 01:49:17.341729 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 01:49:17.358232 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 01:49:17.389059 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 01:49:17.398763 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 01:49:17.411486 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 01:49:17.504132 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 01:49:17.560706 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 01:49:17.563574 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 01:49:17.573915 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 01:49:17.576904 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 01:49:17.616377 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 01:49:17.618255 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 01:49:17.621618 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 01:49:17.622954 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 01:49:17.624614 (MainThread): Parsing macros/etc/query.sql
2020-10-13 01:49:17.626193 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 01:49:17.629424 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 01:49:17.631016 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 01:49:17.647941 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 01:49:17.651218 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 01:49:17.653852 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 01:49:17.655463 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 01:49:17.746631 (MainThread): Parsing macros/relations.sql
2020-10-13 01:49:17.749356 (MainThread): Parsing macros/adapters.sql
2020-10-13 01:49:17.780975 (MainThread): Parsing macros/catalog.sql
2020-10-13 01:49:17.784908 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 01:49:17.810375 (MainThread): Partial parsing not enabled
2020-10-13 01:49:17.851932 (MainThread): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:49:17.852060 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:49:17.876732 (MainThread): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:49:17.876866 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:49:17.883926 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:49:17.884017 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:49:17.891019 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:49:17.891110 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:49:18.045894 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airflow_dbt.ge_tutorials

2020-10-13 01:49:18.307834 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 01:49:18.312298 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-10-13 01:49:18.312538 (MainThread): Flushing usage events
2020-10-13 01:49:18.312713 (MainThread): Connection 'model.airflow_dbt.stg_npi' was properly closed.
2020-10-13 01:49:41.264256 (MainThread): Got an exception trying to initialize tracking
2020-10-13 01:49:41.264407 (MainThread): Running with dbt=0.16.0
2020-10-13 01:49:41.350721 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['airflow_dbt/ge_tutorials'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-13 01:49:41.351082 (MainThread): Tracking: do not track
2020-10-13 01:49:41.386698 (MainThread): Partial parsing not enabled
2020-10-13 01:49:41.388767 (MainThread): Parsing macros/core.sql
2020-10-13 01:49:41.396998 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 01:49:41.412536 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 01:49:41.425486 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 01:49:41.451206 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 01:49:41.459701 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 01:49:41.470864 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 01:49:41.532104 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 01:49:41.560859 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 01:49:41.563781 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 01:49:41.574524 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 01:49:41.578031 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 01:49:41.630168 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 01:49:41.632772 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 01:49:41.637227 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 01:49:41.638968 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 01:49:41.641129 (MainThread): Parsing macros/etc/query.sql
2020-10-13 01:49:41.643223 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 01:49:41.647608 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 01:49:41.649749 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 01:49:41.670726 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 01:49:41.674774 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 01:49:41.678007 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 01:49:41.679964 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 01:49:41.825637 (MainThread): Parsing macros/relations.sql
2020-10-13 01:49:41.830280 (MainThread): Parsing macros/adapters.sql
2020-10-13 01:49:41.863889 (MainThread): Parsing macros/catalog.sql
2020-10-13 01:49:41.868066 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 01:49:41.896317 (MainThread): Partial parsing not enabled
2020-10-13 01:49:41.939153 (MainThread): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:49:41.939316 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:49:41.964668 (MainThread): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:49:41.964919 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:49:41.973521 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:49:41.973668 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:49:41.982062 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:49:41.982197 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:49:42.150552 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airflow_dbt.ge_tutorials

2020-10-13 01:49:42.412818 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 01:49:42.417398 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-10-13 01:49:42.417648 (MainThread): Flushing usage events
2020-10-13 01:49:42.417821 (MainThread): Connection 'model.airflow_dbt.stg_npi' was properly closed.
2020-10-13 01:52:32.848824 (MainThread): Got an exception trying to initialize tracking
2020-10-13 01:52:32.848981 (MainThread): Running with dbt=0.16.0
2020-10-13 01:52:32.928896 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.list.ListTask'>, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, output='selector', partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, resource_types=[], rpc_method=None, select=None, single_threaded=True, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='list', write_json=True)
2020-10-13 01:52:32.929259 (MainThread): Tracking: do not track
2020-10-13 01:52:32.963113 (MainThread): Partial parsing not enabled
2020-10-13 01:52:32.965158 (MainThread): Parsing macros/core.sql
2020-10-13 01:52:32.973253 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 01:52:32.988589 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 01:52:33.001191 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 01:52:33.027363 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 01:52:33.035958 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 01:52:33.047090 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 01:52:33.107305 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 01:52:33.135094 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 01:52:33.137908 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 01:52:33.148088 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 01:52:33.151092 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 01:52:33.191688 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 01:52:33.194077 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 01:52:33.198263 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 01:52:33.200093 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 01:52:33.202220 (MainThread): Parsing macros/etc/query.sql
2020-10-13 01:52:33.204255 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 01:52:33.208489 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 01:52:33.210622 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 01:52:33.233592 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 01:52:33.238186 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 01:52:33.241802 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 01:52:33.243758 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 01:52:33.381221 (MainThread): Parsing macros/relations.sql
2020-10-13 01:52:33.385821 (MainThread): Parsing macros/adapters.sql
2020-10-13 01:52:33.433321 (MainThread): Parsing macros/catalog.sql
2020-10-13 01:52:33.437511 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 01:52:33.461817 (MainThread): Partial parsing not enabled
2020-10-13 01:52:33.505103 (MainThread): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:52:33.505231 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:52:33.529300 (MainThread): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:52:33.529442 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:52:33.537420 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:52:33.537550 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:52:33.545418 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:52:33.545536 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:52:33.705857 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airflow_dbt_pg.ge_tutorials

2020-10-13 01:52:33.952743 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 01:52:33.956847 (MainThread): Flushing usage events
2020-10-13 01:52:33.957032 (MainThread): Connection 'model.airflow_dbt.stg_npi' was properly closed.
2020-10-13 02:17:50.193231 (MainThread): Got an exception trying to initialize tracking
2020-10-13 02:17:50.193380 (MainThread): Running with dbt=0.16.0
2020-10-13 02:17:50.278294 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['airflow_dbt.airflow_dbt_pg.ge_tutorials.*'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-13 02:17:50.278639 (MainThread): Tracking: do not track
2020-10-13 02:17:50.311725 (MainThread): Partial parsing not enabled
2020-10-13 02:17:50.313687 (MainThread): Parsing macros/core.sql
2020-10-13 02:17:50.321366 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 02:17:50.335479 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 02:17:50.346743 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 02:17:50.369405 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 02:17:50.377153 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 02:17:50.387315 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 02:17:50.445118 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 02:17:50.471344 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 02:17:50.473899 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 02:17:50.483344 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 02:17:50.486073 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 02:17:50.521175 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 02:17:50.522787 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 02:17:50.525720 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 02:17:50.526913 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 02:17:50.528397 (MainThread): Parsing macros/etc/query.sql
2020-10-13 02:17:50.529803 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 02:17:50.532840 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 02:17:50.534472 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 02:17:50.552956 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 02:17:50.556685 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 02:17:50.559727 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 02:17:50.561429 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 02:17:50.654937 (MainThread): Parsing macros/relations.sql
2020-10-13 02:17:50.657783 (MainThread): Parsing macros/adapters.sql
2020-10-13 02:17:50.693524 (MainThread): Parsing macros/catalog.sql
2020-10-13 02:17:50.698147 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 02:17:50.727504 (MainThread): Partial parsing not enabled
2020-10-13 02:17:50.776338 (MainThread): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 02:17:50.776502 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:17:50.804893 (MainThread): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 02:17:50.805047 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:17:50.814133 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 02:17:50.814298 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:17:50.824268 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 02:17:50.824445 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:17:51.007867 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airflow_dbt_pg.ge_tutorials

2020-10-13 02:17:51.290792 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 02:17:51.295239 (MainThread): 
2020-10-13 02:17:51.295692 (MainThread): Acquiring new postgres connection "master".
2020-10-13 02:17:51.295807 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:17:51.321294 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-13 02:17:51.321462 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-13 02:17:51.504236 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-13 02:17:51.504474 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-13 02:17:51.509961 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2020-10-13 02:17:51.549055 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-13 02:17:51.549376 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-13 02:17:51.552930 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-13 02:17:51.553097 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-13 02:17:51.553557 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:17:51.553741 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-13 02:17:51.553904 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-13 02:17:51.557462 (ThreadPoolExecutor-1_0): SQL status: SELECT 31 in 0.00 seconds
2020-10-13 02:17:51.605110 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-13 02:17:51.631271 (MainThread): Using postgres connection "master".
2020-10-13 02:17:51.631404 (MainThread): On master: BEGIN
2020-10-13 02:17:51.634323 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:17:51.634453 (MainThread): Using postgres connection "master".
2020-10-13 02:17:51.634542 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-13 02:17:51.639841 (MainThread): SQL status: SELECT 5 in 0.01 seconds
2020-10-13 02:17:51.648061 (MainThread): On master: ROLLBACK
2020-10-13 02:17:51.648362 (MainThread): Using postgres connection "master".
2020-10-13 02:17:51.648468 (MainThread): On master: BEGIN
2020-10-13 02:17:51.648926 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:17:51.649042 (MainThread): On master: COMMIT
2020-10-13 02:17:51.649132 (MainThread): Using postgres connection "master".
2020-10-13 02:17:51.649214 (MainThread): On master: COMMIT
2020-10-13 02:17:51.649415 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-13 02:17:51.649703 (MainThread): 02:17:51 | Concurrency: 1 threads (target='dev')
2020-10-13 02:17:51.649833 (MainThread): 02:17:51 | 
2020-10-13 02:17:51.655627 (Thread-1): Began running node model.airflow_dbt.stg_npi
2020-10-13 02:17:51.655805 (Thread-1): 02:17:51 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-13 02:17:51.656115 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 02:17:51.656201 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-13 02:17:51.656296 (Thread-1): Compiling model.airflow_dbt.stg_npi
2020-10-13 02:17:51.679594 (Thread-1): Writing injected SQL for node "model.airflow_dbt.stg_npi"
2020-10-13 02:17:51.679996 (Thread-1): finished collecting timing info
2020-10-13 02:17:51.730898 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 02:17:51.731067 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-13 02:17:51.731637 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:17:51.734754 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 02:17:51.734871 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-13 02:17:51.735175 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:17:51.737006 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.stg_npi"
2020-10-13 02:17:51.737373 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 02:17:51.737473 (Thread-1): On model.airflow_dbt.stg_npi: BEGIN
2020-10-13 02:17:51.737733 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:17:51.737853 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 02:17:51.737946 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-13 02:17:51.739370 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 02:17:51.744572 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 02:17:51.744696 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
alter table "airflow"."public"."stg_npi" rename to "stg_npi__dbt_backup"
2020-10-13 02:17:51.745149 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 02:17:51.749283 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 02:17:51.749409 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-13 02:17:51.749927 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 02:17:51.751268 (Thread-1): On model.airflow_dbt.stg_npi: COMMIT
2020-10-13 02:17:51.751392 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 02:17:51.751489 (Thread-1): On model.airflow_dbt.stg_npi: COMMIT
2020-10-13 02:17:51.752625 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 02:17:51.755197 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 02:17:51.755326 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-13 02:17:51.757401 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:17:51.760780 (Thread-1): finished collecting timing info
2020-10-13 02:17:51.761623 (Thread-1): 02:17:51 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.11s]
2020-10-13 02:17:51.761783 (Thread-1): Finished running node model.airflow_dbt.stg_npi
2020-10-13 02:17:51.761941 (Thread-1): Began running node model.airflow_dbt.stg_state_abbreviations
2020-10-13 02:17:51.762089 (Thread-1): 02:17:51 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-13 02:17:51.762512 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 02:17:51.762621 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.stg_npi).
2020-10-13 02:17:51.762723 (Thread-1): Compiling model.airflow_dbt.stg_state_abbreviations
2020-10-13 02:17:51.772776 (Thread-1): Writing injected SQL for node "model.airflow_dbt.stg_state_abbreviations"
2020-10-13 02:17:51.773030 (Thread-1): finished collecting timing info
2020-10-13 02:17:51.784200 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 02:17:51.784365 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-13 02:17:51.784757 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:17:51.787875 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 02:17:51.787987 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-13 02:17:51.788288 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:17:51.790466 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.stg_state_abbreviations"
2020-10-13 02:17:51.790781 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 02:17:51.790890 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: BEGIN
2020-10-13 02:17:51.791195 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:17:51.791317 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 02:17:51.791411 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-13 02:17:51.792172 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 02:17:51.798273 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 02:17:51.798445 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations" rename to "stg_state_abbreviations__dbt_backup"
2020-10-13 02:17:51.799304 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 02:17:51.803040 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 02:17:51.803185 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-13 02:17:51.803653 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 02:17:51.804751 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: COMMIT
2020-10-13 02:17:51.804866 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 02:17:51.804963 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: COMMIT
2020-10-13 02:17:51.806141 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 02:17:51.808676 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 02:17:51.808785 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-13 02:17:51.810174 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:17:51.813535 (Thread-1): finished collecting timing info
2020-10-13 02:17:51.814324 (Thread-1): 02:17:51 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.05s]
2020-10-13 02:17:51.814474 (Thread-1): Finished running node model.airflow_dbt.stg_state_abbreviations
2020-10-13 02:17:51.814897 (Thread-1): Began running node model.airflow_dbt.npi_with_state
2020-10-13 02:17:51.815060 (Thread-1): 02:17:51 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-13 02:17:51.815358 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 02:17:51.815455 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.stg_state_abbreviations).
2020-10-13 02:17:51.815552 (Thread-1): Compiling model.airflow_dbt.npi_with_state
2020-10-13 02:17:51.828902 (Thread-1): Writing injected SQL for node "model.airflow_dbt.npi_with_state"
2020-10-13 02:17:51.829265 (Thread-1): finished collecting timing info
2020-10-13 02:17:51.842109 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 02:17:51.842262 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-13 02:17:51.842637 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:17:51.845739 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 02:17:51.845852 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-13 02:17:51.846159 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:17:51.848101 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.npi_with_state"
2020-10-13 02:17:51.848381 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 02:17:51.848484 (Thread-1): On model.airflow_dbt.npi_with_state: BEGIN
2020-10-13 02:17:51.848753 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:17:51.848871 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 02:17:51.848967 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-13 02:17:51.850225 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 02:17:51.853325 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 02:17:51.853437 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-13 02:17:51.853882 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 02:17:51.854913 (Thread-1): On model.airflow_dbt.npi_with_state: COMMIT
2020-10-13 02:17:51.855020 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 02:17:51.855111 (Thread-1): On model.airflow_dbt.npi_with_state: COMMIT
2020-10-13 02:17:51.856281 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 02:17:51.858508 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 02:17:51.858611 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-13 02:17:51.858911 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:17:51.861900 (Thread-1): finished collecting timing info
2020-10-13 02:17:51.862660 (Thread-1): 02:17:51 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.05s]
2020-10-13 02:17:51.862818 (Thread-1): Finished running node model.airflow_dbt.npi_with_state
2020-10-13 02:17:51.863234 (Thread-1): Began running node model.airflow_dbt.count_providers_by_state
2020-10-13 02:17:51.863392 (Thread-1): 02:17:51 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-13 02:17:51.863668 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 02:17:51.863759 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.npi_with_state).
2020-10-13 02:17:51.863859 (Thread-1): Compiling model.airflow_dbt.count_providers_by_state
2020-10-13 02:17:51.872794 (Thread-1): Writing injected SQL for node "model.airflow_dbt.count_providers_by_state"
2020-10-13 02:17:51.873023 (Thread-1): finished collecting timing info
2020-10-13 02:17:51.883918 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 02:17:51.884078 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-13 02:17:51.884492 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:17:51.888161 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 02:17:51.888320 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-13 02:17:51.888686 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:17:51.890796 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.count_providers_by_state"
2020-10-13 02:17:51.891165 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 02:17:51.891285 (Thread-1): On model.airflow_dbt.count_providers_by_state: BEGIN
2020-10-13 02:17:51.891592 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:17:51.891710 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 02:17:51.891806 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-13 02:17:51.892968 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 02:17:51.898209 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 02:17:51.898396 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-13 02:17:51.899130 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 02:17:51.900471 (Thread-1): On model.airflow_dbt.count_providers_by_state: COMMIT
2020-10-13 02:17:51.900607 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 02:17:51.900705 (Thread-1): On model.airflow_dbt.count_providers_by_state: COMMIT
2020-10-13 02:17:51.902041 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 02:17:51.908823 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 02:17:51.909070 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-13 02:17:51.909710 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:17:51.915715 (Thread-1): finished collecting timing info
2020-10-13 02:17:51.917005 (Thread-1): 02:17:51 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.05s]
2020-10-13 02:17:51.917227 (Thread-1): Finished running node model.airflow_dbt.count_providers_by_state
2020-10-13 02:17:51.956827 (MainThread): Using postgres connection "master".
2020-10-13 02:17:51.957034 (MainThread): On master: BEGIN
2020-10-13 02:17:51.957417 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:17:51.957574 (MainThread): On master: COMMIT
2020-10-13 02:17:51.957708 (MainThread): Using postgres connection "master".
2020-10-13 02:17:51.957831 (MainThread): On master: COMMIT
2020-10-13 02:17:51.958158 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-13 02:17:51.958628 (MainThread): 02:17:51 | 
2020-10-13 02:17:51.958850 (MainThread): 02:17:51 | Finished running 4 view models in 0.66s.
2020-10-13 02:17:51.959050 (MainThread): Connection 'master' was left open.
2020-10-13 02:17:51.959206 (MainThread): On master: Close
2020-10-13 02:17:51.959400 (MainThread): Connection 'model.airflow_dbt.count_providers_by_state' was left open.
2020-10-13 02:17:51.959528 (MainThread): On model.airflow_dbt.count_providers_by_state: Close
2020-10-13 02:17:51.986572 (MainThread): 
2020-10-13 02:17:51.986882 (MainThread): Completed successfully
2020-10-13 02:17:51.987125 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-13 02:17:51.987492 (MainThread): Flushing usage events
2020-10-13 02:18:41.515606 (MainThread): Got an exception trying to initialize tracking
2020-10-13 02:18:41.515764 (MainThread): Running with dbt=0.16.0
2020-10-13 02:18:41.594978 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.list.ListTask'>, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, output='selector', partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, resource_types=[], rpc_method=None, select=None, single_threaded=True, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='list', write_json=True)
2020-10-13 02:18:41.595317 (MainThread): Tracking: do not track
2020-10-13 02:18:41.628760 (MainThread): Partial parsing not enabled
2020-10-13 02:18:41.630832 (MainThread): Parsing macros/core.sql
2020-10-13 02:18:41.638952 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 02:18:41.654255 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 02:18:41.667012 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 02:18:41.692815 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 02:18:41.701460 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 02:18:41.712605 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 02:18:41.774479 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 02:18:41.801508 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 02:18:41.804171 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 02:18:41.813891 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 02:18:41.816722 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 02:18:41.853562 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 02:18:41.855321 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 02:18:41.858390 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 02:18:41.859661 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 02:18:41.861211 (MainThread): Parsing macros/etc/query.sql
2020-10-13 02:18:41.862681 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 02:18:41.865870 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 02:18:41.867446 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 02:18:41.883971 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 02:18:41.887920 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 02:18:41.891083 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 02:18:41.892922 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 02:18:42.000886 (MainThread): Parsing macros/relations.sql
2020-10-13 02:18:42.005712 (MainThread): Parsing macros/adapters.sql
2020-10-13 02:18:42.073108 (MainThread): Parsing macros/catalog.sql
2020-10-13 02:18:42.080155 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 02:18:42.127687 (MainThread): Partial parsing not enabled
2020-10-13 02:18:42.172420 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 02:18:42.172559 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:18:42.196483 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 02:18:42.196603 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:18:42.203448 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 02:18:42.203542 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:18:42.210604 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 02:18:42.210719 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:18:42.373298 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airflow_dbt_pg.ge_tutorials

2020-10-13 02:18:42.625621 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 02:18:42.629743 (MainThread): Flushing usage events
2020-10-13 02:18:42.629958 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-13 02:20:36.056761 (MainThread): Got an exception trying to initialize tracking
2020-10-13 02:20:36.056912 (MainThread): Running with dbt=0.16.0
2020-10-13 02:20:36.139392 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.list.ListTask'>, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, output='selector', partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, resource_types=[], rpc_method=None, select=None, single_threaded=True, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='list', write_json=True)
2020-10-13 02:20:36.139794 (MainThread): Tracking: do not track
2020-10-13 02:20:36.175362 (MainThread): Partial parsing not enabled
2020-10-13 02:20:36.177500 (MainThread): Parsing macros/core.sql
2020-10-13 02:20:36.186037 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 02:20:36.201803 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 02:20:36.215441 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 02:20:36.242897 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 02:20:36.252105 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 02:20:36.264558 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 02:20:36.336865 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 02:20:36.370289 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 02:20:36.373809 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 02:20:36.386653 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 02:20:36.390691 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 02:20:36.440927 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 02:20:36.443063 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 02:20:36.446719 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 02:20:36.448234 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 02:20:36.450104 (MainThread): Parsing macros/etc/query.sql
2020-10-13 02:20:36.451895 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 02:20:36.455516 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 02:20:36.457306 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 02:20:36.475583 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 02:20:36.479103 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 02:20:36.481936 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 02:20:36.483531 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 02:20:36.566918 (MainThread): Parsing macros/relations.sql
2020-10-13 02:20:36.569435 (MainThread): Parsing macros/adapters.sql
2020-10-13 02:20:36.601111 (MainThread): Parsing macros/catalog.sql
2020-10-13 02:20:36.605055 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 02:20:36.630005 (MainThread): Partial parsing not enabled
2020-10-13 02:20:36.672206 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 02:20:36.672347 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:20:36.696498 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 02:20:36.696644 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:20:36.703955 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 02:20:36.704054 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:20:36.711101 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 02:20:36.711195 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:20:37.228285 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 02:20:37.232211 (MainThread): Flushing usage events
2020-10-13 02:20:37.232397 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-13 02:20:57.633183 (MainThread): Got an exception trying to initialize tracking
2020-10-13 02:20:57.633332 (MainThread): Running with dbt=0.16.0
2020-10-13 02:20:57.719274 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['airflow_dbt_pg.ge_tutorials.*'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-13 02:20:57.719598 (MainThread): Tracking: do not track
2020-10-13 02:20:57.752439 (MainThread): Partial parsing not enabled
2020-10-13 02:20:57.754353 (MainThread): Parsing macros/core.sql
2020-10-13 02:20:57.761782 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 02:20:57.775602 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 02:20:57.786679 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 02:20:57.809058 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 02:20:57.816773 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 02:20:57.827098 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 02:20:57.885418 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 02:20:57.912013 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 02:20:57.914571 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 02:20:57.924158 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 02:20:57.926948 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 02:20:57.962532 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 02:20:57.964174 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 02:20:57.967146 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 02:20:57.968350 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 02:20:57.969859 (MainThread): Parsing macros/etc/query.sql
2020-10-13 02:20:57.971310 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 02:20:57.974219 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 02:20:57.975663 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 02:20:57.990581 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 02:20:57.993526 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 02:20:57.995897 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 02:20:57.997211 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 02:20:58.074250 (MainThread): Parsing macros/relations.sql
2020-10-13 02:20:58.076587 (MainThread): Parsing macros/adapters.sql
2020-10-13 02:20:58.106413 (MainThread): Parsing macros/catalog.sql
2020-10-13 02:20:58.110096 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 02:20:58.133586 (MainThread): Partial parsing not enabled
2020-10-13 02:20:58.172176 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 02:20:58.172318 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:20:58.197635 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 02:20:58.197772 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:20:58.205431 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 02:20:58.205531 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:20:58.212901 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 02:20:58.212995 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:20:58.699696 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 02:20:58.704342 (MainThread): 
2020-10-13 02:20:58.704761 (MainThread): Acquiring new postgres connection "master".
2020-10-13 02:20:58.704877 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:20:58.730746 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-13 02:20:58.730922 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-13 02:20:58.869877 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-13 02:20:58.870032 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-13 02:20:58.874049 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-13 02:20:58.898599 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-13 02:20:58.898756 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-13 02:20:58.900897 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-13 02:20:58.901006 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-13 02:20:58.901394 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:20:58.901513 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-13 02:20:58.901603 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-13 02:20:58.903732 (ThreadPoolExecutor-1_0): SQL status: SELECT 31 in 0.00 seconds
2020-10-13 02:20:58.938367 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-13 02:20:58.964268 (MainThread): Using postgres connection "master".
2020-10-13 02:20:58.964396 (MainThread): On master: BEGIN
2020-10-13 02:20:58.967267 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:20:58.967393 (MainThread): Using postgres connection "master".
2020-10-13 02:20:58.967480 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-13 02:20:58.972714 (MainThread): SQL status: SELECT 5 in 0.01 seconds
2020-10-13 02:20:58.980895 (MainThread): On master: ROLLBACK
2020-10-13 02:20:58.981180 (MainThread): Using postgres connection "master".
2020-10-13 02:20:58.981282 (MainThread): On master: BEGIN
2020-10-13 02:20:58.981737 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:20:58.981868 (MainThread): On master: COMMIT
2020-10-13 02:20:58.981960 (MainThread): Using postgres connection "master".
2020-10-13 02:20:58.982043 (MainThread): On master: COMMIT
2020-10-13 02:20:58.982282 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-13 02:20:58.982575 (MainThread): 02:20:58 | Concurrency: 1 threads (target='dev')
2020-10-13 02:20:58.982707 (MainThread): 02:20:58 | 
2020-10-13 02:20:58.988577 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-13 02:20:58.988751 (Thread-1): 02:20:58 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-13 02:20:58.989076 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 02:20:58.989176 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-13 02:20:58.989272 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-13 02:20:59.012394 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-13 02:20:59.012788 (Thread-1): finished collecting timing info
2020-10-13 02:20:59.063914 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 02:20:59.064082 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-13 02:20:59.064510 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:20:59.067535 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 02:20:59.067665 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-13 02:20:59.067947 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:20:59.069782 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-13 02:20:59.070155 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 02:20:59.070255 (Thread-1): On model.airflow_dbt_pg.stg_npi: BEGIN
2020-10-13 02:20:59.070478 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:20:59.070595 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 02:20:59.070683 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-13 02:20:59.071833 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 02:20:59.076975 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 02:20:59.077101 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
alter table "airflow"."public"."stg_npi" rename to "stg_npi__dbt_backup"
2020-10-13 02:20:59.077496 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 02:20:59.081488 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 02:20:59.081612 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-13 02:20:59.082013 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 02:20:59.083046 (Thread-1): On model.airflow_dbt_pg.stg_npi: COMMIT
2020-10-13 02:20:59.083155 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 02:20:59.083244 (Thread-1): On model.airflow_dbt_pg.stg_npi: COMMIT
2020-10-13 02:20:59.086169 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 02:20:59.088748 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 02:20:59.088879 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-13 02:20:59.090669 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:20:59.093859 (Thread-1): finished collecting timing info
2020-10-13 02:20:59.094639 (Thread-1): 02:20:59 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.11s]
2020-10-13 02:20:59.094798 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-13 02:20:59.094958 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 02:20:59.095265 (Thread-1): 02:20:59 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-13 02:20:59.095585 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 02:20:59.095682 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt_pg.stg_npi).
2020-10-13 02:20:59.095778 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 02:20:59.105649 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-13 02:20:59.105962 (Thread-1): finished collecting timing info
2020-10-13 02:20:59.117707 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 02:20:59.117948 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-13 02:20:59.118423 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:20:59.122433 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 02:20:59.122621 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-13 02:20:59.123033 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:20:59.125597 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-13 02:20:59.126023 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 02:20:59.126163 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: BEGIN
2020-10-13 02:20:59.126477 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:20:59.126612 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 02:20:59.126721 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-13 02:20:59.127612 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 02:20:59.134605 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 02:20:59.134811 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations" rename to "stg_state_abbreviations__dbt_backup"
2020-10-13 02:20:59.135483 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 02:20:59.139872 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 02:20:59.140059 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-13 02:20:59.140595 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 02:20:59.141959 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: COMMIT
2020-10-13 02:20:59.142096 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 02:20:59.142211 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: COMMIT
2020-10-13 02:20:59.143269 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 02:20:59.146367 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 02:20:59.146513 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-13 02:20:59.147965 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:20:59.152076 (Thread-1): finished collecting timing info
2020-10-13 02:20:59.153072 (Thread-1): 02:20:59 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.06s]
2020-10-13 02:20:59.153265 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 02:20:59.153791 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-13 02:20:59.153984 (Thread-1): 02:20:59 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-13 02:20:59.154381 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 02:20:59.154512 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt_pg.stg_state_abbreviations).
2020-10-13 02:20:59.154640 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-13 02:20:59.170487 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-13 02:20:59.170984 (Thread-1): finished collecting timing info
2020-10-13 02:20:59.183978 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 02:20:59.184173 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-13 02:20:59.184604 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:20:59.188830 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 02:20:59.189038 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-13 02:20:59.189432 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:20:59.191863 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-13 02:20:59.192194 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 02:20:59.192320 (Thread-1): On model.airflow_dbt_pg.npi_with_state: BEGIN
2020-10-13 02:20:59.192540 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:20:59.192667 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 02:20:59.192774 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-13 02:20:59.194002 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 02:20:59.197849 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 02:20:59.197990 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-13 02:20:59.198439 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 02:20:59.199707 (Thread-1): On model.airflow_dbt_pg.npi_with_state: COMMIT
2020-10-13 02:20:59.199837 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 02:20:59.199947 (Thread-1): On model.airflow_dbt_pg.npi_with_state: COMMIT
2020-10-13 02:20:59.201013 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 02:20:59.203810 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 02:20:59.203935 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-13 02:20:59.204219 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:20:59.207766 (Thread-1): finished collecting timing info
2020-10-13 02:20:59.208622 (Thread-1): 02:20:59 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.05s]
2020-10-13 02:20:59.208793 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-13 02:20:59.209239 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-13 02:20:59.209416 (Thread-1): 02:20:59 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-13 02:20:59.209753 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 02:20:59.209866 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt_pg.npi_with_state).
2020-10-13 02:20:59.209972 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-13 02:20:59.221463 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-13 02:20:59.221776 (Thread-1): finished collecting timing info
2020-10-13 02:20:59.233601 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 02:20:59.233777 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-13 02:20:59.234084 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:20:59.239433 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 02:20:59.239675 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-13 02:20:59.240082 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:20:59.243913 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-13 02:20:59.244390 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 02:20:59.244568 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: BEGIN
2020-10-13 02:20:59.244860 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:20:59.245049 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 02:20:59.245216 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-13 02:20:59.246370 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 02:20:59.254682 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 02:20:59.254904 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-13 02:20:59.255403 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 02:20:59.257322 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: COMMIT
2020-10-13 02:20:59.257513 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 02:20:59.257684 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: COMMIT
2020-10-13 02:20:59.258809 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 02:20:59.263136 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 02:20:59.263325 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-13 02:20:59.263751 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:20:59.269448 (Thread-1): finished collecting timing info
2020-10-13 02:20:59.270848 (Thread-1): 02:20:59 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.06s]
2020-10-13 02:20:59.271635 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-13 02:20:59.290327 (MainThread): Using postgres connection "master".
2020-10-13 02:20:59.290595 (MainThread): On master: BEGIN
2020-10-13 02:20:59.291039 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:20:59.291260 (MainThread): On master: COMMIT
2020-10-13 02:20:59.291417 (MainThread): Using postgres connection "master".
2020-10-13 02:20:59.291561 (MainThread): On master: COMMIT
2020-10-13 02:20:59.291876 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-13 02:20:59.292477 (MainThread): 02:20:59 | 
2020-10-13 02:20:59.293342 (MainThread): 02:20:59 | Finished running 4 view models in 0.59s.
2020-10-13 02:20:59.294009 (MainThread): Connection 'master' was left open.
2020-10-13 02:20:59.294202 (MainThread): On master: Close
2020-10-13 02:20:59.298659 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was left open.
2020-10-13 02:20:59.298942 (MainThread): On model.airflow_dbt_pg.count_providers_by_state: Close
2020-10-13 02:20:59.340679 (MainThread): 
2020-10-13 02:20:59.341410 (MainThread): Completed successfully
2020-10-13 02:20:59.342103 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-13 02:20:59.343122 (MainThread): Flushing usage events
2020-10-13 03:47:39.490293 (MainThread): Got an exception trying to initialize tracking
2020-10-13 03:47:39.490452 (MainThread): Running with dbt=0.16.0
2020-10-13 03:47:39.572538 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.list.ListTask'>, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, output='selector', partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, resource_types=[], rpc_method=None, select=None, single_threaded=True, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='list', write_json=True)
2020-10-13 03:47:39.572902 (MainThread): Tracking: do not track
2020-10-13 03:47:39.610537 (MainThread): Partial parsing not enabled
2020-10-13 03:47:39.612921 (MainThread): Parsing macros/core.sql
2020-10-13 03:47:39.623383 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 03:47:39.641356 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 03:47:39.657975 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 03:47:39.691671 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 03:47:39.704159 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 03:47:39.718875 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 03:47:39.794264 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 03:47:39.841485 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 03:47:39.846557 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 03:47:39.862537 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 03:47:39.867364 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 03:47:39.918756 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 03:47:39.920968 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 03:47:39.927829 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 03:47:39.930724 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 03:47:39.933978 (MainThread): Parsing macros/etc/query.sql
2020-10-13 03:47:39.937073 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 03:47:39.943178 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 03:47:39.946196 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 03:47:39.975388 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 03:47:39.981277 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 03:47:39.985946 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 03:47:39.988575 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 03:47:40.108599 (MainThread): Parsing macros/relations.sql
2020-10-13 03:47:40.111724 (MainThread): Parsing macros/adapters.sql
2020-10-13 03:47:40.150225 (MainThread): Parsing macros/catalog.sql
2020-10-13 03:47:40.154851 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 03:47:40.183849 (MainThread): Partial parsing not enabled
2020-10-13 03:47:40.232632 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 03:47:40.232786 (MainThread): Opening a new connection, currently in state init
2020-10-13 03:47:40.260818 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 03:47:40.260968 (MainThread): Opening a new connection, currently in state init
2020-10-13 03:47:40.269088 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 03:47:40.269199 (MainThread): Opening a new connection, currently in state init
2020-10-13 03:47:40.278078 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 03:47:40.278265 (MainThread): Opening a new connection, currently in state init
2020-10-13 03:47:40.783052 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 03:47:40.787243 (MainThread): Flushing usage events
2020-10-13 03:47:40.787437 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-13 03:59:13.515115 (MainThread): Got an exception trying to initialize tracking
2020-10-13 03:59:13.515269 (MainThread): Running with dbt=0.16.0
2020-10-13 03:59:13.599718 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-13 03:59:13.600728 (MainThread): Tracking: do not track
2020-10-13 03:59:13.633814 (MainThread): Partial parsing not enabled
2020-10-13 03:59:13.635801 (MainThread): Parsing macros/core.sql
2020-10-13 03:59:13.643466 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 03:59:13.657721 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 03:59:13.669620 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 03:59:13.694105 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 03:59:13.702707 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 03:59:13.723988 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 03:59:13.839626 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 03:59:13.870481 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 03:59:13.873544 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 03:59:13.884678 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 03:59:13.887944 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 03:59:13.927748 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 03:59:13.929576 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 03:59:13.932820 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 03:59:13.934136 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 03:59:13.935782 (MainThread): Parsing macros/etc/query.sql
2020-10-13 03:59:13.937338 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 03:59:13.940541 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 03:59:13.942149 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 03:59:13.958754 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 03:59:13.962083 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 03:59:13.964691 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 03:59:13.966137 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 03:59:14.070380 (MainThread): Parsing macros/relations.sql
2020-10-13 03:59:14.074397 (MainThread): Parsing macros/adapters.sql
2020-10-13 03:59:14.120307 (MainThread): Parsing macros/catalog.sql
2020-10-13 03:59:14.125182 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 03:59:14.156963 (MainThread): Partial parsing not enabled
2020-10-13 03:59:14.209167 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 03:59:14.209360 (MainThread): Opening a new connection, currently in state init
2020-10-13 03:59:14.238446 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 03:59:14.238608 (MainThread): Opening a new connection, currently in state init
2020-10-13 03:59:14.247804 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 03:59:14.247962 (MainThread): Opening a new connection, currently in state init
2020-10-13 03:59:14.257432 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 03:59:14.257596 (MainThread): Opening a new connection, currently in state init
2020-10-13 03:59:14.804692 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 03:59:14.809977 (MainThread): 
2020-10-13 03:59:14.810244 (MainThread): 03:59:14 | Concurrency: 1 threads (target='dev')
2020-10-13 03:59:14.810407 (MainThread): 03:59:14 | 
2020-10-13 03:59:14.819108 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-13 03:59:14.819640 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 03:59:14.819779 (Thread-1): Opening a new connection, currently in state init
2020-10-13 03:59:14.819908 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-13 03:59:14.847454 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-13 03:59:14.847835 (Thread-1): finished collecting timing info
2020-10-13 03:59:14.848200 (Thread-1): finished collecting timing info
2020-10-13 03:59:14.848787 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-13 03:59:14.848976 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 03:59:14.849312 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 03:59:14.849434 (Thread-1): Opening a new connection, currently in state init
2020-10-13 03:59:14.849553 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 03:59:14.860980 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-13 03:59:14.861346 (Thread-1): finished collecting timing info
2020-10-13 03:59:14.861683 (Thread-1): finished collecting timing info
2020-10-13 03:59:14.862217 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 03:59:14.862705 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-13 03:59:14.863074 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 03:59:14.863192 (Thread-1): Opening a new connection, currently in state init
2020-10-13 03:59:14.863303 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-13 03:59:14.875884 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-13 03:59:14.876253 (Thread-1): finished collecting timing info
2020-10-13 03:59:14.876599 (Thread-1): finished collecting timing info
2020-10-13 03:59:14.877138 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-13 03:59:14.877605 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-13 03:59:14.877957 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 03:59:14.878075 (Thread-1): Opening a new connection, currently in state init
2020-10-13 03:59:14.878187 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-13 03:59:14.889003 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-13 03:59:14.889376 (Thread-1): finished collecting timing info
2020-10-13 03:59:14.889713 (Thread-1): finished collecting timing info
2020-10-13 03:59:14.890248 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-13 03:59:14.919112 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-13 03:59:14.919316 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was properly closed.
2020-10-13 03:59:14.937382 (MainThread): 03:59:14 | Done.
2020-10-13 03:59:14.939550 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-13 03:59:14.939700 (MainThread): Opening a new connection, currently in state init
2020-10-13 03:59:14.939885 (MainThread): 03:59:14 | Building catalog
2020-10-13 03:59:14.976095 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-13 03:59:14.976296 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-13 03:59:15.092522 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-13 03:59:15.092690 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-13 03:59:15.096115 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-13 03:59:15.096277 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-13 03:59:15.096377 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-13 03:59:15.099637 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.00 seconds
2020-10-13 03:59:15.118520 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-13 03:59:15.372423 (MainThread): 03:59:15 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-13 03:59:15.372940 (MainThread): Flushing usage events
2020-10-13 03:59:15.373115 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-13 03:59:15.373215 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-13 03:59:15.373307 (MainThread): On airflow.information_schema: Close
2020-10-13 03:59:16.733916 (MainThread): Got an exception trying to initialize tracking
2020-10-13 03:59:16.734076 (MainThread): Running with dbt=0.16.0
2020-10-13 03:59:16.821725 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-13 03:59:16.822118 (MainThread): Tracking: do not track
2020-10-13 03:59:16.830373 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-13 03:59:16.830710 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-13 03:59:16.830969 (MainThread): Press Ctrl+C to exit.


2020-10-13 04:38:00.409072 (MainThread): Got an exception trying to initialize tracking
2020-10-13 04:38:00.409296 (MainThread): Running with dbt=0.16.0
2020-10-13 04:38:00.514479 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['airflow_dbt_pg.ge_tutorials.*'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-13 04:38:00.515044 (MainThread): Tracking: do not track
2020-10-13 04:38:00.552560 (MainThread): Partial parsing not enabled
2020-10-13 04:38:00.554887 (MainThread): Parsing macros/core.sql
2020-10-13 04:38:00.563216 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 04:38:00.578680 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 04:38:00.591728 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 04:38:00.619345 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 04:38:00.629012 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 04:38:00.641137 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 04:38:00.707129 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 04:38:00.735119 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 04:38:00.737816 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 04:38:00.747679 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 04:38:00.750419 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 04:38:00.786789 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 04:38:00.788408 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 04:38:00.791356 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 04:38:00.792551 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 04:38:00.794044 (MainThread): Parsing macros/etc/query.sql
2020-10-13 04:38:00.795470 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 04:38:00.798351 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 04:38:00.799784 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 04:38:00.815491 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 04:38:00.818580 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 04:38:00.821073 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 04:38:00.822456 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 04:38:00.901405 (MainThread): Parsing macros/relations.sql
2020-10-13 04:38:00.903921 (MainThread): Parsing macros/adapters.sql
2020-10-13 04:38:00.934280 (MainThread): Parsing macros/catalog.sql
2020-10-13 04:38:00.937941 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 04:38:00.965157 (MainThread): Partial parsing not enabled
2020-10-13 04:38:01.015076 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 04:38:01.015244 (MainThread): Opening a new connection, currently in state init
2020-10-13 04:38:01.045330 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 04:38:01.045506 (MainThread): Opening a new connection, currently in state init
2020-10-13 04:38:01.055865 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:38:01.056021 (MainThread): Opening a new connection, currently in state init
2020-10-13 04:38:01.066423 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:38:01.066579 (MainThread): Opening a new connection, currently in state init
2020-10-13 04:38:01.536529 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 04:38:01.540985 (MainThread): 
2020-10-13 04:38:01.541399 (MainThread): Acquiring new postgres connection "master".
2020-10-13 04:38:01.541517 (MainThread): Opening a new connection, currently in state init
2020-10-13 04:38:01.565931 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-13 04:38:01.566200 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-13 04:38:01.704522 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-13 04:38:01.704674 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-13 04:38:01.708558 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-13 04:38:01.733696 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-13 04:38:01.733970 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-13 04:38:01.736327 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-13 04:38:01.736472 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-13 04:38:01.736830 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-13 04:38:01.736964 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-13 04:38:01.737066 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-13 04:38:01.742138 (ThreadPoolExecutor-1_0): SQL status: SELECT 27 in 0.00 seconds
2020-10-13 04:38:01.778048 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-13 04:38:01.813332 (MainThread): Using postgres connection "master".
2020-10-13 04:38:01.813524 (MainThread): On master: BEGIN
2020-10-13 04:38:01.817245 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 04:38:01.817516 (MainThread): Using postgres connection "master".
2020-10-13 04:38:01.817702 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-13 04:38:01.824913 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-10-13 04:38:01.826933 (MainThread): On master: ROLLBACK
2020-10-13 04:38:01.827382 (MainThread): Using postgres connection "master".
2020-10-13 04:38:01.827570 (MainThread): On master: BEGIN
2020-10-13 04:38:01.828079 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 04:38:01.828279 (MainThread): On master: COMMIT
2020-10-13 04:38:01.828452 (MainThread): Using postgres connection "master".
2020-10-13 04:38:01.828612 (MainThread): On master: COMMIT
2020-10-13 04:38:01.828944 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-13 04:38:01.829485 (MainThread): 04:38:01 | Concurrency: 1 threads (target='dev')
2020-10-13 04:38:01.829735 (MainThread): 04:38:01 | 
2020-10-13 04:38:01.840901 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-13 04:38:01.841175 (Thread-1): 04:38:01 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-13 04:38:01.841882 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:38:01.842016 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-13 04:38:01.842153 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-13 04:38:01.873101 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-13 04:38:01.873511 (Thread-1): finished collecting timing info
2020-10-13 04:38:01.984412 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:38:01.984711 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-13 04:38:01.998982 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-10-13 04:38:02.005090 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:38:02.005354 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-13 04:38:02.005844 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:38:02.009683 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-13 04:38:02.010285 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:38:02.010487 (Thread-1): On model.airflow_dbt_pg.stg_npi: BEGIN
2020-10-13 04:38:02.022672 (Thread-1): SQL status: BEGIN in 0.01 seconds
2020-10-13 04:38:02.022907 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:38:02.023059 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-13 04:38:02.024984 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 04:38:02.029923 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:38:02.030131 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-13 04:38:02.030750 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 04:38:02.032407 (Thread-1): On model.airflow_dbt_pg.stg_npi: COMMIT
2020-10-13 04:38:02.032586 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:38:02.032737 (Thread-1): On model.airflow_dbt_pg.stg_npi: COMMIT
2020-10-13 04:38:02.034484 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 04:38:02.038409 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:38:02.038638 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-13 04:38:02.039076 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:38:02.043920 (Thread-1): finished collecting timing info
2020-10-13 04:38:02.047197 (Thread-1): 04:38:02 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.20s]
2020-10-13 04:38:02.047540 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-13 04:38:02.047770 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 04:38:02.048149 (Thread-1): 04:38:02 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-13 04:38:02.048659 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:38:02.048808 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt_pg.stg_npi).
2020-10-13 04:38:02.048963 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 04:38:02.066985 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-13 04:38:02.067594 (Thread-1): finished collecting timing info
2020-10-13 04:38:02.088382 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:38:02.088625 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-13 04:38:02.089154 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:38:02.093539 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:38:02.093756 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-13 04:38:02.094262 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:38:02.096942 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-13 04:38:02.097480 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:38:02.097632 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: BEGIN
2020-10-13 04:38:02.098006 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 04:38:02.098167 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:38:02.098293 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-13 04:38:02.099553 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 04:38:02.104694 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:38:02.104936 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-13 04:38:02.105662 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 04:38:02.107965 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: COMMIT
2020-10-13 04:38:02.108352 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:38:02.108622 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: COMMIT
2020-10-13 04:38:02.109941 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 04:38:02.113886 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:38:02.114142 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-13 04:38:02.114761 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:38:02.119602 (Thread-1): finished collecting timing info
2020-10-13 04:38:02.120922 (Thread-1): 04:38:02 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.07s]
2020-10-13 04:38:02.121176 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 04:38:02.121820 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-13 04:38:02.122068 (Thread-1): 04:38:02 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-13 04:38:02.122607 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 04:38:02.122759 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt_pg.stg_state_abbreviations).
2020-10-13 04:38:02.122906 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-13 04:38:02.141541 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-13 04:38:02.141986 (Thread-1): finished collecting timing info
2020-10-13 04:38:02.156510 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 04:38:02.156798 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-13 04:38:02.157270 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:38:02.163220 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 04:38:02.163433 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-13 04:38:02.163945 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:38:02.166228 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-13 04:38:02.166656 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 04:38:02.166797 (Thread-1): On model.airflow_dbt_pg.npi_with_state: BEGIN
2020-10-13 04:38:02.167118 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 04:38:02.167267 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 04:38:02.167387 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-13 04:38:02.169412 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 04:38:02.173560 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 04:38:02.173715 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-13 04:38:02.174355 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 04:38:02.175720 (Thread-1): On model.airflow_dbt_pg.npi_with_state: COMMIT
2020-10-13 04:38:02.175865 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 04:38:02.175984 (Thread-1): On model.airflow_dbt_pg.npi_with_state: COMMIT
2020-10-13 04:38:02.177093 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 04:38:02.180102 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 04:38:02.180262 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-13 04:38:02.180665 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:38:02.184588 (Thread-1): finished collecting timing info
2020-10-13 04:38:02.185606 (Thread-1): 04:38:02 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.06s]
2020-10-13 04:38:02.185806 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-13 04:38:02.186297 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-13 04:38:02.186501 (Thread-1): 04:38:02 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-13 04:38:02.186936 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 04:38:02.187062 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt_pg.npi_with_state).
2020-10-13 04:38:02.187181 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-13 04:38:02.198182 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-13 04:38:02.198526 (Thread-1): finished collecting timing info
2020-10-13 04:38:02.209746 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 04:38:02.209912 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-13 04:38:02.210360 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:38:02.213995 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 04:38:02.214170 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-13 04:38:02.214559 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:38:02.216769 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-13 04:38:02.217157 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 04:38:02.217284 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: BEGIN
2020-10-13 04:38:02.217603 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 04:38:02.217740 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 04:38:02.217848 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-13 04:38:02.219680 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 04:38:02.223484 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 04:38:02.223641 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-13 04:38:02.224199 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 04:38:02.225374 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: COMMIT
2020-10-13 04:38:02.225499 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 04:38:02.225603 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: COMMIT
2020-10-13 04:38:02.226632 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 04:38:02.229127 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 04:38:02.229252 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-13 04:38:02.229616 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:38:02.233085 (Thread-1): finished collecting timing info
2020-10-13 04:38:02.233917 (Thread-1): 04:38:02 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.05s]
2020-10-13 04:38:02.234078 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-13 04:38:02.253859 (MainThread): Using postgres connection "master".
2020-10-13 04:38:02.254073 (MainThread): On master: BEGIN
2020-10-13 04:38:02.254393 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 04:38:02.254510 (MainThread): On master: COMMIT
2020-10-13 04:38:02.254621 (MainThread): Using postgres connection "master".
2020-10-13 04:38:02.254710 (MainThread): On master: COMMIT
2020-10-13 04:38:02.254940 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-13 04:38:02.255307 (MainThread): 04:38:02 | 
2020-10-13 04:38:02.255509 (MainThread): 04:38:02 | Finished running 4 view models in 0.71s.
2020-10-13 04:38:02.255643 (MainThread): Connection 'master' was left open.
2020-10-13 04:38:02.255761 (MainThread): On master: Close
2020-10-13 04:38:02.255902 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was left open.
2020-10-13 04:38:02.255997 (MainThread): On model.airflow_dbt_pg.count_providers_by_state: Close
2020-10-13 04:38:02.272970 (MainThread): 
2020-10-13 04:38:02.273209 (MainThread): Completed successfully
2020-10-13 04:38:02.273409 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-13 04:38:02.273678 (MainThread): Flushing usage events
2020-10-13 04:39:28.239494 (MainThread): Got an exception trying to initialize tracking
2020-10-13 04:39:28.239647 (MainThread): Running with dbt=0.16.0
2020-10-13 04:39:28.327819 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['dbt.airflow_dbt_pg.ge_tutorials.*'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='./dbt', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-13 04:39:28.328177 (MainThread): Tracking: do not track
2020-10-13 04:39:28.366228 (MainThread): Partial parsing not enabled
2020-10-13 04:39:28.368761 (MainThread): Parsing macros/core.sql
2020-10-13 04:39:28.379186 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 04:39:28.398887 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 04:39:28.413742 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 04:39:28.441606 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 04:39:28.451147 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 04:39:28.463663 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 04:39:28.529694 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 04:39:28.558882 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 04:39:28.561603 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 04:39:28.571619 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 04:39:28.574514 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 04:39:28.611897 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 04:39:28.613648 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 04:39:28.616852 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 04:39:28.618182 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 04:39:28.619822 (MainThread): Parsing macros/etc/query.sql
2020-10-13 04:39:28.621371 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 04:39:28.624532 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 04:39:28.626086 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 04:39:28.643420 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 04:39:28.647052 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 04:39:28.649979 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 04:39:28.651732 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 04:39:28.741572 (MainThread): Parsing macros/relations.sql
2020-10-13 04:39:28.746478 (MainThread): Parsing macros/adapters.sql
2020-10-13 04:39:28.804842 (MainThread): Parsing macros/catalog.sql
2020-10-13 04:39:28.812172 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 04:39:28.873517 (MainThread): Partial parsing not enabled
2020-10-13 04:39:28.926255 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 04:39:28.926435 (MainThread): Opening a new connection, currently in state init
2020-10-13 04:39:28.958821 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 04:39:28.958979 (MainThread): Opening a new connection, currently in state init
2020-10-13 04:39:28.967845 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:39:28.967989 (MainThread): Opening a new connection, currently in state init
2020-10-13 04:39:28.976809 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:39:28.976972 (MainThread): Opening a new connection, currently in state init
2020-10-13 04:39:29.419658 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 04:39:29.424090 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-10-13 04:39:29.424333 (MainThread): Flushing usage events
2020-10-13 04:39:29.424505 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-13 04:39:43.357766 (MainThread): Got an exception trying to initialize tracking
2020-10-13 04:39:43.357913 (MainThread): Running with dbt=0.16.0
2020-10-13 04:39:43.442036 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['airflow_dbt_pg.ge_tutorials.*'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='./dbt', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-13 04:39:43.442398 (MainThread): Tracking: do not track
2020-10-13 04:39:43.475818 (MainThread): Partial parsing not enabled
2020-10-13 04:39:43.477852 (MainThread): Parsing macros/core.sql
2020-10-13 04:39:43.485811 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 04:39:43.500427 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 04:39:43.512187 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 04:39:43.535520 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 04:39:43.543495 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 04:39:43.553699 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 04:39:43.611872 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 04:39:43.638197 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 04:39:43.640751 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 04:39:43.650200 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 04:39:43.652949 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 04:39:43.688169 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 04:39:43.689779 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 04:39:43.692790 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 04:39:43.693990 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 04:39:43.695488 (MainThread): Parsing macros/etc/query.sql
2020-10-13 04:39:43.696904 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 04:39:43.699789 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 04:39:43.701218 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 04:39:43.716122 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 04:39:43.719025 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 04:39:43.721376 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 04:39:43.722692 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 04:39:43.799264 (MainThread): Parsing macros/relations.sql
2020-10-13 04:39:43.801570 (MainThread): Parsing macros/adapters.sql
2020-10-13 04:39:43.831218 (MainThread): Parsing macros/catalog.sql
2020-10-13 04:39:43.834867 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 04:39:43.858010 (MainThread): Partial parsing not enabled
2020-10-13 04:39:43.897250 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 04:39:43.897354 (MainThread): Opening a new connection, currently in state init
2020-10-13 04:39:43.919863 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 04:39:43.919963 (MainThread): Opening a new connection, currently in state init
2020-10-13 04:39:43.926710 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:39:43.926801 (MainThread): Opening a new connection, currently in state init
2020-10-13 04:39:43.933582 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:39:43.933673 (MainThread): Opening a new connection, currently in state init
2020-10-13 04:39:44.399281 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 04:39:44.403615 (MainThread): 
2020-10-13 04:39:44.404050 (MainThread): Acquiring new postgres connection "master".
2020-10-13 04:39:44.404163 (MainThread): Opening a new connection, currently in state init
2020-10-13 04:39:44.432311 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-13 04:39:44.432661 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-13 04:39:44.582210 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-13 04:39:44.582368 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-13 04:39:44.586414 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-13 04:39:44.610972 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-13 04:39:44.611127 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-13 04:39:44.613255 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-13 04:39:44.613371 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-13 04:39:44.613741 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-13 04:39:44.613869 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-13 04:39:44.613964 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-13 04:39:44.616052 (ThreadPoolExecutor-1_0): SQL status: SELECT 31 in 0.00 seconds
2020-10-13 04:39:44.650860 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-13 04:39:44.677957 (MainThread): Using postgres connection "master".
2020-10-13 04:39:44.678100 (MainThread): On master: BEGIN
2020-10-13 04:39:44.681286 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 04:39:44.681433 (MainThread): Using postgres connection "master".
2020-10-13 04:39:44.681528 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-13 04:39:44.687109 (MainThread): SQL status: SELECT 5 in 0.01 seconds
2020-10-13 04:39:44.695863 (MainThread): On master: ROLLBACK
2020-10-13 04:39:44.696174 (MainThread): Using postgres connection "master".
2020-10-13 04:39:44.696287 (MainThread): On master: BEGIN
2020-10-13 04:39:44.696769 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 04:39:44.696895 (MainThread): On master: COMMIT
2020-10-13 04:39:44.696993 (MainThread): Using postgres connection "master".
2020-10-13 04:39:44.697081 (MainThread): On master: COMMIT
2020-10-13 04:39:44.697348 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-13 04:39:44.697677 (MainThread): 04:39:44 | Concurrency: 1 threads (target='dev')
2020-10-13 04:39:44.697824 (MainThread): 04:39:44 | 
2020-10-13 04:39:44.704016 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-13 04:39:44.704237 (Thread-1): 04:39:44 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-13 04:39:44.704633 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:39:44.704733 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-13 04:39:44.704837 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-13 04:39:44.729202 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-13 04:39:44.729566 (Thread-1): finished collecting timing info
2020-10-13 04:39:44.781149 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:39:44.781319 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-13 04:39:44.781916 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:39:44.784956 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:39:44.785070 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-13 04:39:44.785380 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:39:44.787230 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-13 04:39:44.787560 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:39:44.787668 (Thread-1): On model.airflow_dbt_pg.stg_npi: BEGIN
2020-10-13 04:39:44.787959 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 04:39:44.788084 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:39:44.788187 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-13 04:39:44.789528 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 04:39:44.794831 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:39:44.794966 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
alter table "airflow"."public"."stg_npi" rename to "stg_npi__dbt_backup"
2020-10-13 04:39:44.795477 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 04:39:44.799622 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:39:44.799741 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-13 04:39:44.800184 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 04:39:44.801210 (Thread-1): On model.airflow_dbt_pg.stg_npi: COMMIT
2020-10-13 04:39:44.801320 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:39:44.801413 (Thread-1): On model.airflow_dbt_pg.stg_npi: COMMIT
2020-10-13 04:39:44.802587 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 04:39:44.804984 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:39:44.805104 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-13 04:39:44.807070 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:39:44.810166 (Thread-1): finished collecting timing info
2020-10-13 04:39:44.810971 (Thread-1): 04:39:44 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.11s]
2020-10-13 04:39:44.811131 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-13 04:39:44.811296 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 04:39:44.811605 (Thread-1): 04:39:44 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-13 04:39:44.811929 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:39:44.812031 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt_pg.stg_npi).
2020-10-13 04:39:44.812130 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 04:39:44.821677 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-13 04:39:44.821993 (Thread-1): finished collecting timing info
2020-10-13 04:39:44.832301 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:39:44.832497 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-13 04:39:44.832937 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:39:44.836161 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:39:44.836294 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-13 04:39:44.836619 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:39:44.838560 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-13 04:39:44.838895 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:39:44.839008 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: BEGIN
2020-10-13 04:39:44.839308 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 04:39:44.839435 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:39:44.839535 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-13 04:39:44.840337 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 04:39:44.850176 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:39:44.850444 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations" rename to "stg_state_abbreviations__dbt_backup"
2020-10-13 04:39:44.851186 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 04:39:44.857123 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:39:44.857330 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-13 04:39:44.858045 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 04:39:44.860033 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: COMMIT
2020-10-13 04:39:44.860223 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:39:44.860386 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: COMMIT
2020-10-13 04:39:44.861514 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 04:39:44.865837 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:39:44.866031 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-13 04:39:44.867648 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:39:44.873475 (Thread-1): finished collecting timing info
2020-10-13 04:39:44.874925 (Thread-1): 04:39:44 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.06s]
2020-10-13 04:39:44.875782 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 04:39:44.876538 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-13 04:39:44.876923 (Thread-1): 04:39:44 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-13 04:39:44.877900 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 04:39:44.878163 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt_pg.stg_state_abbreviations).
2020-10-13 04:39:44.878422 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-13 04:39:44.903120 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-13 04:39:44.904910 (Thread-1): finished collecting timing info
2020-10-13 04:39:44.926024 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 04:39:44.926292 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-13 04:39:44.926900 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:39:44.932295 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 04:39:44.932488 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-13 04:39:44.932910 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:39:44.936264 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-13 04:39:44.936831 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 04:39:44.937009 (Thread-1): On model.airflow_dbt_pg.npi_with_state: BEGIN
2020-10-13 04:39:44.937316 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 04:39:44.937500 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 04:39:44.937662 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-13 04:39:44.939591 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 04:39:44.945312 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 04:39:44.953502 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-13 04:39:44.954362 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 04:39:44.956455 (Thread-1): On model.airflow_dbt_pg.npi_with_state: COMMIT
2020-10-13 04:39:44.956658 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 04:39:44.956831 (Thread-1): On model.airflow_dbt_pg.npi_with_state: COMMIT
2020-10-13 04:39:44.957980 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 04:39:44.962357 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 04:39:44.962581 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-13 04:39:44.963063 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:39:44.968863 (Thread-1): finished collecting timing info
2020-10-13 04:39:44.970292 (Thread-1): 04:39:44 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.09s]
2020-10-13 04:39:44.971158 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-13 04:39:44.971888 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-13 04:39:44.972254 (Thread-1): 04:39:44 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-13 04:39:44.973277 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 04:39:44.973528 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt_pg.npi_with_state).
2020-10-13 04:39:44.973817 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-13 04:39:44.985552 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-13 04:39:44.985918 (Thread-1): finished collecting timing info
2020-10-13 04:39:44.997583 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 04:39:44.997783 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-13 04:39:44.998277 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:39:45.002472 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 04:39:45.002678 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-13 04:39:45.003134 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:39:45.005880 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-13 04:39:45.006462 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 04:39:45.006631 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: BEGIN
2020-10-13 04:39:45.006993 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 04:39:45.007146 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 04:39:45.007266 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-13 04:39:45.008640 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 04:39:45.014752 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 04:39:45.014939 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-13 04:39:45.015531 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 04:39:45.016890 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: COMMIT
2020-10-13 04:39:45.017032 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 04:39:45.017151 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: COMMIT
2020-10-13 04:39:45.018190 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 04:39:45.021218 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 04:39:45.021392 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-13 04:39:45.021806 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:39:45.025840 (Thread-1): finished collecting timing info
2020-10-13 04:39:45.026894 (Thread-1): 04:39:45 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.05s]
2020-10-13 04:39:45.027098 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-13 04:39:45.106919 (MainThread): Using postgres connection "master".
2020-10-13 04:39:45.107089 (MainThread): On master: BEGIN
2020-10-13 04:39:45.107450 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 04:39:45.107609 (MainThread): On master: COMMIT
2020-10-13 04:39:45.107708 (MainThread): Using postgres connection "master".
2020-10-13 04:39:45.107800 (MainThread): On master: COMMIT
2020-10-13 04:39:45.108067 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-13 04:39:45.108417 (MainThread): 04:39:45 | 
2020-10-13 04:39:45.108567 (MainThread): 04:39:45 | Finished running 4 view models in 0.70s.
2020-10-13 04:39:45.108717 (MainThread): Connection 'master' was left open.
2020-10-13 04:39:45.108839 (MainThread): On master: Close
2020-10-13 04:39:45.108988 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was left open.
2020-10-13 04:39:45.109118 (MainThread): On model.airflow_dbt_pg.count_providers_by_state: Close
2020-10-13 04:39:45.127322 (MainThread): 
2020-10-13 04:39:45.127524 (MainThread): Completed successfully
2020-10-13 04:39:45.127695 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-13 04:39:45.127959 (MainThread): Flushing usage events
2020-10-13 04:43:54.018578 (MainThread): Got an exception trying to initialize tracking
2020-10-13 04:43:54.018726 (MainThread): Running with dbt=0.16.0
2020-10-13 04:43:54.097663 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['airflow_dbt_pg.ge_tutorials.*'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='/usr/local/airflow/dbt', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-13 04:43:54.098011 (MainThread): Tracking: do not track
2020-10-13 04:43:54.129056 (MainThread): Partial parsing not enabled
2020-10-13 04:43:54.130850 (MainThread): Parsing macros/core.sql
2020-10-13 04:43:54.138127 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 04:43:54.153390 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 04:43:54.166897 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 04:43:54.192431 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 04:43:54.200721 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 04:43:54.211310 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 04:43:54.270749 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 04:43:54.297578 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 04:43:54.300323 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 04:43:54.310026 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 04:43:54.312859 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 04:43:54.348993 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 04:43:54.350667 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 04:43:54.353605 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 04:43:54.354796 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 04:43:54.356474 (MainThread): Parsing macros/etc/query.sql
2020-10-13 04:43:54.357909 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 04:43:54.360791 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 04:43:54.362205 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 04:43:54.377448 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 04:43:54.380439 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 04:43:54.382781 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 04:43:54.384141 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 04:43:54.469531 (MainThread): Parsing macros/relations.sql
2020-10-13 04:43:54.472719 (MainThread): Parsing macros/adapters.sql
2020-10-13 04:43:54.510934 (MainThread): Parsing macros/catalog.sql
2020-10-13 04:43:54.516086 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 04:43:54.550637 (MainThread): Partial parsing not enabled
2020-10-13 04:43:54.600295 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 04:43:54.600440 (MainThread): Opening a new connection, currently in state init
2020-10-13 04:43:54.626771 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 04:43:54.626912 (MainThread): Opening a new connection, currently in state init
2020-10-13 04:43:54.635196 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:43:54.635366 (MainThread): Opening a new connection, currently in state init
2020-10-13 04:43:54.643930 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:43:54.644087 (MainThread): Opening a new connection, currently in state init
2020-10-13 04:43:55.122487 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 04:43:55.126782 (MainThread): 
2020-10-13 04:43:55.127149 (MainThread): Acquiring new postgres connection "master".
2020-10-13 04:43:55.127255 (MainThread): Opening a new connection, currently in state init
2020-10-13 04:43:55.151268 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-13 04:43:55.151528 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-13 04:43:55.282399 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-13 04:43:55.282559 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-13 04:43:55.286564 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-13 04:43:55.315045 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-13 04:43:55.315394 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-13 04:43:55.319088 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-13 04:43:55.319276 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-13 04:43:55.319770 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-13 04:43:55.319953 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-13 04:43:55.320106 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-13 04:43:55.323815 (ThreadPoolExecutor-1_0): SQL status: SELECT 31 in 0.00 seconds
2020-10-13 04:43:55.382233 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-13 04:43:55.450702 (MainThread): Using postgres connection "master".
2020-10-13 04:43:55.450914 (MainThread): On master: BEGIN
2020-10-13 04:43:55.454159 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 04:43:55.454378 (MainThread): Using postgres connection "master".
2020-10-13 04:43:55.454548 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-13 04:43:55.460605 (MainThread): SQL status: SELECT 5 in 0.01 seconds
2020-10-13 04:43:55.476527 (MainThread): On master: ROLLBACK
2020-10-13 04:43:55.476948 (MainThread): Using postgres connection "master".
2020-10-13 04:43:55.477118 (MainThread): On master: BEGIN
2020-10-13 04:43:55.477640 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 04:43:55.477827 (MainThread): On master: COMMIT
2020-10-13 04:43:55.477987 (MainThread): Using postgres connection "master".
2020-10-13 04:43:55.478141 (MainThread): On master: COMMIT
2020-10-13 04:43:55.478448 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-13 04:43:55.478992 (MainThread): 04:43:55 | Concurrency: 1 threads (target='dev')
2020-10-13 04:43:55.479229 (MainThread): 04:43:55 | 
2020-10-13 04:43:55.488480 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-13 04:43:55.488790 (Thread-1): 04:43:55 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-13 04:43:55.489317 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:43:55.489466 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-13 04:43:55.489640 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-13 04:43:55.522778 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-13 04:43:55.523118 (Thread-1): finished collecting timing info
2020-10-13 04:43:55.578232 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:43:55.578401 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-13 04:43:55.578988 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:43:55.582133 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:43:55.582254 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-13 04:43:55.582573 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:43:55.584433 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-13 04:43:55.584759 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:43:55.584861 (Thread-1): On model.airflow_dbt_pg.stg_npi: BEGIN
2020-10-13 04:43:55.585158 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 04:43:55.585277 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:43:55.585370 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-13 04:43:55.586628 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 04:43:55.591856 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:43:55.591996 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
alter table "airflow"."public"."stg_npi" rename to "stg_npi__dbt_backup"
2020-10-13 04:43:55.592421 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 04:43:55.596563 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:43:55.596691 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-13 04:43:55.597116 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 04:43:55.598134 (Thread-1): On model.airflow_dbt_pg.stg_npi: COMMIT
2020-10-13 04:43:55.598239 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:43:55.598329 (Thread-1): On model.airflow_dbt_pg.stg_npi: COMMIT
2020-10-13 04:43:55.599357 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 04:43:55.601795 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 04:43:55.601912 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-13 04:43:55.603662 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:43:55.606785 (Thread-1): finished collecting timing info
2020-10-13 04:43:55.607588 (Thread-1): 04:43:55 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.12s]
2020-10-13 04:43:55.607747 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-13 04:43:55.607908 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 04:43:55.608146 (Thread-1): 04:43:55 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-13 04:43:55.608429 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:43:55.608520 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt_pg.stg_npi).
2020-10-13 04:43:55.608614 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 04:43:55.618291 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-13 04:43:55.618622 (Thread-1): finished collecting timing info
2020-10-13 04:43:55.628008 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:43:55.628156 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-13 04:43:55.628510 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:43:55.631498 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:43:55.631617 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-13 04:43:55.631898 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:43:55.633755 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-13 04:43:55.634083 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:43:55.634186 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: BEGIN
2020-10-13 04:43:55.634385 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 04:43:55.634488 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:43:55.634587 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-13 04:43:55.635247 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 04:43:55.640575 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:43:55.640710 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations" rename to "stg_state_abbreviations__dbt_backup"
2020-10-13 04:43:55.641145 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 04:43:55.644692 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:43:55.644845 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-13 04:43:55.645263 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 04:43:55.646514 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: COMMIT
2020-10-13 04:43:55.646683 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:43:55.646777 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: COMMIT
2020-10-13 04:43:55.647885 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 04:43:55.650639 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 04:43:55.650792 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-13 04:43:55.652383 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:43:55.656110 (Thread-1): finished collecting timing info
2020-10-13 04:43:55.657079 (Thread-1): 04:43:55 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.05s]
2020-10-13 04:43:55.657258 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 04:43:55.657644 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-13 04:43:55.657797 (Thread-1): 04:43:55 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-13 04:43:55.658114 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 04:43:55.658208 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt_pg.stg_state_abbreviations).
2020-10-13 04:43:55.658304 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-13 04:43:55.671226 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-13 04:43:55.671547 (Thread-1): finished collecting timing info
2020-10-13 04:43:55.682201 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 04:43:55.682363 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-13 04:43:55.682666 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:43:55.686142 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 04:43:55.686295 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-13 04:43:55.686575 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:43:55.689355 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-13 04:43:55.689710 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 04:43:55.689821 (Thread-1): On model.airflow_dbt_pg.npi_with_state: BEGIN
2020-10-13 04:43:55.690038 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 04:43:55.690146 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 04:43:55.690235 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-13 04:43:55.691319 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 04:43:55.694631 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 04:43:55.694810 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-13 04:43:55.695228 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 04:43:55.696303 (Thread-1): On model.airflow_dbt_pg.npi_with_state: COMMIT
2020-10-13 04:43:55.696420 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 04:43:55.696514 (Thread-1): On model.airflow_dbt_pg.npi_with_state: COMMIT
2020-10-13 04:43:55.697464 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 04:43:55.699898 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 04:43:55.700012 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-13 04:43:55.700277 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:43:55.703452 (Thread-1): finished collecting timing info
2020-10-13 04:43:55.704247 (Thread-1): 04:43:55 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.05s]
2020-10-13 04:43:55.704395 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-13 04:43:55.704760 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-13 04:43:55.704922 (Thread-1): 04:43:55 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-13 04:43:55.705206 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 04:43:55.705300 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt_pg.npi_with_state).
2020-10-13 04:43:55.705395 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-13 04:43:55.714952 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-13 04:43:55.715277 (Thread-1): finished collecting timing info
2020-10-13 04:43:55.725037 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 04:43:55.725196 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-13 04:43:55.725495 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:43:55.728655 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 04:43:55.728776 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-13 04:43:55.729041 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:43:55.730990 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-13 04:43:55.731307 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 04:43:55.731411 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: BEGIN
2020-10-13 04:43:55.731589 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 04:43:55.731693 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 04:43:55.731790 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-13 04:43:55.732805 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 04:43:55.737331 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 04:43:55.737464 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-13 04:43:55.737817 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 04:43:55.738866 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: COMMIT
2020-10-13 04:43:55.738975 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 04:43:55.739067 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: COMMIT
2020-10-13 04:43:55.739985 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 04:43:55.742345 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 04:43:55.742455 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-13 04:43:55.742724 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 04:43:55.745860 (Thread-1): finished collecting timing info
2020-10-13 04:43:55.746695 (Thread-1): 04:43:55 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.04s]
2020-10-13 04:43:55.746844 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-13 04:43:55.795783 (MainThread): Using postgres connection "master".
2020-10-13 04:43:55.795970 (MainThread): On master: BEGIN
2020-10-13 04:43:55.796358 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 04:43:55.796509 (MainThread): On master: COMMIT
2020-10-13 04:43:55.796617 (MainThread): Using postgres connection "master".
2020-10-13 04:43:55.796717 (MainThread): On master: COMMIT
2020-10-13 04:43:55.796983 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-13 04:43:55.797385 (MainThread): 04:43:55 | 
2020-10-13 04:43:55.797536 (MainThread): 04:43:55 | Finished running 4 view models in 0.67s.
2020-10-13 04:43:55.797654 (MainThread): Connection 'master' was left open.
2020-10-13 04:43:55.797750 (MainThread): On master: Close
2020-10-13 04:43:55.797897 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was left open.
2020-10-13 04:43:55.797994 (MainThread): On model.airflow_dbt_pg.count_providers_by_state: Close
2020-10-13 04:43:55.816163 (MainThread): 
2020-10-13 04:43:55.816350 (MainThread): Completed successfully
2020-10-13 04:43:55.816508 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-13 04:43:55.816734 (MainThread): Flushing usage events
2020-10-13 05:03:09.846804 (MainThread): Got an exception trying to initialize tracking
2020-10-13 05:03:09.846956 (MainThread): Running with dbt=0.16.0
2020-10-13 05:03:09.928701 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['airflow_dbt_pg.ge_tutorials.*'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='/usr/local/airflow/dbt', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-13 05:03:09.929053 (MainThread): Tracking: do not track
2020-10-13 05:03:09.963574 (MainThread): Partial parsing not enabled
2020-10-13 05:03:09.965748 (MainThread): Parsing macros/core.sql
2020-10-13 05:03:09.974289 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 05:03:09.990175 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 05:03:10.004039 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 05:03:10.031604 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 05:03:10.041745 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 05:03:10.053612 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 05:03:10.113338 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 05:03:10.140135 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 05:03:10.142723 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 05:03:10.152391 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 05:03:10.155193 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 05:03:10.191659 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 05:03:10.193410 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 05:03:10.196504 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 05:03:10.197754 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 05:03:10.199330 (MainThread): Parsing macros/etc/query.sql
2020-10-13 05:03:10.200812 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 05:03:10.203882 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 05:03:10.205372 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 05:03:10.220554 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 05:03:10.223536 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 05:03:10.225919 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 05:03:10.227250 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 05:03:10.305522 (MainThread): Parsing macros/relations.sql
2020-10-13 05:03:10.307916 (MainThread): Parsing macros/adapters.sql
2020-10-13 05:03:10.337894 (MainThread): Parsing macros/catalog.sql
2020-10-13 05:03:10.341599 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 05:03:10.365443 (MainThread): Partial parsing not enabled
2020-10-13 05:03:10.406527 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 05:03:10.406661 (MainThread): Opening a new connection, currently in state init
2020-10-13 05:03:10.428766 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 05:03:10.428863 (MainThread): Opening a new connection, currently in state init
2020-10-13 05:03:10.435343 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 05:03:10.435432 (MainThread): Opening a new connection, currently in state init
2020-10-13 05:03:10.441960 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 05:03:10.442048 (MainThread): Opening a new connection, currently in state init
2020-10-13 05:03:10.914038 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 05:03:10.918577 (MainThread): 
2020-10-13 05:03:10.919002 (MainThread): Acquiring new postgres connection "master".
2020-10-13 05:03:10.919117 (MainThread): Opening a new connection, currently in state init
2020-10-13 05:03:10.942698 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-13 05:03:10.942877 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-13 05:03:11.094171 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-13 05:03:11.094331 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-13 05:03:11.098420 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-13 05:03:11.123030 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-13 05:03:11.123178 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-13 05:03:11.125260 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-13 05:03:11.125374 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-13 05:03:11.125760 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-13 05:03:11.125877 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-13 05:03:11.125969 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-13 05:03:11.128036 (ThreadPoolExecutor-1_0): SQL status: SELECT 27 in 0.00 seconds
2020-10-13 05:03:11.157445 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-13 05:03:11.182972 (MainThread): Using postgres connection "master".
2020-10-13 05:03:11.183120 (MainThread): On master: BEGIN
2020-10-13 05:03:11.186090 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 05:03:11.186238 (MainThread): Using postgres connection "master".
2020-10-13 05:03:11.186332 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-13 05:03:11.191733 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-10-13 05:03:11.192862 (MainThread): On master: ROLLBACK
2020-10-13 05:03:11.193147 (MainThread): Using postgres connection "master".
2020-10-13 05:03:11.193260 (MainThread): On master: BEGIN
2020-10-13 05:03:11.193640 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 05:03:11.193771 (MainThread): On master: COMMIT
2020-10-13 05:03:11.193865 (MainThread): Using postgres connection "master".
2020-10-13 05:03:11.193952 (MainThread): On master: COMMIT
2020-10-13 05:03:11.194176 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-13 05:03:11.194518 (MainThread): 05:03:11 | Concurrency: 1 threads (target='dev')
2020-10-13 05:03:11.194673 (MainThread): 05:03:11 | 
2020-10-13 05:03:11.200784 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-13 05:03:11.200977 (Thread-1): 05:03:11 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-13 05:03:11.201472 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 05:03:11.201569 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-13 05:03:11.201672 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-13 05:03:11.223210 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-13 05:03:11.223484 (Thread-1): finished collecting timing info
2020-10-13 05:03:11.267700 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 05:03:11.267847 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-13 05:03:11.268392 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 05:03:11.270943 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 05:03:11.271039 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-13 05:03:11.271323 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 05:03:11.272908 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-13 05:03:11.273181 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 05:03:11.273270 (Thread-1): On model.airflow_dbt_pg.stg_npi: BEGIN
2020-10-13 05:03:11.273532 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 05:03:11.273636 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 05:03:11.273719 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-13 05:03:11.274939 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 05:03:11.277751 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 05:03:11.277861 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-13 05:03:11.278244 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 05:03:11.279187 (Thread-1): On model.airflow_dbt_pg.stg_npi: COMMIT
2020-10-13 05:03:11.279288 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 05:03:11.279371 (Thread-1): On model.airflow_dbt_pg.stg_npi: COMMIT
2020-10-13 05:03:11.280360 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 05:03:11.282594 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 05:03:11.282702 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-13 05:03:11.283010 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 05:03:11.285912 (Thread-1): finished collecting timing info
2020-10-13 05:03:11.287844 (Thread-1): 05:03:11 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.09s]
2020-10-13 05:03:11.287991 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-13 05:03:11.288136 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 05:03:11.288294 (Thread-1): 05:03:11 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-13 05:03:11.288557 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 05:03:11.288648 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt_pg.stg_npi).
2020-10-13 05:03:11.288741 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 05:03:11.297688 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-13 05:03:11.297964 (Thread-1): finished collecting timing info
2020-10-13 05:03:11.306862 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 05:03:11.307016 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-13 05:03:11.307420 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 05:03:11.310249 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 05:03:11.310360 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-13 05:03:11.310698 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 05:03:11.312469 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-13 05:03:11.312782 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 05:03:11.312882 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: BEGIN
2020-10-13 05:03:11.313148 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 05:03:11.313261 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 05:03:11.313352 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-13 05:03:11.314074 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 05:03:11.317207 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 05:03:11.317333 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-13 05:03:11.317730 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 05:03:11.318726 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: COMMIT
2020-10-13 05:03:11.318834 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 05:03:11.318925 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: COMMIT
2020-10-13 05:03:11.319911 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 05:03:11.322176 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 05:03:11.322283 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-13 05:03:11.322570 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 05:03:11.325555 (Thread-1): finished collecting timing info
2020-10-13 05:03:11.326330 (Thread-1): 05:03:11 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.04s]
2020-10-13 05:03:11.326474 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 05:03:11.326927 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-13 05:03:11.327081 (Thread-1): 05:03:11 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-13 05:03:11.327350 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 05:03:11.327439 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt_pg.stg_state_abbreviations).
2020-10-13 05:03:11.327529 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-13 05:03:11.337902 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-13 05:03:11.338207 (Thread-1): finished collecting timing info
2020-10-13 05:03:11.347290 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 05:03:11.347440 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-13 05:03:11.347847 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 05:03:11.352072 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 05:03:11.352204 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-13 05:03:11.352560 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 05:03:11.354269 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-13 05:03:11.354614 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 05:03:11.354719 (Thread-1): On model.airflow_dbt_pg.npi_with_state: BEGIN
2020-10-13 05:03:11.354980 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 05:03:11.355096 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 05:03:11.355190 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-13 05:03:11.356281 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 05:03:11.359544 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 05:03:11.359662 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-13 05:03:11.360117 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 05:03:11.361155 (Thread-1): On model.airflow_dbt_pg.npi_with_state: COMMIT
2020-10-13 05:03:11.361267 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 05:03:11.361361 (Thread-1): On model.airflow_dbt_pg.npi_with_state: COMMIT
2020-10-13 05:03:11.362346 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 05:03:11.364673 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 05:03:11.364797 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-13 05:03:11.365117 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 05:03:11.368168 (Thread-1): finished collecting timing info
2020-10-13 05:03:11.368952 (Thread-1): 05:03:11 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.04s]
2020-10-13 05:03:11.369103 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-13 05:03:11.369551 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-13 05:03:11.369713 (Thread-1): 05:03:11 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-13 05:03:11.369996 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 05:03:11.370090 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt_pg.npi_with_state).
2020-10-13 05:03:11.370186 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-13 05:03:11.379247 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-13 05:03:11.379535 (Thread-1): finished collecting timing info
2020-10-13 05:03:11.388978 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 05:03:11.389124 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-13 05:03:11.389544 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 05:03:11.392632 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 05:03:11.392751 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-13 05:03:11.393098 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 05:03:11.395041 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-13 05:03:11.395355 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 05:03:11.395461 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: BEGIN
2020-10-13 05:03:11.395732 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 05:03:11.395852 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 05:03:11.395949 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-13 05:03:11.397058 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 05:03:11.400239 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 05:03:11.400358 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-13 05:03:11.400806 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 05:03:11.401839 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: COMMIT
2020-10-13 05:03:11.401949 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 05:03:11.402043 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: COMMIT
2020-10-13 05:03:11.403068 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 05:03:11.405465 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 05:03:11.405579 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-13 05:03:11.405932 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 05:03:11.411508 (Thread-1): finished collecting timing info
2020-10-13 05:03:11.412855 (Thread-1): 05:03:11 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.04s]
2020-10-13 05:03:11.413380 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-13 05:03:11.506787 (MainThread): Using postgres connection "master".
2020-10-13 05:03:11.507047 (MainThread): On master: BEGIN
2020-10-13 05:03:11.507442 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 05:03:11.507628 (MainThread): On master: COMMIT
2020-10-13 05:03:11.507803 (MainThread): Using postgres connection "master".
2020-10-13 05:03:11.507972 (MainThread): On master: COMMIT
2020-10-13 05:03:11.508548 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-13 05:03:11.509408 (MainThread): 05:03:11 | 
2020-10-13 05:03:11.509660 (MainThread): 05:03:11 | Finished running 4 view models in 0.59s.
2020-10-13 05:03:11.509860 (MainThread): Connection 'master' was left open.
2020-10-13 05:03:11.510001 (MainThread): On master: Close
2020-10-13 05:03:11.510687 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was left open.
2020-10-13 05:03:11.510879 (MainThread): On model.airflow_dbt_pg.count_providers_by_state: Close
2020-10-13 05:03:11.542491 (MainThread): 
2020-10-13 05:03:11.542733 (MainThread): Completed successfully
2020-10-13 05:03:11.542933 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-13 05:03:11.543218 (MainThread): Flushing usage events
2020-10-13 15:41:22.932656 (MainThread): Got an exception trying to initialize tracking
2020-10-13 15:41:22.932851 (MainThread): Running with dbt=0.16.0
2020-10-13 15:41:23.024106 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-13 15:41:23.024708 (MainThread): Tracking: do not track
2020-10-13 15:41:23.086536 (MainThread): Partial parsing not enabled
2020-10-13 15:41:23.091955 (MainThread): Parsing macros/core.sql
2020-10-13 15:41:23.109638 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 15:41:23.135003 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 15:41:23.148106 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 15:41:23.174751 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 15:41:23.184131 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 15:41:23.197098 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 15:41:23.269080 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 15:41:23.303871 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 15:41:23.307641 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 15:41:23.322628 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 15:41:23.327463 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 15:41:23.389591 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 15:41:23.392664 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 15:41:23.399085 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 15:41:23.402319 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 15:41:23.405708 (MainThread): Parsing macros/etc/query.sql
2020-10-13 15:41:23.408557 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 15:41:23.413932 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 15:41:23.416794 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 15:41:23.447943 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 15:41:23.454807 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 15:41:23.460334 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 15:41:23.463624 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 15:41:23.576024 (MainThread): Parsing macros/relations.sql
2020-10-13 15:41:23.579956 (MainThread): Parsing macros/adapters.sql
2020-10-13 15:41:23.627625 (MainThread): Parsing macros/catalog.sql
2020-10-13 15:41:23.633952 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 15:41:23.667519 (MainThread): Partial parsing not enabled
2020-10-13 15:41:23.719353 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 15:41:23.719522 (MainThread): Opening a new connection, currently in state init
2020-10-13 15:41:23.748722 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 15:41:23.748892 (MainThread): Opening a new connection, currently in state init
2020-10-13 15:41:23.758253 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 15:41:23.758398 (MainThread): Opening a new connection, currently in state init
2020-10-13 15:41:23.767704 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 15:41:23.767873 (MainThread): Opening a new connection, currently in state init
2020-10-13 15:41:24.343958 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 15:41:24.349509 (MainThread): 
2020-10-13 15:41:24.349783 (MainThread): 15:41:24 | Concurrency: 1 threads (target='dev')
2020-10-13 15:41:24.349950 (MainThread): 15:41:24 | 
2020-10-13 15:41:24.358925 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-13 15:41:24.359461 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 15:41:24.359599 (Thread-1): Opening a new connection, currently in state init
2020-10-13 15:41:24.359747 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-13 15:41:24.386358 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-13 15:41:24.389074 (Thread-1): finished collecting timing info
2020-10-13 15:41:24.389504 (Thread-1): finished collecting timing info
2020-10-13 15:41:24.390031 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-13 15:41:24.390195 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 15:41:24.390660 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 15:41:24.390794 (Thread-1): Opening a new connection, currently in state init
2020-10-13 15:41:24.390913 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 15:41:24.402443 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-13 15:41:24.402792 (Thread-1): finished collecting timing info
2020-10-13 15:41:24.403121 (Thread-1): finished collecting timing info
2020-10-13 15:41:24.403658 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 15:41:24.404279 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-13 15:41:24.404978 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 15:41:24.405142 (Thread-1): Opening a new connection, currently in state init
2020-10-13 15:41:24.405262 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-13 15:41:24.418134 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-13 15:41:24.418477 (Thread-1): finished collecting timing info
2020-10-13 15:41:24.418791 (Thread-1): finished collecting timing info
2020-10-13 15:41:24.419280 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-13 15:41:24.419792 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-13 15:41:24.420131 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 15:41:24.420240 (Thread-1): Opening a new connection, currently in state init
2020-10-13 15:41:24.420373 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-13 15:41:24.431943 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-13 15:41:24.432290 (Thread-1): finished collecting timing info
2020-10-13 15:41:24.432603 (Thread-1): finished collecting timing info
2020-10-13 15:41:24.433118 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-13 15:41:24.458743 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-13 15:41:24.458930 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was properly closed.
2020-10-13 15:41:24.477224 (MainThread): 15:41:24 | Done.
2020-10-13 15:41:24.480566 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-13 15:41:24.480738 (MainThread): Opening a new connection, currently in state init
2020-10-13 15:41:24.480935 (MainThread): 15:41:24 | Building catalog
2020-10-13 15:41:24.532827 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-13 15:41:24.533902 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-13 15:41:24.765010 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-13 15:41:24.765283 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-13 15:41:24.769461 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-13 15:41:24.769710 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-13 15:41:24.769858 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-13 15:41:24.776391 (ThreadPoolExecutor-0_0): SQL status: SELECT 197 in 0.01 seconds
2020-10-13 15:41:24.804312 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-13 15:41:24.982454 (MainThread): 15:41:24 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-13 15:41:24.982922 (MainThread): Flushing usage events
2020-10-13 15:41:24.983089 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-13 15:41:24.983186 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-13 15:41:24.983276 (MainThread): On airflow.information_schema: Close
2020-10-13 15:41:26.606075 (MainThread): Got an exception trying to initialize tracking
2020-10-13 15:41:26.606271 (MainThread): Running with dbt=0.16.0
2020-10-13 15:41:26.703409 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-13 15:41:26.703788 (MainThread): Tracking: do not track
2020-10-13 15:41:26.712525 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-13 15:41:26.712858 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-13 15:41:26.712987 (MainThread): Press Ctrl+C to exit.


2020-10-13 16:53:14.494050 (MainThread): Got an exception trying to initialize tracking
2020-10-13 16:53:14.494193 (MainThread): Running with dbt=0.16.0
2020-10-13 16:53:14.571753 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-13 16:53:14.572137 (MainThread): Tracking: do not track
2020-10-13 16:53:14.609663 (MainThread): Partial parsing not enabled
2020-10-13 16:53:14.611867 (MainThread): Parsing macros/core.sql
2020-10-13 16:53:14.620361 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 16:53:14.636339 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 16:53:14.649382 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 16:53:14.674972 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 16:53:14.683378 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 16:53:14.694567 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 16:53:14.782531 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 16:53:14.835999 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 16:53:14.841195 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 16:53:14.860538 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 16:53:14.864696 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 16:53:14.901914 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 16:53:14.903745 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 16:53:14.906965 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 16:53:14.908275 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 16:53:14.909919 (MainThread): Parsing macros/etc/query.sql
2020-10-13 16:53:14.911460 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 16:53:14.914645 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 16:53:14.916202 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 16:53:14.932167 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 16:53:14.935284 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 16:53:14.937792 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 16:53:14.939182 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 16:53:15.023138 (MainThread): Parsing macros/relations.sql
2020-10-13 16:53:15.025836 (MainThread): Parsing macros/adapters.sql
2020-10-13 16:53:15.070210 (MainThread): Parsing macros/catalog.sql
2020-10-13 16:53:15.076275 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 16:53:15.123322 (MainThread): Partial parsing not enabled
2020-10-13 16:53:15.195167 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 16:53:15.195325 (MainThread): Opening a new connection, currently in state init
2020-10-13 16:53:15.229274 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 16:53:15.229464 (MainThread): Opening a new connection, currently in state init
2020-10-13 16:53:15.240401 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 16:53:15.240544 (MainThread): Opening a new connection, currently in state init
2020-10-13 16:53:15.250236 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 16:53:15.250373 (MainThread): Opening a new connection, currently in state init
2020-10-13 16:53:15.705037 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 16:53:15.710438 (MainThread): 
2020-10-13 16:53:15.710675 (MainThread): 16:53:15 | Concurrency: 1 threads (target='dev')
2020-10-13 16:53:15.710868 (MainThread): 16:53:15 | 
2020-10-13 16:53:15.719335 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-13 16:53:15.719843 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 16:53:15.719997 (Thread-1): Opening a new connection, currently in state init
2020-10-13 16:53:15.720130 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-13 16:53:15.746162 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-13 16:53:15.746507 (Thread-1): finished collecting timing info
2020-10-13 16:53:15.746825 (Thread-1): finished collecting timing info
2020-10-13 16:53:15.747321 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-13 16:53:15.747479 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 16:53:15.747769 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 16:53:15.747875 (Thread-1): Opening a new connection, currently in state init
2020-10-13 16:53:15.747976 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 16:53:15.757807 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-13 16:53:15.758093 (Thread-1): finished collecting timing info
2020-10-13 16:53:15.758387 (Thread-1): finished collecting timing info
2020-10-13 16:53:15.758846 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 16:53:15.759269 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-13 16:53:15.759582 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 16:53:15.759688 (Thread-1): Opening a new connection, currently in state init
2020-10-13 16:53:15.759788 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-13 16:53:15.770562 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-13 16:53:15.770838 (Thread-1): finished collecting timing info
2020-10-13 16:53:15.771123 (Thread-1): finished collecting timing info
2020-10-13 16:53:15.771572 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-13 16:53:15.772009 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-13 16:53:15.772311 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 16:53:15.772413 (Thread-1): Opening a new connection, currently in state init
2020-10-13 16:53:15.772509 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-13 16:53:15.781591 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-13 16:53:15.781849 (Thread-1): finished collecting timing info
2020-10-13 16:53:15.782119 (Thread-1): finished collecting timing info
2020-10-13 16:53:15.782540 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-13 16:53:15.819211 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-13 16:53:15.819366 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was properly closed.
2020-10-13 16:53:15.833370 (MainThread): 16:53:15 | Done.
2020-10-13 16:53:15.835240 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-13 16:53:15.835353 (MainThread): Opening a new connection, currently in state init
2020-10-13 16:53:15.835438 (MainThread): 16:53:15 | Building catalog
2020-10-13 16:53:15.867594 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-13 16:53:15.867731 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-13 16:53:15.966412 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-13 16:53:15.966569 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-13 16:53:15.969933 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-13 16:53:15.970078 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-13 16:53:15.970164 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-13 16:53:15.973213 (ThreadPoolExecutor-0_0): SQL status: SELECT 197 in 0.00 seconds
2020-10-13 16:53:15.992479 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-13 16:53:16.193760 (MainThread): 16:53:16 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-13 16:53:16.194139 (MainThread): Flushing usage events
2020-10-13 16:53:16.194282 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-13 16:53:16.194361 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-13 16:53:16.194437 (MainThread): On airflow.information_schema: Close
2020-10-13 16:53:17.485664 (MainThread): Got an exception trying to initialize tracking
2020-10-13 16:53:17.485825 (MainThread): Running with dbt=0.16.0
2020-10-13 16:53:17.570728 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-13 16:53:17.571083 (MainThread): Tracking: do not track
2020-10-13 16:53:17.580658 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-13 16:53:17.580979 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-13 16:53:17.581123 (MainThread): Press Ctrl+C to exit.


2020-10-13 17:35:43.409527 (MainThread): Got an exception trying to initialize tracking
2020-10-13 17:35:43.409679 (MainThread): Running with dbt=0.16.0
2020-10-13 17:35:43.484354 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['airflow_dbt_pg.ge_tutorials.*'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='/usr/local/airflow/dbt', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-13 17:35:43.484637 (MainThread): Tracking: do not track
2020-10-13 17:35:43.514090 (MainThread): Partial parsing not enabled
2020-10-13 17:35:43.515829 (MainThread): Parsing macros/core.sql
2020-10-13 17:35:43.522784 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 17:35:43.535804 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 17:35:43.546535 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 17:35:43.568736 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 17:35:43.576491 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 17:35:43.587727 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 17:35:43.651909 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 17:35:43.678576 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 17:35:43.681165 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 17:35:43.690674 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 17:35:43.693439 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 17:35:43.731401 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 17:35:43.733807 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 17:35:43.738624 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 17:35:43.740602 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 17:35:43.743422 (MainThread): Parsing macros/etc/query.sql
2020-10-13 17:35:43.745636 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 17:35:43.750940 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 17:35:43.753227 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 17:35:43.777919 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 17:35:43.781880 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 17:35:43.784929 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 17:35:43.786601 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 17:35:43.887269 (MainThread): Parsing macros/relations.sql
2020-10-13 17:35:43.890412 (MainThread): Parsing macros/adapters.sql
2020-10-13 17:35:43.935683 (MainThread): Parsing macros/catalog.sql
2020-10-13 17:35:43.941004 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 17:35:43.975354 (MainThread): Partial parsing not enabled
2020-10-13 17:35:44.027878 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 17:35:44.028033 (MainThread): Opening a new connection, currently in state init
2020-10-13 17:35:44.059422 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 17:35:44.059659 (MainThread): Opening a new connection, currently in state init
2020-10-13 17:35:44.072597 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 17:35:44.072813 (MainThread): Opening a new connection, currently in state init
2020-10-13 17:35:44.086511 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 17:35:44.086711 (MainThread): Opening a new connection, currently in state init
2020-10-13 17:35:44.685441 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 17:35:44.689853 (MainThread): 
2020-10-13 17:35:44.690217 (MainThread): Acquiring new postgres connection "master".
2020-10-13 17:35:44.690324 (MainThread): Opening a new connection, currently in state init
2020-10-13 17:35:44.713663 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-13 17:35:44.713808 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-13 17:35:44.847347 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-13 17:35:44.847580 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-13 17:35:44.851861 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-13 17:35:44.894379 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-13 17:35:44.895250 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-13 17:35:44.898429 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-13 17:35:44.898619 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-13 17:35:44.902765 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-13 17:35:44.902969 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-13 17:35:44.903114 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-13 17:35:44.908192 (ThreadPoolExecutor-1_0): SQL status: SELECT 27 in 0.00 seconds
2020-10-13 17:35:44.987334 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-13 17:35:45.037464 (MainThread): Using postgres connection "master".
2020-10-13 17:35:45.037676 (MainThread): On master: BEGIN
2020-10-13 17:35:45.041497 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 17:35:45.041769 (MainThread): Using postgres connection "master".
2020-10-13 17:35:45.041941 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-13 17:35:45.054016 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-10-13 17:35:45.055661 (MainThread): On master: ROLLBACK
2020-10-13 17:35:45.056057 (MainThread): Using postgres connection "master".
2020-10-13 17:35:45.056202 (MainThread): On master: BEGIN
2020-10-13 17:35:45.056704 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 17:35:45.056922 (MainThread): On master: COMMIT
2020-10-13 17:35:45.057075 (MainThread): Using postgres connection "master".
2020-10-13 17:35:45.057225 (MainThread): On master: COMMIT
2020-10-13 17:35:45.057531 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-13 17:35:45.057910 (MainThread): 17:35:45 | Concurrency: 1 threads (target='dev')
2020-10-13 17:35:45.058076 (MainThread): 17:35:45 | 
2020-10-13 17:35:45.069286 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-13 17:35:45.069544 (Thread-1): 17:35:45 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-13 17:35:45.070263 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 17:35:45.070439 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-13 17:35:45.070578 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-13 17:35:45.097794 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-13 17:35:45.098238 (Thread-1): finished collecting timing info
2020-10-13 17:35:45.157458 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 17:35:45.157733 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-13 17:35:45.158391 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 17:35:45.164219 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 17:35:45.164483 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-13 17:35:45.165683 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 17:35:45.169519 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-13 17:35:45.170503 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 17:35:45.170710 (Thread-1): On model.airflow_dbt_pg.stg_npi: BEGIN
2020-10-13 17:35:45.171185 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 17:35:45.171387 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 17:35:45.171550 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-13 17:35:45.173927 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 17:35:45.180377 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 17:35:45.180656 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-13 17:35:45.181415 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 17:35:45.183371 (Thread-1): On model.airflow_dbt_pg.stg_npi: COMMIT
2020-10-13 17:35:45.183589 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 17:35:45.183750 (Thread-1): On model.airflow_dbt_pg.stg_npi: COMMIT
2020-10-13 17:35:45.184979 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 17:35:45.189168 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 17:35:45.189456 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-13 17:35:45.190014 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 17:35:45.195911 (Thread-1): finished collecting timing info
2020-10-13 17:35:45.200176 (Thread-1): 17:35:45 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.13s]
2020-10-13 17:35:45.200477 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-13 17:35:45.200744 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 17:35:45.200991 (Thread-1): 17:35:45 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-13 17:35:45.201511 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 17:35:45.201680 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt_pg.stg_npi).
2020-10-13 17:35:45.201858 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 17:35:45.219660 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-13 17:35:45.220206 (Thread-1): finished collecting timing info
2020-10-13 17:35:45.237594 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 17:35:45.237831 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-13 17:35:45.238287 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 17:35:45.243854 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 17:35:45.244091 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-13 17:35:45.244519 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 17:35:45.248066 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-13 17:35:45.248652 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 17:35:45.248857 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: BEGIN
2020-10-13 17:35:45.249239 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 17:35:45.249433 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 17:35:45.249606 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-13 17:35:45.253749 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 17:35:45.259550 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 17:35:45.259898 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-13 17:35:45.260721 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 17:35:45.262338 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: COMMIT
2020-10-13 17:35:45.262572 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 17:35:45.262768 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: COMMIT
2020-10-13 17:35:45.264060 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 17:35:45.267261 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 17:35:45.267421 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-13 17:35:45.267816 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 17:35:45.271601 (Thread-1): finished collecting timing info
2020-10-13 17:35:45.272484 (Thread-1): 17:35:45 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.07s]
2020-10-13 17:35:45.272705 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 17:35:45.273171 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-13 17:35:45.273355 (Thread-1): 17:35:45 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-13 17:35:45.273691 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 17:35:45.273798 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt_pg.stg_state_abbreviations).
2020-10-13 17:35:45.273905 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-13 17:35:45.288604 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-13 17:35:45.288968 (Thread-1): finished collecting timing info
2020-10-13 17:35:45.302201 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 17:35:45.302384 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-13 17:35:45.302772 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 17:35:45.307719 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 17:35:45.307859 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-13 17:35:45.308191 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 17:35:45.311160 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-13 17:35:45.311799 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 17:35:45.312037 (Thread-1): On model.airflow_dbt_pg.npi_with_state: BEGIN
2020-10-13 17:35:45.312355 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 17:35:45.312539 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 17:35:45.312669 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-13 17:35:45.314853 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 17:35:45.319307 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 17:35:45.319467 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-13 17:35:45.319977 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 17:35:45.321321 (Thread-1): On model.airflow_dbt_pg.npi_with_state: COMMIT
2020-10-13 17:35:45.321456 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 17:35:45.321569 (Thread-1): On model.airflow_dbt_pg.npi_with_state: COMMIT
2020-10-13 17:35:45.322635 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 17:35:45.325524 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 17:35:45.325714 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-13 17:35:45.326295 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 17:35:45.331626 (Thread-1): finished collecting timing info
2020-10-13 17:35:45.332814 (Thread-1): 17:35:45 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.06s]
2020-10-13 17:35:45.333084 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-13 17:35:45.333660 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-13 17:35:45.333897 (Thread-1): 17:35:45 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-13 17:35:45.334394 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 17:35:45.334542 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt_pg.npi_with_state).
2020-10-13 17:35:45.334701 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-13 17:35:45.347645 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-13 17:35:45.348095 (Thread-1): finished collecting timing info
2020-10-13 17:35:45.360039 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 17:35:45.360336 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-13 17:35:45.360871 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 17:35:45.365524 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 17:35:45.365727 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-13 17:35:45.366117 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 17:35:45.368464 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-13 17:35:45.368859 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 17:35:45.368984 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: BEGIN
2020-10-13 17:35:45.369198 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 17:35:45.369330 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 17:35:45.369437 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-13 17:35:45.370751 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 17:35:45.374478 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 17:35:45.374676 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-13 17:35:45.375079 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 17:35:45.376809 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: COMMIT
2020-10-13 17:35:45.377067 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 17:35:45.377242 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: COMMIT
2020-10-13 17:35:45.378526 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 17:35:45.382016 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 17:35:45.382201 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-13 17:35:45.382618 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 17:35:45.386388 (Thread-1): finished collecting timing info
2020-10-13 17:35:45.387318 (Thread-1): 17:35:45 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.05s]
2020-10-13 17:35:45.387494 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-13 17:35:45.477480 (MainThread): Using postgres connection "master".
2020-10-13 17:35:45.478122 (MainThread): On master: BEGIN
2020-10-13 17:35:45.479114 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 17:35:45.479681 (MainThread): On master: COMMIT
2020-10-13 17:35:45.480151 (MainThread): Using postgres connection "master".
2020-10-13 17:35:45.480506 (MainThread): On master: COMMIT
2020-10-13 17:35:45.481309 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-13 17:35:45.482623 (MainThread): 17:35:45 | 
2020-10-13 17:35:45.483161 (MainThread): 17:35:45 | Finished running 4 view models in 0.79s.
2020-10-13 17:35:45.483582 (MainThread): Connection 'master' was left open.
2020-10-13 17:35:45.483968 (MainThread): On master: Close
2020-10-13 17:35:45.484470 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was left open.
2020-10-13 17:35:45.484843 (MainThread): On model.airflow_dbt_pg.count_providers_by_state: Close
2020-10-13 17:35:45.553462 (MainThread): 
2020-10-13 17:35:45.554078 (MainThread): Completed successfully
2020-10-13 17:35:45.554546 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-13 17:35:45.555165 (MainThread): Flushing usage events
2020-10-13 17:36:22.689104 (MainThread): Got an exception trying to initialize tracking
2020-10-13 17:36:22.689259 (MainThread): Running with dbt=0.16.0
2020-10-13 17:36:22.784906 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['airflow_dbt_pg.ge_tutorials.*'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='/usr/local/airflow/dbt', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-13 17:36:22.785366 (MainThread): Tracking: do not track
2020-10-13 17:36:22.830068 (MainThread): Partial parsing not enabled
2020-10-13 17:36:22.832672 (MainThread): Parsing macros/core.sql
2020-10-13 17:36:22.843308 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 17:36:22.863451 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 17:36:22.880440 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 17:36:22.917501 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 17:36:22.930332 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 17:36:22.946704 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 17:36:23.038395 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 17:36:23.076060 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 17:36:23.079413 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 17:36:23.091442 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 17:36:23.094872 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 17:36:23.138462 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 17:36:23.140484 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 17:36:23.144081 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 17:36:23.145550 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 17:36:23.147305 (MainThread): Parsing macros/etc/query.sql
2020-10-13 17:36:23.148925 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 17:36:23.152233 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 17:36:23.153893 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 17:36:23.170541 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 17:36:23.173885 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 17:36:23.176856 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 17:36:23.178600 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 17:36:23.313009 (MainThread): Parsing macros/relations.sql
2020-10-13 17:36:23.317964 (MainThread): Parsing macros/adapters.sql
2020-10-13 17:36:23.373118 (MainThread): Parsing macros/catalog.sql
2020-10-13 17:36:23.377988 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 17:36:23.410480 (MainThread): Partial parsing not enabled
2020-10-13 17:36:23.460737 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 17:36:23.460891 (MainThread): Opening a new connection, currently in state init
2020-10-13 17:36:23.488614 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 17:36:23.488784 (MainThread): Opening a new connection, currently in state init
2020-10-13 17:36:23.497274 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 17:36:23.497425 (MainThread): Opening a new connection, currently in state init
2020-10-13 17:36:23.505844 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 17:36:23.505979 (MainThread): Opening a new connection, currently in state init
2020-10-13 17:36:23.948574 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 17:36:23.953923 (MainThread): 
2020-10-13 17:36:23.954387 (MainThread): Acquiring new postgres connection "master".
2020-10-13 17:36:23.954521 (MainThread): Opening a new connection, currently in state init
2020-10-13 17:36:23.981101 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-13 17:36:23.981274 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-13 17:36:24.112860 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-13 17:36:24.113017 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-13 17:36:24.116885 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-13 17:36:24.141524 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-13 17:36:24.141794 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-13 17:36:24.143851 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-13 17:36:24.143955 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-13 17:36:24.144266 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-13 17:36:24.144377 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-13 17:36:24.144466 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-13 17:36:24.146494 (ThreadPoolExecutor-1_0): SQL status: SELECT 27 in 0.00 seconds
2020-10-13 17:36:24.175709 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-13 17:36:24.204766 (MainThread): Using postgres connection "master".
2020-10-13 17:36:24.204915 (MainThread): On master: BEGIN
2020-10-13 17:36:24.207718 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 17:36:24.207887 (MainThread): Using postgres connection "master".
2020-10-13 17:36:24.207988 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-13 17:36:24.213742 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-10-13 17:36:24.214883 (MainThread): On master: ROLLBACK
2020-10-13 17:36:24.215110 (MainThread): Using postgres connection "master".
2020-10-13 17:36:24.215218 (MainThread): On master: BEGIN
2020-10-13 17:36:24.215499 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 17:36:24.215612 (MainThread): On master: COMMIT
2020-10-13 17:36:24.215703 (MainThread): Using postgres connection "master".
2020-10-13 17:36:24.215790 (MainThread): On master: COMMIT
2020-10-13 17:36:24.215970 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-13 17:36:24.216280 (MainThread): 17:36:24 | Concurrency: 1 threads (target='dev')
2020-10-13 17:36:24.216420 (MainThread): 17:36:24 | 
2020-10-13 17:36:24.222853 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-13 17:36:24.223073 (Thread-1): 17:36:24 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-13 17:36:24.223611 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 17:36:24.223713 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-13 17:36:24.223820 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-13 17:36:24.247556 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-13 17:36:24.247911 (Thread-1): finished collecting timing info
2020-10-13 17:36:24.307339 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 17:36:24.307510 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-13 17:36:24.308083 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 17:36:24.311216 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 17:36:24.311358 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-13 17:36:24.311700 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 17:36:24.313720 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-13 17:36:24.314055 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 17:36:24.314161 (Thread-1): On model.airflow_dbt_pg.stg_npi: BEGIN
2020-10-13 17:36:24.314454 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 17:36:24.314578 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 17:36:24.314678 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-13 17:36:24.316157 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 17:36:24.319453 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 17:36:24.319568 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-13 17:36:24.319993 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 17:36:24.321054 (Thread-1): On model.airflow_dbt_pg.stg_npi: COMMIT
2020-10-13 17:36:24.321166 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 17:36:24.321262 (Thread-1): On model.airflow_dbt_pg.stg_npi: COMMIT
2020-10-13 17:36:24.322430 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 17:36:24.324892 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 17:36:24.325040 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-13 17:36:24.325367 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 17:36:24.328573 (Thread-1): finished collecting timing info
2020-10-13 17:36:24.330713 (Thread-1): 17:36:24 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.11s]
2020-10-13 17:36:24.330878 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-13 17:36:24.331046 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 17:36:24.331295 (Thread-1): 17:36:24 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-13 17:36:24.331589 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 17:36:24.331683 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt_pg.stg_npi).
2020-10-13 17:36:24.331781 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 17:36:24.341307 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-13 17:36:24.341630 (Thread-1): finished collecting timing info
2020-10-13 17:36:24.351234 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 17:36:24.351379 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-13 17:36:24.351789 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 17:36:24.354798 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 17:36:24.354905 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-13 17:36:24.355215 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 17:36:24.357053 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-13 17:36:24.357360 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 17:36:24.357461 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: BEGIN
2020-10-13 17:36:24.357750 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 17:36:24.357866 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 17:36:24.357960 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-13 17:36:24.358731 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 17:36:24.361767 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 17:36:24.361890 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-13 17:36:24.362544 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 17:36:24.363528 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: COMMIT
2020-10-13 17:36:24.363635 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 17:36:24.363727 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: COMMIT
2020-10-13 17:36:24.365293 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 17:36:24.367633 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 17:36:24.367743 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-13 17:36:24.368079 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 17:36:24.371209 (Thread-1): finished collecting timing info
2020-10-13 17:36:24.371975 (Thread-1): 17:36:24 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.04s]
2020-10-13 17:36:24.372125 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 17:36:24.372553 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-13 17:36:24.372714 (Thread-1): 17:36:24 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-13 17:36:24.373001 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 17:36:24.373093 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt_pg.stg_state_abbreviations).
2020-10-13 17:36:24.373186 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-13 17:36:24.384084 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-13 17:36:24.384388 (Thread-1): finished collecting timing info
2020-10-13 17:36:24.393984 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 17:36:24.394117 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-13 17:36:24.394537 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 17:36:24.399147 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 17:36:24.399281 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-13 17:36:24.399612 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 17:36:24.401328 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-13 17:36:24.401628 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 17:36:24.401730 (Thread-1): On model.airflow_dbt_pg.npi_with_state: BEGIN
2020-10-13 17:36:24.401986 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 17:36:24.402102 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 17:36:24.402202 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-13 17:36:24.403309 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 17:36:24.406717 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 17:36:24.406858 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-13 17:36:24.407335 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 17:36:24.408464 (Thread-1): On model.airflow_dbt_pg.npi_with_state: COMMIT
2020-10-13 17:36:24.408577 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 17:36:24.408670 (Thread-1): On model.airflow_dbt_pg.npi_with_state: COMMIT
2020-10-13 17:36:24.409721 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 17:36:24.412808 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 17:36:24.412972 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-13 17:36:24.413393 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 17:36:24.416958 (Thread-1): finished collecting timing info
2020-10-13 17:36:24.417827 (Thread-1): 17:36:24 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.04s]
2020-10-13 17:36:24.417981 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-13 17:36:24.418388 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-13 17:36:24.418550 (Thread-1): 17:36:24 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-13 17:36:24.418842 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 17:36:24.418935 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt_pg.npi_with_state).
2020-10-13 17:36:24.419031 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-13 17:36:24.429926 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-13 17:36:24.430623 (Thread-1): finished collecting timing info
2020-10-13 17:36:24.441240 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 17:36:24.441398 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-13 17:36:24.441776 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 17:36:24.445108 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 17:36:24.445237 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-13 17:36:24.445550 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 17:36:24.447570 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-13 17:36:24.447875 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 17:36:24.447981 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: BEGIN
2020-10-13 17:36:24.448165 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 17:36:24.448271 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 17:36:24.448361 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-13 17:36:24.449403 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 17:36:24.452683 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 17:36:24.452806 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-13 17:36:24.453165 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 17:36:24.454205 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: COMMIT
2020-10-13 17:36:24.454317 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 17:36:24.454413 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: COMMIT
2020-10-13 17:36:24.455377 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 17:36:24.457784 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 17:36:24.457896 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-13 17:36:24.458160 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 17:36:24.461486 (Thread-1): finished collecting timing info
2020-10-13 17:36:24.462298 (Thread-1): 17:36:24 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.04s]
2020-10-13 17:36:24.462456 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-13 17:36:24.531167 (MainThread): Using postgres connection "master".
2020-10-13 17:36:24.531322 (MainThread): On master: BEGIN
2020-10-13 17:36:24.531577 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 17:36:24.531704 (MainThread): On master: COMMIT
2020-10-13 17:36:24.531792 (MainThread): Using postgres connection "master".
2020-10-13 17:36:24.531875 (MainThread): On master: COMMIT
2020-10-13 17:36:24.532048 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-13 17:36:24.532363 (MainThread): 17:36:24 | 
2020-10-13 17:36:24.532495 (MainThread): 17:36:24 | Finished running 4 view models in 0.58s.
2020-10-13 17:36:24.532601 (MainThread): Connection 'master' was left open.
2020-10-13 17:36:24.532696 (MainThread): On master: Close
2020-10-13 17:36:24.532844 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was left open.
2020-10-13 17:36:24.532969 (MainThread): On model.airflow_dbt_pg.count_providers_by_state: Close
2020-10-13 17:36:24.549249 (MainThread): 
2020-10-13 17:36:24.549434 (MainThread): Completed successfully
2020-10-13 17:36:24.549569 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-13 17:36:24.549762 (MainThread): Flushing usage events
2020-10-13 20:52:18.112473 (MainThread): Got an exception trying to initialize tracking
2020-10-13 20:52:18.112642 (MainThread): Running with dbt=0.16.0
2020-10-13 20:52:18.209117 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-13 20:52:18.209675 (MainThread): Tracking: do not track
2020-10-13 20:52:18.261077 (MainThread): Partial parsing not enabled
2020-10-13 20:52:18.266212 (MainThread): Parsing macros/core.sql
2020-10-13 20:52:18.279972 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 20:52:18.308390 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 20:52:18.333418 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 20:52:18.376995 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 20:52:18.387201 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 20:52:18.400482 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 20:52:18.477605 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 20:52:18.512861 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 20:52:18.516578 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 20:52:18.530297 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 20:52:18.534507 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 20:52:18.581748 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 20:52:18.584314 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 20:52:18.590548 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 20:52:18.592684 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 20:52:18.595872 (MainThread): Parsing macros/etc/query.sql
2020-10-13 20:52:18.598699 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 20:52:18.604273 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 20:52:18.607332 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 20:52:18.636081 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 20:52:18.642787 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 20:52:18.647555 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 20:52:18.650439 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 20:52:18.777118 (MainThread): Parsing macros/relations.sql
2020-10-13 20:52:18.781508 (MainThread): Parsing macros/adapters.sql
2020-10-13 20:52:18.824956 (MainThread): Parsing macros/catalog.sql
2020-10-13 20:52:18.830286 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 20:52:18.869560 (MainThread): Partial parsing not enabled
2020-10-13 20:52:18.924894 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 20:52:18.925051 (MainThread): Opening a new connection, currently in state init
2020-10-13 20:52:18.952926 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 20:52:18.953064 (MainThread): Opening a new connection, currently in state init
2020-10-13 20:52:18.961280 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 20:52:18.961402 (MainThread): Opening a new connection, currently in state init
2020-10-13 20:52:18.970050 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 20:52:18.970190 (MainThread): Opening a new connection, currently in state init
2020-10-13 20:52:19.431593 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 20:52:19.436002 (MainThread): 
2020-10-13 20:52:19.436201 (MainThread): 20:52:19 | Concurrency: 1 threads (target='dev')
2020-10-13 20:52:19.436358 (MainThread): 20:52:19 | 
2020-10-13 20:52:19.443483 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-13 20:52:19.443916 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 20:52:19.444029 (Thread-1): Opening a new connection, currently in state init
2020-10-13 20:52:19.444136 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-13 20:52:19.466979 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-13 20:52:19.467816 (Thread-1): finished collecting timing info
2020-10-13 20:52:19.468190 (Thread-1): finished collecting timing info
2020-10-13 20:52:19.468765 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-13 20:52:19.468919 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 20:52:19.469201 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 20:52:19.469304 (Thread-1): Opening a new connection, currently in state init
2020-10-13 20:52:19.469403 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 20:52:19.479133 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-13 20:52:19.479426 (Thread-1): finished collecting timing info
2020-10-13 20:52:19.479714 (Thread-1): finished collecting timing info
2020-10-13 20:52:19.480175 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 20:52:19.480543 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-13 20:52:19.480824 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 20:52:19.480922 (Thread-1): Opening a new connection, currently in state init
2020-10-13 20:52:19.481015 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-13 20:52:19.491715 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-13 20:52:19.492020 (Thread-1): finished collecting timing info
2020-10-13 20:52:19.492323 (Thread-1): finished collecting timing info
2020-10-13 20:52:19.492782 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-13 20:52:19.493199 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-13 20:52:19.493504 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 20:52:19.493605 (Thread-1): Opening a new connection, currently in state init
2020-10-13 20:52:19.493701 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-13 20:52:19.502711 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-13 20:52:19.502964 (Thread-1): finished collecting timing info
2020-10-13 20:52:19.503241 (Thread-1): finished collecting timing info
2020-10-13 20:52:19.503668 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-13 20:52:19.543455 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-13 20:52:19.543612 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was properly closed.
2020-10-13 20:52:19.557409 (MainThread): 20:52:19 | Done.
2020-10-13 20:52:19.560175 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-13 20:52:19.560292 (MainThread): Opening a new connection, currently in state init
2020-10-13 20:52:19.560400 (MainThread): 20:52:19 | Building catalog
2020-10-13 20:52:19.592909 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-13 20:52:19.593071 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-13 20:52:19.754467 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-13 20:52:19.754711 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-13 20:52:19.759207 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-13 20:52:19.759447 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-13 20:52:19.759605 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-13 20:52:19.768283 (ThreadPoolExecutor-0_0): SQL status: SELECT 197 in 0.01 seconds
2020-10-13 20:52:19.791370 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-13 20:52:19.959774 (MainThread): 20:52:19 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-13 20:52:19.960307 (MainThread): Flushing usage events
2020-10-13 20:52:19.960480 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-13 20:52:19.960572 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-13 20:52:19.960658 (MainThread): On airflow.information_schema: Close
2020-10-13 20:52:21.297437 (MainThread): Got an exception trying to initialize tracking
2020-10-13 20:52:21.297631 (MainThread): Running with dbt=0.16.0
2020-10-13 20:52:21.393664 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-13 20:52:21.394084 (MainThread): Tracking: do not track
2020-10-13 20:52:21.404646 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-13 20:52:21.405000 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-13 20:52:21.405139 (MainThread): Press Ctrl+C to exit.


2020-10-14 13:45:59.197936 (MainThread): Got an exception trying to initialize tracking
2020-10-14 13:45:59.198095 (MainThread): Running with dbt=0.16.0
2020-10-14 13:45:59.282807 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-14 13:45:59.283377 (MainThread): Tracking: do not track
2020-10-14 13:45:59.382710 (MainThread): Partial parsing not enabled
2020-10-14 13:45:59.390519 (MainThread): Parsing macros/core.sql
2020-10-14 13:45:59.417762 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-14 13:45:59.434320 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-14 13:45:59.446547 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-14 13:45:59.473246 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-14 13:45:59.482750 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-14 13:45:59.495277 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-14 13:45:59.570126 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-14 13:45:59.606229 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-14 13:45:59.610433 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-14 13:45:59.627904 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-14 13:45:59.633094 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-14 13:45:59.698283 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-14 13:45:59.701278 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-14 13:45:59.706647 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-14 13:45:59.709221 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-14 13:45:59.711887 (MainThread): Parsing macros/etc/query.sql
2020-10-14 13:45:59.714325 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-14 13:45:59.719724 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-14 13:45:59.722090 (MainThread): Parsing macros/etc/datetime.sql
2020-10-14 13:45:59.745649 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-14 13:45:59.749912 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-14 13:45:59.753872 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-14 13:45:59.756651 (MainThread): Parsing macros/adapters/common.sql
2020-10-14 13:45:59.880207 (MainThread): Parsing macros/relations.sql
2020-10-14 13:45:59.884410 (MainThread): Parsing macros/adapters.sql
2020-10-14 13:45:59.934440 (MainThread): Parsing macros/catalog.sql
2020-10-14 13:45:59.940019 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-14 13:45:59.974207 (MainThread): Partial parsing not enabled
2020-10-14 13:46:00.023999 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-14 13:46:00.024148 (MainThread): Opening a new connection, currently in state init
2020-10-14 13:46:00.052210 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-14 13:46:00.052359 (MainThread): Opening a new connection, currently in state init
2020-10-14 13:46:00.061355 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-14 13:46:00.061560 (MainThread): Opening a new connection, currently in state init
2020-10-14 13:46:00.070861 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-14 13:46:00.071010 (MainThread): Opening a new connection, currently in state init
2020-10-14 13:46:00.567156 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-14 13:46:00.571988 (MainThread): 
2020-10-14 13:46:00.572214 (MainThread): 13:46:00 | Concurrency: 1 threads (target='dev')
2020-10-14 13:46:00.572376 (MainThread): 13:46:00 | 
2020-10-14 13:46:00.580972 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-14 13:46:00.581420 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-14 13:46:00.581535 (Thread-1): Opening a new connection, currently in state init
2020-10-14 13:46:00.581643 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-14 13:46:00.606678 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-14 13:46:00.607916 (Thread-1): finished collecting timing info
2020-10-14 13:46:00.608560 (Thread-1): finished collecting timing info
2020-10-14 13:46:00.609194 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-14 13:46:00.609376 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-14 13:46:00.609809 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-14 13:46:00.609927 (Thread-1): Opening a new connection, currently in state init
2020-10-14 13:46:00.610030 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-14 13:46:00.619868 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-14 13:46:00.620169 (Thread-1): finished collecting timing info
2020-10-14 13:46:00.620499 (Thread-1): finished collecting timing info
2020-10-14 13:46:00.620995 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-14 13:46:00.621411 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-14 13:46:00.621732 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-14 13:46:00.621838 (Thread-1): Opening a new connection, currently in state init
2020-10-14 13:46:00.621938 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-14 13:46:00.634189 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-14 13:46:00.634518 (Thread-1): finished collecting timing info
2020-10-14 13:46:00.634820 (Thread-1): finished collecting timing info
2020-10-14 13:46:00.635303 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-14 13:46:00.635702 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-14 13:46:00.636018 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-14 13:46:00.636124 (Thread-1): Opening a new connection, currently in state init
2020-10-14 13:46:00.636223 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-14 13:46:00.646927 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-14 13:46:00.647258 (Thread-1): finished collecting timing info
2020-10-14 13:46:00.647558 (Thread-1): finished collecting timing info
2020-10-14 13:46:00.648039 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-14 13:46:00.680800 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-14 13:46:00.680970 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was properly closed.
2020-10-14 13:46:00.698129 (MainThread): 13:46:00 | Done.
2020-10-14 13:46:00.700954 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-14 13:46:00.701075 (MainThread): Opening a new connection, currently in state init
2020-10-14 13:46:00.701173 (MainThread): 13:46:00 | Building catalog
2020-10-14 13:46:00.747011 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-14 13:46:00.747396 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-14 13:46:00.961999 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-14 13:46:00.962187 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-14 13:46:00.966187 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-14 13:46:00.966512 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-14 13:46:00.966703 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-14 13:46:00.972774 (ThreadPoolExecutor-0_0): SQL status: SELECT 197 in 0.01 seconds
2020-10-14 13:46:00.998850 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-14 13:46:01.151844 (MainThread): 13:46:01 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-14 13:46:01.152302 (MainThread): Flushing usage events
2020-10-14 13:46:01.152453 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-14 13:46:01.152541 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-14 13:46:01.152622 (MainThread): On airflow.information_schema: Close
2020-10-14 13:46:02.482213 (MainThread): Got an exception trying to initialize tracking
2020-10-14 13:46:02.482366 (MainThread): Running with dbt=0.16.0
2020-10-14 13:46:02.567207 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-14 13:46:02.567586 (MainThread): Tracking: do not track
2020-10-14 13:46:02.574316 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-14 13:46:02.574584 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-14 13:46:02.574715 (MainThread): Press Ctrl+C to exit.


2020-10-14 17:52:32.000301 (MainThread): Got an exception trying to initialize tracking
2020-10-14 17:52:32.000459 (MainThread): Running with dbt=0.16.0
2020-10-14 17:52:32.102366 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-14 17:52:32.102840 (MainThread): Tracking: do not track
2020-10-14 17:52:32.144845 (MainThread): Partial parsing not enabled
2020-10-14 17:52:32.147455 (MainThread): Parsing macros/core.sql
2020-10-14 17:52:32.157605 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-14 17:52:32.176620 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-14 17:52:32.191453 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-14 17:52:32.221708 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-14 17:52:32.231937 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-14 17:52:32.249264 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-14 17:52:32.368066 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-14 17:52:32.399764 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-14 17:52:32.402540 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-14 17:52:32.412697 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-14 17:52:32.415672 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-14 17:52:32.453493 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-14 17:52:32.455266 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-14 17:52:32.458418 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-14 17:52:32.459697 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-14 17:52:32.461288 (MainThread): Parsing macros/etc/query.sql
2020-10-14 17:52:32.462808 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-14 17:52:32.465901 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-14 17:52:32.467417 (MainThread): Parsing macros/etc/datetime.sql
2020-10-14 17:52:32.484634 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-14 17:52:32.488369 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-14 17:52:32.491265 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-14 17:52:32.492926 (MainThread): Parsing macros/adapters/common.sql
2020-10-14 17:52:32.591568 (MainThread): Parsing macros/relations.sql
2020-10-14 17:52:32.595048 (MainThread): Parsing macros/adapters.sql
2020-10-14 17:52:32.644664 (MainThread): Parsing macros/catalog.sql
2020-10-14 17:52:32.650945 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-14 17:52:32.688901 (MainThread): Partial parsing not enabled
2020-10-14 17:52:32.748121 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-14 17:52:32.748291 (MainThread): Opening a new connection, currently in state init
2020-10-14 17:52:32.777522 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-14 17:52:32.777690 (MainThread): Opening a new connection, currently in state init
2020-10-14 17:52:32.786834 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-14 17:52:32.786997 (MainThread): Opening a new connection, currently in state init
2020-10-14 17:52:32.796377 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-14 17:52:32.796547 (MainThread): Opening a new connection, currently in state init
2020-10-14 17:52:33.338073 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-14 17:52:33.343411 (MainThread): 
2020-10-14 17:52:33.343660 (MainThread): 17:52:33 | Concurrency: 1 threads (target='dev')
2020-10-14 17:52:33.343830 (MainThread): 17:52:33 | 
2020-10-14 17:52:33.352642 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-14 17:52:33.353156 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-14 17:52:33.353290 (Thread-1): Opening a new connection, currently in state init
2020-10-14 17:52:33.353418 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-14 17:52:33.378828 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-14 17:52:33.379170 (Thread-1): finished collecting timing info
2020-10-14 17:52:33.379489 (Thread-1): finished collecting timing info
2020-10-14 17:52:33.379988 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-14 17:52:33.380154 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-14 17:52:33.380446 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-14 17:52:33.380552 (Thread-1): Opening a new connection, currently in state init
2020-10-14 17:52:33.380653 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-14 17:52:33.391261 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-14 17:52:33.391712 (Thread-1): finished collecting timing info
2020-10-14 17:52:33.392179 (Thread-1): finished collecting timing info
2020-10-14 17:52:33.392920 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-14 17:52:33.393487 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-14 17:52:33.393954 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-14 17:52:33.394071 (Thread-1): Opening a new connection, currently in state init
2020-10-14 17:52:33.394179 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-14 17:52:33.408044 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-14 17:52:33.408391 (Thread-1): finished collecting timing info
2020-10-14 17:52:33.408726 (Thread-1): finished collecting timing info
2020-10-14 17:52:33.409221 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-14 17:52:33.409638 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-14 17:52:33.409963 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-14 17:52:33.410067 (Thread-1): Opening a new connection, currently in state init
2020-10-14 17:52:33.410165 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-14 17:52:33.420396 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-14 17:52:33.420713 (Thread-1): finished collecting timing info
2020-10-14 17:52:33.421014 (Thread-1): finished collecting timing info
2020-10-14 17:52:33.421491 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-14 17:52:33.452714 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-14 17:52:33.452951 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was properly closed.
2020-10-14 17:52:33.475869 (MainThread): 17:52:33 | Done.
2020-10-14 17:52:33.478447 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-14 17:52:33.478582 (MainThread): Opening a new connection, currently in state init
2020-10-14 17:52:33.478688 (MainThread): 17:52:33 | Building catalog
2020-10-14 17:52:33.513539 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-14 17:52:33.513702 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-14 17:52:33.631620 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-14 17:52:33.631769 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-14 17:52:33.635038 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-14 17:52:33.635184 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-14 17:52:33.635276 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-14 17:52:33.638367 (ThreadPoolExecutor-0_0): SQL status: SELECT 197 in 0.00 seconds
2020-10-14 17:52:33.661990 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-14 17:52:33.881049 (MainThread): 17:52:33 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-14 17:52:33.881566 (MainThread): Flushing usage events
2020-10-14 17:52:33.881747 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-14 17:52:33.881844 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-14 17:52:33.881935 (MainThread): On airflow.information_schema: Close
2020-10-14 17:52:35.389730 (MainThread): Got an exception trying to initialize tracking
2020-10-14 17:52:35.389908 (MainThread): Running with dbt=0.16.0
2020-10-14 17:52:35.501572 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-14 17:52:35.502189 (MainThread): Tracking: do not track
2020-10-14 17:52:35.512111 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-14 17:52:35.512544 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-14 17:52:35.512744 (MainThread): Press Ctrl+C to exit.


2020-10-15 01:59:29.009629 (MainThread): Got an exception trying to initialize tracking
2020-10-15 01:59:29.009792 (MainThread): Running with dbt=0.16.0
2020-10-15 01:59:29.101247 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-15 01:59:29.101813 (MainThread): Tracking: do not track
2020-10-15 01:59:29.161757 (MainThread): Partial parsing not enabled
2020-10-15 01:59:29.168423 (MainThread): Parsing macros/core.sql
2020-10-15 01:59:29.184520 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-15 01:59:29.211528 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-15 01:59:29.235488 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-15 01:59:29.266849 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-15 01:59:29.277556 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-15 01:59:29.292190 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-15 01:59:29.373485 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-15 01:59:29.415888 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-15 01:59:29.421248 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-15 01:59:29.437515 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-15 01:59:29.441759 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-15 01:59:29.496238 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-15 01:59:29.499268 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-15 01:59:29.504190 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-15 01:59:29.506635 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-15 01:59:29.509090 (MainThread): Parsing macros/etc/query.sql
2020-10-15 01:59:29.511693 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-15 01:59:29.517149 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-15 01:59:29.519885 (MainThread): Parsing macros/etc/datetime.sql
2020-10-15 01:59:29.545624 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-15 01:59:29.551877 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-15 01:59:29.555948 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-15 01:59:29.558365 (MainThread): Parsing macros/adapters/common.sql
2020-10-15 01:59:29.668875 (MainThread): Parsing macros/relations.sql
2020-10-15 01:59:29.672281 (MainThread): Parsing macros/adapters.sql
2020-10-15 01:59:29.715247 (MainThread): Parsing macros/catalog.sql
2020-10-15 01:59:29.721389 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-15 01:59:29.759715 (MainThread): Partial parsing not enabled
2020-10-15 01:59:29.816126 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-15 01:59:29.816283 (MainThread): Opening a new connection, currently in state init
2020-10-15 01:59:29.844173 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-15 01:59:29.844334 (MainThread): Opening a new connection, currently in state init
2020-10-15 01:59:29.852943 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-15 01:59:29.853091 (MainThread): Opening a new connection, currently in state init
2020-10-15 01:59:29.862084 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-15 01:59:29.862239 (MainThread): Opening a new connection, currently in state init
2020-10-15 01:59:30.356029 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-15 01:59:30.360516 (MainThread): 
2020-10-15 01:59:30.360722 (MainThread): 01:59:30 | Concurrency: 1 threads (target='dev')
2020-10-15 01:59:30.360884 (MainThread): 01:59:30 | 
2020-10-15 01:59:30.369943 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-15 01:59:30.370386 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-15 01:59:30.370516 (Thread-1): Opening a new connection, currently in state init
2020-10-15 01:59:30.370630 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-15 01:59:30.393900 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-15 01:59:30.394656 (Thread-1): finished collecting timing info
2020-10-15 01:59:30.394985 (Thread-1): finished collecting timing info
2020-10-15 01:59:30.395476 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-15 01:59:30.395635 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-15 01:59:30.395930 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-15 01:59:30.396039 (Thread-1): Opening a new connection, currently in state init
2020-10-15 01:59:30.396142 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-15 01:59:30.405915 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-15 01:59:30.406198 (Thread-1): finished collecting timing info
2020-10-15 01:59:30.406484 (Thread-1): finished collecting timing info
2020-10-15 01:59:30.406928 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-15 01:59:30.407363 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-15 01:59:30.407664 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-15 01:59:30.407767 (Thread-1): Opening a new connection, currently in state init
2020-10-15 01:59:30.407864 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-15 01:59:30.418479 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-15 01:59:30.418782 (Thread-1): finished collecting timing info
2020-10-15 01:59:30.419072 (Thread-1): finished collecting timing info
2020-10-15 01:59:30.419528 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-15 01:59:30.419979 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-15 01:59:30.420285 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-15 01:59:30.420389 (Thread-1): Opening a new connection, currently in state init
2020-10-15 01:59:30.420487 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-15 01:59:30.429646 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-15 01:59:30.429931 (Thread-1): finished collecting timing info
2020-10-15 01:59:30.430213 (Thread-1): finished collecting timing info
2020-10-15 01:59:30.430675 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-15 01:59:30.469888 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-15 01:59:30.470056 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was properly closed.
2020-10-15 01:59:30.485934 (MainThread): 01:59:30 | Done.
2020-10-15 01:59:30.488712 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-15 01:59:30.488833 (MainThread): Opening a new connection, currently in state init
2020-10-15 01:59:30.488927 (MainThread): 01:59:30 | Building catalog
2020-10-15 01:59:30.524340 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-15 01:59:30.524503 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-15 01:59:30.695727 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-15 01:59:30.695925 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-15 01:59:30.699254 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-15 01:59:30.699460 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-15 01:59:30.699603 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-15 01:59:30.704566 (ThreadPoolExecutor-0_0): SQL status: SELECT 197 in 0.00 seconds
2020-10-15 01:59:30.735426 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-15 01:59:30.916438 (MainThread): 01:59:30 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-15 01:59:30.916987 (MainThread): Flushing usage events
2020-10-15 01:59:30.917158 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-15 01:59:30.917251 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-15 01:59:30.917340 (MainThread): On airflow.information_schema: Close
2020-10-15 01:59:32.354177 (MainThread): Got an exception trying to initialize tracking
2020-10-15 01:59:32.354326 (MainThread): Running with dbt=0.16.0
2020-10-15 01:59:32.440279 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-15 01:59:32.440681 (MainThread): Tracking: do not track
2020-10-15 01:59:32.448864 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-15 01:59:32.449176 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-15 01:59:32.449344 (MainThread): Press Ctrl+C to exit.


2020-10-15 02:14:26.087587 (MainThread): Got an exception trying to initialize tracking
2020-10-15 02:14:26.087773 (MainThread): Running with dbt=0.16.0
2020-10-15 02:14:26.186326 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-15 02:14:26.193049 (MainThread): Tracking: do not track
2020-10-15 02:14:26.234081 (MainThread): Partial parsing not enabled
2020-10-15 02:14:26.236441 (MainThread): Parsing macros/core.sql
2020-10-15 02:14:26.245523 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-15 02:14:26.262107 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-15 02:14:26.276453 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-15 02:14:26.307416 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-15 02:14:26.320244 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-15 02:14:26.343627 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-15 02:14:26.460033 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-15 02:14:26.494807 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-15 02:14:26.498042 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-15 02:14:26.510588 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-15 02:14:26.514059 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-15 02:14:26.580085 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-15 02:14:26.583188 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-15 02:14:26.588235 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-15 02:14:26.590365 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-15 02:14:26.592888 (MainThread): Parsing macros/etc/query.sql
2020-10-15 02:14:26.595212 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-15 02:14:26.600436 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-15 02:14:26.602772 (MainThread): Parsing macros/etc/datetime.sql
2020-10-15 02:14:26.625043 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-15 02:14:26.629327 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-15 02:14:26.632772 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-15 02:14:26.634855 (MainThread): Parsing macros/adapters/common.sql
2020-10-15 02:14:26.784550 (MainThread): Parsing macros/relations.sql
2020-10-15 02:14:26.789504 (MainThread): Parsing macros/adapters.sql
2020-10-15 02:14:26.856605 (MainThread): Parsing macros/catalog.sql
2020-10-15 02:14:26.864057 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-15 02:14:26.911757 (MainThread): Partial parsing not enabled
2020-10-15 02:14:26.997899 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-15 02:14:26.998156 (MainThread): Opening a new connection, currently in state init
2020-10-15 02:14:27.054936 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-15 02:14:27.055270 (MainThread): Opening a new connection, currently in state init
2020-10-15 02:14:27.074187 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-15 02:14:27.074499 (MainThread): Opening a new connection, currently in state init
2020-10-15 02:14:27.094030 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-15 02:14:27.094330 (MainThread): Opening a new connection, currently in state init
2020-10-15 02:14:27.831747 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-15 02:14:27.837371 (MainThread): 
2020-10-15 02:14:27.837751 (MainThread): 02:14:27 | Concurrency: 1 threads (target='dev')
2020-10-15 02:14:27.837975 (MainThread): 02:14:27 | 
2020-10-15 02:14:27.846588 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-15 02:14:27.847095 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-15 02:14:27.847245 (Thread-1): Opening a new connection, currently in state init
2020-10-15 02:14:27.847367 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-15 02:14:27.880291 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-15 02:14:27.880769 (Thread-1): finished collecting timing info
2020-10-15 02:14:27.881287 (Thread-1): finished collecting timing info
2020-10-15 02:14:27.882073 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-15 02:14:27.882332 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-15 02:14:27.882914 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-15 02:14:27.883087 (Thread-1): Opening a new connection, currently in state init
2020-10-15 02:14:27.883253 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-15 02:14:27.898188 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-15 02:14:27.898556 (Thread-1): finished collecting timing info
2020-10-15 02:14:27.898905 (Thread-1): finished collecting timing info
2020-10-15 02:14:27.899487 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-15 02:14:27.900029 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-15 02:14:27.900398 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-15 02:14:27.900522 (Thread-1): Opening a new connection, currently in state init
2020-10-15 02:14:27.900637 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-15 02:14:27.914867 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-15 02:14:27.915206 (Thread-1): finished collecting timing info
2020-10-15 02:14:27.915603 (Thread-1): finished collecting timing info
2020-10-15 02:14:27.916256 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-15 02:14:27.916716 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-15 02:14:27.917081 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-15 02:14:27.917237 (Thread-1): Opening a new connection, currently in state init
2020-10-15 02:14:27.917365 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-15 02:14:27.929307 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-15 02:14:27.929654 (Thread-1): finished collecting timing info
2020-10-15 02:14:27.930007 (Thread-1): finished collecting timing info
2020-10-15 02:14:27.930568 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-15 02:14:27.946497 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-15 02:14:27.946666 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was properly closed.
2020-10-15 02:14:27.966639 (MainThread): 02:14:27 | Done.
2020-10-15 02:14:27.968703 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-15 02:14:27.968836 (MainThread): Opening a new connection, currently in state init
2020-10-15 02:14:27.968941 (MainThread): 02:14:27 | Building catalog
2020-10-15 02:14:28.010487 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-15 02:14:28.010660 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-15 02:14:28.145944 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-15 02:14:28.146102 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-15 02:14:28.149555 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-15 02:14:28.149769 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-15 02:14:28.149907 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-15 02:14:28.153343 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.00 seconds
2020-10-15 02:14:28.180807 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-15 02:14:28.399837 (MainThread): 02:14:28 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-15 02:14:28.400280 (MainThread): Flushing usage events
2020-10-15 02:14:28.400446 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-15 02:14:28.400539 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-15 02:14:28.400629 (MainThread): On airflow.information_schema: Close
2020-10-15 02:14:30.073077 (MainThread): Got an exception trying to initialize tracking
2020-10-15 02:14:30.073347 (MainThread): Running with dbt=0.16.0
2020-10-15 02:14:30.190664 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-15 02:14:30.191275 (MainThread): Tracking: do not track
2020-10-15 02:14:30.204386 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-15 02:14:30.205216 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-15 02:14:30.205519 (MainThread): Press Ctrl+C to exit.


2020-10-15 03:23:50.453372 (MainThread): Got an exception trying to initialize tracking
2020-10-15 03:23:50.453556 (MainThread): Running with dbt=0.16.0
2020-10-15 03:23:50.554931 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-15 03:23:50.555403 (MainThread): Tracking: do not track
2020-10-15 03:23:50.599652 (MainThread): Partial parsing not enabled
2020-10-15 03:23:50.601942 (MainThread): Parsing macros/core.sql
2020-10-15 03:23:50.611448 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-15 03:23:50.630183 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-15 03:23:50.645877 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-15 03:23:50.696724 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-15 03:23:50.714121 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-15 03:23:50.736956 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-15 03:23:50.828539 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-15 03:23:50.866463 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-15 03:23:50.869823 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-15 03:23:50.883376 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-15 03:23:50.886936 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-15 03:23:50.935158 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-15 03:23:50.937361 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-15 03:23:50.941426 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-15 03:23:50.943055 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-15 03:23:50.945922 (MainThread): Parsing macros/etc/query.sql
2020-10-15 03:23:50.948172 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-15 03:23:50.952196 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-15 03:23:50.954035 (MainThread): Parsing macros/etc/datetime.sql
2020-10-15 03:23:50.976368 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-15 03:23:50.982602 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-15 03:23:50.985933 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-15 03:23:50.987724 (MainThread): Parsing macros/adapters/common.sql
2020-10-15 03:23:51.134991 (MainThread): Parsing macros/relations.sql
2020-10-15 03:23:51.139064 (MainThread): Parsing macros/adapters.sql
2020-10-15 03:23:51.189109 (MainThread): Parsing macros/catalog.sql
2020-10-15 03:23:51.196444 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-15 03:23:51.239286 (MainThread): Partial parsing not enabled
2020-10-15 03:23:51.304708 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-15 03:23:51.304930 (MainThread): Opening a new connection, currently in state init
2020-10-15 03:23:51.345000 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-15 03:23:51.345262 (MainThread): Opening a new connection, currently in state init
2020-10-15 03:23:51.356462 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-15 03:23:51.356636 (MainThread): Opening a new connection, currently in state init
2020-10-15 03:23:51.369178 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-15 03:23:51.369487 (MainThread): Opening a new connection, currently in state init
2020-10-15 03:23:51.949579 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-15 03:23:51.954573 (MainThread): 
2020-10-15 03:23:51.954801 (MainThread): 03:23:51 | Concurrency: 1 threads (target='dev')
2020-10-15 03:23:51.954963 (MainThread): 03:23:51 | 
2020-10-15 03:23:51.964042 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-15 03:23:51.964627 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-15 03:23:51.964763 (Thread-1): Opening a new connection, currently in state init
2020-10-15 03:23:51.964885 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-15 03:23:51.990796 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-15 03:23:51.991139 (Thread-1): finished collecting timing info
2020-10-15 03:23:51.991472 (Thread-1): finished collecting timing info
2020-10-15 03:23:51.992009 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-15 03:23:51.992183 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-15 03:23:51.992587 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-15 03:23:51.992697 (Thread-1): Opening a new connection, currently in state init
2020-10-15 03:23:51.992815 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-15 03:23:52.004268 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-15 03:23:52.004582 (Thread-1): finished collecting timing info
2020-10-15 03:23:52.004922 (Thread-1): finished collecting timing info
2020-10-15 03:23:52.005396 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-15 03:23:52.005790 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-15 03:23:52.006105 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-15 03:23:52.006211 (Thread-1): Opening a new connection, currently in state init
2020-10-15 03:23:52.006310 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-15 03:23:52.019834 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-15 03:23:52.020173 (Thread-1): finished collecting timing info
2020-10-15 03:23:52.020486 (Thread-1): finished collecting timing info
2020-10-15 03:23:52.020993 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-15 03:23:52.021384 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-15 03:23:52.021698 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-15 03:23:52.021812 (Thread-1): Opening a new connection, currently in state init
2020-10-15 03:23:52.021913 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-15 03:23:52.032942 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-15 03:23:52.033283 (Thread-1): finished collecting timing info
2020-10-15 03:23:52.033597 (Thread-1): finished collecting timing info
2020-10-15 03:23:52.034104 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-15 03:23:52.063781 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-15 03:23:52.063948 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was properly closed.
2020-10-15 03:23:52.080509 (MainThread): 03:23:52 | Done.
2020-10-15 03:23:52.082459 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-15 03:23:52.082603 (MainThread): Opening a new connection, currently in state init
2020-10-15 03:23:52.082701 (MainThread): 03:23:52 | Building catalog
2020-10-15 03:23:52.121461 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-15 03:23:52.121623 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-15 03:23:52.252288 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-15 03:23:52.252590 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-15 03:23:52.256788 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-15 03:23:52.256971 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-15 03:23:52.257081 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-15 03:23:52.262475 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.01 seconds
2020-10-15 03:23:52.288445 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-15 03:23:52.525000 (MainThread): 03:23:52 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-15 03:23:52.525557 (MainThread): Flushing usage events
2020-10-15 03:23:52.525770 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-15 03:23:52.525885 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-15 03:23:52.525993 (MainThread): On airflow.information_schema: Close
2020-10-15 03:23:54.184891 (MainThread): Got an exception trying to initialize tracking
2020-10-15 03:23:54.185058 (MainThread): Running with dbt=0.16.0
2020-10-15 03:23:54.296000 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-15 03:23:54.296506 (MainThread): Tracking: do not track
2020-10-15 03:23:54.307881 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-15 03:23:54.308272 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-15 03:23:54.308553 (MainThread): Press Ctrl+C to exit.


2020-10-15 03:57:00.840132 (MainThread): Got an exception trying to initialize tracking
2020-10-15 03:57:00.840318 (MainThread): Running with dbt=0.16.0
2020-10-15 03:57:00.965255 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['airflow_dbt_pg.ge_tutorials.*'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='/usr/local/airflow/dbt', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-15 03:57:00.967752 (MainThread): Tracking: do not track
2020-10-15 03:57:01.022604 (MainThread): Partial parsing not enabled
2020-10-15 03:57:01.026047 (MainThread): Parsing macros/core.sql
2020-10-15 03:57:01.038226 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-15 03:57:01.065924 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-15 03:57:01.085469 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-15 03:57:01.120457 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-15 03:57:01.133692 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-15 03:57:01.148916 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-15 03:57:01.228165 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-15 03:57:01.266569 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-15 03:57:01.270613 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-15 03:57:01.284159 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-15 03:57:01.289573 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-15 03:57:01.347724 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-15 03:57:01.350126 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-15 03:57:01.355359 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-15 03:57:01.357505 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-15 03:57:01.360407 (MainThread): Parsing macros/etc/query.sql
2020-10-15 03:57:01.363077 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-15 03:57:01.367787 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-15 03:57:01.370639 (MainThread): Parsing macros/etc/datetime.sql
2020-10-15 03:57:01.393504 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-15 03:57:01.397710 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-15 03:57:01.401067 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-15 03:57:01.403047 (MainThread): Parsing macros/adapters/common.sql
2020-10-15 03:57:01.510965 (MainThread): Parsing macros/relations.sql
2020-10-15 03:57:01.514796 (MainThread): Parsing macros/adapters.sql
2020-10-15 03:57:01.564380 (MainThread): Parsing macros/catalog.sql
2020-10-15 03:57:01.570466 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-15 03:57:01.610571 (MainThread): Partial parsing not enabled
2020-10-15 03:57:01.667347 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-15 03:57:01.667499 (MainThread): Opening a new connection, currently in state init
2020-10-15 03:57:01.698453 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-15 03:57:01.698600 (MainThread): Opening a new connection, currently in state init
2020-10-15 03:57:01.708395 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-15 03:57:01.708556 (MainThread): Opening a new connection, currently in state init
2020-10-15 03:57:01.717454 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-15 03:57:01.717594 (MainThread): Opening a new connection, currently in state init
2020-10-15 03:57:02.335059 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-15 03:57:02.340070 (MainThread): 
2020-10-15 03:57:02.340567 (MainThread): Acquiring new postgres connection "master".
2020-10-15 03:57:02.340698 (MainThread): Opening a new connection, currently in state init
2020-10-15 03:57:02.368646 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-15 03:57:02.368894 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-15 03:57:02.541785 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-15 03:57:02.541997 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-15 03:57:02.546026 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-15 03:57:02.577737 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-15 03:57:02.578046 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-15 03:57:02.580785 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-15 03:57:02.580953 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-15 03:57:02.581374 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-15 03:57:02.581524 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-15 03:57:02.581644 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-15 03:57:02.588201 (ThreadPoolExecutor-1_0): SQL status: SELECT 27 in 0.01 seconds
2020-10-15 03:57:02.630008 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-15 03:57:02.665326 (MainThread): Using postgres connection "master".
2020-10-15 03:57:02.665487 (MainThread): On master: BEGIN
2020-10-15 03:57:02.668600 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-15 03:57:02.668764 (MainThread): Using postgres connection "master".
2020-10-15 03:57:02.668891 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-15 03:57:02.676331 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-10-15 03:57:02.677605 (MainThread): On master: ROLLBACK
2020-10-15 03:57:02.677926 (MainThread): Using postgres connection "master".
2020-10-15 03:57:02.678050 (MainThread): On master: BEGIN
2020-10-15 03:57:02.678471 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-15 03:57:02.678611 (MainThread): On master: COMMIT
2020-10-15 03:57:02.678714 (MainThread): Using postgres connection "master".
2020-10-15 03:57:02.678810 (MainThread): On master: COMMIT
2020-10-15 03:57:02.679086 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-15 03:57:02.679440 (MainThread): 03:57:02 | Concurrency: 1 threads (target='dev')
2020-10-15 03:57:02.679597 (MainThread): 03:57:02 | 
2020-10-15 03:57:02.686797 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-15 03:57:02.687860 (Thread-1): 03:57:02 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-15 03:57:02.688604 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-15 03:57:02.688728 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-15 03:57:02.688851 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-15 03:57:02.714009 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-15 03:57:02.714330 (Thread-1): finished collecting timing info
2020-10-15 03:57:02.771404 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-15 03:57:02.771590 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-15 03:57:02.772090 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-15 03:57:02.775347 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-15 03:57:02.775506 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-15 03:57:02.775867 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-15 03:57:02.777883 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-15 03:57:02.778951 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-15 03:57:02.779069 (Thread-1): On model.airflow_dbt_pg.stg_npi: BEGIN
2020-10-15 03:57:02.779325 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-15 03:57:02.779436 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-15 03:57:02.779613 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-15 03:57:02.781187 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-15 03:57:02.784576 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-15 03:57:02.784712 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-15 03:57:02.785104 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-15 03:57:02.786261 (Thread-1): On model.airflow_dbt_pg.stg_npi: COMMIT
2020-10-15 03:57:02.786529 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-15 03:57:02.786692 (Thread-1): On model.airflow_dbt_pg.stg_npi: COMMIT
2020-10-15 03:57:02.788507 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-15 03:57:02.792637 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-15 03:57:02.792856 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-15 03:57:02.793272 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-15 03:57:02.796551 (Thread-1): finished collecting timing info
2020-10-15 03:57:02.798646 (Thread-1): 03:57:02 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.11s]
2020-10-15 03:57:02.798827 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-15 03:57:02.799022 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-15 03:57:02.799177 (Thread-1): 03:57:02 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-15 03:57:02.799564 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-15 03:57:02.799664 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt_pg.stg_npi).
2020-10-15 03:57:02.799761 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-15 03:57:02.809812 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-15 03:57:02.810148 (Thread-1): finished collecting timing info
2020-10-15 03:57:02.823555 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-15 03:57:02.823778 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-15 03:57:02.824234 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-15 03:57:02.827581 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-15 03:57:02.827728 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-15 03:57:02.828119 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-15 03:57:02.830093 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-15 03:57:02.830420 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-15 03:57:02.830549 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: BEGIN
2020-10-15 03:57:02.830838 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-15 03:57:02.830958 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-15 03:57:02.831055 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-15 03:57:02.831780 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-15 03:57:02.834931 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-15 03:57:02.835045 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-15 03:57:02.835462 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-15 03:57:02.836578 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: COMMIT
2020-10-15 03:57:02.836739 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-15 03:57:02.836873 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: COMMIT
2020-10-15 03:57:02.838104 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-15 03:57:02.840924 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-15 03:57:02.841079 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-15 03:57:02.841431 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-15 03:57:02.844802 (Thread-1): finished collecting timing info
2020-10-15 03:57:02.845627 (Thread-1): 03:57:02 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.05s]
2020-10-15 03:57:02.845802 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-15 03:57:02.846237 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-15 03:57:02.846391 (Thread-1): 03:57:02 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-15 03:57:02.846740 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-15 03:57:02.846841 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt_pg.stg_state_abbreviations).
2020-10-15 03:57:02.846938 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-15 03:57:02.861991 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-15 03:57:02.862402 (Thread-1): finished collecting timing info
2020-10-15 03:57:02.873884 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-15 03:57:02.874068 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-15 03:57:02.874482 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-15 03:57:02.879375 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-15 03:57:02.879533 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-15 03:57:02.879901 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-15 03:57:02.881737 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-15 03:57:02.882069 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-15 03:57:02.882179 (Thread-1): On model.airflow_dbt_pg.npi_with_state: BEGIN
2020-10-15 03:57:02.882387 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-15 03:57:02.882535 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-15 03:57:02.882649 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-15 03:57:02.884472 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-15 03:57:02.890182 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-15 03:57:02.890466 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-15 03:57:02.891247 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-15 03:57:02.892528 (Thread-1): On model.airflow_dbt_pg.npi_with_state: COMMIT
2020-10-15 03:57:02.892684 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-15 03:57:02.892792 (Thread-1): On model.airflow_dbt_pg.npi_with_state: COMMIT
2020-10-15 03:57:02.893946 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-15 03:57:02.896700 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-15 03:57:02.896840 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-15 03:57:02.897188 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-15 03:57:02.900630 (Thread-1): finished collecting timing info
2020-10-15 03:57:02.901482 (Thread-1): 03:57:02 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.05s]
2020-10-15 03:57:02.901664 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-15 03:57:02.902134 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-15 03:57:02.902330 (Thread-1): 03:57:02 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-15 03:57:02.902700 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-15 03:57:02.902819 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt_pg.npi_with_state).
2020-10-15 03:57:02.902955 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-15 03:57:02.913302 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-15 03:57:02.913651 (Thread-1): finished collecting timing info
2020-10-15 03:57:02.926883 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-15 03:57:02.927066 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-15 03:57:02.927485 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-15 03:57:02.931156 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-15 03:57:02.931314 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-15 03:57:02.931686 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-15 03:57:02.933889 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-15 03:57:02.934261 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-15 03:57:02.934380 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: BEGIN
2020-10-15 03:57:02.934685 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-15 03:57:02.934818 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-15 03:57:02.934924 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-15 03:57:02.936266 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-15 03:57:02.940396 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-15 03:57:02.940571 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-15 03:57:02.941075 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-15 03:57:02.942339 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: COMMIT
2020-10-15 03:57:02.942517 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-15 03:57:02.942627 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: COMMIT
2020-10-15 03:57:02.943724 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-15 03:57:02.946569 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-15 03:57:02.946720 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-15 03:57:02.947046 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-15 03:57:02.950702 (Thread-1): finished collecting timing info
2020-10-15 03:57:02.951620 (Thread-1): 03:57:02 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.05s]
2020-10-15 03:57:02.951825 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-15 03:57:02.991485 (MainThread): Using postgres connection "master".
2020-10-15 03:57:02.991736 (MainThread): On master: BEGIN
2020-10-15 03:57:02.992129 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-15 03:57:02.992327 (MainThread): On master: COMMIT
2020-10-15 03:57:02.992487 (MainThread): Using postgres connection "master".
2020-10-15 03:57:02.992642 (MainThread): On master: COMMIT
2020-10-15 03:57:02.992917 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-15 03:57:02.993496 (MainThread): 03:57:02 | 
2020-10-15 03:57:02.993699 (MainThread): 03:57:02 | Finished running 4 view models in 0.65s.
2020-10-15 03:57:02.993905 (MainThread): Connection 'master' was left open.
2020-10-15 03:57:02.994052 (MainThread): On master: Close
2020-10-15 03:57:02.994233 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was left open.
2020-10-15 03:57:02.994345 (MainThread): On model.airflow_dbt_pg.count_providers_by_state: Close
2020-10-15 03:57:03.014747 (MainThread): 
2020-10-15 03:57:03.014985 (MainThread): Completed successfully
2020-10-15 03:57:03.015223 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-15 03:57:03.015537 (MainThread): Flushing usage events
2020-10-15 14:11:37.731212 (MainThread): Got an exception trying to initialize tracking
2020-10-15 14:11:37.731376 (MainThread): Running with dbt=0.16.0
2020-10-15 14:11:37.833057 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-15 14:11:37.835859 (MainThread): Tracking: do not track
2020-10-15 14:11:37.913217 (MainThread): Partial parsing not enabled
2020-10-15 14:11:37.920198 (MainThread): Parsing macros/core.sql
2020-10-15 14:11:37.937479 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-15 14:11:37.956131 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-15 14:11:37.971544 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-15 14:11:38.003422 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-15 14:11:38.016061 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-15 14:11:38.030061 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-15 14:11:38.109416 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-15 14:11:38.147829 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-15 14:11:38.152236 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-15 14:11:38.166558 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-15 14:11:38.171122 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-15 14:11:38.240198 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-15 14:11:38.244194 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-15 14:11:38.251351 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-15 14:11:38.253918 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-15 14:11:38.256815 (MainThread): Parsing macros/etc/query.sql
2020-10-15 14:11:38.259937 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-15 14:11:38.267836 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-15 14:11:38.271844 (MainThread): Parsing macros/etc/datetime.sql
2020-10-15 14:11:38.300797 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-15 14:11:38.305253 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-15 14:11:38.308732 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-15 14:11:38.310995 (MainThread): Parsing macros/adapters/common.sql
2020-10-15 14:11:38.447218 (MainThread): Parsing macros/relations.sql
2020-10-15 14:11:38.452803 (MainThread): Parsing macros/adapters.sql
2020-10-15 14:11:38.519315 (MainThread): Parsing macros/catalog.sql
2020-10-15 14:11:38.527161 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-15 14:11:38.577609 (MainThread): Partial parsing not enabled
2020-10-15 14:11:38.638414 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-15 14:11:38.638572 (MainThread): Opening a new connection, currently in state init
2020-10-15 14:11:38.669882 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-15 14:11:38.670032 (MainThread): Opening a new connection, currently in state init
2020-10-15 14:11:38.678828 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-15 14:11:38.678968 (MainThread): Opening a new connection, currently in state init
2020-10-15 14:11:38.688685 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-15 14:11:38.688829 (MainThread): Opening a new connection, currently in state init
2020-10-15 14:11:39.191138 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-15 14:11:39.195490 (MainThread): 
2020-10-15 14:11:39.195684 (MainThread): 14:11:39 | Concurrency: 1 threads (target='dev')
2020-10-15 14:11:39.195839 (MainThread): 14:11:39 | 
2020-10-15 14:11:39.205460 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-15 14:11:39.206131 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-15 14:11:39.206322 (Thread-1): Opening a new connection, currently in state init
2020-10-15 14:11:39.206497 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-15 14:11:39.238035 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-15 14:11:39.239276 (Thread-1): finished collecting timing info
2020-10-15 14:11:39.239644 (Thread-1): finished collecting timing info
2020-10-15 14:11:39.240302 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-15 14:11:39.240477 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-15 14:11:39.240892 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-15 14:11:39.241004 (Thread-1): Opening a new connection, currently in state init
2020-10-15 14:11:39.241112 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-15 14:11:39.251487 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-15 14:11:39.252189 (Thread-1): finished collecting timing info
2020-10-15 14:11:39.252672 (Thread-1): finished collecting timing info
2020-10-15 14:11:39.253250 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-15 14:11:39.253686 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-15 14:11:39.253990 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-15 14:11:39.254096 (Thread-1): Opening a new connection, currently in state init
2020-10-15 14:11:39.254197 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-15 14:11:39.265558 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-15 14:11:39.265975 (Thread-1): finished collecting timing info
2020-10-15 14:11:39.266320 (Thread-1): finished collecting timing info
2020-10-15 14:11:39.267253 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-15 14:11:39.268188 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-15 14:11:39.268880 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-15 14:11:39.269133 (Thread-1): Opening a new connection, currently in state init
2020-10-15 14:11:39.269299 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-15 14:11:39.279697 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-15 14:11:39.280034 (Thread-1): finished collecting timing info
2020-10-15 14:11:39.280335 (Thread-1): finished collecting timing info
2020-10-15 14:11:39.280868 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-15 14:11:39.304179 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-15 14:11:39.304411 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was properly closed.
2020-10-15 14:11:39.329174 (MainThread): 14:11:39 | Done.
2020-10-15 14:11:39.333188 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-15 14:11:39.333553 (MainThread): Opening a new connection, currently in state init
2020-10-15 14:11:39.333748 (MainThread): 14:11:39 | Building catalog
2020-10-15 14:11:39.387322 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-15 14:11:39.387718 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-15 14:11:39.577249 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-15 14:11:39.577433 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-15 14:11:39.581653 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-15 14:11:39.581850 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-15 14:11:39.581969 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-15 14:11:39.591139 (ThreadPoolExecutor-0_0): SQL status: SELECT 197 in 0.01 seconds
2020-10-15 14:11:39.620086 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-15 14:11:39.813805 (MainThread): 14:11:39 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-15 14:11:39.814339 (MainThread): Flushing usage events
2020-10-15 14:11:39.814529 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-15 14:11:39.814640 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-15 14:11:39.814797 (MainThread): On airflow.information_schema: Close
2020-10-15 14:11:41.567520 (MainThread): Got an exception trying to initialize tracking
2020-10-15 14:11:41.567840 (MainThread): Running with dbt=0.16.0
2020-10-15 14:11:41.685525 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-15 14:11:41.685901 (MainThread): Tracking: do not track
2020-10-15 14:11:41.695079 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-15 14:11:41.695469 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-15 14:11:41.695648 (MainThread): Press Ctrl+C to exit.


2020-10-16 01:34:50.252875 (MainThread): Got an exception trying to initialize tracking
2020-10-16 01:34:50.253057 (MainThread): Running with dbt=0.16.0
2020-10-16 01:34:50.338302 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-16 01:34:50.338968 (MainThread): Tracking: do not track
2020-10-16 01:34:50.393354 (MainThread): Partial parsing not enabled
2020-10-16 01:34:50.398333 (MainThread): Parsing macros/core.sql
2020-10-16 01:34:50.412575 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-16 01:34:50.438586 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-16 01:34:50.461258 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-16 01:34:50.496468 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-16 01:34:50.505660 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-16 01:34:50.517987 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-16 01:34:50.588093 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-16 01:34:50.622689 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-16 01:34:50.626001 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-16 01:34:50.638018 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-16 01:34:50.641644 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-16 01:34:50.689695 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-16 01:34:50.692563 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-16 01:34:50.696761 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-16 01:34:50.699368 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-16 01:34:50.702167 (MainThread): Parsing macros/etc/query.sql
2020-10-16 01:34:50.704429 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-16 01:34:50.709426 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-16 01:34:50.711634 (MainThread): Parsing macros/etc/datetime.sql
2020-10-16 01:34:50.735562 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-16 01:34:50.741380 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-16 01:34:50.745755 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-16 01:34:50.748412 (MainThread): Parsing macros/adapters/common.sql
2020-10-16 01:34:50.857238 (MainThread): Parsing macros/relations.sql
2020-10-16 01:34:50.860315 (MainThread): Parsing macros/adapters.sql
2020-10-16 01:34:50.901094 (MainThread): Parsing macros/catalog.sql
2020-10-16 01:34:50.907370 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-16 01:34:50.945565 (MainThread): Partial parsing not enabled
2020-10-16 01:34:50.998403 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-16 01:34:50.998560 (MainThread): Opening a new connection, currently in state init
2020-10-16 01:34:51.026889 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-16 01:34:51.027035 (MainThread): Opening a new connection, currently in state init
2020-10-16 01:34:51.035444 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-16 01:34:51.035597 (MainThread): Opening a new connection, currently in state init
2020-10-16 01:34:51.044504 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-16 01:34:51.044656 (MainThread): Opening a new connection, currently in state init
2020-10-16 01:34:51.537003 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-16 01:34:51.541752 (MainThread): 
2020-10-16 01:34:51.541973 (MainThread): 01:34:51 | Concurrency: 1 threads (target='dev')
2020-10-16 01:34:51.542159 (MainThread): 01:34:51 | 
2020-10-16 01:34:51.549431 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-16 01:34:51.549852 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-16 01:34:51.549962 (Thread-1): Opening a new connection, currently in state init
2020-10-16 01:34:51.550066 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-16 01:34:51.573701 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-16 01:34:51.574610 (Thread-1): finished collecting timing info
2020-10-16 01:34:51.574936 (Thread-1): finished collecting timing info
2020-10-16 01:34:51.575417 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-16 01:34:51.575570 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-16 01:34:51.575870 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-16 01:34:51.576009 (Thread-1): Opening a new connection, currently in state init
2020-10-16 01:34:51.576156 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-16 01:34:51.586058 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-16 01:34:51.586439 (Thread-1): finished collecting timing info
2020-10-16 01:34:51.586743 (Thread-1): finished collecting timing info
2020-10-16 01:34:51.587233 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-16 01:34:51.587678 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-16 01:34:51.588115 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-16 01:34:51.588264 (Thread-1): Opening a new connection, currently in state init
2020-10-16 01:34:51.588408 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-16 01:34:51.601413 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-16 01:34:51.601761 (Thread-1): finished collecting timing info
2020-10-16 01:34:51.602069 (Thread-1): finished collecting timing info
2020-10-16 01:34:51.602571 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-16 01:34:51.603006 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-16 01:34:51.603325 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-16 01:34:51.603431 (Thread-1): Opening a new connection, currently in state init
2020-10-16 01:34:51.603531 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-16 01:34:51.614726 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-16 01:34:51.615067 (Thread-1): finished collecting timing info
2020-10-16 01:34:51.615377 (Thread-1): finished collecting timing info
2020-10-16 01:34:51.615879 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-16 01:34:51.649455 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-16 01:34:51.649623 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was properly closed.
2020-10-16 01:34:51.666493 (MainThread): 01:34:51 | Done.
2020-10-16 01:34:51.669472 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-16 01:34:51.669630 (MainThread): Opening a new connection, currently in state init
2020-10-16 01:34:51.669845 (MainThread): 01:34:51 | Building catalog
2020-10-16 01:34:51.708264 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-16 01:34:51.708440 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-16 01:34:51.864567 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-16 01:34:51.864781 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-16 01:34:51.869719 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-16 01:34:51.869931 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-16 01:34:51.870172 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-16 01:34:51.879039 (ThreadPoolExecutor-0_0): SQL status: SELECT 197 in 0.01 seconds
2020-10-16 01:34:51.905644 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-16 01:34:52.098520 (MainThread): 01:34:52 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-16 01:34:52.098998 (MainThread): Flushing usage events
2020-10-16 01:34:52.099158 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-16 01:34:52.099254 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-16 01:34:52.099345 (MainThread): On airflow.information_schema: Close
2020-10-16 01:34:53.528950 (MainThread): Got an exception trying to initialize tracking
2020-10-16 01:34:53.529108 (MainThread): Running with dbt=0.16.0
2020-10-16 01:34:53.623031 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-16 01:34:53.623473 (MainThread): Tracking: do not track
2020-10-16 01:34:53.632474 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-16 01:34:53.632754 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-16 01:34:53.632895 (MainThread): Press Ctrl+C to exit.


2020-10-20 15:44:16.037572 (MainThread): Got an exception trying to initialize tracking
2020-10-20 15:44:16.037734 (MainThread): Running with dbt=0.16.0
2020-10-20 15:44:16.131139 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-20 15:44:16.133660 (MainThread): Tracking: do not track
2020-10-20 15:44:16.169675 (MainThread): Partial parsing not enabled
2020-10-20 15:44:16.172011 (MainThread): Parsing macros/core.sql
2020-10-20 15:44:16.180240 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-20 15:44:16.196274 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-20 15:44:16.210065 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-20 15:44:16.247263 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-20 15:44:16.264347 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-20 15:44:16.285681 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-20 15:44:16.385538 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-20 15:44:16.418723 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-20 15:44:16.421907 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-20 15:44:16.433292 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-20 15:44:16.436818 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-20 15:44:16.479091 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-20 15:44:16.481203 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-20 15:44:16.485077 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-20 15:44:16.486833 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-20 15:44:16.488942 (MainThread): Parsing macros/etc/query.sql
2020-10-20 15:44:16.490851 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-20 15:44:16.494593 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-20 15:44:16.496488 (MainThread): Parsing macros/etc/datetime.sql
2020-10-20 15:44:16.514776 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-20 15:44:16.518192 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-20 15:44:16.520922 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-20 15:44:16.522436 (MainThread): Parsing macros/adapters/common.sql
2020-10-20 15:44:16.651073 (MainThread): Parsing macros/relations.sql
2020-10-20 15:44:16.654933 (MainThread): Parsing macros/adapters.sql
2020-10-20 15:44:16.701849 (MainThread): Parsing macros/catalog.sql
2020-10-20 15:44:16.706562 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-20 15:44:16.745234 (MainThread): Partial parsing not enabled
2020-10-20 15:44:16.804361 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-20 15:44:16.804539 (MainThread): Opening a new connection, currently in state init
2020-10-20 15:44:16.837624 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-20 15:44:16.837821 (MainThread): Opening a new connection, currently in state init
2020-10-20 15:44:16.848915 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-20 15:44:16.849124 (MainThread): Opening a new connection, currently in state init
2020-10-20 15:44:16.860600 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-20 15:44:16.860810 (MainThread): Opening a new connection, currently in state init
2020-10-20 15:44:17.362767 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-20 15:44:17.368009 (MainThread): 
2020-10-20 15:44:17.368267 (MainThread): 15:44:17 | Concurrency: 1 threads (target='dev')
2020-10-20 15:44:17.368440 (MainThread): 15:44:17 | 
2020-10-20 15:44:17.375991 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-20 15:44:17.376439 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-20 15:44:17.376560 (Thread-1): Opening a new connection, currently in state init
2020-10-20 15:44:17.376671 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-20 15:44:17.401177 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-20 15:44:17.401907 (Thread-1): finished collecting timing info
2020-10-20 15:44:17.402232 (Thread-1): finished collecting timing info
2020-10-20 15:44:17.402721 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-20 15:44:17.402889 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-20 15:44:17.403298 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-20 15:44:17.403407 (Thread-1): Opening a new connection, currently in state init
2020-10-20 15:44:17.403507 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-20 15:44:17.413221 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-20 15:44:17.413549 (Thread-1): finished collecting timing info
2020-10-20 15:44:17.413977 (Thread-1): finished collecting timing info
2020-10-20 15:44:17.414476 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-20 15:44:17.414883 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-20 15:44:17.415204 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-20 15:44:17.415333 (Thread-1): Opening a new connection, currently in state init
2020-10-20 15:44:17.415437 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-20 15:44:17.426945 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-20 15:44:17.427285 (Thread-1): finished collecting timing info
2020-10-20 15:44:17.427583 (Thread-1): finished collecting timing info
2020-10-20 15:44:17.428042 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-20 15:44:17.428452 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-20 15:44:17.428759 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-20 15:44:17.428861 (Thread-1): Opening a new connection, currently in state init
2020-10-20 15:44:17.428956 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-20 15:44:17.438691 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-20 15:44:17.439042 (Thread-1): finished collecting timing info
2020-10-20 15:44:17.439358 (Thread-1): finished collecting timing info
2020-10-20 15:44:17.439850 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-20 15:44:17.475990 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-20 15:44:17.476151 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was properly closed.
2020-10-20 15:44:17.491520 (MainThread): 15:44:17 | Done.
2020-10-20 15:44:17.493436 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-20 15:44:17.493559 (MainThread): Opening a new connection, currently in state init
2020-10-20 15:44:17.493659 (MainThread): 15:44:17 | Building catalog
2020-10-20 15:44:17.527749 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-20 15:44:17.527900 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-20 15:44:17.643237 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-20 15:44:17.643420 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-20 15:44:17.647161 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-20 15:44:17.647337 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-20 15:44:17.647436 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-20 15:44:17.650761 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.00 seconds
2020-10-20 15:44:17.669142 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-20 15:44:17.864257 (MainThread): 15:44:17 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-20 15:44:17.864729 (MainThread): Flushing usage events
2020-10-20 15:44:17.864900 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-20 15:44:17.864991 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-20 15:44:17.865078 (MainThread): On airflow.information_schema: Close
2020-10-20 15:44:19.345551 (MainThread): Got an exception trying to initialize tracking
2020-10-20 15:44:19.345731 (MainThread): Running with dbt=0.16.0
2020-10-20 15:44:19.433403 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-20 15:44:19.433748 (MainThread): Tracking: do not track
2020-10-20 15:44:19.442372 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-20 15:44:19.442665 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-20 15:44:19.442789 (MainThread): Press Ctrl+C to exit.


2020-10-20 17:05:44.121737 (MainThread): Got an exception trying to initialize tracking
2020-10-20 17:05:44.121891 (MainThread): Running with dbt=0.16.0
2020-10-20 17:05:44.222276 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-20 17:05:44.222656 (MainThread): Tracking: do not track
2020-10-20 17:05:44.266444 (MainThread): Partial parsing not enabled
2020-10-20 17:05:44.270218 (MainThread): Parsing macros/core.sql
2020-10-20 17:05:44.280932 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-20 17:05:44.301459 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-20 17:05:44.316176 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-20 17:05:44.346352 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-20 17:05:44.362930 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-20 17:05:44.385142 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-20 17:05:44.489491 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-20 17:05:44.530291 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-20 17:05:44.534284 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-20 17:05:44.548140 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-20 17:05:44.552092 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-20 17:05:44.597496 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-20 17:05:44.599494 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-20 17:05:44.603060 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-20 17:05:44.604507 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-20 17:05:44.606326 (MainThread): Parsing macros/etc/query.sql
2020-10-20 17:05:44.608240 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-20 17:05:44.612075 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-20 17:05:44.613859 (MainThread): Parsing macros/etc/datetime.sql
2020-10-20 17:05:44.632438 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-20 17:05:44.636001 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-20 17:05:44.638879 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-20 17:05:44.640500 (MainThread): Parsing macros/adapters/common.sql
2020-10-20 17:05:44.765770 (MainThread): Parsing macros/relations.sql
2020-10-20 17:05:44.770450 (MainThread): Parsing macros/adapters.sql
2020-10-20 17:05:44.821492 (MainThread): Parsing macros/catalog.sql
2020-10-20 17:05:44.826626 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-20 17:05:44.862791 (MainThread): Partial parsing not enabled
2020-10-20 17:05:44.923808 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-20 17:05:44.923975 (MainThread): Opening a new connection, currently in state init
2020-10-20 17:05:44.955315 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-20 17:05:44.955511 (MainThread): Opening a new connection, currently in state init
2020-10-20 17:05:44.966681 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-20 17:05:44.966864 (MainThread): Opening a new connection, currently in state init
2020-10-20 17:05:44.977878 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-20 17:05:44.978053 (MainThread): Opening a new connection, currently in state init
2020-10-20 17:05:45.552015 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-20 17:05:45.558653 (MainThread): 
2020-10-20 17:05:45.558954 (MainThread): 17:05:45 | Concurrency: 1 threads (target='dev')
2020-10-20 17:05:45.559148 (MainThread): 17:05:45 | 
2020-10-20 17:05:45.569539 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-20 17:05:45.569984 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-20 17:05:45.570100 (Thread-1): Opening a new connection, currently in state init
2020-10-20 17:05:45.570210 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-20 17:05:45.593670 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-20 17:05:45.594017 (Thread-1): finished collecting timing info
2020-10-20 17:05:45.594330 (Thread-1): finished collecting timing info
2020-10-20 17:05:45.594833 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-20 17:05:45.594989 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-20 17:05:45.595282 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-20 17:05:45.595390 (Thread-1): Opening a new connection, currently in state init
2020-10-20 17:05:45.595492 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-20 17:05:45.605526 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-20 17:05:45.605856 (Thread-1): finished collecting timing info
2020-10-20 17:05:45.606147 (Thread-1): finished collecting timing info
2020-10-20 17:05:45.606616 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-20 17:05:45.607006 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-20 17:05:45.607326 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-20 17:05:45.607431 (Thread-1): Opening a new connection, currently in state init
2020-10-20 17:05:45.607527 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-20 17:05:45.618165 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-20 17:05:45.618461 (Thread-1): finished collecting timing info
2020-10-20 17:05:45.618746 (Thread-1): finished collecting timing info
2020-10-20 17:05:45.619213 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-20 17:05:45.619647 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-20 17:05:45.619948 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-20 17:05:45.620050 (Thread-1): Opening a new connection, currently in state init
2020-10-20 17:05:45.620146 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-20 17:05:45.629251 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-20 17:05:45.629549 (Thread-1): finished collecting timing info
2020-10-20 17:05:45.629835 (Thread-1): finished collecting timing info
2020-10-20 17:05:45.630289 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-20 17:05:45.669599 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-20 17:05:45.669751 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was properly closed.
2020-10-20 17:05:45.683917 (MainThread): 17:05:45 | Done.
2020-10-20 17:05:45.685743 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-20 17:05:45.685841 (MainThread): Opening a new connection, currently in state init
2020-10-20 17:05:45.685933 (MainThread): 17:05:45 | Building catalog
2020-10-20 17:05:45.717855 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-20 17:05:45.718001 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-20 17:05:45.826928 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-20 17:05:45.827088 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-20 17:05:45.830291 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-20 17:05:45.830450 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-20 17:05:45.830547 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-20 17:05:45.833750 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.00 seconds
2020-10-20 17:05:45.861647 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-20 17:05:46.061187 (MainThread): 17:05:46 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-20 17:05:46.061692 (MainThread): Flushing usage events
2020-10-20 17:05:46.061865 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-20 17:05:46.061963 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-20 17:05:46.062057 (MainThread): On airflow.information_schema: Close
2020-10-20 17:05:47.488052 (MainThread): Got an exception trying to initialize tracking
2020-10-20 17:05:47.488200 (MainThread): Running with dbt=0.16.0
2020-10-20 17:05:47.571177 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-20 17:05:47.571581 (MainThread): Tracking: do not track
2020-10-20 17:05:47.581437 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-20 17:05:47.581750 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-20 17:05:47.581879 (MainThread): Press Ctrl+C to exit.


2020-10-24 05:18:42.483184 (MainThread): Got an exception trying to initialize tracking
2020-10-24 05:18:42.483387 (MainThread): Running with dbt=0.16.0
2020-10-24 05:18:42.580848 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-24 05:18:42.581682 (MainThread): Tracking: do not track
2020-10-24 05:18:42.618763 (MainThread): Partial parsing not enabled
2020-10-24 05:18:42.621076 (MainThread): Parsing macros/core.sql
2020-10-24 05:18:42.630501 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-24 05:18:42.658238 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-24 05:18:42.681459 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-24 05:18:42.724727 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-24 05:18:42.741177 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-24 05:18:42.764258 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-24 05:18:42.846488 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-24 05:18:42.883710 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-24 05:18:42.888444 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-24 05:18:42.903015 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-24 05:18:42.907341 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-24 05:18:42.962804 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-24 05:18:42.965998 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-24 05:18:42.971377 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-24 05:18:42.973542 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-24 05:18:42.975930 (MainThread): Parsing macros/etc/query.sql
2020-10-24 05:18:42.978226 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-24 05:18:42.984323 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-24 05:18:42.987238 (MainThread): Parsing macros/etc/datetime.sql
2020-10-24 05:18:43.015141 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-24 05:18:43.020761 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-24 05:18:43.025438 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-24 05:18:43.029134 (MainThread): Parsing macros/adapters/common.sql
2020-10-24 05:18:43.269391 (MainThread): Parsing macros/relations.sql
2020-10-24 05:18:43.278135 (MainThread): Parsing macros/adapters.sql
2020-10-24 05:18:43.340538 (MainThread): Parsing macros/catalog.sql
2020-10-24 05:18:43.346619 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-24 05:18:43.393566 (MainThread): Partial parsing not enabled
2020-10-24 05:18:43.461090 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-24 05:18:43.461266 (MainThread): Opening a new connection, currently in state init
2020-10-24 05:18:43.498955 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-24 05:18:43.499192 (MainThread): Opening a new connection, currently in state init
2020-10-24 05:18:43.510791 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-24 05:18:43.510981 (MainThread): Opening a new connection, currently in state init
2020-10-24 05:18:43.525045 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-24 05:18:43.525225 (MainThread): Opening a new connection, currently in state init
2020-10-24 05:18:43.853228 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.854877 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.855072 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.855937 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.856108 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.856263 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.856417 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.856574 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.856724 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.857007 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.857159 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.857306 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.857450 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.859938 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.860123 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.860306 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.860464 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.860656 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.861149 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.861347 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.861521 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.861693 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.861844 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.862225 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.862394 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.862553 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.862703 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.862851 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.863003 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.863190 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.863376 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.863966 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.864144 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.864464 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.864654 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.864852 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.865056 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.865250 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.865448 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.866269 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.866440 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.866597 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.866748 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.866898 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.867047 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.867197 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.867344 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.867510 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.867673 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.867831 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.867988 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.868170 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.868739 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.869792 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.869979 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.870833 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.871014 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.871183 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.872287 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.872465 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.872646 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.872811 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.873010 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.873204 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.873819 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.874033 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.874548 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.874766 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.874986 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.875246 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.875641 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.875934 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.876142 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.876439 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.877098 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.877359 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.877576 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.878638 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.878869 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.879601 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.879843 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.887250 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.887515 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.887699 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.887873 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.888087 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.888950 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.889163 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.889343 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.889556 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.889763 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.889965 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.890187 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.890432 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.897316 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.897662 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.899807 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.900061 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.900248 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.900427 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.907155 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.910038 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.910336 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.929612 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.929933 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.930212 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.930498 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.930944 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.932594 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.932965 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.933302 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.946587 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.949974 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.950283 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.975100 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:43.975379 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.003917 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.004332 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.004610 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.046055 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.046321 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.046553 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.117045 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.117448 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.117692 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.117991 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.118240 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.118454 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.118663 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.118956 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.119198 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.119418 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.119686 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.119918 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.120163 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.120392 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.128171 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.132938 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.133286 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.133536 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.134178 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.134454 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.147053 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.147366 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.147628 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.148040 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 05:18:44.155644 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-24 05:18:44.161593 (MainThread): 
2020-10-24 05:18:44.161871 (MainThread): 05:18:44 | Concurrency: 1 threads (target='dev')
2020-10-24 05:18:44.162074 (MainThread): 05:18:44 | 
2020-10-24 05:18:44.171105 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-24 05:18:44.171643 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-24 05:18:44.171786 (Thread-1): Opening a new connection, currently in state init
2020-10-24 05:18:44.171917 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-24 05:18:44.198638 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-24 05:18:44.200256 (Thread-1): finished collecting timing info
2020-10-24 05:18:44.200607 (Thread-1): finished collecting timing info
2020-10-24 05:18:44.201121 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-24 05:18:44.201285 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 05:18:44.201583 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-24 05:18:44.201710 (Thread-1): Opening a new connection, currently in state init
2020-10-24 05:18:44.201819 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 05:18:44.211865 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-24 05:18:44.212142 (Thread-1): finished collecting timing info
2020-10-24 05:18:44.212434 (Thread-1): finished collecting timing info
2020-10-24 05:18:44.212892 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 05:18:44.213381 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-24 05:18:44.213691 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-24 05:18:44.213796 (Thread-1): Opening a new connection, currently in state init
2020-10-24 05:18:44.213895 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-24 05:18:44.225303 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-24 05:18:44.225594 (Thread-1): finished collecting timing info
2020-10-24 05:18:44.225896 (Thread-1): finished collecting timing info
2020-10-24 05:18:44.226371 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-24 05:18:44.226819 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-24 05:18:44.227144 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-24 05:18:44.227263 (Thread-1): Opening a new connection, currently in state init
2020-10-24 05:18:44.227365 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-24 05:18:44.236558 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-24 05:18:44.236871 (Thread-1): finished collecting timing info
2020-10-24 05:18:44.237158 (Thread-1): finished collecting timing info
2020-10-24 05:18:44.237634 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-24 05:18:44.270907 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-24 05:18:44.271029 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was properly closed.
2020-10-24 05:18:44.289609 (MainThread): 05:18:44 | Done.
2020-10-24 05:18:44.292863 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-24 05:18:44.293009 (MainThread): Opening a new connection, currently in state init
2020-10-24 05:18:44.293230 (MainThread): 05:18:44 | Building catalog
2020-10-24 05:18:44.328996 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-24 05:18:44.329104 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-24 05:18:44.453869 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-24 05:18:44.454136 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-24 05:18:44.457935 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-24 05:18:44.458144 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-24 05:18:44.458266 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-24 05:18:44.462216 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.00 seconds
2020-10-24 05:18:44.488531 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-24 05:18:44.680097 (MainThread): 05:18:44 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-24 05:18:44.680692 (MainThread): Flushing usage events
2020-10-24 05:18:44.680998 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-24 05:18:44.681238 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-24 05:18:44.681449 (MainThread): On airflow.information_schema: Close
2020-10-24 05:18:46.464269 (MainThread): Got an exception trying to initialize tracking
2020-10-24 05:18:46.464696 (MainThread): Running with dbt=0.16.0
2020-10-24 05:18:46.577266 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-24 05:18:46.577796 (MainThread): Tracking: do not track
2020-10-24 05:18:46.589287 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-24 05:18:46.589641 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-24 05:18:46.589958 (MainThread): Press Ctrl+C to exit.


2020-10-24 12:12:37.427028 (MainThread): Got an exception trying to initialize tracking
2020-10-24 12:12:37.427213 (MainThread): Running with dbt=0.16.0
2020-10-24 12:12:37.518433 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-24 12:12:37.519138 (MainThread): Tracking: do not track
2020-10-24 12:12:37.569904 (MainThread): Partial parsing not enabled
2020-10-24 12:12:37.577853 (MainThread): Parsing macros/core.sql
2020-10-24 12:12:37.593725 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-24 12:12:37.623134 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-24 12:12:37.650704 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-24 12:12:37.698369 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-24 12:12:37.708319 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-24 12:12:37.721516 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-24 12:12:37.794941 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-24 12:12:37.827440 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-24 12:12:37.830683 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-24 12:12:37.842457 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-24 12:12:37.846458 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-24 12:12:37.889199 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-24 12:12:37.891479 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-24 12:12:37.895458 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-24 12:12:37.897099 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-24 12:12:37.899111 (MainThread): Parsing macros/etc/query.sql
2020-10-24 12:12:37.901363 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-24 12:12:37.905831 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-24 12:12:37.907959 (MainThread): Parsing macros/etc/datetime.sql
2020-10-24 12:12:37.929335 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-24 12:12:37.933687 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-24 12:12:37.938111 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-24 12:12:37.940207 (MainThread): Parsing macros/adapters/common.sql
2020-10-24 12:12:38.065599 (MainThread): Parsing macros/relations.sql
2020-10-24 12:12:38.068695 (MainThread): Parsing macros/adapters.sql
2020-10-24 12:12:38.108004 (MainThread): Parsing macros/catalog.sql
2020-10-24 12:12:38.112658 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-24 12:12:38.145521 (MainThread): Partial parsing not enabled
2020-10-24 12:12:38.205169 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-24 12:12:38.205345 (MainThread): Opening a new connection, currently in state init
2020-10-24 12:12:38.235412 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-24 12:12:38.235639 (MainThread): Opening a new connection, currently in state init
2020-10-24 12:12:38.245167 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-24 12:12:38.245309 (MainThread): Opening a new connection, currently in state init
2020-10-24 12:12:38.254470 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-24 12:12:38.254682 (MainThread): Opening a new connection, currently in state init
2020-10-24 12:12:38.539908 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.541569 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.541774 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.542664 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.542841 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.543002 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.543161 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.543316 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.543471 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.543760 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.543916 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.544067 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.544217 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.546409 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.546587 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.546771 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.546931 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.547131 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.547626 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.547828 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.548007 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.548191 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.548347 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.548732 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.548903 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.549064 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.549217 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.549370 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.549526 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.549718 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.549908 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.550486 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.550664 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.550975 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.551160 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.551327 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.551524 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.551719 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.551911 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.553364 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.553614 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.553832 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.554004 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.554162 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.554355 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.554542 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.554735 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.554923 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.555108 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.555277 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.555451 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.555687 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.556296 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.557411 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.557600 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.558383 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.558562 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.558730 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.559693 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.559865 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.560028 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.560190 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.560385 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.560575 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.561103 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.561290 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.561740 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.561948 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.562147 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.562379 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.562669 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.562881 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.563078 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.563272 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.563824 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.564072 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.564287 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.565283 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.565509 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.566225 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.566447 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.572164 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.572503 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.572711 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.572886 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.573048 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.573708 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.573889 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.574050 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.574250 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.574445 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.574638 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.574828 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.575057 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.580493 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.580708 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.582084 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.582268 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.582435 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.582599 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.588978 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.591282 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.591498 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.609513 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.609865 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.610125 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.610349 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.610581 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.611403 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.611636 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.611881 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.625037 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.627968 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.628239 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.651949 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.652266 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.679343 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.679680 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.679921 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.714462 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.714706 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.714879 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.772843 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.773178 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.773383 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.773578 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.773769 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.773961 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.774151 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.774339 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.774559 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.774762 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.774995 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.775211 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.775441 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.775657 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.781913 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.785299 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.785578 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.785789 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.786228 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.786460 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.796523 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.796766 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.796946 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.797157 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 12:12:38.803154 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-24 12:12:38.807583 (MainThread): 
2020-10-24 12:12:38.807765 (MainThread): 12:12:38 | Concurrency: 1 threads (target='dev')
2020-10-24 12:12:38.807894 (MainThread): 12:12:38 | 
2020-10-24 12:12:38.814236 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-24 12:12:38.814652 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-24 12:12:38.814762 (Thread-1): Opening a new connection, currently in state init
2020-10-24 12:12:38.814869 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-24 12:12:38.837555 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-24 12:12:38.846971 (Thread-1): finished collecting timing info
2020-10-24 12:12:38.847276 (Thread-1): finished collecting timing info
2020-10-24 12:12:38.847736 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-24 12:12:38.847881 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 12:12:38.848146 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-24 12:12:38.848244 (Thread-1): Opening a new connection, currently in state init
2020-10-24 12:12:38.848337 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 12:12:38.857542 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-24 12:12:38.857804 (Thread-1): finished collecting timing info
2020-10-24 12:12:38.858073 (Thread-1): finished collecting timing info
2020-10-24 12:12:38.858496 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 12:12:38.858918 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-24 12:12:38.859203 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-24 12:12:38.859300 (Thread-1): Opening a new connection, currently in state init
2020-10-24 12:12:38.859391 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-24 12:12:38.869894 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-24 12:12:38.870188 (Thread-1): finished collecting timing info
2020-10-24 12:12:38.870469 (Thread-1): finished collecting timing info
2020-10-24 12:12:38.870912 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-24 12:12:38.871346 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-24 12:12:38.871640 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-24 12:12:38.871739 (Thread-1): Opening a new connection, currently in state init
2020-10-24 12:12:38.871845 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-24 12:12:38.881839 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-24 12:12:38.882198 (Thread-1): finished collecting timing info
2020-10-24 12:12:38.882504 (Thread-1): finished collecting timing info
2020-10-24 12:12:38.883004 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-24 12:12:38.914176 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-24 12:12:38.914343 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was properly closed.
2020-10-24 12:12:38.929633 (MainThread): 12:12:38 | Done.
2020-10-24 12:12:38.932565 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-24 12:12:38.932706 (MainThread): Opening a new connection, currently in state init
2020-10-24 12:12:38.932807 (MainThread): 12:12:38 | Building catalog
2020-10-24 12:12:38.967363 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-24 12:12:38.967522 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-24 12:12:39.104322 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-24 12:12:39.104540 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-24 12:12:39.109044 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-24 12:12:39.109310 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-24 12:12:39.109494 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-24 12:12:39.116133 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.01 seconds
2020-10-24 12:12:39.148858 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-24 12:12:39.314418 (MainThread): 12:12:39 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-24 12:12:39.314900 (MainThread): Flushing usage events
2020-10-24 12:12:39.315059 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-24 12:12:39.315150 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-24 12:12:39.315236 (MainThread): On airflow.information_schema: Close
2020-10-24 12:12:40.660846 (MainThread): Got an exception trying to initialize tracking
2020-10-24 12:12:40.660998 (MainThread): Running with dbt=0.16.0
2020-10-24 12:12:40.748098 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-24 12:12:40.748536 (MainThread): Tracking: do not track
2020-10-24 12:12:40.758431 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-24 12:12:40.758811 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-24 12:12:40.758986 (MainThread): Press Ctrl+C to exit.


2020-10-24 15:36:15.272817 (MainThread): Got an exception trying to initialize tracking
2020-10-24 15:36:15.272996 (MainThread): Running with dbt=0.16.0
2020-10-24 15:36:15.361794 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-24 15:36:15.362507 (MainThread): Tracking: do not track
2020-10-24 15:36:15.395981 (MainThread): Partial parsing not enabled
2020-10-24 15:36:15.399297 (MainThread): Parsing macros/core.sql
2020-10-24 15:36:15.407729 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-24 15:36:15.423884 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-24 15:36:15.457310 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-24 15:36:15.516773 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-24 15:36:15.535541 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-24 15:36:15.559933 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-24 15:36:15.638654 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-24 15:36:15.673172 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-24 15:36:15.676630 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-24 15:36:15.688323 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-24 15:36:15.691949 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-24 15:36:15.735408 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-24 15:36:15.737583 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-24 15:36:15.741494 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-24 15:36:15.743115 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-24 15:36:15.745086 (MainThread): Parsing macros/etc/query.sql
2020-10-24 15:36:15.746934 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-24 15:36:15.750610 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-24 15:36:15.752476 (MainThread): Parsing macros/etc/datetime.sql
2020-10-24 15:36:15.773492 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-24 15:36:15.778811 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-24 15:36:15.782119 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-24 15:36:15.784304 (MainThread): Parsing macros/adapters/common.sql
2020-10-24 15:36:15.909407 (MainThread): Parsing macros/relations.sql
2020-10-24 15:36:15.913046 (MainThread): Parsing macros/adapters.sql
2020-10-24 15:36:15.962186 (MainThread): Parsing macros/catalog.sql
2020-10-24 15:36:15.968767 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-24 15:36:16.013955 (MainThread): Partial parsing not enabled
2020-10-24 15:36:16.069715 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-24 15:36:16.069924 (MainThread): Opening a new connection, currently in state init
2020-10-24 15:36:16.118420 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-24 15:36:16.118606 (MainThread): Opening a new connection, currently in state init
2020-10-24 15:36:16.129894 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-24 15:36:16.130074 (MainThread): Opening a new connection, currently in state init
2020-10-24 15:36:16.140568 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-24 15:36:16.140731 (MainThread): Opening a new connection, currently in state init
2020-10-24 15:36:16.410292 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.411789 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.411980 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.412804 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.412968 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.413125 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.413272 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.413414 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.413556 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.413828 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.413975 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.414116 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.414253 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.416303 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.416473 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.416648 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.416799 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.416983 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.417452 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.417650 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.417812 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.417970 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.418109 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.418453 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.418618 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.418787 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.418928 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.419066 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.419207 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.419395 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.419565 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.420082 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.420243 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.420535 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.420708 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.420857 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.421044 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.421218 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.421389 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.422145 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.422302 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.422446 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.422601 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.422742 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.422881 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.423022 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.423160 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.423331 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.423486 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.423640 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.423792 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.423965 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.424479 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.425423 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.425595 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.426319 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.426486 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.426643 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.427532 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.427694 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.427847 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.427997 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.428181 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.428360 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.428848 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.429022 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.429431 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.429632 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.429816 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.430022 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.430284 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.430475 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.430658 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.430837 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.431358 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.431597 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.431795 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.432727 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.432938 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.433609 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.433782 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.438215 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.438393 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.438546 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.438693 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.438839 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.439390 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.439556 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.439705 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.439887 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.440067 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.440242 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.440416 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.440621 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.445774 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.445978 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.447306 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.447495 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.447660 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.447826 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.453092 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.455122 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.455324 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.469539 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.469814 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.469983 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.470156 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.470338 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.470950 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.471131 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.471330 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.480912 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.483160 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.483370 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.502286 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.502526 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.528493 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.528880 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.529152 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.566964 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.567223 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.567422 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.626578 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.626910 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.627118 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.627356 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.627578 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.627774 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.627962 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.628151 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.628383 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.628586 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.628820 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.629034 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.629263 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.629478 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.635921 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.639531 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.639804 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.640030 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.640494 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.640744 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.650910 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.651122 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.651314 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.651523 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 15:36:16.657524 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-24 15:36:16.662282 (MainThread): 
2020-10-24 15:36:16.662505 (MainThread): 15:36:16 | Concurrency: 1 threads (target='dev')
2020-10-24 15:36:16.662660 (MainThread): 15:36:16 | 
2020-10-24 15:36:16.669005 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-24 15:36:16.669431 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-24 15:36:16.669543 (Thread-1): Opening a new connection, currently in state init
2020-10-24 15:36:16.669648 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-24 15:36:16.692310 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-24 15:36:16.693210 (Thread-1): finished collecting timing info
2020-10-24 15:36:16.693520 (Thread-1): finished collecting timing info
2020-10-24 15:36:16.693987 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-24 15:36:16.694135 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 15:36:16.694409 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-24 15:36:16.694510 (Thread-1): Opening a new connection, currently in state init
2020-10-24 15:36:16.694607 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 15:36:16.703921 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-24 15:36:16.704179 (Thread-1): finished collecting timing info
2020-10-24 15:36:16.704457 (Thread-1): finished collecting timing info
2020-10-24 15:36:16.704890 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 15:36:16.705321 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-24 15:36:16.705618 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-24 15:36:16.705725 (Thread-1): Opening a new connection, currently in state init
2020-10-24 15:36:16.705819 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-24 15:36:16.716371 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-24 15:36:16.716616 (Thread-1): finished collecting timing info
2020-10-24 15:36:16.716885 (Thread-1): finished collecting timing info
2020-10-24 15:36:16.717299 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-24 15:36:16.717718 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-24 15:36:16.718002 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-24 15:36:16.718099 (Thread-1): Opening a new connection, currently in state init
2020-10-24 15:36:16.718189 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-24 15:36:16.726692 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-24 15:36:16.726920 (Thread-1): finished collecting timing info
2020-10-24 15:36:16.727188 (Thread-1): finished collecting timing info
2020-10-24 15:36:16.727613 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-24 15:36:16.768988 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-24 15:36:16.769125 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was properly closed.
2020-10-24 15:36:16.782996 (MainThread): 15:36:16 | Done.
2020-10-24 15:36:16.785712 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-24 15:36:16.785818 (MainThread): Opening a new connection, currently in state init
2020-10-24 15:36:16.785904 (MainThread): 15:36:16 | Building catalog
2020-10-24 15:36:16.817899 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-24 15:36:16.818049 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-24 15:36:16.952438 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-24 15:36:16.952697 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-24 15:36:16.957353 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-24 15:36:16.957572 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-24 15:36:16.957720 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-24 15:36:16.962709 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.00 seconds
2020-10-24 15:36:16.998554 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-24 15:36:17.166067 (MainThread): 15:36:17 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-24 15:36:17.166498 (MainThread): Flushing usage events
2020-10-24 15:36:17.166652 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-24 15:36:17.166738 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-24 15:36:17.166820 (MainThread): On airflow.information_schema: Close
2020-10-24 15:36:18.474939 (MainThread): Got an exception trying to initialize tracking
2020-10-24 15:36:18.475090 (MainThread): Running with dbt=0.16.0
2020-10-24 15:36:18.554283 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-24 15:36:18.554719 (MainThread): Tracking: do not track
2020-10-24 15:36:18.561846 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-24 15:36:18.562120 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-24 15:36:18.562252 (MainThread): Press Ctrl+C to exit.


2020-10-24 16:44:19.063797 (MainThread): Got an exception trying to initialize tracking
2020-10-24 16:44:19.063945 (MainThread): Running with dbt=0.16.0
2020-10-24 16:44:19.150831 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-24 16:44:19.151174 (MainThread): Tracking: do not track
2020-10-24 16:44:19.184576 (MainThread): Partial parsing not enabled
2020-10-24 16:44:19.186701 (MainThread): Parsing macros/core.sql
2020-10-24 16:44:19.194819 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-24 16:44:19.210192 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-24 16:44:19.223380 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-24 16:44:19.251418 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-24 16:44:19.267312 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-24 16:44:19.287924 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-24 16:44:19.391940 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-24 16:44:19.420125 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-24 16:44:19.422927 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-24 16:44:19.433179 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-24 16:44:19.436297 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-24 16:44:19.475387 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-24 16:44:19.477189 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-24 16:44:19.480367 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-24 16:44:19.481654 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-24 16:44:19.483260 (MainThread): Parsing macros/etc/query.sql
2020-10-24 16:44:19.484796 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-24 16:44:19.488107 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-24 16:44:19.489780 (MainThread): Parsing macros/etc/datetime.sql
2020-10-24 16:44:19.507412 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-24 16:44:19.510786 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-24 16:44:19.513482 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-24 16:44:19.514964 (MainThread): Parsing macros/adapters/common.sql
2020-10-24 16:44:19.621433 (MainThread): Parsing macros/relations.sql
2020-10-24 16:44:19.625042 (MainThread): Parsing macros/adapters.sql
2020-10-24 16:44:19.670714 (MainThread): Parsing macros/catalog.sql
2020-10-24 16:44:19.675804 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-24 16:44:19.708869 (MainThread): Partial parsing not enabled
2020-10-24 16:44:19.758886 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-24 16:44:19.759032 (MainThread): Opening a new connection, currently in state init
2020-10-24 16:44:19.787090 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-24 16:44:19.787264 (MainThread): Opening a new connection, currently in state init
2020-10-24 16:44:19.796177 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-24 16:44:19.796343 (MainThread): Opening a new connection, currently in state init
2020-10-24 16:44:19.805953 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-24 16:44:19.806135 (MainThread): Opening a new connection, currently in state init
2020-10-24 16:44:20.067009 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.068658 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.068859 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.069716 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.069887 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.070043 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.070218 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.070370 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.070519 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.070801 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.070952 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.071097 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.071253 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.073354 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.073525 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.073703 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.073857 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.074048 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.074535 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.074734 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.074903 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.075080 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.075223 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.075590 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.075747 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.075897 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.076039 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.076180 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.076323 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.076499 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.076675 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.077190 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.077357 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.077651 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.077831 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.077984 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.078173 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.078354 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.078531 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.079302 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.079473 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.079627 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.079776 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.079922 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.080098 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.080244 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.080390 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.080551 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.080709 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.080864 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.081017 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.081216 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.081713 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.082657 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.082835 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.083594 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.083761 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.083916 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.084856 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.085027 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.085185 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.085340 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.085528 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.085713 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.086217 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.086403 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.086837 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.087035 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.087238 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.087480 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.087762 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.087959 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.088146 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.088331 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.088865 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.089104 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.089306 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.090266 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.090483 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.091185 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.091387 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.095983 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.096178 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.096338 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.096491 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.096644 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.097221 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.097386 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.097535 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.097719 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.097900 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.098078 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.098254 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.098461 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.103699 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.103925 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.105300 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.105478 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.105639 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.105796 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.110992 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.112990 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.113178 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.127370 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.127614 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.127777 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.127948 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.128129 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.128762 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.128943 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.129134 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.138749 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.141035 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.141238 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.159528 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.159743 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.181094 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.181411 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.181623 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.214044 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.214301 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.214487 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.278716 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.279046 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.279268 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.279467 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.279657 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.279850 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.280038 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.280229 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.280449 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.280651 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.280885 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.281100 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.281336 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.281552 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.288049 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.291767 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.292045 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.292281 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.292764 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.293023 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.303761 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.304004 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.304205 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.304430 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 16:44:20.310659 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-24 16:44:20.315205 (MainThread): 
2020-10-24 16:44:20.315427 (MainThread): 16:44:20 | Concurrency: 1 threads (target='dev')
2020-10-24 16:44:20.315580 (MainThread): 16:44:20 | 
2020-10-24 16:44:20.322161 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-24 16:44:20.322604 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-24 16:44:20.322716 (Thread-1): Opening a new connection, currently in state init
2020-10-24 16:44:20.322825 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-24 16:44:20.345527 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-24 16:44:20.345856 (Thread-1): finished collecting timing info
2020-10-24 16:44:20.346159 (Thread-1): finished collecting timing info
2020-10-24 16:44:20.346633 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-24 16:44:20.346787 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 16:44:20.347068 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-24 16:44:20.347173 (Thread-1): Opening a new connection, currently in state init
2020-10-24 16:44:20.347295 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 16:44:20.356830 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-24 16:44:20.357129 (Thread-1): finished collecting timing info
2020-10-24 16:44:20.357414 (Thread-1): finished collecting timing info
2020-10-24 16:44:20.357867 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 16:44:20.358307 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-24 16:44:20.358605 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-24 16:44:20.358707 (Thread-1): Opening a new connection, currently in state init
2020-10-24 16:44:20.358803 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-24 16:44:20.369537 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-24 16:44:20.369849 (Thread-1): finished collecting timing info
2020-10-24 16:44:20.370139 (Thread-1): finished collecting timing info
2020-10-24 16:44:20.370603 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-24 16:44:20.371065 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-24 16:44:20.371389 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-24 16:44:20.371495 (Thread-1): Opening a new connection, currently in state init
2020-10-24 16:44:20.371593 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-24 16:44:20.380546 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-24 16:44:20.380821 (Thread-1): finished collecting timing info
2020-10-24 16:44:20.381103 (Thread-1): finished collecting timing info
2020-10-24 16:44:20.381544 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-24 16:44:20.422128 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-24 16:44:20.422280 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was properly closed.
2020-10-24 16:44:20.435958 (MainThread): 16:44:20 | Done.
2020-10-24 16:44:20.437738 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-24 16:44:20.437839 (MainThread): Opening a new connection, currently in state init
2020-10-24 16:44:20.437926 (MainThread): 16:44:20 | Building catalog
2020-10-24 16:44:20.469543 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-24 16:44:20.469702 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-24 16:44:20.573273 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-24 16:44:20.573427 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-24 16:44:20.576914 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-24 16:44:20.577070 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-24 16:44:20.577166 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-24 16:44:20.580191 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.00 seconds
2020-10-24 16:44:20.599217 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-24 16:44:20.802083 (MainThread): 16:44:20 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-24 16:44:20.802589 (MainThread): Flushing usage events
2020-10-24 16:44:20.802779 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-24 16:44:20.802889 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-24 16:44:20.802995 (MainThread): On airflow.information_schema: Close
2020-10-24 16:44:22.074078 (MainThread): Got an exception trying to initialize tracking
2020-10-24 16:44:22.074294 (MainThread): Running with dbt=0.16.0
2020-10-24 16:44:22.157672 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-24 16:44:22.158035 (MainThread): Tracking: do not track
2020-10-24 16:44:22.166401 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-24 16:44:22.166713 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-24 16:44:22.166851 (MainThread): Press Ctrl+C to exit.


2020-10-24 17:27:02.310665 (MainThread): Got an exception trying to initialize tracking
2020-10-24 17:27:02.310815 (MainThread): Running with dbt=0.16.0
2020-10-24 17:27:02.397705 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-24 17:27:02.404159 (MainThread): Tracking: do not track
2020-10-24 17:27:02.437461 (MainThread): Partial parsing not enabled
2020-10-24 17:27:02.439578 (MainThread): Parsing macros/core.sql
2020-10-24 17:27:02.447685 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-24 17:27:02.462667 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-24 17:27:02.475340 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-24 17:27:02.508655 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-24 17:27:02.524014 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-24 17:27:02.544851 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-24 17:27:02.649681 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-24 17:27:02.678425 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-24 17:27:02.681297 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-24 17:27:02.691587 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-24 17:27:02.694568 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-24 17:27:02.733572 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-24 17:27:02.735538 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-24 17:27:02.738813 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-24 17:27:02.740126 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-24 17:27:02.741744 (MainThread): Parsing macros/etc/query.sql
2020-10-24 17:27:02.743299 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-24 17:27:02.746466 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-24 17:27:02.748066 (MainThread): Parsing macros/etc/datetime.sql
2020-10-24 17:27:02.763863 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-24 17:27:02.766973 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-24 17:27:02.769462 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-24 17:27:02.770876 (MainThread): Parsing macros/adapters/common.sql
2020-10-24 17:27:02.895041 (MainThread): Parsing macros/relations.sql
2020-10-24 17:27:02.898911 (MainThread): Parsing macros/adapters.sql
2020-10-24 17:27:02.943451 (MainThread): Parsing macros/catalog.sql
2020-10-24 17:27:02.948199 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-24 17:27:02.978593 (MainThread): Partial parsing not enabled
2020-10-24 17:27:03.028428 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-24 17:27:03.028609 (MainThread): Opening a new connection, currently in state init
2020-10-24 17:27:03.062508 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-24 17:27:03.062678 (MainThread): Opening a new connection, currently in state init
2020-10-24 17:27:03.073087 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-24 17:27:03.073258 (MainThread): Opening a new connection, currently in state init
2020-10-24 17:27:03.083350 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-24 17:27:03.083518 (MainThread): Opening a new connection, currently in state init
2020-10-24 17:27:03.330042 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.331528 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.331718 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.332543 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.332706 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.332855 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.333003 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.333144 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.333285 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.333554 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.333699 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.333839 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.333988 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.336002 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.336157 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.336318 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.336458 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.336629 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.337068 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.337244 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.337414 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.337571 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.337706 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.338043 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.338193 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.338334 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.338468 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.338602 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.338737 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.338904 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.339071 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.339606 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.339764 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.340054 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.340225 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.340369 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.340539 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.340706 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.340871 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.341641 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.341798 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.341942 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.342080 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.342218 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.342354 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.342493 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.342628 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.342782 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.342929 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.343075 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.343219 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.343406 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.343903 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.344813 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.344981 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.345681 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.345841 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.346009 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.346899 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.347059 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.347210 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.347371 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.347551 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.347729 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.348211 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.348391 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.348801 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.349006 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.349183 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.349383 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.349635 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.349819 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.349995 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.350168 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.350672 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.350897 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.351086 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.352007 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.352211 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.352870 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.353040 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.357329 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.357500 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.357649 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.357792 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.357934 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.358462 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.358622 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.358766 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.358941 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.359114 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.359298 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.359472 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.359673 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.364594 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.364780 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.366035 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.366234 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.366401 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.366550 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.371503 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.373403 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.373576 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.387185 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.387457 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.387658 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.387828 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.388004 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.388608 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.388781 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.388964 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.398234 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.400434 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.400631 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.419184 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.419440 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.444275 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.444666 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.444944 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.482116 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.482368 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.482547 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.540910 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.541225 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.541427 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.541614 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.541796 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.542000 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.542200 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.542387 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.542604 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.542806 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.543041 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.543254 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.543476 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.543683 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.549791 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.553262 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.553515 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.553727 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.554157 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.554388 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.564210 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.564423 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.564603 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.564811 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 17:27:03.570633 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-24 17:27:03.575063 (MainThread): 
2020-10-24 17:27:03.575280 (MainThread): 17:27:03 | Concurrency: 1 threads (target='dev')
2020-10-24 17:27:03.575430 (MainThread): 17:27:03 | 
2020-10-24 17:27:03.581785 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-24 17:27:03.582217 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-24 17:27:03.582333 (Thread-1): Opening a new connection, currently in state init
2020-10-24 17:27:03.582442 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-24 17:27:03.608006 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-24 17:27:03.608347 (Thread-1): finished collecting timing info
2020-10-24 17:27:03.608668 (Thread-1): finished collecting timing info
2020-10-24 17:27:03.609162 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-24 17:27:03.609320 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 17:27:03.609641 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-24 17:27:03.609799 (Thread-1): Opening a new connection, currently in state init
2020-10-24 17:27:03.609930 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 17:27:03.619796 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-24 17:27:03.620084 (Thread-1): finished collecting timing info
2020-10-24 17:27:03.620373 (Thread-1): finished collecting timing info
2020-10-24 17:27:03.620849 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 17:27:03.621297 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-24 17:27:03.621598 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-24 17:27:03.621701 (Thread-1): Opening a new connection, currently in state init
2020-10-24 17:27:03.621796 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-24 17:27:03.632899 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-24 17:27:03.633217 (Thread-1): finished collecting timing info
2020-10-24 17:27:03.633504 (Thread-1): finished collecting timing info
2020-10-24 17:27:03.633961 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-24 17:27:03.634419 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-24 17:27:03.634723 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-24 17:27:03.634825 (Thread-1): Opening a new connection, currently in state init
2020-10-24 17:27:03.634921 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-24 17:27:03.643831 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-24 17:27:03.644070 (Thread-1): finished collecting timing info
2020-10-24 17:27:03.644346 (Thread-1): finished collecting timing info
2020-10-24 17:27:03.644771 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-24 17:27:03.681669 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-24 17:27:03.681810 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was properly closed.
2020-10-24 17:27:03.696158 (MainThread): 17:27:03 | Done.
2020-10-24 17:27:03.697873 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-24 17:27:03.698002 (MainThread): Opening a new connection, currently in state init
2020-10-24 17:27:03.698094 (MainThread): 17:27:03 | Building catalog
2020-10-24 17:27:03.731651 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-24 17:27:03.731809 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-24 17:27:03.850695 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-24 17:27:03.850938 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-24 17:27:03.855277 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-24 17:27:03.855491 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-24 17:27:03.855647 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-24 17:27:03.859974 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.00 seconds
2020-10-24 17:27:03.885075 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-24 17:27:04.055970 (MainThread): 17:27:04 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-24 17:27:04.056422 (MainThread): Flushing usage events
2020-10-24 17:27:04.056581 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-24 17:27:04.056664 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-24 17:27:04.056742 (MainThread): On airflow.information_schema: Close
2020-10-24 17:27:05.348381 (MainThread): Got an exception trying to initialize tracking
2020-10-24 17:27:05.348534 (MainThread): Running with dbt=0.16.0
2020-10-24 17:27:05.432237 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-24 17:27:05.432595 (MainThread): Tracking: do not track
2020-10-24 17:27:05.440214 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-24 17:27:05.440483 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-24 17:27:05.440618 (MainThread): Press Ctrl+C to exit.


2020-10-24 18:55:16.154499 (MainThread): Got an exception trying to initialize tracking
2020-10-24 18:55:16.154646 (MainThread): Running with dbt=0.16.0
2020-10-24 18:55:16.242508 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-24 18:55:16.243179 (MainThread): Tracking: do not track
2020-10-24 18:55:16.276141 (MainThread): Partial parsing not enabled
2020-10-24 18:55:16.278240 (MainThread): Parsing macros/core.sql
2020-10-24 18:55:16.286298 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-24 18:55:16.301484 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-24 18:55:16.314222 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-24 18:55:16.339982 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-24 18:55:16.349080 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-24 18:55:16.360845 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-24 18:55:16.485457 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-24 18:55:16.515703 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-24 18:55:16.518687 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-24 18:55:16.529574 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-24 18:55:16.532783 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-24 18:55:16.571592 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-24 18:55:16.573384 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-24 18:55:16.576570 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-24 18:55:16.577865 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-24 18:55:16.579503 (MainThread): Parsing macros/etc/query.sql
2020-10-24 18:55:16.581042 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-24 18:55:16.584255 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-24 18:55:16.585880 (MainThread): Parsing macros/etc/datetime.sql
2020-10-24 18:55:16.602499 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-24 18:55:16.605775 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-24 18:55:16.608429 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-24 18:55:16.609888 (MainThread): Parsing macros/adapters/common.sql
2020-10-24 18:55:16.718130 (MainThread): Parsing macros/relations.sql
2020-10-24 18:55:16.722845 (MainThread): Parsing macros/adapters.sql
2020-10-24 18:55:16.766984 (MainThread): Parsing macros/catalog.sql
2020-10-24 18:55:16.771683 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-24 18:55:16.809178 (MainThread): Partial parsing not enabled
2020-10-24 18:55:16.861308 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-24 18:55:16.861476 (MainThread): Opening a new connection, currently in state init
2020-10-24 18:55:16.890472 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-24 18:55:16.890648 (MainThread): Opening a new connection, currently in state init
2020-10-24 18:55:16.901307 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-24 18:55:16.901502 (MainThread): Opening a new connection, currently in state init
2020-10-24 18:55:16.912411 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-24 18:55:16.912587 (MainThread): Opening a new connection, currently in state init
2020-10-24 18:55:17.170721 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.172205 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.172395 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.173213 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.173376 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.173525 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.173672 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.173813 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.173957 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.174229 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.174384 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.174526 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.174663 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.176708 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.176872 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.177043 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.177191 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.177372 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.177845 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.178032 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.178196 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.178365 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.178511 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.178860 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.179017 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.179166 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.179308 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.179449 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.179593 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.179768 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.179944 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.180468 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.180631 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.180928 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.181099 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.181251 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.181437 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.181616 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.181792 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.182543 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.182704 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.182850 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.182992 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.183132 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.183270 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.183411 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.183549 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.183704 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.183856 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.184014 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.184164 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.184336 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.184837 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.185747 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.185918 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.186689 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.186858 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.187013 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.187893 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.188057 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.188210 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.188358 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.188556 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.188735 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.189215 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.189391 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.189812 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.189997 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.190175 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.190399 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.190662 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.190846 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.191020 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.191192 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.191723 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.191956 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.192151 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.193089 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.193299 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.193978 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.194163 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.198611 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.198802 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.198957 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.199107 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.199256 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.199829 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.199994 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.200142 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.200326 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.200505 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.200681 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.200855 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.201064 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.206226 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.206433 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.207747 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.207919 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.208073 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.208223 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.213444 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.215446 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.215631 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.229822 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.230095 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.230266 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.230456 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.230638 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.231268 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.231449 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.231641 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.241148 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.243410 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.243609 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.262057 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.262270 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.283960 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.284314 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.284548 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.321489 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.321775 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.321986 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.384443 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.384771 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.384978 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.385169 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.385357 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.385547 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.385732 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.385918 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.386134 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.386332 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.386576 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.386788 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.387023 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.387236 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.393545 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.396994 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.397247 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.397464 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.397909 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.398149 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.408140 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.408365 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.408544 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.408749 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 18:55:17.414695 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-24 18:55:17.419217 (MainThread): 
2020-10-24 18:55:17.419548 (MainThread): 18:55:17 | Concurrency: 1 threads (target='dev')
2020-10-24 18:55:17.419763 (MainThread): 18:55:17 | 
2020-10-24 18:55:17.428493 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-24 18:55:17.428927 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-24 18:55:17.429038 (Thread-1): Opening a new connection, currently in state init
2020-10-24 18:55:17.429145 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-24 18:55:17.452097 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-24 18:55:17.452419 (Thread-1): finished collecting timing info
2020-10-24 18:55:17.452717 (Thread-1): finished collecting timing info
2020-10-24 18:55:17.453182 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-24 18:55:17.453339 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 18:55:17.453719 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-24 18:55:17.453822 (Thread-1): Opening a new connection, currently in state init
2020-10-24 18:55:17.453916 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 18:55:17.463137 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-24 18:55:17.463425 (Thread-1): finished collecting timing info
2020-10-24 18:55:17.463709 (Thread-1): finished collecting timing info
2020-10-24 18:55:17.464156 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 18:55:17.464596 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-24 18:55:17.464898 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-24 18:55:17.464999 (Thread-1): Opening a new connection, currently in state init
2020-10-24 18:55:17.465092 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-24 18:55:17.475780 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-24 18:55:17.476049 (Thread-1): finished collecting timing info
2020-10-24 18:55:17.476329 (Thread-1): finished collecting timing info
2020-10-24 18:55:17.476766 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-24 18:55:17.477181 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-24 18:55:17.477476 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-24 18:55:17.477576 (Thread-1): Opening a new connection, currently in state init
2020-10-24 18:55:17.477669 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-24 18:55:17.486467 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-24 18:55:17.486700 (Thread-1): finished collecting timing info
2020-10-24 18:55:17.486967 (Thread-1): finished collecting timing info
2020-10-24 18:55:17.487381 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-24 18:55:17.527738 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-24 18:55:17.527874 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was properly closed.
2020-10-24 18:55:17.540963 (MainThread): 18:55:17 | Done.
2020-10-24 18:55:17.542623 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-24 18:55:17.542734 (MainThread): Opening a new connection, currently in state init
2020-10-24 18:55:17.542824 (MainThread): 18:55:17 | Building catalog
2020-10-24 18:55:17.573561 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-24 18:55:17.573728 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-24 18:55:17.674939 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-24 18:55:17.675087 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-24 18:55:17.679715 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-24 18:55:17.679956 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-24 18:55:17.680121 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-24 18:55:17.685808 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.01 seconds
2020-10-24 18:55:17.716557 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-24 18:55:17.923812 (MainThread): 18:55:17 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-24 18:55:17.924260 (MainThread): Flushing usage events
2020-10-24 18:55:17.924419 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-24 18:55:17.924509 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-24 18:55:17.924595 (MainThread): On airflow.information_schema: Close
2020-10-24 18:55:19.206941 (MainThread): Got an exception trying to initialize tracking
2020-10-24 18:55:19.207105 (MainThread): Running with dbt=0.16.0
2020-10-24 18:55:19.292168 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-24 18:55:19.292512 (MainThread): Tracking: do not track
2020-10-24 18:55:19.300026 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-24 18:55:19.300288 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-24 18:55:19.300416 (MainThread): Press Ctrl+C to exit.


2020-10-24 23:35:19.005170 (MainThread): Got an exception trying to initialize tracking
2020-10-24 23:35:19.005330 (MainThread): Running with dbt=0.16.0
2020-10-24 23:35:19.090743 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-24 23:35:19.093015 (MainThread): Tracking: do not track
2020-10-24 23:35:19.128144 (MainThread): Partial parsing not enabled
2020-10-24 23:35:19.130316 (MainThread): Parsing macros/core.sql
2020-10-24 23:35:19.138354 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-24 23:35:19.153570 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-24 23:35:19.167317 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-24 23:35:19.193635 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-24 23:35:19.202470 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-24 23:35:19.221170 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-24 23:35:19.326385 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-24 23:35:19.353247 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-24 23:35:19.355921 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-24 23:35:19.365978 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-24 23:35:19.368899 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-24 23:35:19.405888 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-24 23:35:19.407620 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-24 23:35:19.410705 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-24 23:35:19.411921 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-24 23:35:19.413444 (MainThread): Parsing macros/etc/query.sql
2020-10-24 23:35:19.414900 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-24 23:35:19.418030 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-24 23:35:19.419525 (MainThread): Parsing macros/etc/datetime.sql
2020-10-24 23:35:19.435545 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-24 23:35:19.438709 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-24 23:35:19.441188 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-24 23:35:19.442563 (MainThread): Parsing macros/adapters/common.sql
2020-10-24 23:35:19.547051 (MainThread): Parsing macros/relations.sql
2020-10-24 23:35:19.551466 (MainThread): Parsing macros/adapters.sql
2020-10-24 23:35:19.601358 (MainThread): Parsing macros/catalog.sql
2020-10-24 23:35:19.606595 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-24 23:35:19.638658 (MainThread): Partial parsing not enabled
2020-10-24 23:35:19.689732 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-24 23:35:19.689883 (MainThread): Opening a new connection, currently in state init
2020-10-24 23:35:19.717904 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-24 23:35:19.718064 (MainThread): Opening a new connection, currently in state init
2020-10-24 23:35:19.727158 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-24 23:35:19.727316 (MainThread): Opening a new connection, currently in state init
2020-10-24 23:35:19.736770 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-24 23:35:19.736940 (MainThread): Opening a new connection, currently in state init
2020-10-24 23:35:19.995826 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:19.997398 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:19.997609 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:19.998540 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:19.998714 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:19.998871 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:19.999025 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:19.999172 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:19.999318 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:19.999603 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:19.999755 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:19.999903 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.000048 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.002175 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.002351 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.002529 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.002684 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.002876 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.003396 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.003593 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.003765 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.003933 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.004083 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.004451 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.004616 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.004772 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.004918 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.005064 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.005211 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.005409 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.005592 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.006137 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.006317 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.006632 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.006810 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.006968 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.007157 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.007342 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.007523 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.008327 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.008496 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.008650 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.008799 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.008945 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.009092 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.009249 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.009396 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.009560 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.009719 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.009876 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.010031 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.010210 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.010739 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.011717 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.011896 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.012640 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.012812 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.012973 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.013904 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.014067 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.014219 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.014369 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.014550 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.014737 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.015229 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.015402 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.015813 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.016004 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.016187 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.016406 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.016674 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.016869 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.017052 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.017241 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.017767 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.018003 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.018233 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.019171 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.019383 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.020067 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.020245 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.024795 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.024996 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.025153 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.025313 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.025463 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.026051 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.026221 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.026372 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.026556 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.026737 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.026916 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.027092 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.027304 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.032755 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.032993 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.034470 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.034661 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.034824 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.034982 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.040248 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.042305 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.042508 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.056861 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.057110 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.057295 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.057468 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.057680 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.058324 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.058505 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.058695 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.068319 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.070694 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.070904 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.089503 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.089720 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.111610 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.111937 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.112155 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.146807 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.147120 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.147352 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.216458 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.216791 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.217000 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.217193 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.217408 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.217601 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.217790 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.217977 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.218195 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.218395 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.218628 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.218843 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.219073 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.219288 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.225763 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.229497 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.229788 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.230027 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.230519 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.230781 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.241592 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.241836 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.242024 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.242239 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:35:20.248509 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-24 23:35:20.253137 (MainThread): 
2020-10-24 23:35:20.253375 (MainThread): 23:35:20 | Concurrency: 1 threads (target='dev')
2020-10-24 23:35:20.253519 (MainThread): 23:35:20 | 
2020-10-24 23:35:20.259947 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-24 23:35:20.260389 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-24 23:35:20.260500 (Thread-1): Opening a new connection, currently in state init
2020-10-24 23:35:20.260607 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-24 23:35:20.283608 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-24 23:35:20.283923 (Thread-1): finished collecting timing info
2020-10-24 23:35:20.284228 (Thread-1): finished collecting timing info
2020-10-24 23:35:20.284701 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-24 23:35:20.284852 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 23:35:20.285131 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-24 23:35:20.285239 (Thread-1): Opening a new connection, currently in state init
2020-10-24 23:35:20.285495 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 23:35:20.294886 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-24 23:35:20.295168 (Thread-1): finished collecting timing info
2020-10-24 23:35:20.295455 (Thread-1): finished collecting timing info
2020-10-24 23:35:20.295905 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 23:35:20.296365 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-24 23:35:20.296671 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-24 23:35:20.296771 (Thread-1): Opening a new connection, currently in state init
2020-10-24 23:35:20.296866 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-24 23:35:20.307796 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-24 23:35:20.308111 (Thread-1): finished collecting timing info
2020-10-24 23:35:20.308405 (Thread-1): finished collecting timing info
2020-10-24 23:35:20.308872 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-24 23:35:20.309270 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-24 23:35:20.309557 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-24 23:35:20.309656 (Thread-1): Opening a new connection, currently in state init
2020-10-24 23:35:20.309751 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-24 23:35:20.318973 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-24 23:35:20.319278 (Thread-1): finished collecting timing info
2020-10-24 23:35:20.319567 (Thread-1): finished collecting timing info
2020-10-24 23:35:20.320030 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-24 23:35:20.359961 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-24 23:35:20.360109 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was properly closed.
2020-10-24 23:35:20.373944 (MainThread): 23:35:20 | Done.
2020-10-24 23:35:20.375551 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-24 23:35:20.375647 (MainThread): Opening a new connection, currently in state init
2020-10-24 23:35:20.375728 (MainThread): 23:35:20 | Building catalog
2020-10-24 23:35:20.407197 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-24 23:35:20.407351 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-24 23:35:20.512415 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-24 23:35:20.512592 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-24 23:35:20.516080 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-24 23:35:20.516309 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-24 23:35:20.516441 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-24 23:35:20.520504 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.00 seconds
2020-10-24 23:35:20.547954 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-24 23:35:20.744105 (MainThread): 23:35:20 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-24 23:35:20.744683 (MainThread): Flushing usage events
2020-10-24 23:35:20.744882 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-24 23:35:20.744991 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-24 23:35:20.745094 (MainThread): On airflow.information_schema: Close
2020-10-24 23:35:22.060688 (MainThread): Got an exception trying to initialize tracking
2020-10-24 23:35:22.060850 (MainThread): Running with dbt=0.16.0
2020-10-24 23:35:22.142491 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-24 23:35:22.142824 (MainThread): Tracking: do not track
2020-10-24 23:35:22.151442 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-24 23:35:22.151739 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-24 23:35:22.151867 (MainThread): Press Ctrl+C to exit.


2020-10-24 23:36:38.613744 (MainThread): Got an exception trying to initialize tracking
2020-10-24 23:36:38.613892 (MainThread): Running with dbt=0.16.0
2020-10-24 23:36:38.700971 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-24 23:36:38.701355 (MainThread): Tracking: do not track
2020-10-24 23:36:38.735141 (MainThread): Partial parsing not enabled
2020-10-24 23:36:38.737221 (MainThread): Parsing macros/core.sql
2020-10-24 23:36:38.745259 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-24 23:36:38.760726 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-24 23:36:38.773397 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-24 23:36:38.800216 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-24 23:36:38.815593 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-24 23:36:38.837047 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-24 23:36:38.944265 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-24 23:36:38.971967 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-24 23:36:38.974754 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-24 23:36:38.984975 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-24 23:36:38.987977 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-24 23:36:39.025624 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-24 23:36:39.027432 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-24 23:36:39.030627 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-24 23:36:39.031920 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-24 23:36:39.033537 (MainThread): Parsing macros/etc/query.sql
2020-10-24 23:36:39.035071 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-24 23:36:39.038193 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-24 23:36:39.039750 (MainThread): Parsing macros/etc/datetime.sql
2020-10-24 23:36:39.056583 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-24 23:36:39.059950 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-24 23:36:39.062816 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-24 23:36:39.064303 (MainThread): Parsing macros/adapters/common.sql
2020-10-24 23:36:39.166632 (MainThread): Parsing macros/relations.sql
2020-10-24 23:36:39.170557 (MainThread): Parsing macros/adapters.sql
2020-10-24 23:36:39.223384 (MainThread): Parsing macros/catalog.sql
2020-10-24 23:36:39.229564 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-24 23:36:39.274268 (MainThread): Partial parsing not enabled
2020-10-24 23:36:39.333837 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-24 23:36:39.334007 (MainThread): Opening a new connection, currently in state init
2020-10-24 23:36:39.362124 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-24 23:36:39.362287 (MainThread): Opening a new connection, currently in state init
2020-10-24 23:36:39.371207 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-24 23:36:39.371367 (MainThread): Opening a new connection, currently in state init
2020-10-24 23:36:39.380872 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-24 23:36:39.381044 (MainThread): Opening a new connection, currently in state init
2020-10-24 23:36:39.644915 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.646379 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.646566 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.647356 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.647513 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.647657 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.647799 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.647937 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.648075 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.648336 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.648479 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.648617 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.648752 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.650739 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.650903 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.651070 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.651224 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.651403 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.651856 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.652040 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.652201 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.652360 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.652501 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.652844 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.652997 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.653144 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.653298 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.653440 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.653582 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.653756 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.653929 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.654438 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.654600 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.654889 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.655079 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.655233 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.655415 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.655593 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.655770 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.656517 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.656673 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.656817 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.656956 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.657112 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.657259 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.657403 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.657543 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.657710 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.657864 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.658018 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.658169 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.658344 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.658858 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.659807 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.659980 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.660704 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.660871 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.661027 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.661933 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.662094 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.662246 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.662396 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.662577 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.662755 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.663242 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.663417 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.663824 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.664016 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.664198 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.664407 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.664661 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.664852 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.665036 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.665217 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.665747 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.666020 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.666233 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.667137 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.667352 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.668025 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.668197 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.672573 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.672761 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.672917 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.673067 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.673217 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.673810 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.673977 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.674126 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.674308 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.674490 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.674668 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.674844 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.675055 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.680146 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.680338 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.681730 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.681909 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.682086 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.682243 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.687485 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.689487 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.689673 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.703753 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.704020 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.704225 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.704402 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.704583 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.705213 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.705418 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.705609 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.715275 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.717557 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.717757 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.735908 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.736125 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.757501 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.757817 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.758046 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.789806 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.790078 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.790258 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.854140 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.854489 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.854701 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.854896 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.855084 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.855275 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.855463 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.855651 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.855870 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.856071 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.856303 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.856518 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.856747 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.856960 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.863391 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.867133 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.867419 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.867656 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.868139 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.868411 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.879369 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.879607 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.879799 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.880025 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:36:39.886315 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-24 23:36:39.890943 (MainThread): 
2020-10-24 23:36:39.891156 (MainThread): 23:36:39 | Concurrency: 1 threads (target='dev')
2020-10-24 23:36:39.891308 (MainThread): 23:36:39 | 
2020-10-24 23:36:39.897812 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-24 23:36:39.898256 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-24 23:36:39.898367 (Thread-1): Opening a new connection, currently in state init
2020-10-24 23:36:39.898473 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-24 23:36:39.920935 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-24 23:36:39.921255 (Thread-1): finished collecting timing info
2020-10-24 23:36:39.921575 (Thread-1): finished collecting timing info
2020-10-24 23:36:39.922093 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-24 23:36:39.922246 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 23:36:39.922525 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-24 23:36:39.922627 (Thread-1): Opening a new connection, currently in state init
2020-10-24 23:36:39.922724 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 23:36:39.932169 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-24 23:36:39.932460 (Thread-1): finished collecting timing info
2020-10-24 23:36:39.932743 (Thread-1): finished collecting timing info
2020-10-24 23:36:39.933190 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 23:36:39.933655 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-24 23:36:39.933954 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-24 23:36:39.934055 (Thread-1): Opening a new connection, currently in state init
2020-10-24 23:36:39.934151 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-24 23:36:39.944812 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-24 23:36:39.945105 (Thread-1): finished collecting timing info
2020-10-24 23:36:39.945400 (Thread-1): finished collecting timing info
2020-10-24 23:36:39.945849 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-24 23:36:39.946289 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-24 23:36:39.946594 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-24 23:36:39.946695 (Thread-1): Opening a new connection, currently in state init
2020-10-24 23:36:39.946791 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-24 23:36:39.955698 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-24 23:36:39.955979 (Thread-1): finished collecting timing info
2020-10-24 23:36:39.956259 (Thread-1): finished collecting timing info
2020-10-24 23:36:39.956703 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-24 23:36:39.997736 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-24 23:36:39.997879 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was properly closed.
2020-10-24 23:36:40.011172 (MainThread): 23:36:40 | Done.
2020-10-24 23:36:40.012931 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-24 23:36:40.013027 (MainThread): Opening a new connection, currently in state init
2020-10-24 23:36:40.013110 (MainThread): 23:36:40 | Building catalog
2020-10-24 23:36:40.045287 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-24 23:36:40.045453 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-24 23:36:40.150355 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-24 23:36:40.150507 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-24 23:36:40.153800 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-24 23:36:40.153954 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-24 23:36:40.154064 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-24 23:36:40.157029 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.00 seconds
2020-10-24 23:36:40.176257 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-24 23:36:40.381620 (MainThread): 23:36:40 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-24 23:36:40.382100 (MainThread): Flushing usage events
2020-10-24 23:36:40.382271 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-24 23:36:40.382369 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-24 23:36:40.382463 (MainThread): On airflow.information_schema: Close
2020-10-24 23:36:41.783083 (MainThread): Got an exception trying to initialize tracking
2020-10-24 23:36:41.783259 (MainThread): Running with dbt=0.16.0
2020-10-24 23:36:41.868440 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-24 23:36:41.868786 (MainThread): Tracking: do not track
2020-10-24 23:36:41.878109 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-24 23:36:41.878390 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-24 23:36:41.878508 (MainThread): Press Ctrl+C to exit.


2020-10-24 23:37:06.103995 (MainThread): Got an exception trying to initialize tracking
2020-10-24 23:37:06.104146 (MainThread): Running with dbt=0.16.0
2020-10-24 23:37:06.199964 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-24 23:37:06.200342 (MainThread): Tracking: do not track
2020-10-24 23:37:06.238557 (MainThread): Partial parsing not enabled
2020-10-24 23:37:06.240736 (MainThread): Parsing macros/core.sql
2020-10-24 23:37:06.248894 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-24 23:37:06.264384 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-24 23:37:06.277120 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-24 23:37:06.301850 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-24 23:37:06.310356 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-24 23:37:06.321834 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-24 23:37:06.434800 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-24 23:37:06.474965 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-24 23:37:06.477924 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-24 23:37:06.488822 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-24 23:37:06.491992 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-24 23:37:06.530987 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-24 23:37:06.532777 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-24 23:37:06.535971 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-24 23:37:06.537250 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-24 23:37:06.538828 (MainThread): Parsing macros/etc/query.sql
2020-10-24 23:37:06.540327 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-24 23:37:06.543406 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-24 23:37:06.544912 (MainThread): Parsing macros/etc/datetime.sql
2020-10-24 23:37:06.560605 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-24 23:37:06.563840 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-24 23:37:06.566418 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-24 23:37:06.567863 (MainThread): Parsing macros/adapters/common.sql
2020-10-24 23:37:06.661371 (MainThread): Parsing macros/relations.sql
2020-10-24 23:37:06.664876 (MainThread): Parsing macros/adapters.sql
2020-10-24 23:37:06.714175 (MainThread): Parsing macros/catalog.sql
2020-10-24 23:37:06.721314 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-24 23:37:06.761499 (MainThread): Partial parsing not enabled
2020-10-24 23:37:06.813082 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-24 23:37:06.813229 (MainThread): Opening a new connection, currently in state init
2020-10-24 23:37:06.841696 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-24 23:37:06.841845 (MainThread): Opening a new connection, currently in state init
2020-10-24 23:37:06.850377 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-24 23:37:06.850528 (MainThread): Opening a new connection, currently in state init
2020-10-24 23:37:06.861068 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-24 23:37:06.861228 (MainThread): Opening a new connection, currently in state init
2020-10-24 23:37:07.121871 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.123375 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.123571 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.124418 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.124583 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.124734 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.124883 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.125027 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.125171 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.125483 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.125634 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.125779 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.125919 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.127981 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.128149 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.128321 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.128473 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.128657 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.129144 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.129352 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.129522 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.129685 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.129830 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.130193 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.130353 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.130505 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.130649 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.130791 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.130935 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.131116 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.131303 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.131837 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.132004 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.132308 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.132485 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.132639 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.132829 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.133011 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.133189 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.133980 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.134142 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.134293 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.134439 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.134583 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.134725 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.134868 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.135011 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.135172 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.135329 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.135482 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.135634 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.135810 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.136317 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.137268 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.137440 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.138135 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.138295 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.138451 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.139335 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.139491 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.139640 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.139786 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.139978 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.140151 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.140629 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.140797 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.141192 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.141396 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.141578 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.141780 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.142030 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.142217 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.142395 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.142572 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.143073 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.143300 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.143490 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.144389 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.144591 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.145276 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.145447 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.149836 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.150027 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.150178 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.150324 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.150469 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.151033 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.151195 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.151341 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.151520 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.151696 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.151870 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.152042 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.152261 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.157322 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.157511 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.159204 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.159474 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.159684 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.159915 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.165497 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.167574 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.167767 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.182010 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.182243 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.182426 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.182600 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.182779 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.183422 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.183606 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.183803 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.193364 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.195576 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.195782 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.213722 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.213935 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.234689 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.234999 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.235210 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.265214 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.265464 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.265632 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.327838 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.328191 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.328430 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.328643 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.328852 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.329063 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.329290 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.329515 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.329748 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.329961 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.330207 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.330434 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.330684 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.330909 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.337619 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.341426 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.341707 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.341946 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.342436 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.342699 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.354036 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.354290 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.354506 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.354751 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:37:07.361546 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-24 23:37:07.366494 (MainThread): 
2020-10-24 23:37:07.366724 (MainThread): 23:37:07 | Concurrency: 1 threads (target='dev')
2020-10-24 23:37:07.366885 (MainThread): 23:37:07 | 
2020-10-24 23:37:07.373979 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-24 23:37:07.374443 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-24 23:37:07.374578 (Thread-1): Opening a new connection, currently in state init
2020-10-24 23:37:07.374689 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-24 23:37:07.398375 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-24 23:37:07.398716 (Thread-1): finished collecting timing info
2020-10-24 23:37:07.399020 (Thread-1): finished collecting timing info
2020-10-24 23:37:07.399490 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-24 23:37:07.399641 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 23:37:07.399916 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-24 23:37:07.400023 (Thread-1): Opening a new connection, currently in state init
2020-10-24 23:37:07.400120 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 23:37:07.409464 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-24 23:37:07.409722 (Thread-1): finished collecting timing info
2020-10-24 23:37:07.410000 (Thread-1): finished collecting timing info
2020-10-24 23:37:07.410433 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 23:37:07.410875 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-24 23:37:07.411169 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-24 23:37:07.411269 (Thread-1): Opening a new connection, currently in state init
2020-10-24 23:37:07.411363 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-24 23:37:07.421776 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-24 23:37:07.422074 (Thread-1): finished collecting timing info
2020-10-24 23:37:07.422353 (Thread-1): finished collecting timing info
2020-10-24 23:37:07.422794 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-24 23:37:07.423232 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-24 23:37:07.423527 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-24 23:37:07.423625 (Thread-1): Opening a new connection, currently in state init
2020-10-24 23:37:07.423716 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-24 23:37:07.432413 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-24 23:37:07.432677 (Thread-1): finished collecting timing info
2020-10-24 23:37:07.432946 (Thread-1): finished collecting timing info
2020-10-24 23:37:07.433380 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-24 23:37:07.473664 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-24 23:37:07.473811 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was properly closed.
2020-10-24 23:37:07.487127 (MainThread): 23:37:07 | Done.
2020-10-24 23:37:07.488858 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-24 23:37:07.488956 (MainThread): Opening a new connection, currently in state init
2020-10-24 23:37:07.489037 (MainThread): 23:37:07 | Building catalog
2020-10-24 23:37:07.519686 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-24 23:37:07.519819 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-24 23:37:07.618257 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-24 23:37:07.618409 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-24 23:37:07.621868 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-24 23:37:07.622019 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-24 23:37:07.622106 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-24 23:37:07.625003 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.00 seconds
2020-10-24 23:37:07.642304 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-24 23:37:07.875720 (MainThread): 23:37:07 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-24 23:37:07.876182 (MainThread): Flushing usage events
2020-10-24 23:37:07.876345 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-24 23:37:07.876440 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-24 23:37:07.876528 (MainThread): On airflow.information_schema: Close
2020-10-24 23:37:09.358658 (MainThread): Got an exception trying to initialize tracking
2020-10-24 23:37:09.358876 (MainThread): Running with dbt=0.16.0
2020-10-24 23:37:09.454645 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-24 23:37:09.455022 (MainThread): Tracking: do not track
2020-10-24 23:37:09.464021 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-24 23:37:09.464307 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-24 23:37:09.464457 (MainThread): Press Ctrl+C to exit.


2020-10-24 23:38:08.556901 (MainThread): Got an exception trying to initialize tracking
2020-10-24 23:38:08.557047 (MainThread): Running with dbt=0.16.0
2020-10-24 23:38:08.641430 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-24 23:38:08.641780 (MainThread): Tracking: do not track
2020-10-24 23:38:08.675587 (MainThread): Partial parsing not enabled
2020-10-24 23:38:08.677652 (MainThread): Parsing macros/core.sql
2020-10-24 23:38:08.685461 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-24 23:38:08.700132 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-24 23:38:08.712221 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-24 23:38:08.736188 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-24 23:38:08.747406 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-24 23:38:08.767991 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-24 23:38:08.881034 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-24 23:38:08.908857 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-24 23:38:08.911577 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-24 23:38:08.921596 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-24 23:38:08.924494 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-24 23:38:08.962655 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-24 23:38:08.964445 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-24 23:38:08.967623 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-24 23:38:08.968912 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-24 23:38:08.970528 (MainThread): Parsing macros/etc/query.sql
2020-10-24 23:38:08.972060 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-24 23:38:08.975184 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-24 23:38:08.976777 (MainThread): Parsing macros/etc/datetime.sql
2020-10-24 23:38:08.992758 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-24 23:38:08.995924 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-24 23:38:08.998491 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-24 23:38:08.999916 (MainThread): Parsing macros/adapters/common.sql
2020-10-24 23:38:09.087800 (MainThread): Parsing macros/relations.sql
2020-10-24 23:38:09.091051 (MainThread): Parsing macros/adapters.sql
2020-10-24 23:38:09.140964 (MainThread): Parsing macros/catalog.sql
2020-10-24 23:38:09.148382 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-24 23:38:09.193257 (MainThread): Partial parsing not enabled
2020-10-24 23:38:09.245086 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-24 23:38:09.245245 (MainThread): Opening a new connection, currently in state init
2020-10-24 23:38:09.273577 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-24 23:38:09.273724 (MainThread): Opening a new connection, currently in state init
2020-10-24 23:38:09.282402 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-24 23:38:09.282549 (MainThread): Opening a new connection, currently in state init
2020-10-24 23:38:09.291386 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-24 23:38:09.291538 (MainThread): Opening a new connection, currently in state init
2020-10-24 23:38:09.552149 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.553710 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.553909 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.554765 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.554931 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.555083 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.555234 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.555378 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.555525 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.555820 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.555968 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.556111 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.556252 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.558387 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.558566 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.558740 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.558894 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.559081 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.559560 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.559752 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.559920 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.560085 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.560230 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.560597 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.560759 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.560915 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.561061 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.561205 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.561366 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.561550 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.561731 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.562277 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.562441 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.562736 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.562911 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.563063 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.563243 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.563418 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.563593 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.564363 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.564523 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.564671 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.564814 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.564955 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.565094 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.565258 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.565403 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.565560 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.565711 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.565859 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.566006 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.566180 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.566681 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.567625 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.567798 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.568517 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.568682 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.568840 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.569758 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.569918 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.570068 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.570216 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.570395 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.570571 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.571047 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.571219 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.571620 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.571809 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.571989 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.572193 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.572444 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.572634 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.572813 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.572991 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.573522 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.573755 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.573954 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.574871 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.575076 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.575751 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.575928 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.580423 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.580604 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.580758 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.580906 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.581055 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.581651 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.581819 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.581967 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.582148 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.582328 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.582504 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.582679 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.582887 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.588026 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.588225 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.589640 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.589818 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.589974 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.590124 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.595296 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.597261 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.597438 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.611020 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.611228 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.611385 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.611542 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.611714 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.612309 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.612482 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.612665 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.621962 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.624144 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.624336 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.641770 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.641974 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.662223 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.662521 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.662720 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.691419 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.691651 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.691804 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.753134 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.753530 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.753774 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.754006 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.754235 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.754464 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.754689 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.754915 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.755176 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.755415 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.755695 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.755953 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.756236 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.756480 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.763396 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.767206 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.767490 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.767747 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.768255 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.768567 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.780099 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.780358 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.780565 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.780805 (MainThread): can't resolve package from __spec__ or __package__, falling back on __name__ and __path__
2020-10-24 23:38:09.787716 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-24 23:38:09.792919 (MainThread): 
2020-10-24 23:38:09.793131 (MainThread): 23:38:09 | Concurrency: 1 threads (target='dev')
2020-10-24 23:38:09.793297 (MainThread): 23:38:09 | 
2020-10-24 23:38:09.800227 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-24 23:38:09.800697 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-24 23:38:09.800817 (Thread-1): Opening a new connection, currently in state init
2020-10-24 23:38:09.800934 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-24 23:38:09.824252 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-24 23:38:09.824580 (Thread-1): finished collecting timing info
2020-10-24 23:38:09.824884 (Thread-1): finished collecting timing info
2020-10-24 23:38:09.825364 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-24 23:38:09.825519 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 23:38:09.825801 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-24 23:38:09.825904 (Thread-1): Opening a new connection, currently in state init
2020-10-24 23:38:09.826001 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 23:38:09.835400 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-24 23:38:09.835666 (Thread-1): finished collecting timing info
2020-10-24 23:38:09.835947 (Thread-1): finished collecting timing info
2020-10-24 23:38:09.836380 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-24 23:38:09.836808 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-24 23:38:09.837106 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-24 23:38:09.837207 (Thread-1): Opening a new connection, currently in state init
2020-10-24 23:38:09.837311 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-24 23:38:09.847951 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-24 23:38:09.848230 (Thread-1): finished collecting timing info
2020-10-24 23:38:09.848512 (Thread-1): finished collecting timing info
2020-10-24 23:38:09.848957 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-24 23:38:09.849407 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-24 23:38:09.849711 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-24 23:38:09.849813 (Thread-1): Opening a new connection, currently in state init
2020-10-24 23:38:09.849907 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-24 23:38:09.858896 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-24 23:38:09.859170 (Thread-1): finished collecting timing info
2020-10-24 23:38:09.859453 (Thread-1): finished collecting timing info
2020-10-24 23:38:09.859884 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-24 23:38:09.900260 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-24 23:38:09.900408 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was properly closed.
2020-10-24 23:38:09.914016 (MainThread): 23:38:09 | Done.
2020-10-24 23:38:09.915791 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-24 23:38:09.915887 (MainThread): Opening a new connection, currently in state init
2020-10-24 23:38:09.915970 (MainThread): 23:38:09 | Building catalog
2020-10-24 23:38:09.946764 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-24 23:38:09.946902 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-24 23:38:10.045811 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-24 23:38:10.045956 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-24 23:38:10.049134 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-24 23:38:10.049304 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-24 23:38:10.049393 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-24 23:38:10.052193 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.00 seconds
2020-10-24 23:38:10.069035 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-24 23:38:10.303962 (MainThread): 23:38:10 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-24 23:38:10.304421 (MainThread): Flushing usage events
2020-10-24 23:38:10.304587 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-24 23:38:10.304680 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-24 23:38:10.304770 (MainThread): On airflow.information_schema: Close
2020-10-24 23:38:11.711061 (MainThread): Got an exception trying to initialize tracking
2020-10-24 23:38:11.711210 (MainThread): Running with dbt=0.16.0
2020-10-24 23:38:11.796591 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-24 23:38:11.796947 (MainThread): Tracking: do not track
2020-10-24 23:38:11.805262 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-24 23:38:11.805533 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-24 23:38:11.805642 (MainThread): Press Ctrl+C to exit.


