2020-10-08 04:52:36.684606 (MainThread): Got an exception trying to initialize tracking
2020-10-08 04:52:36.684828 (MainThread): Running with dbt=0.16.0
2020-10-08 04:52:36.795588 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='/usr/local/airflow/dbt', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-08 04:52:36.798028 (MainThread): Tracking: do not track
2020-10-08 04:52:36.832665 (MainThread): Partial parsing not enabled
2020-10-08 04:52:36.835003 (MainThread): Parsing macros/core.sql
2020-10-08 04:52:36.843651 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-08 04:52:36.860047 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-08 04:52:36.873706 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-08 04:52:36.902418 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-08 04:52:36.914549 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-08 04:52:36.937273 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-08 04:52:37.051438 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-08 04:52:37.086532 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-08 04:52:37.089808 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-08 04:52:37.102350 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-08 04:52:37.105902 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-08 04:52:37.151928 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-08 04:52:37.154070 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-08 04:52:37.157753 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-08 04:52:37.159256 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-08 04:52:37.161420 (MainThread): Parsing macros/etc/query.sql
2020-10-08 04:52:37.163302 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-08 04:52:37.167144 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-08 04:52:37.169004 (MainThread): Parsing macros/etc/datetime.sql
2020-10-08 04:52:37.187644 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-08 04:52:37.191371 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-08 04:52:37.194341 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-08 04:52:37.196024 (MainThread): Parsing macros/adapters/common.sql
2020-10-08 04:52:37.298548 (MainThread): Parsing macros/relations.sql
2020-10-08 04:52:37.301755 (MainThread): Parsing macros/adapters.sql
2020-10-08 04:52:37.340234 (MainThread): Parsing macros/catalog.sql
2020-10-08 04:52:37.345113 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-08 04:52:37.376394 (MainThread): Partial parsing not enabled
2020-10-08 04:52:37.429128 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 04:52:37.429339 (MainThread): Opening a new connection, currently in state init
2020-10-08 04:52:37.460620 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 04:52:37.460839 (MainThread): Opening a new connection, currently in state init
2020-10-08 04:52:37.471146 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 04:52:37.471288 (MainThread): Opening a new connection, currently in state init
2020-10-08 04:52:37.481414 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 04:52:37.481590 (MainThread): Opening a new connection, currently in state init
2020-10-08 04:52:38.067802 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-08 04:52:38.072549 (MainThread): 
2020-10-08 04:52:38.072930 (MainThread): Acquiring new postgres connection "master".
2020-10-08 04:52:38.073042 (MainThread): Opening a new connection, currently in state init
2020-10-08 04:52:38.099762 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-08 04:52:38.100042 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-08 04:52:38.257651 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-08 04:52:38.257811 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-08 04:52:38.262265 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-08 04:52:38.288630 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-08 04:52:38.288790 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-08 04:52:38.290952 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-08 04:52:38.291071 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-08 04:52:38.291516 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-08 04:52:38.291661 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-08 04:52:38.291760 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-08 04:52:38.294874 (ThreadPoolExecutor-1_0): SQL status: SELECT 25 in 0.00 seconds
2020-10-08 04:52:38.322422 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-08 04:52:38.346792 (MainThread): Using postgres connection "master".
2020-10-08 04:52:38.346896 (MainThread): On master: BEGIN
2020-10-08 04:52:38.349618 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 04:52:38.349734 (MainThread): Using postgres connection "master".
2020-10-08 04:52:38.349820 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-08 04:52:38.355972 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-10-08 04:52:38.356977 (MainThread): On master: ROLLBACK
2020-10-08 04:52:38.357241 (MainThread): Using postgres connection "master".
2020-10-08 04:52:38.357342 (MainThread): On master: BEGIN
2020-10-08 04:52:38.357753 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 04:52:38.357870 (MainThread): On master: COMMIT
2020-10-08 04:52:38.357961 (MainThread): Using postgres connection "master".
2020-10-08 04:52:38.358042 (MainThread): On master: COMMIT
2020-10-08 04:52:38.358293 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-08 04:52:38.358592 (MainThread): 04:52:38 | Concurrency: 1 threads (target='dev')
2020-10-08 04:52:38.358722 (MainThread): 04:52:38 | 
2020-10-08 04:52:38.364320 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-08 04:52:38.364490 (Thread-1): 04:52:38 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-08 04:52:38.364779 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 04:52:38.364864 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-08 04:52:38.364957 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-08 04:52:38.385378 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 04:52:38.385682 (Thread-1): finished collecting timing info
2020-10-08 04:52:38.428215 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 04:52:38.428327 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-08 04:52:38.428834 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.431247 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 04:52:38.431343 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-08 04:52:38.431603 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.433592 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 04:52:38.433897 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 04:52:38.433983 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-08 04:52:38.434228 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 04:52:38.434333 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 04:52:38.434412 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-08 04:52:38.435930 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 04:52:38.438485 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 04:52:38.438577 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-08 04:52:38.438888 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 04:52:38.439949 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-08 04:52:38.440070 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 04:52:38.440173 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-08 04:52:38.441134 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 04:52:38.443002 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 04:52:38.443094 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-08 04:52:38.443338 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.445836 (Thread-1): finished collecting timing info
2020-10-08 04:52:38.446766 (Thread-1): 04:52:38 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.08s]
2020-10-08 04:52:38.446937 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-08 04:52:38.447111 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 04:52:38.447273 (Thread-1): 04:52:38 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-08 04:52:38.447613 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 04:52:38.447725 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-08 04:52:38.447830 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-08 04:52:38.456072 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 04:52:38.456266 (Thread-1): finished collecting timing info
2020-10-08 04:52:38.464977 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 04:52:38.465075 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-08 04:52:38.465409 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.467750 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 04:52:38.467871 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-08 04:52:38.468146 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.469925 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 04:52:38.470133 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 04:52:38.470215 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-08 04:52:38.470396 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 04:52:38.470475 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 04:52:38.470545 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-08 04:52:38.471119 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 04:52:38.473475 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 04:52:38.473562 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-08 04:52:38.473842 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 04:52:38.474606 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-08 04:52:38.474692 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 04:52:38.474767 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-08 04:52:38.475737 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 04:52:38.477728 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 04:52:38.477814 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-08 04:52:38.478035 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.480436 (Thread-1): finished collecting timing info
2020-10-08 04:52:38.481046 (Thread-1): 04:52:38 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.03s]
2020-10-08 04:52:38.481164 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 04:52:38.481497 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-08 04:52:38.481613 (Thread-1): 04:52:38 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-08 04:52:38.481834 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 04:52:38.481908 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-08 04:52:38.482008 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-08 04:52:38.491497 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 04:52:38.491684 (Thread-1): finished collecting timing info
2020-10-08 04:52:38.499498 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 04:52:38.499593 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-08 04:52:38.499872 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.502354 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 04:52:38.502443 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-08 04:52:38.502700 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.504408 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 04:52:38.504691 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 04:52:38.504806 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-08 04:52:38.505026 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 04:52:38.505116 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 04:52:38.505194 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-08 04:52:38.506226 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 04:52:38.509783 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 04:52:38.509874 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-08 04:52:38.510186 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 04:52:38.511102 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-08 04:52:38.511220 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 04:52:38.511334 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-08 04:52:38.512301 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 04:52:38.514093 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 04:52:38.514178 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-08 04:52:38.514409 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.516811 (Thread-1): finished collecting timing info
2020-10-08 04:52:38.517423 (Thread-1): 04:52:38 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.04s]
2020-10-08 04:52:38.517542 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-08 04:52:38.517900 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-08 04:52:38.518034 (Thread-1): 04:52:38 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-08 04:52:38.518301 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 04:52:38.518389 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-08 04:52:38.518478 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-08 04:52:38.526383 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 04:52:38.526609 (Thread-1): finished collecting timing info
2020-10-08 04:52:38.534392 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 04:52:38.534490 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-08 04:52:38.534792 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.537315 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 04:52:38.537416 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-08 04:52:38.537702 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.539545 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 04:52:38.539846 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 04:52:38.539956 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-08 04:52:38.540277 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 04:52:38.540406 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 04:52:38.540515 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-08 04:52:38.541910 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 04:52:38.545229 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 04:52:38.545373 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-08 04:52:38.545878 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 04:52:38.547063 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-08 04:52:38.547190 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 04:52:38.547298 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-08 04:52:38.548415 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 04:52:38.551626 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 04:52:38.551788 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-08 04:52:38.552212 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 04:52:38.556396 (Thread-1): finished collecting timing info
2020-10-08 04:52:38.557337 (Thread-1): 04:52:38 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.04s]
2020-10-08 04:52:38.557556 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-08 04:52:38.566106 (MainThread): Using postgres connection "master".
2020-10-08 04:52:38.566363 (MainThread): On master: BEGIN
2020-10-08 04:52:38.566774 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 04:52:38.566974 (MainThread): On master: COMMIT
2020-10-08 04:52:38.567144 (MainThread): Using postgres connection "master".
2020-10-08 04:52:38.567323 (MainThread): On master: COMMIT
2020-10-08 04:52:38.567646 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-08 04:52:38.568187 (MainThread): 04:52:38 | 
2020-10-08 04:52:38.568422 (MainThread): 04:52:38 | Finished running 4 view models in 0.50s.
2020-10-08 04:52:38.568629 (MainThread): Connection 'master' was left open.
2020-10-08 04:52:38.568797 (MainThread): On master: Close
2020-10-08 04:52:38.569022 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-08 04:52:38.569188 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-08 04:52:38.597873 (MainThread): 
2020-10-08 04:52:38.598189 (MainThread): Completed successfully
2020-10-08 04:52:38.598440 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-08 04:52:38.598785 (MainThread): Flushing usage events
2020-10-08 05:11:57.691262 (MainThread): Got an exception trying to initialize tracking
2020-10-08 05:11:57.691414 (MainThread): Running with dbt=0.16.0
2020-10-08 05:11:57.766781 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='/usr/local/airflow/dbt', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-08 05:11:57.767166 (MainThread): Tracking: do not track
2020-10-08 05:11:57.797899 (MainThread): Partial parsing not enabled
2020-10-08 05:11:57.800820 (MainThread): Parsing macros/core.sql
2020-10-08 05:11:57.808006 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-08 05:11:57.820986 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-08 05:11:57.831851 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-08 05:11:57.854052 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-08 05:11:57.861806 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-08 05:11:57.872143 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-08 05:11:57.930223 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-08 05:11:57.956660 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-08 05:11:57.959296 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-08 05:11:57.968885 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-08 05:11:57.971724 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-08 05:11:58.007095 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-08 05:11:58.008802 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-08 05:11:58.011857 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-08 05:11:58.013145 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-08 05:11:58.014731 (MainThread): Parsing macros/etc/query.sql
2020-10-08 05:11:58.016255 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-08 05:11:58.019241 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-08 05:11:58.020779 (MainThread): Parsing macros/etc/datetime.sql
2020-10-08 05:11:58.035728 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-08 05:11:58.038731 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-08 05:11:58.041177 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-08 05:11:58.042604 (MainThread): Parsing macros/adapters/common.sql
2020-10-08 05:11:58.121066 (MainThread): Parsing macros/relations.sql
2020-10-08 05:11:58.123708 (MainThread): Parsing macros/adapters.sql
2020-10-08 05:11:58.155211 (MainThread): Parsing macros/catalog.sql
2020-10-08 05:11:58.159442 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-08 05:11:58.189257 (MainThread): Partial parsing not enabled
2020-10-08 05:11:58.237659 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:11:58.237829 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:11:58.267583 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:11:58.267771 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:11:58.278741 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:11:58.278959 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:11:58.289697 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:11:58.289870 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:11:58.754131 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-08 05:11:58.759084 (MainThread): 
2020-10-08 05:11:58.759532 (MainThread): Acquiring new postgres connection "master".
2020-10-08 05:11:58.759708 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:11:58.784478 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-08 05:11:58.784746 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-08 05:11:58.913132 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-08 05:11:58.913275 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-08 05:11:58.916723 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-08 05:11:58.939451 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-08 05:11:58.939602 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-08 05:11:58.941517 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-08 05:11:58.941628 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-08 05:11:58.941987 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:11:58.942093 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-08 05:11:58.942175 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-08 05:11:58.944410 (ThreadPoolExecutor-1_0): SQL status: SELECT 25 in 0.00 seconds
2020-10-08 05:11:58.969652 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-08 05:11:58.995541 (MainThread): Using postgres connection "master".
2020-10-08 05:11:58.995690 (MainThread): On master: BEGIN
2020-10-08 05:11:58.998767 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:11:58.998914 (MainThread): Using postgres connection "master".
2020-10-08 05:11:58.999006 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-08 05:11:59.004571 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-10-08 05:11:59.005687 (MainThread): On master: ROLLBACK
2020-10-08 05:11:59.005987 (MainThread): Using postgres connection "master".
2020-10-08 05:11:59.006097 (MainThread): On master: BEGIN
2020-10-08 05:11:59.006550 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:11:59.006672 (MainThread): On master: COMMIT
2020-10-08 05:11:59.006770 (MainThread): Using postgres connection "master".
2020-10-08 05:11:59.006857 (MainThread): On master: COMMIT
2020-10-08 05:11:59.007110 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:11:59.007432 (MainThread): 05:11:59 | Concurrency: 1 threads (target='dev')
2020-10-08 05:11:59.007566 (MainThread): 05:11:59 | 
2020-10-08 05:11:59.013817 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-08 05:11:59.014011 (Thread-1): 05:11:59 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-08 05:11:59.014348 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:11:59.014439 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-08 05:11:59.014539 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-08 05:11:59.046437 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 05:11:59.046885 (Thread-1): finished collecting timing info
2020-10-08 05:11:59.125449 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:11:59.125677 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-08 05:11:59.126259 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.130745 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:11:59.130904 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-08 05:11:59.131254 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.134072 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 05:11:59.134499 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:11:59.134639 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-08 05:11:59.134930 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:11:59.135263 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:11:59.135405 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-08 05:11:59.137420 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 05:11:59.142779 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:11:59.142964 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-08 05:11:59.145323 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 05:11:59.147097 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-08 05:11:59.147266 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:11:59.147407 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-08 05:11:59.148473 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:11:59.151979 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:11:59.152131 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-08 05:11:59.152466 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.157396 (Thread-1): finished collecting timing info
2020-10-08 05:11:59.158930 (Thread-1): 05:11:59 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.14s]
2020-10-08 05:11:59.159167 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-08 05:11:59.159413 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 05:11:59.159628 (Thread-1): 05:11:59 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-08 05:11:59.160138 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:11:59.160278 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-08 05:11:59.160421 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-08 05:11:59.169606 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 05:11:59.169899 (Thread-1): finished collecting timing info
2020-10-08 05:11:59.180045 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:11:59.180183 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-08 05:11:59.180563 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.183470 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:11:59.183597 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-08 05:11:59.183951 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.185790 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 05:11:59.186101 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:11:59.186204 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-08 05:11:59.186492 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:11:59.186605 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:11:59.186697 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-08 05:11:59.187423 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 05:11:59.191920 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:11:59.192090 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-08 05:11:59.192543 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 05:11:59.193958 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-08 05:11:59.194108 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:11:59.194243 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-08 05:11:59.195268 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:11:59.198558 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:11:59.198720 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-08 05:11:59.199104 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.203486 (Thread-1): finished collecting timing info
2020-10-08 05:11:59.204581 (Thread-1): 05:11:59 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.04s]
2020-10-08 05:11:59.204781 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 05:11:59.205275 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-08 05:11:59.205479 (Thread-1): 05:11:59 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-08 05:11:59.205860 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:11:59.205987 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-08 05:11:59.206115 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-08 05:11:59.219295 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 05:11:59.219669 (Thread-1): finished collecting timing info
2020-10-08 05:11:59.228842 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:11:59.228986 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-08 05:11:59.229382 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.232388 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:11:59.232501 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-08 05:11:59.232809 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.234698 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 05:11:59.235008 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:11:59.235109 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-08 05:11:59.235360 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:11:59.235459 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:11:59.235544 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-08 05:11:59.236671 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 05:11:59.241493 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:11:59.241649 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-08 05:11:59.242223 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 05:11:59.243345 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-08 05:11:59.243458 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:11:59.243553 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-08 05:11:59.244722 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:11:59.247135 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:11:59.247263 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-08 05:11:59.247629 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.250762 (Thread-1): finished collecting timing info
2020-10-08 05:11:59.251612 (Thread-1): 05:11:59 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.05s]
2020-10-08 05:11:59.251767 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-08 05:11:59.252203 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-08 05:11:59.252364 (Thread-1): 05:11:59 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-08 05:11:59.252666 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:11:59.252759 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-08 05:11:59.252854 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-08 05:11:59.262277 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 05:11:59.262617 (Thread-1): finished collecting timing info
2020-10-08 05:11:59.272602 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:11:59.272774 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-08 05:11:59.273197 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.276654 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:11:59.276822 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-08 05:11:59.277236 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.279497 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 05:11:59.279905 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:11:59.280027 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-08 05:11:59.280376 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:11:59.280514 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:11:59.280624 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-08 05:11:59.282550 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 05:11:59.286709 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:11:59.286906 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-08 05:11:59.287564 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 05:11:59.288936 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-08 05:11:59.289082 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:11:59.289200 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-08 05:11:59.290303 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:11:59.293417 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:11:59.293597 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-08 05:11:59.294021 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:11:59.297996 (Thread-1): finished collecting timing info
2020-10-08 05:11:59.299028 (Thread-1): 05:11:59 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.05s]
2020-10-08 05:11:59.299223 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-08 05:11:59.320394 (MainThread): Using postgres connection "master".
2020-10-08 05:11:59.320638 (MainThread): On master: BEGIN
2020-10-08 05:11:59.321025 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:11:59.321219 (MainThread): On master: COMMIT
2020-10-08 05:11:59.321380 (MainThread): Using postgres connection "master".
2020-10-08 05:11:59.321533 (MainThread): On master: COMMIT
2020-10-08 05:11:59.321836 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:11:59.322372 (MainThread): 05:11:59 | 
2020-10-08 05:11:59.322600 (MainThread): 05:11:59 | Finished running 4 view models in 0.56s.
2020-10-08 05:11:59.322799 (MainThread): Connection 'master' was left open.
2020-10-08 05:11:59.322967 (MainThread): On master: Close
2020-10-08 05:11:59.323188 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-08 05:11:59.323361 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-08 05:11:59.349994 (MainThread): 
2020-10-08 05:11:59.350209 (MainThread): Completed successfully
2020-10-08 05:11:59.350367 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-08 05:11:59.350587 (MainThread): Flushing usage events
2020-10-08 05:36:38.747465 (MainThread): Got an exception trying to initialize tracking
2020-10-08 05:36:38.747620 (MainThread): Running with dbt=0.16.0
2020-10-08 05:36:38.920311 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='/usr/local/airflow/dbt', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-08 05:36:38.920699 (MainThread): Tracking: do not track
2020-10-08 05:36:38.966100 (MainThread): Partial parsing not enabled
2020-10-08 05:36:38.968857 (MainThread): Parsing macros/core.sql
2020-10-08 05:36:38.979255 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-08 05:36:38.997871 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-08 05:36:39.013512 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-08 05:36:39.043054 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-08 05:36:39.052472 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-08 05:36:39.065085 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-08 05:36:39.133798 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-08 05:36:39.167461 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-08 05:36:39.170766 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-08 05:36:39.182936 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-08 05:36:39.186528 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-08 05:36:39.235236 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-08 05:36:39.238021 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-08 05:36:39.242077 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-08 05:36:39.243784 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-08 05:36:39.245708 (MainThread): Parsing macros/etc/query.sql
2020-10-08 05:36:39.247450 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-08 05:36:39.250960 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-08 05:36:39.252706 (MainThread): Parsing macros/etc/datetime.sql
2020-10-08 05:36:39.270374 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-08 05:36:39.273746 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-08 05:36:39.276403 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-08 05:36:39.277776 (MainThread): Parsing macros/adapters/common.sql
2020-10-08 05:36:39.360146 (MainThread): Parsing macros/relations.sql
2020-10-08 05:36:39.362954 (MainThread): Parsing macros/adapters.sql
2020-10-08 05:36:39.394071 (MainThread): Parsing macros/catalog.sql
2020-10-08 05:36:39.398079 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-08 05:36:39.426044 (MainThread): Partial parsing not enabled
2020-10-08 05:36:39.473129 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:36:39.473292 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:36:39.501378 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:36:39.501551 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:36:39.511366 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:36:39.511544 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:36:39.522111 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:36:39.522292 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:36:40.108965 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-08 05:36:40.114067 (MainThread): 
2020-10-08 05:36:40.114516 (MainThread): Acquiring new postgres connection "master".
2020-10-08 05:36:40.114642 (MainThread): Opening a new connection, currently in state init
2020-10-08 05:36:40.139921 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-08 05:36:40.140098 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-08 05:36:40.267658 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-08 05:36:40.267800 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-08 05:36:40.272426 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-08 05:36:40.298049 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-08 05:36:40.298206 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-08 05:36:40.300351 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-08 05:36:40.300471 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-08 05:36:40.300794 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:36:40.300915 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-08 05:36:40.301010 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-08 05:36:40.303327 (ThreadPoolExecutor-1_0): SQL status: SELECT 25 in 0.00 seconds
2020-10-08 05:36:40.333939 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-08 05:36:40.369555 (MainThread): Using postgres connection "master".
2020-10-08 05:36:40.369838 (MainThread): On master: BEGIN
2020-10-08 05:36:40.373576 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:36:40.373814 (MainThread): Using postgres connection "master".
2020-10-08 05:36:40.373945 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-08 05:36:40.380844 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-10-08 05:36:40.382232 (MainThread): On master: ROLLBACK
2020-10-08 05:36:40.382524 (MainThread): Using postgres connection "master".
2020-10-08 05:36:40.382666 (MainThread): On master: BEGIN
2020-10-08 05:36:40.383129 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:36:40.383287 (MainThread): On master: COMMIT
2020-10-08 05:36:40.383434 (MainThread): Using postgres connection "master".
2020-10-08 05:36:40.383548 (MainThread): On master: COMMIT
2020-10-08 05:36:40.383850 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:36:40.384244 (MainThread): 05:36:40 | Concurrency: 1 threads (target='dev')
2020-10-08 05:36:40.384421 (MainThread): 05:36:40 | 
2020-10-08 05:36:40.392183 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-08 05:36:40.392435 (Thread-1): 05:36:40 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-08 05:36:40.392903 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:36:40.393025 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-08 05:36:40.393155 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-08 05:36:40.419062 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 05:36:40.419405 (Thread-1): finished collecting timing info
2020-10-08 05:36:40.470604 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:36:40.470772 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-08 05:36:40.471378 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.475091 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:36:40.475204 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-08 05:36:40.475527 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.477356 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 05:36:40.477674 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:36:40.477777 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-08 05:36:40.478063 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:36:40.478184 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:36:40.478279 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-08 05:36:40.479620 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 05:36:40.482783 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:36:40.482898 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-08 05:36:40.483335 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 05:36:40.484336 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-08 05:36:40.484445 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:36:40.484540 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-08 05:36:40.488189 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:36:40.490543 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 05:36:40.490670 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-08 05:36:40.491026 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.494180 (Thread-1): finished collecting timing info
2020-10-08 05:36:40.494978 (Thread-1): 05:36:40 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.10s]
2020-10-08 05:36:40.495152 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-08 05:36:40.495357 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 05:36:40.495513 (Thread-1): 05:36:40 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-08 05:36:40.495826 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:36:40.495929 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-08 05:36:40.496030 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-08 05:36:40.506109 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 05:36:40.506421 (Thread-1): finished collecting timing info
2020-10-08 05:36:40.516493 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:36:40.516688 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-08 05:36:40.517163 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.520694 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:36:40.520870 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-08 05:36:40.521352 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.523975 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 05:36:40.524516 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:36:40.524700 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-08 05:36:40.524975 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:36:40.525124 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:36:40.525258 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-08 05:36:40.526248 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 05:36:40.530263 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:36:40.530425 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-08 05:36:40.530893 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 05:36:40.532010 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-08 05:36:40.532124 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:36:40.532217 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-08 05:36:40.533182 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:36:40.536315 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 05:36:40.536537 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-08 05:36:40.536937 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.543077 (Thread-1): finished collecting timing info
2020-10-08 05:36:40.543986 (Thread-1): 05:36:40 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.05s]
2020-10-08 05:36:40.544167 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 05:36:40.544616 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-08 05:36:40.544787 (Thread-1): 05:36:40 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-08 05:36:40.545137 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:36:40.545241 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-08 05:36:40.545343 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-08 05:36:40.557299 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 05:36:40.557641 (Thread-1): finished collecting timing info
2020-10-08 05:36:40.567418 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:36:40.567585 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-08 05:36:40.568004 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.572219 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:36:40.572377 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-08 05:36:40.572899 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.575042 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 05:36:40.575417 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:36:40.575533 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-08 05:36:40.575837 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:36:40.575959 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:36:40.576065 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-08 05:36:40.577226 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 05:36:40.580434 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:36:40.580550 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-08 05:36:40.580980 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 05:36:40.582015 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-08 05:36:40.582126 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:36:40.582221 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-08 05:36:40.583223 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:36:40.585692 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 05:36:40.585815 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-08 05:36:40.586133 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.590121 (Thread-1): finished collecting timing info
2020-10-08 05:36:40.590998 (Thread-1): 05:36:40 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.05s]
2020-10-08 05:36:40.591175 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-08 05:36:40.591709 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-08 05:36:40.591876 (Thread-1): 05:36:40 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-08 05:36:40.592210 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:36:40.592311 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-08 05:36:40.592410 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-08 05:36:40.601682 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 05:36:40.602245 (Thread-1): finished collecting timing info
2020-10-08 05:36:40.613109 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:36:40.613280 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-08 05:36:40.613646 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.616681 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:36:40.616798 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-08 05:36:40.617143 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.620947 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 05:36:40.621388 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:36:40.621542 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-08 05:36:40.621897 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:36:40.622041 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:36:40.622141 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-08 05:36:40.623542 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 05:36:40.626909 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:36:40.627046 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-08 05:36:40.627522 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 05:36:40.628624 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-08 05:36:40.628739 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:36:40.628835 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-08 05:36:40.629838 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:36:40.632258 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 05:36:40.632370 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-08 05:36:40.632643 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 05:36:40.636092 (Thread-1): finished collecting timing info
2020-10-08 05:36:40.637131 (Thread-1): 05:36:40 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.04s]
2020-10-08 05:36:40.637318 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-08 05:36:40.702675 (MainThread): Using postgres connection "master".
2020-10-08 05:36:40.702850 (MainThread): On master: BEGIN
2020-10-08 05:36:40.703169 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 05:36:40.703304 (MainThread): On master: COMMIT
2020-10-08 05:36:40.703419 (MainThread): Using postgres connection "master".
2020-10-08 05:36:40.703519 (MainThread): On master: COMMIT
2020-10-08 05:36:40.703717 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-08 05:36:40.704062 (MainThread): 05:36:40 | 
2020-10-08 05:36:40.704199 (MainThread): 05:36:40 | Finished running 4 view models in 0.59s.
2020-10-08 05:36:40.704318 (MainThread): Connection 'master' was left open.
2020-10-08 05:36:40.704428 (MainThread): On master: Close
2020-10-08 05:36:40.704574 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-08 05:36:40.704694 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-08 05:36:40.721874 (MainThread): 
2020-10-08 05:36:40.722079 (MainThread): Completed successfully
2020-10-08 05:36:40.722229 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-08 05:36:40.722487 (MainThread): Flushing usage events
2020-10-08 20:12:08.601906 (MainThread): Got an exception trying to initialize tracking
2020-10-08 20:12:08.602056 (MainThread): Running with dbt=0.16.0
2020-10-08 20:12:08.677343 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='/usr/local/airflow/dbt', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-08 20:12:08.677667 (MainThread): Tracking: do not track
2020-10-08 20:12:08.710802 (MainThread): Partial parsing not enabled
2020-10-08 20:12:08.712821 (MainThread): Parsing macros/core.sql
2020-10-08 20:12:08.720448 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-08 20:12:08.734254 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-08 20:12:08.746468 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-08 20:12:08.773249 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-08 20:12:08.782664 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-08 20:12:08.795555 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-08 20:12:08.915479 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-08 20:12:08.954582 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-08 20:12:08.959295 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-08 20:12:08.978650 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-08 20:12:08.983576 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-08 20:12:09.030646 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-08 20:12:09.032672 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-08 20:12:09.036131 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-08 20:12:09.037538 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-08 20:12:09.039296 (MainThread): Parsing macros/etc/query.sql
2020-10-08 20:12:09.040962 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-08 20:12:09.044361 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-08 20:12:09.046079 (MainThread): Parsing macros/etc/datetime.sql
2020-10-08 20:12:09.065618 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-08 20:12:09.070148 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-08 20:12:09.073458 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-08 20:12:09.075174 (MainThread): Parsing macros/adapters/common.sql
2020-10-08 20:12:09.164213 (MainThread): Parsing macros/relations.sql
2020-10-08 20:12:09.166885 (MainThread): Parsing macros/adapters.sql
2020-10-08 20:12:09.201806 (MainThread): Parsing macros/catalog.sql
2020-10-08 20:12:09.206302 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-08 20:12:09.231972 (MainThread): Partial parsing not enabled
2020-10-08 20:12:09.270213 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 20:12:09.270333 (MainThread): Opening a new connection, currently in state init
2020-10-08 20:12:09.291691 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 20:12:09.291783 (MainThread): Opening a new connection, currently in state init
2020-10-08 20:12:09.298160 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 20:12:09.298247 (MainThread): Opening a new connection, currently in state init
2020-10-08 20:12:09.304675 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 20:12:09.304762 (MainThread): Opening a new connection, currently in state init
2020-10-08 20:12:09.696087 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-08 20:12:09.700605 (MainThread): 
2020-10-08 20:12:09.700979 (MainThread): Acquiring new postgres connection "master".
2020-10-08 20:12:09.701089 (MainThread): Opening a new connection, currently in state init
2020-10-08 20:12:09.723886 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-08 20:12:09.724012 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-08 20:12:09.873535 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-08 20:12:09.873723 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-08 20:12:09.878321 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-08 20:12:09.907183 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-08 20:12:09.907422 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-08 20:12:09.909740 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-08 20:12:09.909876 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-08 20:12:09.910235 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-08 20:12:09.910350 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-08 20:12:09.910445 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-08 20:12:09.913527 (ThreadPoolExecutor-1_0): SQL status: SELECT 27 in 0.00 seconds
2020-10-08 20:12:09.945437 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-08 20:12:09.973118 (MainThread): Using postgres connection "master".
2020-10-08 20:12:09.973268 (MainThread): On master: BEGIN
2020-10-08 20:12:09.975961 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 20:12:09.976121 (MainThread): Using postgres connection "master".
2020-10-08 20:12:09.976218 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-08 20:12:09.981869 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-10-08 20:12:09.983008 (MainThread): On master: ROLLBACK
2020-10-08 20:12:09.983242 (MainThread): Using postgres connection "master".
2020-10-08 20:12:09.983347 (MainThread): On master: BEGIN
2020-10-08 20:12:09.983634 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 20:12:09.983763 (MainThread): On master: COMMIT
2020-10-08 20:12:09.983854 (MainThread): Using postgres connection "master".
2020-10-08 20:12:09.983940 (MainThread): On master: COMMIT
2020-10-08 20:12:09.984118 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-08 20:12:09.984423 (MainThread): 20:12:09 | Concurrency: 1 threads (target='dev')
2020-10-08 20:12:09.984557 (MainThread): 20:12:09 | 
2020-10-08 20:12:09.990836 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-08 20:12:09.991040 (Thread-1): 20:12:09 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-08 20:12:09.991537 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 20:12:09.991636 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-08 20:12:09.991741 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-08 20:12:10.014610 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 20:12:10.014959 (Thread-1): finished collecting timing info
2020-10-08 20:12:10.066864 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 20:12:10.067035 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-08 20:12:10.067592 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.071175 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 20:12:10.071330 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-08 20:12:10.071718 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.073644 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 20:12:10.073945 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 20:12:10.074047 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-08 20:12:10.074316 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 20:12:10.074437 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 20:12:10.074532 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-08 20:12:10.075790 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 20:12:10.078938 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 20:12:10.079053 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-08 20:12:10.079474 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 20:12:10.080507 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-08 20:12:10.080645 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 20:12:10.080742 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-08 20:12:10.081782 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 20:12:10.084161 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 20:12:10.084279 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-08 20:12:10.084595 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.087681 (Thread-1): finished collecting timing info
2020-10-08 20:12:10.089683 (Thread-1): 20:12:10 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.10s]
2020-10-08 20:12:10.089835 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-08 20:12:10.089993 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 20:12:10.090231 (Thread-1): 20:12:10 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-08 20:12:10.090513 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 20:12:10.090607 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-08 20:12:10.090704 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-08 20:12:10.100144 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 20:12:10.100441 (Thread-1): finished collecting timing info
2020-10-08 20:12:10.109491 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 20:12:10.109628 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-08 20:12:10.110023 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.112911 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 20:12:10.113021 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-08 20:12:10.113346 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.115152 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 20:12:10.115448 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 20:12:10.115547 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-08 20:12:10.115818 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 20:12:10.115929 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 20:12:10.116021 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-08 20:12:10.116757 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 20:12:10.119710 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 20:12:10.119818 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-08 20:12:10.120216 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 20:12:10.121181 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-08 20:12:10.121284 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 20:12:10.121372 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-08 20:12:10.122382 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 20:12:10.124623 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 20:12:10.124727 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-08 20:12:10.125037 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.128031 (Thread-1): finished collecting timing info
2020-10-08 20:12:10.128793 (Thread-1): 20:12:10 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.04s]
2020-10-08 20:12:10.128936 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 20:12:10.129326 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-08 20:12:10.129477 (Thread-1): 20:12:10 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-08 20:12:10.129764 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 20:12:10.129854 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-08 20:12:10.129946 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-08 20:12:10.140415 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 20:12:10.140697 (Thread-1): finished collecting timing info
2020-10-08 20:12:10.149832 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 20:12:10.149957 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-08 20:12:10.150367 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.154725 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 20:12:10.154852 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-08 20:12:10.155221 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.156908 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 20:12:10.157225 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 20:12:10.157323 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-08 20:12:10.157581 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 20:12:10.157693 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 20:12:10.157783 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-08 20:12:10.158998 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 20:12:10.162224 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 20:12:10.162331 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-08 20:12:10.162766 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 20:12:10.163737 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-08 20:12:10.163844 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 20:12:10.163932 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-08 20:12:10.164934 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 20:12:10.167175 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 20:12:10.167284 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-08 20:12:10.167616 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.170617 (Thread-1): finished collecting timing info
2020-10-08 20:12:10.171371 (Thread-1): 20:12:10 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.04s]
2020-10-08 20:12:10.171513 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-08 20:12:10.171903 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-08 20:12:10.172055 (Thread-1): 20:12:10 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-08 20:12:10.172327 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 20:12:10.172415 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-08 20:12:10.172583 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-08 20:12:10.181307 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 20:12:10.181569 (Thread-1): finished collecting timing info
2020-10-08 20:12:10.190463 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 20:12:10.190585 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-08 20:12:10.190977 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.193830 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 20:12:10.193933 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-08 20:12:10.194257 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.196013 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 20:12:10.196388 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 20:12:10.196488 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-08 20:12:10.196731 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-08 20:12:10.196825 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 20:12:10.196907 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-08 20:12:10.198055 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-08 20:12:10.201118 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 20:12:10.201228 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-08 20:12:10.201636 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-08 20:12:10.202618 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-08 20:12:10.202722 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 20:12:10.202810 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-08 20:12:10.207146 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-08 20:12:10.209356 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 20:12:10.209459 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-08 20:12:10.209778 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-08 20:12:10.212693 (Thread-1): finished collecting timing info
2020-10-08 20:12:10.213419 (Thread-1): 20:12:10 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.04s]
2020-10-08 20:12:10.213556 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-08 20:12:10.296924 (MainThread): Using postgres connection "master".
2020-10-08 20:12:10.297155 (MainThread): On master: BEGIN
2020-10-08 20:12:10.297526 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-08 20:12:10.297684 (MainThread): On master: COMMIT
2020-10-08 20:12:10.297799 (MainThread): Using postgres connection "master".
2020-10-08 20:12:10.297905 (MainThread): On master: COMMIT
2020-10-08 20:12:10.298156 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-08 20:12:10.298530 (MainThread): 20:12:10 | 
2020-10-08 20:12:10.298685 (MainThread): 20:12:10 | Finished running 4 view models in 0.60s.
2020-10-08 20:12:10.298812 (MainThread): Connection 'master' was left open.
2020-10-08 20:12:10.298914 (MainThread): On master: Close
2020-10-08 20:12:10.299069 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-08 20:12:10.299175 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-08 20:12:10.317091 (MainThread): 
2020-10-08 20:12:10.317285 (MainThread): Completed successfully
2020-10-08 20:12:10.317424 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-08 20:12:10.317645 (MainThread): Flushing usage events
2020-10-08 21:11:00.846095 (MainThread): Got an exception trying to initialize tracking
2020-10-08 21:11:00.846250 (MainThread): Running with dbt=0.16.0
2020-10-08 21:11:00.943083 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-08 21:11:00.943574 (MainThread): Tracking: do not track
2020-10-08 21:11:00.978756 (MainThread): Partial parsing not enabled
2020-10-08 21:11:00.982012 (MainThread): Parsing macros/core.sql
2020-10-08 21:11:00.989948 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-08 21:11:01.004232 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-08 21:11:01.015720 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-08 21:11:01.038651 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-08 21:11:01.048061 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-08 21:11:01.060744 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-08 21:11:01.142519 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-08 21:11:01.177251 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-08 21:11:01.180650 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-08 21:11:01.192694 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-08 21:11:01.196430 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-08 21:11:01.239971 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-08 21:11:01.242078 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-08 21:11:01.245694 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-08 21:11:01.247181 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-08 21:11:01.249029 (MainThread): Parsing macros/etc/query.sql
2020-10-08 21:11:01.250830 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-08 21:11:01.254321 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-08 21:11:01.256108 (MainThread): Parsing macros/etc/datetime.sql
2020-10-08 21:11:01.274249 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-08 21:11:01.277954 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-08 21:11:01.280951 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-08 21:11:01.282696 (MainThread): Parsing macros/adapters/common.sql
2020-10-08 21:11:01.377048 (MainThread): Parsing macros/relations.sql
2020-10-08 21:11:01.379940 (MainThread): Parsing macros/adapters.sql
2020-10-08 21:11:01.413698 (MainThread): Parsing macros/catalog.sql
2020-10-08 21:11:01.417863 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-08 21:11:01.444494 (MainThread): Partial parsing not enabled
2020-10-08 21:11:01.491543 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 21:11:01.491736 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:11:01.525019 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 21:11:01.525189 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:11:01.535255 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 21:11:01.535414 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:11:01.544519 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 21:11:01.544663 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:11:02.003631 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-08 21:11:02.011975 (MainThread): 
2020-10-08 21:11:02.012656 (MainThread): 21:11:02 | Concurrency: 1 threads (target='dev')
2020-10-08 21:11:02.013349 (MainThread): 21:11:02 | 
2020-10-08 21:11:02.027208 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-08 21:11:02.027777 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 21:11:02.027943 (Thread-1): Opening a new connection, currently in state init
2020-10-08 21:11:02.028100 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-08 21:11:02.060233 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 21:11:02.060560 (Thread-1): finished collecting timing info
2020-10-08 21:11:02.060883 (Thread-1): finished collecting timing info
2020-10-08 21:11:02.061379 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-08 21:11:02.061556 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 21:11:02.061948 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 21:11:02.062055 (Thread-1): Opening a new connection, currently in state init
2020-10-08 21:11:02.062175 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-08 21:11:02.072061 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 21:11:02.072391 (Thread-1): finished collecting timing info
2020-10-08 21:11:02.072702 (Thread-1): finished collecting timing info
2020-10-08 21:11:02.073196 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 21:11:02.073614 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-08 21:11:02.073936 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 21:11:02.074045 (Thread-1): Opening a new connection, currently in state init
2020-10-08 21:11:02.074160 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-08 21:11:02.085519 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 21:11:02.085868 (Thread-1): finished collecting timing info
2020-10-08 21:11:02.086196 (Thread-1): finished collecting timing info
2020-10-08 21:11:02.086700 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-08 21:11:02.087183 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-08 21:11:02.087506 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 21:11:02.087615 (Thread-1): Opening a new connection, currently in state init
2020-10-08 21:11:02.087717 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-08 21:11:02.097290 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 21:11:02.097646 (Thread-1): finished collecting timing info
2020-10-08 21:11:02.097951 (Thread-1): finished collecting timing info
2020-10-08 21:11:02.098459 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-08 21:11:02.127132 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-08 21:11:02.127315 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was properly closed.
2020-10-08 21:11:02.144911 (MainThread): 21:11:02 | Done.
2020-10-08 21:11:02.148516 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-08 21:11:02.148695 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:11:02.148843 (MainThread): 21:11:02 | Building catalog
2020-10-08 21:11:02.194378 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-08 21:11:02.194543 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-08 21:11:02.310205 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-08 21:11:02.310366 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-08 21:11:02.313927 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-08 21:11:02.314093 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-08 21:11:02.314218 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-08 21:11:02.319079 (ThreadPoolExecutor-0_0): SQL status: SELECT 197 in 0.00 seconds
2020-10-08 21:11:02.340683 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-08 21:11:02.471334 (MainThread): 21:11:02 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-08 21:11:02.471663 (MainThread): Flushing usage events
2020-10-08 21:11:02.471824 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-08 21:11:02.471903 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-08 21:11:02.471974 (MainThread): On airflow.information_schema: Close
2020-10-08 21:50:25.001746 (MainThread): Got an exception trying to initialize tracking
2020-10-08 21:50:25.001893 (MainThread): Running with dbt=0.16.0
2020-10-08 21:50:25.085105 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-08 21:50:25.086220 (MainThread): Tracking: do not track
2020-10-08 21:50:25.120209 (MainThread): Partial parsing not enabled
2020-10-08 21:50:25.122357 (MainThread): Parsing macros/core.sql
2020-10-08 21:50:25.130557 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-08 21:50:25.145891 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-08 21:50:25.158924 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-08 21:50:25.184720 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-08 21:50:25.193506 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-08 21:50:25.205267 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-08 21:50:25.303526 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-08 21:50:25.373410 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-08 21:50:25.376725 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-08 21:50:25.388562 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-08 21:50:25.392186 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-08 21:50:25.440808 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-08 21:50:25.443469 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-08 21:50:25.448171 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-08 21:50:25.450103 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-08 21:50:25.452497 (MainThread): Parsing macros/etc/query.sql
2020-10-08 21:50:25.454822 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-08 21:50:25.459316 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-08 21:50:25.461511 (MainThread): Parsing macros/etc/datetime.sql
2020-10-08 21:50:25.482313 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-08 21:50:25.486246 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-08 21:50:25.489385 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-08 21:50:25.491179 (MainThread): Parsing macros/adapters/common.sql
2020-10-08 21:50:25.588874 (MainThread): Parsing macros/relations.sql
2020-10-08 21:50:25.591899 (MainThread): Parsing macros/adapters.sql
2020-10-08 21:50:25.629996 (MainThread): Parsing macros/catalog.sql
2020-10-08 21:50:25.634741 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-08 21:50:25.665602 (MainThread): Partial parsing not enabled
2020-10-08 21:50:25.720461 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 21:50:25.720624 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:50:25.748921 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 21:50:25.749075 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:50:25.757520 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 21:50:25.757671 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:50:25.766327 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 21:50:25.766476 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:50:26.240500 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-08 21:50:26.244999 (MainThread): 
2020-10-08 21:50:26.245222 (MainThread): 21:50:26 | Concurrency: 1 threads (target='dev')
2020-10-08 21:50:26.245398 (MainThread): 21:50:26 | 
2020-10-08 21:50:26.252697 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-08 21:50:26.253276 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-08 21:50:26.253420 (Thread-1): Opening a new connection, currently in state init
2020-10-08 21:50:26.253549 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-08 21:50:26.286413 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-08 21:50:26.286886 (Thread-1): finished collecting timing info
2020-10-08 21:50:26.287380 (Thread-1): finished collecting timing info
2020-10-08 21:50:26.288137 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-08 21:50:26.288379 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 21:50:26.288951 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-08 21:50:26.289112 (Thread-1): Opening a new connection, currently in state init
2020-10-08 21:50:26.289261 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-08 21:50:26.304176 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-08 21:50:26.304640 (Thread-1): finished collecting timing info
2020-10-08 21:50:26.305093 (Thread-1): finished collecting timing info
2020-10-08 21:50:26.305833 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-08 21:50:26.306338 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-08 21:50:26.306780 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-08 21:50:26.306934 (Thread-1): Opening a new connection, currently in state init
2020-10-08 21:50:26.307082 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-08 21:50:26.323953 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-08 21:50:26.324413 (Thread-1): finished collecting timing info
2020-10-08 21:50:26.324861 (Thread-1): finished collecting timing info
2020-10-08 21:50:26.325606 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-08 21:50:26.326122 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-08 21:50:26.326557 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-08 21:50:26.326707 (Thread-1): Opening a new connection, currently in state init
2020-10-08 21:50:26.326851 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-08 21:50:26.340988 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-08 21:50:26.341452 (Thread-1): finished collecting timing info
2020-10-08 21:50:26.341882 (Thread-1): finished collecting timing info
2020-10-08 21:50:26.342626 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-08 21:50:26.362418 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-08 21:50:26.362699 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was properly closed.
2020-10-08 21:50:26.393994 (MainThread): 21:50:26 | Done.
2020-10-08 21:50:26.396445 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-08 21:50:26.396608 (MainThread): Opening a new connection, currently in state init
2020-10-08 21:50:26.396789 (MainThread): 21:50:26 | Building catalog
2020-10-08 21:50:26.440380 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-08 21:50:26.440727 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-08 21:50:26.627902 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-08 21:50:26.628054 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-08 21:50:26.631344 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-08 21:50:26.631486 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-08 21:50:26.631572 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-08 21:50:26.634945 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.00 seconds
2020-10-08 21:50:26.651585 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-08 21:50:26.789547 (MainThread): 21:50:26 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-08 21:50:26.790080 (MainThread): Flushing usage events
2020-10-08 21:50:26.790277 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-08 21:50:26.790376 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-08 21:50:26.790468 (MainThread): On airflow.information_schema: Close
2020-10-08 21:50:50.078732 (MainThread): Got an exception trying to initialize tracking
2020-10-08 21:50:50.078888 (MainThread): Running with dbt=0.16.0
2020-10-08 21:50:50.162561 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-08 21:50:50.162891 (MainThread): Tracking: do not track
2020-10-08 21:50:50.171281 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-08 21:50:50.171559 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-08 21:50:50.171683 (MainThread): Press Ctrl+C to exit.


2020-10-08 22:16:01.981827 (MainThread): Flushing usage events
2020-10-08 22:16:01.982196 (MainThread): ctrl-c
2020-10-08 22:16:46.228802 (MainThread): Got an exception trying to initialize tracking
2020-10-08 22:16:46.228961 (MainThread): Running with dbt=0.16.0
2020-10-08 22:16:46.318970 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8080, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-08 22:16:46.319396 (MainThread): Tracking: do not track
2020-10-08 22:16:46.328110 (MainThread): Serving docs at 0.0.0.0:8080
2020-10-08 22:16:46.328401 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2020-10-08 22:16:46.328634 (MainThread): Press Ctrl+C to exit.


2020-10-08 22:16:46.329083 (MainThread): Flushing usage events
2020-10-08 22:16:46.329341 (MainThread): Encountered an error:
2020-10-08 22:16:46.329455 (MainThread): [Errno 98] Address already in use
2020-10-08 22:16:46.330541 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/serve.py", line 31, in run
    SimpleHTTPRequestHandler  # type: ignore
  File "/usr/local/lib/python3.7/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/usr/local/lib/python3.7/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

2020-10-08 22:17:39.653198 (MainThread): Got an exception trying to initialize tracking
2020-10-08 22:17:39.653345 (MainThread): Running with dbt=0.16.0
2020-10-08 22:17:39.733574 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8080, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-08 22:17:39.733897 (MainThread): Tracking: do not track
2020-10-08 22:17:39.742019 (MainThread): Serving docs at 0.0.0.0:8080
2020-10-08 22:17:39.742299 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2020-10-08 22:17:39.742431 (MainThread): Press Ctrl+C to exit.


2020-10-08 22:17:39.742857 (MainThread): Flushing usage events
2020-10-08 22:17:39.743111 (MainThread): Encountered an error:
2020-10-08 22:17:39.743224 (MainThread): [Errno 98] Address already in use
2020-10-08 22:17:39.744082 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.7/site-packages/dbt/task/serve.py", line 31, in run
    SimpleHTTPRequestHandler  # type: ignore
  File "/usr/local/lib/python3.7/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/usr/local/lib/python3.7/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

2020-10-08 22:17:44.248396 (MainThread): Got an exception trying to initialize tracking
2020-10-08 22:17:44.248589 (MainThread): Running with dbt=0.16.0
2020-10-08 22:17:44.340428 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-08 22:17:44.340783 (MainThread): Tracking: do not track
2020-10-08 22:17:44.348664 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-08 22:17:44.348928 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-08 22:17:44.349059 (MainThread): Press Ctrl+C to exit.


2020-10-08 22:17:59.255577 (MainThread): Flushing usage events
2020-10-08 22:17:59.256091 (MainThread): ctrl-c
2020-10-09 01:50:47.092529 (MainThread): Got an exception trying to initialize tracking
2020-10-09 01:50:47.092681 (MainThread): Running with dbt=0.16.0
2020-10-09 01:50:47.175429 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-09 01:50:47.177822 (MainThread): Tracking: do not track
2020-10-09 01:50:47.210770 (MainThread): Partial parsing not enabled
2020-10-09 01:50:47.213018 (MainThread): Parsing macros/core.sql
2020-10-09 01:50:47.221890 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-09 01:50:47.240065 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-09 01:50:47.257372 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-09 01:50:47.289031 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-09 01:50:47.298916 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-09 01:50:47.311683 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-09 01:50:47.378790 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-09 01:50:47.408100 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-09 01:50:47.410925 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-09 01:50:47.421202 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-09 01:50:47.424026 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-09 01:50:47.460408 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-09 01:50:47.462107 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-09 01:50:47.465130 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-09 01:50:47.466355 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-09 01:50:47.467882 (MainThread): Parsing macros/etc/query.sql
2020-10-09 01:50:47.469329 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-09 01:50:47.472296 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-09 01:50:47.473767 (MainThread): Parsing macros/etc/datetime.sql
2020-10-09 01:50:47.489692 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-09 01:50:47.492904 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-09 01:50:47.495481 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-09 01:50:47.496907 (MainThread): Parsing macros/adapters/common.sql
2020-10-09 01:50:47.578841 (MainThread): Parsing macros/relations.sql
2020-10-09 01:50:47.581496 (MainThread): Parsing macros/adapters.sql
2020-10-09 01:50:47.636718 (MainThread): Parsing macros/catalog.sql
2020-10-09 01:50:47.644215 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-09 01:50:47.701707 (MainThread): Partial parsing not enabled
2020-10-09 01:50:47.758053 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 01:50:47.758248 (MainThread): Opening a new connection, currently in state init
2020-10-09 01:50:47.793076 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 01:50:47.793269 (MainThread): Opening a new connection, currently in state init
2020-10-09 01:50:47.804172 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 01:50:47.804355 (MainThread): Opening a new connection, currently in state init
2020-10-09 01:50:47.815171 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 01:50:47.815335 (MainThread): Opening a new connection, currently in state init
2020-10-09 01:50:48.256482 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-09 01:50:48.261359 (MainThread): 
2020-10-09 01:50:48.261561 (MainThread): 01:50:48 | Concurrency: 1 threads (target='dev')
2020-10-09 01:50:48.261734 (MainThread): 01:50:48 | 
2020-10-09 01:50:48.269519 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-09 01:50:48.270067 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 01:50:48.270230 (Thread-1): Opening a new connection, currently in state init
2020-10-09 01:50:48.270358 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-09 01:50:48.295155 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-09 01:50:48.295489 (Thread-1): finished collecting timing info
2020-10-09 01:50:48.295806 (Thread-1): finished collecting timing info
2020-10-09 01:50:48.296280 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-09 01:50:48.296435 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 01:50:48.296720 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 01:50:48.296827 (Thread-1): Opening a new connection, currently in state init
2020-10-09 01:50:48.296929 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-09 01:50:48.306633 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-09 01:50:48.306877 (Thread-1): finished collecting timing info
2020-10-09 01:50:48.307172 (Thread-1): finished collecting timing info
2020-10-09 01:50:48.307596 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 01:50:48.308000 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-09 01:50:48.308271 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 01:50:48.308370 (Thread-1): Opening a new connection, currently in state init
2020-10-09 01:50:48.308463 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-09 01:50:48.318903 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-09 01:50:48.319139 (Thread-1): finished collecting timing info
2020-10-09 01:50:48.319404 (Thread-1): finished collecting timing info
2020-10-09 01:50:48.319810 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-09 01:50:48.320244 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-09 01:50:48.320528 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 01:50:48.320625 (Thread-1): Opening a new connection, currently in state init
2020-10-09 01:50:48.320715 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-09 01:50:48.329273 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-09 01:50:48.329492 (Thread-1): finished collecting timing info
2020-10-09 01:50:48.329757 (Thread-1): finished collecting timing info
2020-10-09 01:50:48.330170 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-09 01:50:48.369746 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-09 01:50:48.369988 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was properly closed.
2020-10-09 01:50:48.389336 (MainThread): 01:50:48 | Done.
2020-10-09 01:50:48.391740 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-09 01:50:48.391861 (MainThread): Opening a new connection, currently in state init
2020-10-09 01:50:48.391966 (MainThread): 01:50:48 | Building catalog
2020-10-09 01:50:48.428596 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-09 01:50:48.428753 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-09 01:50:48.528698 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-09 01:50:48.528842 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-09 01:50:48.532083 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-09 01:50:48.532216 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-09 01:50:48.532300 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-09 01:50:48.537128 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.00 seconds
2020-10-09 01:50:48.553896 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-09 01:50:48.668229 (MainThread): 01:50:48 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-09 01:50:48.668586 (MainThread): Flushing usage events
2020-10-09 01:50:48.668743 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-09 01:50:48.668820 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-09 01:50:48.668893 (MainThread): On airflow.information_schema: Close
2020-10-09 01:50:57.823147 (MainThread): Got an exception trying to initialize tracking
2020-10-09 01:50:57.823402 (MainThread): Running with dbt=0.16.0
2020-10-09 01:50:57.956089 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-09 01:50:57.956537 (MainThread): Tracking: do not track
2020-10-09 01:50:57.966354 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-09 01:50:57.966731 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-09 01:50:57.966909 (MainThread): Press Ctrl+C to exit.


2020-10-09 02:01:56.230607 (MainThread): Flushing usage events
2020-10-09 02:01:56.231622 (MainThread): ctrl-c
2020-10-09 02:59:26.657298 (MainThread): Got an exception trying to initialize tracking
2020-10-09 02:59:26.657442 (MainThread): Running with dbt=0.16.0
2020-10-09 02:59:26.742750 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-09 02:59:26.743148 (MainThread): Tracking: do not track
2020-10-09 02:59:26.778908 (MainThread): Partial parsing not enabled
2020-10-09 02:59:26.781129 (MainThread): Parsing macros/core.sql
2020-10-09 02:59:26.789654 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-09 02:59:26.805241 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-09 02:59:26.818880 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-09 02:59:26.845024 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-09 02:59:26.854021 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-09 02:59:26.865674 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-09 02:59:26.994471 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-09 02:59:27.034703 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-09 02:59:27.037731 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-09 02:59:27.048274 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-09 02:59:27.051436 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-09 02:59:27.090426 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-09 02:59:27.092274 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-09 02:59:27.095531 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-09 02:59:27.096857 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-09 02:59:27.098564 (MainThread): Parsing macros/etc/query.sql
2020-10-09 02:59:27.100129 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-09 02:59:27.103364 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-09 02:59:27.104927 (MainThread): Parsing macros/etc/datetime.sql
2020-10-09 02:59:27.126314 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-09 02:59:27.129872 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-09 02:59:27.133016 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-09 02:59:27.135047 (MainThread): Parsing macros/adapters/common.sql
2020-10-09 02:59:27.248791 (MainThread): Parsing macros/relations.sql
2020-10-09 02:59:27.252901 (MainThread): Parsing macros/adapters.sql
2020-10-09 02:59:27.303355 (MainThread): Parsing macros/catalog.sql
2020-10-09 02:59:27.309530 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-09 02:59:27.345927 (MainThread): Partial parsing not enabled
2020-10-09 02:59:27.398906 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 02:59:27.399063 (MainThread): Opening a new connection, currently in state init
2020-10-09 02:59:27.427589 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 02:59:27.427760 (MainThread): Opening a new connection, currently in state init
2020-10-09 02:59:27.436745 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 02:59:27.436909 (MainThread): Opening a new connection, currently in state init
2020-10-09 02:59:27.446574 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 02:59:27.446775 (MainThread): Opening a new connection, currently in state init
2020-10-09 02:59:27.956550 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-09 02:59:27.961793 (MainThread): 
2020-10-09 02:59:27.962032 (MainThread): 02:59:27 | Concurrency: 1 threads (target='dev')
2020-10-09 02:59:27.962221 (MainThread): 02:59:27 | 
2020-10-09 02:59:27.970580 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-09 02:59:27.971096 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 02:59:27.971227 (Thread-1): Opening a new connection, currently in state init
2020-10-09 02:59:27.971369 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-09 02:59:28.000077 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-09 02:59:28.000427 (Thread-1): finished collecting timing info
2020-10-09 02:59:28.000759 (Thread-1): finished collecting timing info
2020-10-09 02:59:28.001266 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-09 02:59:28.001430 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 02:59:28.001889 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 02:59:28.002007 (Thread-1): Opening a new connection, currently in state init
2020-10-09 02:59:28.002127 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-09 02:59:28.011830 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-09 02:59:28.012107 (Thread-1): finished collecting timing info
2020-10-09 02:59:28.012399 (Thread-1): finished collecting timing info
2020-10-09 02:59:28.012870 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 02:59:28.013311 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-09 02:59:28.013639 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 02:59:28.013745 (Thread-1): Opening a new connection, currently in state init
2020-10-09 02:59:28.013844 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-09 02:59:28.024953 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-09 02:59:28.025281 (Thread-1): finished collecting timing info
2020-10-09 02:59:28.025583 (Thread-1): finished collecting timing info
2020-10-09 02:59:28.026061 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-09 02:59:28.026492 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-09 02:59:28.026807 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 02:59:28.026913 (Thread-1): Opening a new connection, currently in state init
2020-10-09 02:59:28.027013 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-09 02:59:28.036215 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-09 02:59:28.036473 (Thread-1): finished collecting timing info
2020-10-09 02:59:28.036752 (Thread-1): finished collecting timing info
2020-10-09 02:59:28.037190 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-09 02:59:28.070493 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-09 02:59:28.070653 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was properly closed.
2020-10-09 02:59:28.085867 (MainThread): 02:59:28 | Done.
2020-10-09 02:59:28.087780 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-09 02:59:28.087896 (MainThread): Opening a new connection, currently in state init
2020-10-09 02:59:28.087999 (MainThread): 02:59:28 | Building catalog
2020-10-09 02:59:28.123721 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-09 02:59:28.123877 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-09 02:59:28.233838 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-09 02:59:28.234004 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-09 02:59:28.237651 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-09 02:59:28.237820 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-09 02:59:28.237919 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-09 02:59:28.241101 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.00 seconds
2020-10-09 02:59:28.260384 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-09 02:59:28.448603 (MainThread): 02:59:28 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-09 02:59:28.449076 (MainThread): Flushing usage events
2020-10-09 02:59:28.449305 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-09 02:59:28.449399 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-09 02:59:28.449486 (MainThread): On airflow.information_schema: Close
2020-10-09 02:59:29.828873 (MainThread): Got an exception trying to initialize tracking
2020-10-09 02:59:29.829033 (MainThread): Running with dbt=0.16.0
2020-10-09 02:59:29.913509 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-09 02:59:29.913930 (MainThread): Tracking: do not track
2020-10-09 02:59:29.925815 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-09 02:59:29.926430 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-09 02:59:29.926647 (MainThread): Press Ctrl+C to exit.


2020-10-09 03:09:10.198500 (MainThread): Got an exception trying to initialize tracking
2020-10-09 03:09:10.198686 (MainThread): Running with dbt=0.16.0
2020-10-09 03:09:10.287000 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='/usr/local/airflow/dbt', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-09 03:09:10.289154 (MainThread): Tracking: do not track
2020-10-09 03:09:10.323100 (MainThread): Partial parsing not enabled
2020-10-09 03:09:10.325280 (MainThread): Parsing macros/core.sql
2020-10-09 03:09:10.333624 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-09 03:09:10.349580 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-09 03:09:10.363332 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-09 03:09:10.390771 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-09 03:09:10.400232 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-09 03:09:10.412234 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-09 03:09:10.476584 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-09 03:09:10.506607 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-09 03:09:10.509560 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-09 03:09:10.520320 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-09 03:09:10.523476 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-09 03:09:10.568689 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-09 03:09:10.571231 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-09 03:09:10.575805 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-09 03:09:10.577599 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-09 03:09:10.579839 (MainThread): Parsing macros/etc/query.sql
2020-10-09 03:09:10.581888 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-09 03:09:10.586005 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-09 03:09:10.587968 (MainThread): Parsing macros/etc/datetime.sql
2020-10-09 03:09:10.606990 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-09 03:09:10.610695 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-09 03:09:10.613655 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-09 03:09:10.615291 (MainThread): Parsing macros/adapters/common.sql
2020-10-09 03:09:10.703954 (MainThread): Parsing macros/relations.sql
2020-10-09 03:09:10.706476 (MainThread): Parsing macros/adapters.sql
2020-10-09 03:09:10.739366 (MainThread): Parsing macros/catalog.sql
2020-10-09 03:09:10.743591 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-09 03:09:10.770592 (MainThread): Partial parsing not enabled
2020-10-09 03:09:10.814515 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:10.814657 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:10.839337 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:10.839484 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:10.847250 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:10.847381 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:10.854979 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:10.855097 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:11.399954 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-09 03:09:11.404399 (MainThread): 
2020-10-09 03:09:11.404754 (MainThread): Acquiring new postgres connection "master".
2020-10-09 03:09:11.404859 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:11.427426 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-09 03:09:11.427551 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-09 03:09:11.544239 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-09 03:09:11.544369 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-09 03:09:11.547900 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-09 03:09:11.568599 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-09 03:09:11.568708 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-09 03:09:11.570481 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-09 03:09:11.570576 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-09 03:09:11.570833 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:11.570940 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-09 03:09:11.571017 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-09 03:09:11.573047 (ThreadPoolExecutor-1_0): SQL status: SELECT 27 in 0.00 seconds
2020-10-09 03:09:11.598655 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-09 03:09:11.621628 (MainThread): Using postgres connection "master".
2020-10-09 03:09:11.621725 (MainThread): On master: BEGIN
2020-10-09 03:09:11.624444 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:11.624553 (MainThread): Using postgres connection "master".
2020-10-09 03:09:11.624631 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-09 03:09:11.629353 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2020-10-09 03:09:11.630306 (MainThread): On master: ROLLBACK
2020-10-09 03:09:11.630555 (MainThread): Using postgres connection "master".
2020-10-09 03:09:11.630646 (MainThread): On master: BEGIN
2020-10-09 03:09:11.631039 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:11.631144 (MainThread): On master: COMMIT
2020-10-09 03:09:11.631224 (MainThread): Using postgres connection "master".
2020-10-09 03:09:11.631297 (MainThread): On master: COMMIT
2020-10-09 03:09:11.631530 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:11.631807 (MainThread): 03:09:11 | Concurrency: 1 threads (target='dev')
2020-10-09 03:09:11.631924 (MainThread): 03:09:11 | 
2020-10-09 03:09:11.637275 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-09 03:09:11.637434 (Thread-1): 03:09:11 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-09 03:09:11.637904 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:11.637989 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-09 03:09:11.638080 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-09 03:09:11.659513 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-09 03:09:11.659868 (Thread-1): finished collecting timing info
2020-10-09 03:09:11.703838 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:11.703975 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-09 03:09:11.704501 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.706935 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:11.707024 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-09 03:09:11.707284 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.708825 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-09 03:09:11.709098 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:11.709182 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-09 03:09:11.709446 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:11.709546 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:11.709638 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-09 03:09:11.710756 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-09 03:09:11.713312 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:11.713399 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-09 03:09:11.713750 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-09 03:09:11.714618 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-09 03:09:11.714720 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:11.714798 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-09 03:09:11.716018 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:11.717885 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:11.717976 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-09 03:09:11.718239 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.720769 (Thread-1): finished collecting timing info
2020-10-09 03:09:11.722445 (Thread-1): 03:09:11 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.08s]
2020-10-09 03:09:11.722568 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-09 03:09:11.722688 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 03:09:11.722803 (Thread-1): 03:09:11 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-09 03:09:11.723024 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:11.723099 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-09 03:09:11.723198 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-09 03:09:11.730999 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-09 03:09:11.731229 (Thread-1): finished collecting timing info
2020-10-09 03:09:11.738831 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:11.738967 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-09 03:09:11.739299 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.741702 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:11.741790 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-09 03:09:11.742037 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.743526 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-09 03:09:11.743760 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:11.743844 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-09 03:09:11.744023 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:11.744103 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:11.744185 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-09 03:09:11.744751 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-09 03:09:11.747196 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:11.747285 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-09 03:09:11.747571 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-09 03:09:11.748361 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-09 03:09:11.748448 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:11.748534 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-09 03:09:11.749652 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:11.754721 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:11.754911 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-09 03:09:11.755364 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.760424 (Thread-1): finished collecting timing info
2020-10-09 03:09:11.761541 (Thread-1): 03:09:11 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.04s]
2020-10-09 03:09:11.761746 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 03:09:11.762335 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-09 03:09:11.762561 (Thread-1): 03:09:11 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-09 03:09:11.762956 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:11.763085 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-09 03:09:11.763216 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-09 03:09:11.775130 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-09 03:09:11.775366 (Thread-1): finished collecting timing info
2020-10-09 03:09:11.783344 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:11.783436 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-09 03:09:11.783741 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.787167 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:11.787256 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-09 03:09:11.787524 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.788879 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-09 03:09:11.789113 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:11.789194 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-09 03:09:11.789413 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:11.789505 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:11.789580 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-09 03:09:11.790590 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-09 03:09:11.793198 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:11.793300 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-09 03:09:11.793655 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-09 03:09:11.794480 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-09 03:09:11.794567 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:11.794641 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-09 03:09:11.795910 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:11.797702 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:11.797787 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-09 03:09:11.798034 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.800477 (Thread-1): finished collecting timing info
2020-10-09 03:09:11.801100 (Thread-1): 03:09:11 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.04s]
2020-10-09 03:09:11.801218 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-09 03:09:11.801602 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-09 03:09:11.801730 (Thread-1): 03:09:11 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-09 03:09:11.801953 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:11.802026 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-09 03:09:11.802101 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-09 03:09:11.809611 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-09 03:09:11.809832 (Thread-1): finished collecting timing info
2020-10-09 03:09:11.817328 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:11.817418 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-09 03:09:11.817724 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.820070 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:11.820155 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-09 03:09:11.820415 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.821908 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-09 03:09:11.822143 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:11.822227 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-09 03:09:11.822444 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:11.822535 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:11.822610 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-09 03:09:11.823564 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-09 03:09:11.825964 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:11.826048 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-09 03:09:11.826373 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-09 03:09:11.827160 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-09 03:09:11.827246 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:11.827319 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-09 03:09:11.828551 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:11.830352 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:11.830438 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-09 03:09:11.830696 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:11.833130 (Thread-1): finished collecting timing info
2020-10-09 03:09:11.833738 (Thread-1): 03:09:11 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.03s]
2020-10-09 03:09:11.833853 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-09 03:09:11.839813 (MainThread): Using postgres connection "master".
2020-10-09 03:09:11.839909 (MainThread): On master: BEGIN
2020-10-09 03:09:11.840165 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:11.840265 (MainThread): On master: COMMIT
2020-10-09 03:09:11.840342 (MainThread): Using postgres connection "master".
2020-10-09 03:09:11.840414 (MainThread): On master: COMMIT
2020-10-09 03:09:11.840643 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:11.840900 (MainThread): 03:09:11 | 
2020-10-09 03:09:11.841008 (MainThread): 03:09:11 | Finished running 4 view models in 0.44s.
2020-10-09 03:09:11.841098 (MainThread): Connection 'master' was left open.
2020-10-09 03:09:11.841170 (MainThread): On master: Close
2020-10-09 03:09:11.841280 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-09 03:09:11.841354 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-09 03:09:11.855601 (MainThread): 
2020-10-09 03:09:11.855758 (MainThread): Completed successfully
2020-10-09 03:09:11.855869 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-09 03:09:11.856040 (MainThread): Flushing usage events
2020-10-09 03:09:45.161273 (MainThread): Got an exception trying to initialize tracking
2020-10-09 03:09:45.161421 (MainThread): Running with dbt=0.16.0
2020-10-09 03:09:45.241670 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='/usr/local/airflow/dbt', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-09 03:09:45.241981 (MainThread): Tracking: do not track
2020-10-09 03:09:45.273346 (MainThread): Partial parsing not enabled
2020-10-09 03:09:45.275218 (MainThread): Parsing macros/core.sql
2020-10-09 03:09:45.282412 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-09 03:09:45.296077 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-09 03:09:45.307451 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-09 03:09:45.332196 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-09 03:09:45.341076 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-09 03:09:45.352994 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-09 03:09:45.420337 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-09 03:09:45.455386 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-09 03:09:45.458723 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-09 03:09:45.476233 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-09 03:09:45.481338 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-09 03:09:45.544687 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-09 03:09:45.547612 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-09 03:09:45.552665 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-09 03:09:45.554925 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-09 03:09:45.557681 (MainThread): Parsing macros/etc/query.sql
2020-10-09 03:09:45.560357 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-09 03:09:45.565703 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-09 03:09:45.568468 (MainThread): Parsing macros/etc/datetime.sql
2020-10-09 03:09:45.599079 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-09 03:09:45.605800 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-09 03:09:45.609691 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-09 03:09:45.611783 (MainThread): Parsing macros/adapters/common.sql
2020-10-09 03:09:45.712776 (MainThread): Parsing macros/relations.sql
2020-10-09 03:09:45.715459 (MainThread): Parsing macros/adapters.sql
2020-10-09 03:09:45.748681 (MainThread): Parsing macros/catalog.sql
2020-10-09 03:09:45.753217 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-09 03:09:45.789077 (MainThread): Partial parsing not enabled
2020-10-09 03:09:45.841157 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:45.841295 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:45.864312 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:45.864422 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:45.871558 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:45.871659 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:45.878873 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:45.878970 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:46.303171 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-09 03:09:46.307781 (MainThread): 
2020-10-09 03:09:46.308156 (MainThread): Acquiring new postgres connection "master".
2020-10-09 03:09:46.308265 (MainThread): Opening a new connection, currently in state init
2020-10-09 03:09:46.331703 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-09 03:09:46.331833 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-09 03:09:46.451605 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-09 03:09:46.451756 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-09 03:09:46.455632 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-09 03:09:46.481890 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-09 03:09:46.482122 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-09 03:09:46.484304 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-09 03:09:46.484426 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-09 03:09:46.484795 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:46.484913 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-09 03:09:46.485003 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-09 03:09:46.487131 (ThreadPoolExecutor-1_0): SQL status: SELECT 27 in 0.00 seconds
2020-10-09 03:09:46.519764 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-09 03:09:46.554851 (MainThread): Using postgres connection "master".
2020-10-09 03:09:46.555031 (MainThread): On master: BEGIN
2020-10-09 03:09:46.558442 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:46.558628 (MainThread): Using postgres connection "master".
2020-10-09 03:09:46.558749 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-09 03:09:46.565493 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-10-09 03:09:46.566905 (MainThread): On master: ROLLBACK
2020-10-09 03:09:46.567186 (MainThread): Using postgres connection "master".
2020-10-09 03:09:46.567310 (MainThread): On master: BEGIN
2020-10-09 03:09:46.567657 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:46.567812 (MainThread): On master: COMMIT
2020-10-09 03:09:46.567925 (MainThread): Using postgres connection "master".
2020-10-09 03:09:46.568029 (MainThread): On master: COMMIT
2020-10-09 03:09:46.568245 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:46.568618 (MainThread): 03:09:46 | Concurrency: 1 threads (target='dev')
2020-10-09 03:09:46.568779 (MainThread): 03:09:46 | 
2020-10-09 03:09:46.576250 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-09 03:09:46.576489 (Thread-1): 03:09:46 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-09 03:09:46.577064 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:46.577181 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-09 03:09:46.577304 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-09 03:09:46.612831 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-09 03:09:46.613259 (Thread-1): finished collecting timing info
2020-10-09 03:09:46.665796 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:46.665989 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-09 03:09:46.666512 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.671680 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:46.671903 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-09 03:09:46.672379 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.675397 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-09 03:09:46.675903 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:46.676125 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-09 03:09:46.676584 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:46.676764 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:46.676916 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-09 03:09:46.678802 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-09 03:09:46.683688 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:46.683887 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-09 03:09:46.684485 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-09 03:09:46.686089 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-09 03:09:46.686275 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:46.686421 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-09 03:09:46.688047 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:46.691576 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 03:09:46.691779 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-09 03:09:46.692186 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.696983 (Thread-1): finished collecting timing info
2020-10-09 03:09:46.700042 (Thread-1): 03:09:46 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.12s]
2020-10-09 03:09:46.700297 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-09 03:09:46.700529 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 03:09:46.700851 (Thread-1): 03:09:46 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-09 03:09:46.701272 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:46.701399 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-09 03:09:46.701544 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-09 03:09:46.715761 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-09 03:09:46.716166 (Thread-1): finished collecting timing info
2020-10-09 03:09:46.726668 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:46.726823 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-09 03:09:46.727106 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.730192 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:46.730328 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-09 03:09:46.730603 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.732533 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-09 03:09:46.732878 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:46.732984 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-09 03:09:46.733177 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:46.733280 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:46.733366 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-09 03:09:46.734011 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-09 03:09:46.739162 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:46.739415 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-09 03:09:46.740057 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-09 03:09:46.742002 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-09 03:09:46.742223 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:46.742391 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-09 03:09:46.743442 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:46.747930 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 03:09:46.748153 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-09 03:09:46.748595 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.754488 (Thread-1): finished collecting timing info
2020-10-09 03:09:46.755988 (Thread-1): 03:09:46 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.05s]
2020-10-09 03:09:46.756234 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 03:09:46.760350 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-09 03:09:46.760649 (Thread-1): 03:09:46 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-09 03:09:46.761193 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:46.761356 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-09 03:09:46.761524 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-09 03:09:46.792488 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-09 03:09:46.793001 (Thread-1): finished collecting timing info
2020-10-09 03:09:46.808891 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:46.809073 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-09 03:09:46.809524 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.817086 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:46.817294 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-09 03:09:46.817806 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.820892 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-09 03:09:46.821426 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:46.821591 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-09 03:09:46.821921 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:46.822086 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:46.822244 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-09 03:09:46.824350 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-09 03:09:46.830231 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:46.830433 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-09 03:09:46.831086 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-09 03:09:46.832907 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-09 03:09:46.833072 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:46.833212 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-09 03:09:46.834315 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:46.838475 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 03:09:46.838649 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-09 03:09:46.839068 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.844550 (Thread-1): finished collecting timing info
2020-10-09 03:09:46.845898 (Thread-1): 03:09:46 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.08s]
2020-10-09 03:09:46.846418 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-09 03:09:46.846946 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-09 03:09:46.847194 (Thread-1): 03:09:46 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-09 03:09:46.847850 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:46.848000 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-09 03:09:46.848154 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-09 03:09:46.865200 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-09 03:09:46.865659 (Thread-1): finished collecting timing info
2020-10-09 03:09:46.877710 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:46.877872 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-09 03:09:46.878318 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.881647 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:46.881919 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-09 03:09:46.882283 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.884323 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-09 03:09:46.884647 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:46.884756 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-09 03:09:46.885020 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:46.885145 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:46.885252 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-09 03:09:46.886374 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-09 03:09:46.889734 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:46.889862 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-09 03:09:46.890304 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-09 03:09:46.891407 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-09 03:09:46.891526 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:46.891626 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-09 03:09:46.892661 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:46.895394 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 03:09:46.895544 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-09 03:09:46.895949 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-09 03:09:46.899269 (Thread-1): finished collecting timing info
2020-10-09 03:09:46.900046 (Thread-1): 03:09:46 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.05s]
2020-10-09 03:09:46.900193 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-09 03:09:46.982534 (MainThread): Using postgres connection "master".
2020-10-09 03:09:46.982690 (MainThread): On master: BEGIN
2020-10-09 03:09:46.982957 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-09 03:09:46.983076 (MainThread): On master: COMMIT
2020-10-09 03:09:46.983168 (MainThread): Using postgres connection "master".
2020-10-09 03:09:46.983255 (MainThread): On master: COMMIT
2020-10-09 03:09:46.983435 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-09 03:09:46.983767 (MainThread): 03:09:46 | 
2020-10-09 03:09:46.983903 (MainThread): 03:09:46 | Finished running 4 view models in 0.68s.
2020-10-09 03:09:46.984013 (MainThread): Connection 'master' was left open.
2020-10-09 03:09:46.984102 (MainThread): On master: Close
2020-10-09 03:09:46.984247 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-09 03:09:46.984377 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-09 03:09:47.002466 (MainThread): 
2020-10-09 03:09:47.002665 (MainThread): Completed successfully
2020-10-09 03:09:47.002810 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-09 03:09:47.003018 (MainThread): Flushing usage events
2020-10-09 13:55:59.544685 (MainThread): Got an exception trying to initialize tracking
2020-10-09 13:55:59.544840 (MainThread): Running with dbt=0.16.0
2020-10-09 13:55:59.626896 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-09 13:55:59.627253 (MainThread): Tracking: do not track
2020-10-09 13:55:59.667117 (MainThread): Partial parsing not enabled
2020-10-09 13:55:59.672155 (MainThread): Parsing macros/core.sql
2020-10-09 13:55:59.685734 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-09 13:55:59.711006 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-09 13:55:59.733074 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-09 13:55:59.780115 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-09 13:55:59.790947 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-09 13:55:59.801993 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-09 13:55:59.864676 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-09 13:55:59.893900 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-09 13:55:59.897072 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-09 13:55:59.908327 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-09 13:55:59.911696 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-09 13:55:59.959653 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-09 13:55:59.962552 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-09 13:55:59.967231 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-09 13:55:59.969278 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-09 13:55:59.971537 (MainThread): Parsing macros/etc/query.sql
2020-10-09 13:55:59.973701 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-09 13:55:59.977951 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-09 13:55:59.980294 (MainThread): Parsing macros/etc/datetime.sql
2020-10-09 13:56:00.002917 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-09 13:56:00.007597 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-09 13:56:00.011468 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-09 13:56:00.013890 (MainThread): Parsing macros/adapters/common.sql
2020-10-09 13:56:00.112916 (MainThread): Parsing macros/relations.sql
2020-10-09 13:56:00.116003 (MainThread): Parsing macros/adapters.sql
2020-10-09 13:56:00.154958 (MainThread): Parsing macros/catalog.sql
2020-10-09 13:56:00.160865 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-09 13:56:00.197994 (MainThread): Partial parsing not enabled
2020-10-09 13:56:00.248994 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 13:56:00.249146 (MainThread): Opening a new connection, currently in state init
2020-10-09 13:56:00.276207 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 13:56:00.276356 (MainThread): Opening a new connection, currently in state init
2020-10-09 13:56:00.284386 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 13:56:00.284527 (MainThread): Opening a new connection, currently in state init
2020-10-09 13:56:00.292929 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 13:56:00.293071 (MainThread): Opening a new connection, currently in state init
2020-10-09 13:56:00.750056 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-09 13:56:00.754324 (MainThread): 
2020-10-09 13:56:00.754525 (MainThread): 13:56:00 | Concurrency: 1 threads (target='dev')
2020-10-09 13:56:00.754669 (MainThread): 13:56:00 | 
2020-10-09 13:56:00.761596 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-09 13:56:00.762021 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-09 13:56:00.762129 (Thread-1): Opening a new connection, currently in state init
2020-10-09 13:56:00.762250 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-09 13:56:00.784786 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-09 13:56:00.785077 (Thread-1): finished collecting timing info
2020-10-09 13:56:00.785380 (Thread-1): finished collecting timing info
2020-10-09 13:56:00.785841 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-09 13:56:00.785994 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 13:56:00.786274 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-09 13:56:00.786376 (Thread-1): Opening a new connection, currently in state init
2020-10-09 13:56:00.786606 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-09 13:56:00.795958 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-09 13:56:00.796249 (Thread-1): finished collecting timing info
2020-10-09 13:56:00.796536 (Thread-1): finished collecting timing info
2020-10-09 13:56:00.796990 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-09 13:56:00.797446 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-09 13:56:00.797747 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-09 13:56:00.797849 (Thread-1): Opening a new connection, currently in state init
2020-10-09 13:56:00.797945 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-09 13:56:00.808436 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-09 13:56:00.808680 (Thread-1): finished collecting timing info
2020-10-09 13:56:00.808950 (Thread-1): finished collecting timing info
2020-10-09 13:56:00.809364 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-09 13:56:00.809779 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-09 13:56:00.810069 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-09 13:56:00.810167 (Thread-1): Opening a new connection, currently in state init
2020-10-09 13:56:00.810257 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-09 13:56:00.818782 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-09 13:56:00.819063 (Thread-1): finished collecting timing info
2020-10-09 13:56:00.819343 (Thread-1): finished collecting timing info
2020-10-09 13:56:00.819785 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-09 13:56:00.861627 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-09 13:56:00.861787 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was properly closed.
2020-10-09 13:56:00.875289 (MainThread): 13:56:00 | Done.
2020-10-09 13:56:00.878027 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-09 13:56:00.878135 (MainThread): Opening a new connection, currently in state init
2020-10-09 13:56:00.878223 (MainThread): 13:56:00 | Building catalog
2020-10-09 13:56:00.910311 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-09 13:56:00.910483 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-09 13:56:01.069907 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-09 13:56:01.070139 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-09 13:56:01.074818 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-09 13:56:01.075010 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-09 13:56:01.075137 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-09 13:56:01.080900 (ThreadPoolExecutor-0_0): SQL status: SELECT 197 in 0.01 seconds
2020-10-09 13:56:01.106548 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-09 13:56:01.281472 (MainThread): 13:56:01 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-09 13:56:01.282001 (MainThread): Flushing usage events
2020-10-09 13:56:01.282170 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-09 13:56:01.282260 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-09 13:56:01.282361 (MainThread): On airflow.information_schema: Close
2020-10-09 13:56:02.565593 (MainThread): Got an exception trying to initialize tracking
2020-10-09 13:56:02.565781 (MainThread): Running with dbt=0.16.0
2020-10-09 13:56:02.650590 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-09 13:56:02.650938 (MainThread): Tracking: do not track
2020-10-09 13:56:02.658172 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-09 13:56:02.658550 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-09 13:56:02.658690 (MainThread): Press Ctrl+C to exit.


2020-10-10 02:56:06.604279 (MainThread): Got an exception trying to initialize tracking
2020-10-10 02:56:06.604455 (MainThread): Running with dbt=0.16.0
2020-10-10 02:56:06.690493 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-10 02:56:06.690847 (MainThread): Tracking: do not track
2020-10-10 02:56:06.726202 (MainThread): Partial parsing not enabled
2020-10-10 02:56:06.728276 (MainThread): Parsing macros/core.sql
2020-10-10 02:56:06.736089 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-10 02:56:06.750770 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-10 02:56:06.762895 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-10 02:56:06.803634 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-10 02:56:06.819407 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-10 02:56:06.840302 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-10 02:56:06.944215 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-10 02:56:06.975977 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-10 02:56:06.979019 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-10 02:56:06.990066 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-10 02:56:06.993671 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-10 02:56:07.035636 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-10 02:56:07.037631 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-10 02:56:07.041527 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-10 02:56:07.042995 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-10 02:56:07.044759 (MainThread): Parsing macros/etc/query.sql
2020-10-10 02:56:07.046412 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-10 02:56:07.049860 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-10 02:56:07.051571 (MainThread): Parsing macros/etc/datetime.sql
2020-10-10 02:56:07.069083 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-10 02:56:07.072502 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-10 02:56:07.075266 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-10 02:56:07.076823 (MainThread): Parsing macros/adapters/common.sql
2020-10-10 02:56:07.204319 (MainThread): Parsing macros/relations.sql
2020-10-10 02:56:07.207874 (MainThread): Parsing macros/adapters.sql
2020-10-10 02:56:07.247809 (MainThread): Parsing macros/catalog.sql
2020-10-10 02:56:07.252960 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-10 02:56:07.284309 (MainThread): Partial parsing not enabled
2020-10-10 02:56:07.333596 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-10 02:56:07.333771 (MainThread): Opening a new connection, currently in state init
2020-10-10 02:56:07.367296 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-10 02:56:07.367465 (MainThread): Opening a new connection, currently in state init
2020-10-10 02:56:07.377744 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-10 02:56:07.377917 (MainThread): Opening a new connection, currently in state init
2020-10-10 02:56:07.388458 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-10 02:56:07.388637 (MainThread): Opening a new connection, currently in state init
2020-10-10 02:56:07.857599 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-10 02:56:07.862051 (MainThread): 
2020-10-10 02:56:07.862259 (MainThread): 02:56:07 | Concurrency: 1 threads (target='dev')
2020-10-10 02:56:07.862414 (MainThread): 02:56:07 | 
2020-10-10 02:56:07.869610 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-10 02:56:07.870060 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-10 02:56:07.870173 (Thread-1): Opening a new connection, currently in state init
2020-10-10 02:56:07.870281 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-10 02:56:07.893358 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-10 02:56:07.893745 (Thread-1): finished collecting timing info
2020-10-10 02:56:07.894074 (Thread-1): finished collecting timing info
2020-10-10 02:56:07.894564 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-10 02:56:07.894717 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-10 02:56:07.894997 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-10 02:56:07.895109 (Thread-1): Opening a new connection, currently in state init
2020-10-10 02:56:07.895212 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-10 02:56:07.905359 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-10 02:56:07.905687 (Thread-1): finished collecting timing info
2020-10-10 02:56:07.905991 (Thread-1): finished collecting timing info
2020-10-10 02:56:07.906473 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-10 02:56:07.906894 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-10 02:56:07.907210 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-10 02:56:07.907317 (Thread-1): Opening a new connection, currently in state init
2020-10-10 02:56:07.907417 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-10 02:56:07.918191 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-10 02:56:07.918481 (Thread-1): finished collecting timing info
2020-10-10 02:56:07.918769 (Thread-1): finished collecting timing info
2020-10-10 02:56:07.919214 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-10 02:56:07.919655 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-10 02:56:07.919956 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-10 02:56:07.920059 (Thread-1): Opening a new connection, currently in state init
2020-10-10 02:56:07.920154 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-10 02:56:07.929057 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-10 02:56:07.929295 (Thread-1): finished collecting timing info
2020-10-10 02:56:07.929564 (Thread-1): finished collecting timing info
2020-10-10 02:56:07.929976 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-10 02:56:07.969501 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-10 02:56:07.969651 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was properly closed.
2020-10-10 02:56:07.982808 (MainThread): 02:56:07 | Done.
2020-10-10 02:56:07.984540 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-10 02:56:07.984654 (MainThread): Opening a new connection, currently in state init
2020-10-10 02:56:07.984746 (MainThread): 02:56:07 | Building catalog
2020-10-10 02:56:08.015700 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-10 02:56:08.015852 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-10 02:56:08.118661 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-10 02:56:08.118812 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-10 02:56:08.122050 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-10 02:56:08.122275 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-10 02:56:08.122426 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-10 02:56:08.130311 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.01 seconds
2020-10-10 02:56:08.162323 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-10 02:56:08.353162 (MainThread): 02:56:08 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-10 02:56:08.353752 (MainThread): Flushing usage events
2020-10-10 02:56:08.353965 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-10 02:56:08.354083 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-10 02:56:08.354193 (MainThread): On airflow.information_schema: Close
2020-10-10 02:56:09.676569 (MainThread): Got an exception trying to initialize tracking
2020-10-10 02:56:09.676733 (MainThread): Running with dbt=0.16.0
2020-10-10 02:56:09.767662 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-10 02:56:09.768055 (MainThread): Tracking: do not track
2020-10-10 02:56:09.777509 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-10 02:56:09.777839 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-10 02:56:09.777993 (MainThread): Press Ctrl+C to exit.


2020-10-10 03:03:47.521172 (MainThread): Got an exception trying to initialize tracking
2020-10-10 03:03:47.521316 (MainThread): Running with dbt=0.16.0
2020-10-10 03:03:47.605024 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-10 03:03:47.605385 (MainThread): Tracking: do not track
2020-10-10 03:03:47.640819 (MainThread): Partial parsing not enabled
2020-10-10 03:03:47.642936 (MainThread): Parsing macros/core.sql
2020-10-10 03:03:47.651069 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-10 03:03:47.666645 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-10 03:03:47.679586 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-10 03:03:47.705227 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-10 03:03:47.713956 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-10 03:03:47.725667 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-10 03:03:47.833969 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-10 03:03:47.880050 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-10 03:03:47.883149 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-10 03:03:47.894635 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-10 03:03:47.898211 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-10 03:03:47.942156 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-10 03:03:47.944011 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-10 03:03:47.947246 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-10 03:03:47.948575 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-10 03:03:47.950216 (MainThread): Parsing macros/etc/query.sql
2020-10-10 03:03:47.951760 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-10 03:03:47.954960 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-10 03:03:47.956565 (MainThread): Parsing macros/etc/datetime.sql
2020-10-10 03:03:47.973055 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-10 03:03:47.976277 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-10 03:03:47.978923 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-10 03:03:47.980467 (MainThread): Parsing macros/adapters/common.sql
2020-10-10 03:03:48.086645 (MainThread): Parsing macros/relations.sql
2020-10-10 03:03:48.091263 (MainThread): Parsing macros/adapters.sql
2020-10-10 03:03:48.143578 (MainThread): Parsing macros/catalog.sql
2020-10-10 03:03:48.148740 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-10 03:03:48.180124 (MainThread): Partial parsing not enabled
2020-10-10 03:03:48.239063 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-10 03:03:48.239231 (MainThread): Opening a new connection, currently in state init
2020-10-10 03:03:48.268147 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-10 03:03:48.268329 (MainThread): Opening a new connection, currently in state init
2020-10-10 03:03:48.278049 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-10 03:03:48.278226 (MainThread): Opening a new connection, currently in state init
2020-10-10 03:03:48.289147 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-10 03:03:48.289349 (MainThread): Opening a new connection, currently in state init
2020-10-10 03:03:48.766088 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-10 03:03:48.770931 (MainThread): 
2020-10-10 03:03:48.771134 (MainThread): 03:03:48 | Concurrency: 1 threads (target='dev')
2020-10-10 03:03:48.771275 (MainThread): 03:03:48 | 
2020-10-10 03:03:48.778874 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-10 03:03:48.779327 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-10 03:03:48.779448 (Thread-1): Opening a new connection, currently in state init
2020-10-10 03:03:48.779560 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-10 03:03:48.803050 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-10 03:03:48.803382 (Thread-1): finished collecting timing info
2020-10-10 03:03:48.803689 (Thread-1): finished collecting timing info
2020-10-10 03:03:48.804163 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-10 03:03:48.804325 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-10 03:03:48.804610 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-10 03:03:48.804740 (Thread-1): Opening a new connection, currently in state init
2020-10-10 03:03:48.804987 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-10 03:03:48.814446 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-10 03:03:48.814755 (Thread-1): finished collecting timing info
2020-10-10 03:03:48.815052 (Thread-1): finished collecting timing info
2020-10-10 03:03:48.815529 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-10 03:03:48.816005 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-10 03:03:48.816339 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-10 03:03:48.816446 (Thread-1): Opening a new connection, currently in state init
2020-10-10 03:03:48.816543 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-10 03:03:48.827265 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-10 03:03:48.827550 (Thread-1): finished collecting timing info
2020-10-10 03:03:48.827834 (Thread-1): finished collecting timing info
2020-10-10 03:03:48.828296 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-10 03:03:48.828758 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-10 03:03:48.829077 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-10 03:03:48.829182 (Thread-1): Opening a new connection, currently in state init
2020-10-10 03:03:48.829280 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-10 03:03:48.838439 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-10 03:03:48.838744 (Thread-1): finished collecting timing info
2020-10-10 03:03:48.839038 (Thread-1): finished collecting timing info
2020-10-10 03:03:48.839506 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-10 03:03:48.878824 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-10 03:03:48.878974 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was properly closed.
2020-10-10 03:03:48.892848 (MainThread): 03:03:48 | Done.
2020-10-10 03:03:48.894637 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-10 03:03:48.894739 (MainThread): Opening a new connection, currently in state init
2020-10-10 03:03:48.894829 (MainThread): 03:03:48 | Building catalog
2020-10-10 03:03:48.925631 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-10 03:03:48.925770 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-10 03:03:49.029475 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-10 03:03:49.029630 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-10 03:03:49.032998 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-10 03:03:49.033168 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-10 03:03:49.033266 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-10 03:03:49.036525 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.00 seconds
2020-10-10 03:03:49.055153 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-10 03:03:49.296477 (MainThread): 03:03:49 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-10 03:03:49.297093 (MainThread): Flushing usage events
2020-10-10 03:03:49.297308 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-10 03:03:49.297428 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-10 03:03:49.297540 (MainThread): On airflow.information_schema: Close
2020-10-10 03:03:50.646865 (MainThread): Got an exception trying to initialize tracking
2020-10-10 03:03:50.647015 (MainThread): Running with dbt=0.16.0
2020-10-10 03:03:50.731172 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-10 03:03:50.731527 (MainThread): Tracking: do not track
2020-10-10 03:03:50.741115 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-10 03:03:50.741417 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-10 03:03:50.741556 (MainThread): Press Ctrl+C to exit.


2020-10-12 16:26:17.410706 (MainThread): Got an exception trying to initialize tracking
2020-10-12 16:26:17.410888 (MainThread): Running with dbt=0.16.0
2020-10-12 16:26:17.522796 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-10-12 16:26:17.525262 (MainThread): Tracking: do not track
2020-10-12 16:26:17.572847 (MainThread): Partial parsing not enabled
2020-10-12 16:26:17.575983 (MainThread): Parsing macros/core.sql
2020-10-12 16:26:17.587144 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 16:26:17.607436 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 16:26:17.624496 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 16:26:17.655138 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 16:26:17.665499 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 16:26:17.679940 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 16:26:17.815316 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 16:26:17.865994 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 16:26:17.869841 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 16:26:17.882661 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 16:26:17.886801 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 16:26:17.936460 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 16:26:17.939103 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 16:26:17.943807 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 16:26:17.945923 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 16:26:17.948469 (MainThread): Parsing macros/etc/query.sql
2020-10-12 16:26:17.951219 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 16:26:17.956910 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 16:26:17.959386 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 16:26:17.985969 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 16:26:17.991374 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 16:26:17.995165 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 16:26:17.997238 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 16:26:18.109010 (MainThread): Parsing macros/relations.sql
2020-10-12 16:26:18.112310 (MainThread): Parsing macros/adapters.sql
2020-10-12 16:26:18.162053 (MainThread): Parsing macros/catalog.sql
2020-10-12 16:26:18.170207 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 16:26:18.220402 (MainThread): Partial parsing not enabled
2020-10-12 16:26:18.287702 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:26:18.287883 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:26:18.321363 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:26:18.321518 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:26:18.330836 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:26:18.330988 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:26:18.342393 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:26:18.342625 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:26:18.857145 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 16:26:18.862452 (MainThread): 
2020-10-12 16:26:18.862773 (MainThread): 16:26:18 | Concurrency: 1 threads (target='dev')
2020-10-12 16:26:18.862954 (MainThread): 16:26:18 | 
2020-10-12 16:26:18.871768 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-12 16:26:18.872289 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:26:18.872424 (Thread-1): Opening a new connection, currently in state init
2020-10-12 16:26:18.872552 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-12 16:26:18.900815 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:26:18.901609 (Thread-1): finished collecting timing info
2020-10-12 16:26:18.902012 (Thread-1): finished collecting timing info
2020-10-12 16:26:18.902595 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-12 16:26:18.902795 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:26:18.903144 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:26:18.903271 (Thread-1): Opening a new connection, currently in state init
2020-10-12 16:26:18.903394 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:26:18.915174 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:26:18.915559 (Thread-1): finished collecting timing info
2020-10-12 16:26:18.915930 (Thread-1): finished collecting timing info
2020-10-12 16:26:18.916521 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:26:18.916969 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-12 16:26:18.917301 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:26:18.917419 (Thread-1): Opening a new connection, currently in state init
2020-10-12 16:26:18.917534 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-12 16:26:18.930095 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 16:26:18.930422 (Thread-1): finished collecting timing info
2020-10-12 16:26:18.930747 (Thread-1): finished collecting timing info
2020-10-12 16:26:18.931264 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-12 16:26:18.931737 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:26:18.932072 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:26:18.932185 (Thread-1): Opening a new connection, currently in state init
2020-10-12 16:26:18.932293 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-12 16:26:18.942527 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 16:26:18.942869 (Thread-1): finished collecting timing info
2020-10-12 16:26:18.943181 (Thread-1): finished collecting timing info
2020-10-12 16:26:18.943670 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:26:18.971719 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-12 16:26:18.971891 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was properly closed.
2020-10-12 16:26:18.987749 (MainThread): 16:26:18 | Done.
2020-10-12 16:26:18.989631 (MainThread): Acquiring new postgres connection "generate_catalog".
2020-10-12 16:26:18.989749 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:26:18.989848 (MainThread): 16:26:18 | Building catalog
2020-10-12 16:26:19.025585 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "airflow.information_schema".
2020-10-12 16:26:19.025746 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-12 16:26:19.141987 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-12 16:26:19.142142 (ThreadPoolExecutor-0_0): On airflow.information_schema: BEGIN
2020-10-12 16:26:19.145587 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:26:19.145734 (ThreadPoolExecutor-0_0): Using postgres connection "airflow.information_schema".
2020-10-12 16:26:19.145830 (ThreadPoolExecutor-0_0): On airflow.information_schema: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        null::text as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        null::text as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2020-10-12 16:26:19.149201 (ThreadPoolExecutor-0_0): SQL status: SELECT 169 in 0.00 seconds
2020-10-12 16:26:19.167939 (ThreadPoolExecutor-0_0): On airflow.information_schema: ROLLBACK
2020-10-12 16:26:19.344163 (MainThread): 16:26:19 | Catalog written to /usr/local/airflow/dbt/target/catalog.json
2020-10-12 16:26:19.345055 (MainThread): Flushing usage events
2020-10-12 16:26:19.345328 (MainThread): Connection 'generate_catalog' was properly closed.
2020-10-12 16:26:19.345481 (MainThread): Connection 'airflow.information_schema' was left open.
2020-10-12 16:26:19.345640 (MainThread): On airflow.information_schema: Close
2020-10-12 16:26:20.729892 (MainThread): Got an exception trying to initialize tracking
2020-10-12 16:26:20.730045 (MainThread): Running with dbt=0.16.0
2020-10-12 16:26:20.813905 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', partial_parse=None, port=8085, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-10-12 16:26:20.814267 (MainThread): Tracking: do not track
2020-10-12 16:26:20.822761 (MainThread): Serving docs at 0.0.0.0:8085
2020-10-12 16:26:20.823066 (MainThread): To access from your browser, navigate to:  http://localhost:8085
2020-10-12 16:26:20.823228 (MainThread): Press Ctrl+C to exit.


2020-10-12 16:34:47.919355 (MainThread): Got an exception trying to initialize tracking
2020-10-12 16:34:47.919534 (MainThread): Running with dbt=0.16.0
2020-10-12 16:34:48.014566 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 16:34:48.014988 (MainThread): Tracking: do not track
2020-10-12 16:34:48.053575 (MainThread): Partial parsing not enabled
2020-10-12 16:34:48.055758 (MainThread): Parsing macros/core.sql
2020-10-12 16:34:48.064161 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 16:34:48.080156 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 16:34:48.093814 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 16:34:48.121424 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 16:34:48.130719 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 16:34:48.143042 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 16:34:48.212015 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 16:34:48.241522 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 16:34:48.244450 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 16:34:48.255254 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 16:34:48.258510 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 16:34:48.299104 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 16:34:48.301008 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 16:34:48.304551 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 16:34:48.306067 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 16:34:48.307855 (MainThread): Parsing macros/etc/query.sql
2020-10-12 16:34:48.309510 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 16:34:48.312877 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 16:34:48.314533 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 16:34:48.332021 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 16:34:48.335497 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 16:34:48.338334 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 16:34:48.339908 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 16:34:48.466704 (MainThread): Parsing macros/relations.sql
2020-10-12 16:34:48.471451 (MainThread): Parsing macros/adapters.sql
2020-10-12 16:34:48.527077 (MainThread): Parsing macros/catalog.sql
2020-10-12 16:34:48.532420 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 16:34:48.568428 (MainThread): Partial parsing not enabled
2020-10-12 16:34:48.620001 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:34:48.620164 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:34:48.646455 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:34:48.646597 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:34:48.654331 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:34:48.654464 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:34:48.662692 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:34:48.662811 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:34:49.113347 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 16:34:49.118268 (MainThread): 
2020-10-12 16:34:49.118719 (MainThread): Acquiring new postgres connection "master".
2020-10-12 16:34:49.118856 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:34:49.145238 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-12 16:34:49.145520 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-12 16:34:49.280046 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-12 16:34:49.280190 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-12 16:34:49.286614 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2020-10-12 16:34:49.311068 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-12 16:34:49.311214 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-12 16:34:49.313361 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:34:49.313479 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-12 16:34:49.313835 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:34:49.313958 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:34:49.314052 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-12 16:34:49.316274 (ThreadPoolExecutor-1_0): SQL status: SELECT 25 in 0.00 seconds
2020-10-12 16:34:49.345078 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-12 16:34:49.372835 (MainThread): Using postgres connection "master".
2020-10-12 16:34:49.372985 (MainThread): On master: BEGIN
2020-10-12 16:34:49.375721 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:34:49.375902 (MainThread): Using postgres connection "master".
2020-10-12 16:34:49.376003 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-12 16:34:49.381849 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-10-12 16:34:49.383017 (MainThread): On master: ROLLBACK
2020-10-12 16:34:49.383262 (MainThread): Using postgres connection "master".
2020-10-12 16:34:49.383371 (MainThread): On master: BEGIN
2020-10-12 16:34:49.383666 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:34:49.383788 (MainThread): On master: COMMIT
2020-10-12 16:34:49.383884 (MainThread): Using postgres connection "master".
2020-10-12 16:34:49.383973 (MainThread): On master: COMMIT
2020-10-12 16:34:49.384158 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:34:49.384478 (MainThread): 16:34:49 | Concurrency: 1 threads (target='dev')
2020-10-12 16:34:49.384625 (MainThread): 16:34:49 | 
2020-10-12 16:34:49.395105 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-12 16:34:49.395326 (Thread-1): 16:34:49 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-12 16:34:49.395722 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:34:49.395837 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-12 16:34:49.395944 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-12 16:34:49.420760 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:34:49.421133 (Thread-1): finished collecting timing info
2020-10-12 16:34:49.476633 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:34:49.476847 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-12 16:34:49.477360 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:34:49.481235 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:34:49.481442 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 16:34:49.481881 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:34:49.484373 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:34:49.485287 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:34:49.485453 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-12 16:34:49.485894 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:34:49.486123 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:34:49.486297 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-12 16:34:49.486764 (Thread-1): Postgres error: relation "public.npi_small" does not exist
LINE 12:   from "airflow"."public"."npi_small"
                ^

2020-10-12 16:34:49.486956 (Thread-1): On model.ge_tutorials.stg_npi: ROLLBACK
2020-10-12 16:34:49.487325 (Thread-1): finished collecting timing info
2020-10-12 16:34:49.488190 (Thread-1): Database Error in model stg_npi (models/staging/stg_npi.sql)
  relation "public.npi_small" does not exist
  LINE 12:   from "airflow"."public"."npi_small"
                  ^
  compiled SQL at target/run/ge_tutorials/staging/stg_npi.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "public.npi_small" does not exist
LINE 12:   from "airflow"."public"."npi_small"
                ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 220, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model stg_npi (models/staging/stg_npi.sql)
  relation "public.npi_small" does not exist
  LINE 12:   from "airflow"."public"."npi_small"
                  ^
  compiled SQL at target/run/ge_tutorials/staging/stg_npi.sql
2020-10-12 16:34:49.491410 (Thread-1): 16:34:49 | 1 of 4 ERROR creating view model public.stg_npi...................... [ERROR in 0.10s]
2020-10-12 16:34:49.491688 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-12 16:34:49.491959 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:34:49.492208 (Thread-1): 16:34:49 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-12 16:34:49.492770 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:34:49.493098 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-12 16:34:49.493274 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:34:49.511787 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:34:49.512337 (Thread-1): finished collecting timing info
2020-10-12 16:34:49.533294 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:34:49.533551 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-12 16:34:49.534183 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:34:49.539589 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:34:49.539774 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 16:34:49.540227 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:34:49.542630 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:34:49.543055 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:34:49.543188 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-12 16:34:49.543572 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:34:49.543778 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:34:49.543959 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-12 16:34:49.544428 (Thread-1): Postgres error: relation "public.state_abbreviations" does not exist
LINE 7:   from "airflow"."public"."state_abbreviations"
               ^

2020-10-12 16:34:49.544623 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: ROLLBACK
2020-10-12 16:34:49.545031 (Thread-1): finished collecting timing info
2020-10-12 16:34:49.545864 (Thread-1): Database Error in model stg_state_abbreviations (models/staging/stg_state_abbreviations.sql)
  relation "public.state_abbreviations" does not exist
  LINE 7:   from "airflow"."public"."state_abbreviations"
                 ^
  compiled SQL at target/run/ge_tutorials/staging/stg_state_abbreviations.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "public.state_abbreviations" does not exist
LINE 7:   from "airflow"."public"."state_abbreviations"
               ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 220, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model stg_state_abbreviations (models/staging/stg_state_abbreviations.sql)
  relation "public.state_abbreviations" does not exist
  LINE 7:   from "airflow"."public"."state_abbreviations"
                 ^
  compiled SQL at target/run/ge_tutorials/staging/stg_state_abbreviations.sql
2020-10-12 16:34:49.546894 (Thread-1): 16:34:49 | 2 of 4 ERROR creating view model public.stg_state_abbreviations...... [ERROR in 0.05s]
2020-10-12 16:34:49.547135 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:34:49.547686 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-12 16:34:49.547922 (Thread-1): 16:34:49 | 3 of 4 SKIP relation public.npi_with_state........................... [SKIP]
2020-10-12 16:34:49.548145 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-12 16:34:49.548599 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:34:49.548852 (Thread-1): 16:34:49 | 4 of 4 SKIP relation public.count_providers_by_state................. [SKIP]
2020-10-12 16:34:49.549073 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:34:49.592055 (MainThread): Using postgres connection "master".
2020-10-12 16:34:49.592306 (MainThread): On master: BEGIN
2020-10-12 16:34:49.592682 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:34:49.592864 (MainThread): On master: COMMIT
2020-10-12 16:34:49.593018 (MainThread): Using postgres connection "master".
2020-10-12 16:34:49.593167 (MainThread): On master: COMMIT
2020-10-12 16:34:49.593447 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:34:49.593927 (MainThread): 16:34:49 | 
2020-10-12 16:34:49.594117 (MainThread): 16:34:49 | Finished running 4 view models in 0.48s.
2020-10-12 16:34:49.594286 (MainThread): Connection 'master' was left open.
2020-10-12 16:34:49.594414 (MainThread): On master: Close
2020-10-12 16:34:49.594594 (MainThread): Connection 'model.ge_tutorials.stg_state_abbreviations' was left open.
2020-10-12 16:34:49.594729 (MainThread): On model.ge_tutorials.stg_state_abbreviations: Close
2020-10-12 16:34:49.616512 (MainThread): 
2020-10-12 16:34:49.616776 (MainThread): Completed with 2 errors and 0 warnings:
2020-10-12 16:34:49.616969 (MainThread): 
2020-10-12 16:34:49.617152 (MainThread): Database Error in model stg_npi (models/staging/stg_npi.sql)
2020-10-12 16:34:49.617321 (MainThread):   relation "public.npi_small" does not exist
2020-10-12 16:34:49.617480 (MainThread):   LINE 12:   from "airflow"."public"."npi_small"
2020-10-12 16:34:49.617642 (MainThread):                   ^
2020-10-12 16:34:49.617800 (MainThread):   compiled SQL at target/run/ge_tutorials/staging/stg_npi.sql
2020-10-12 16:34:49.617972 (MainThread): 
2020-10-12 16:34:49.618147 (MainThread): Database Error in model stg_state_abbreviations (models/staging/stg_state_abbreviations.sql)
2020-10-12 16:34:49.618305 (MainThread):   relation "public.state_abbreviations" does not exist
2020-10-12 16:34:49.618454 (MainThread):   LINE 7:   from "airflow"."public"."state_abbreviations"
2020-10-12 16:34:49.618598 (MainThread):                  ^
2020-10-12 16:34:49.618758 (MainThread):   compiled SQL at target/run/ge_tutorials/staging/stg_state_abbreviations.sql
2020-10-12 16:34:49.618950 (MainThread): 
Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
2020-10-12 16:34:49.619348 (MainThread): Flushing usage events
2020-10-12 16:39:54.649640 (MainThread): Got an exception trying to initialize tracking
2020-10-12 16:39:54.649803 (MainThread): Running with dbt=0.16.0
2020-10-12 16:39:54.736466 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 16:39:54.736812 (MainThread): Tracking: do not track
2020-10-12 16:39:54.772003 (MainThread): Partial parsing not enabled
2020-10-12 16:39:54.774507 (MainThread): Parsing macros/core.sql
2020-10-12 16:39:54.784770 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 16:39:54.801021 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 16:39:54.814581 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 16:39:54.842239 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 16:39:54.851815 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 16:39:54.864603 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 16:39:54.935213 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 16:39:54.966972 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 16:39:54.970105 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 16:39:54.981667 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 16:39:54.985352 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 16:39:55.037927 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 16:39:55.040423 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 16:39:55.044839 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 16:39:55.046577 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 16:39:55.048729 (MainThread): Parsing macros/etc/query.sql
2020-10-12 16:39:55.050720 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 16:39:55.054586 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 16:39:55.056473 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 16:39:55.075719 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 16:39:55.079570 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 16:39:55.082601 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 16:39:55.084252 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 16:39:55.177695 (MainThread): Parsing macros/relations.sql
2020-10-12 16:39:55.180618 (MainThread): Parsing macros/adapters.sql
2020-10-12 16:39:55.216794 (MainThread): Parsing macros/catalog.sql
2020-10-12 16:39:55.221246 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 16:39:55.250528 (MainThread): Partial parsing not enabled
2020-10-12 16:39:55.297595 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:39:55.297750 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:39:55.324850 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:39:55.325010 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:39:55.333323 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:39:55.333464 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:39:55.342134 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:39:55.342273 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:39:55.886561 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 16:39:55.891677 (MainThread): 
2020-10-12 16:39:55.892120 (MainThread): Acquiring new postgres connection "master".
2020-10-12 16:39:55.892246 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:39:55.919001 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-12 16:39:55.919169 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-12 16:39:56.053857 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-12 16:39:56.054001 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-12 16:39:56.057876 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-12 16:39:56.082070 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-12 16:39:56.082207 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-12 16:39:56.084281 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:39:56.084392 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-12 16:39:56.084738 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:39:56.084861 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:39:56.084952 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-12 16:39:56.087004 (ThreadPoolExecutor-1_0): SQL status: SELECT 25 in 0.00 seconds
2020-10-12 16:39:56.115411 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-12 16:39:56.143330 (MainThread): Using postgres connection "master".
2020-10-12 16:39:56.143479 (MainThread): On master: BEGIN
2020-10-12 16:39:56.146573 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:39:56.146697 (MainThread): Using postgres connection "master".
2020-10-12 16:39:56.146800 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-12 16:39:56.152127 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-10-12 16:39:56.153188 (MainThread): On master: ROLLBACK
2020-10-12 16:39:56.153461 (MainThread): Using postgres connection "master".
2020-10-12 16:39:56.153567 (MainThread): On master: BEGIN
2020-10-12 16:39:56.154020 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:39:56.154138 (MainThread): On master: COMMIT
2020-10-12 16:39:56.154231 (MainThread): Using postgres connection "master".
2020-10-12 16:39:56.154316 (MainThread): On master: COMMIT
2020-10-12 16:39:56.154559 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:39:56.154876 (MainThread): 16:39:56 | Concurrency: 1 threads (target='dev')
2020-10-12 16:39:56.155018 (MainThread): 16:39:56 | 
2020-10-12 16:39:56.161363 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-12 16:39:56.161565 (Thread-1): 16:39:56 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-12 16:39:56.161911 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:39:56.162005 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-12 16:39:56.162105 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-12 16:39:56.188271 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:39:56.188625 (Thread-1): finished collecting timing info
2020-10-12 16:39:56.240345 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:39:56.240515 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-12 16:39:56.241088 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:39:56.244075 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:39:56.244185 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 16:39:56.244488 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:39:56.246344 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:39:56.246661 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:39:56.246775 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-12 16:39:56.247058 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:39:56.247177 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:39:56.247270 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-12 16:39:56.247607 (Thread-1): Postgres error: relation "public.npi_small" does not exist
LINE 12:   from "airflow"."public"."npi_small"
                ^

2020-10-12 16:39:56.247722 (Thread-1): On model.ge_tutorials.stg_npi: ROLLBACK
2020-10-12 16:39:56.248040 (Thread-1): finished collecting timing info
2020-10-12 16:39:56.248513 (Thread-1): Database Error in model stg_npi (models/staging/stg_npi.sql)
  relation "public.npi_small" does not exist
  LINE 12:   from "airflow"."public"."npi_small"
                  ^
  compiled SQL at target/run/ge_tutorials/staging/stg_npi.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "public.npi_small" does not exist
LINE 12:   from "airflow"."public"."npi_small"
                ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 220, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model stg_npi (models/staging/stg_npi.sql)
  relation "public.npi_small" does not exist
  LINE 12:   from "airflow"."public"."npi_small"
                  ^
  compiled SQL at target/run/ge_tutorials/staging/stg_npi.sql
2020-10-12 16:39:56.250235 (Thread-1): 16:39:56 | 1 of 4 ERROR creating view model public.stg_npi...................... [ERROR in 0.09s]
2020-10-12 16:39:56.250388 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-12 16:39:56.250547 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:39:56.250858 (Thread-1): 16:39:56 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-12 16:39:56.251155 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:39:56.251246 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-12 16:39:56.251339 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:39:56.260838 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:39:56.261161 (Thread-1): finished collecting timing info
2020-10-12 16:39:56.272648 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:39:56.272822 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-12 16:39:56.273253 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:39:56.276419 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:39:56.276536 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 16:39:56.276822 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:39:56.278728 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:39:56.279098 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:39:56.279212 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-12 16:39:56.279539 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:39:56.279654 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:39:56.279745 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-12 16:39:56.280065 (Thread-1): Postgres error: relation "public.state_abbreviations" does not exist
LINE 7:   from "airflow"."public"."state_abbreviations"
               ^

2020-10-12 16:39:56.280171 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: ROLLBACK
2020-10-12 16:39:56.280490 (Thread-1): finished collecting timing info
2020-10-12 16:39:56.281018 (Thread-1): Database Error in model stg_state_abbreviations (models/staging/stg_state_abbreviations.sql)
  relation "public.state_abbreviations" does not exist
  LINE 7:   from "airflow"."public"."state_abbreviations"
                 ^
  compiled SQL at target/run/ge_tutorials/staging/stg_state_abbreviations.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "public.state_abbreviations" does not exist
LINE 7:   from "airflow"."public"."state_abbreviations"
               ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 223, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 166, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 268, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.7/site-packages/dbt/node_runners.py", line 450, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 60, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 231, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/clients/jinja.py", line 161, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 220, in execute
    fetch=fetch
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 116, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model stg_state_abbreviations (models/staging/stg_state_abbreviations.sql)
  relation "public.state_abbreviations" does not exist
  LINE 7:   from "airflow"."public"."state_abbreviations"
                 ^
  compiled SQL at target/run/ge_tutorials/staging/stg_state_abbreviations.sql
2020-10-12 16:39:56.281649 (Thread-1): 16:39:56 | 2 of 4 ERROR creating view model public.stg_state_abbreviations...... [ERROR in 0.03s]
2020-10-12 16:39:56.281798 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:39:56.282296 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-12 16:39:56.282465 (Thread-1): 16:39:56 | 3 of 4 SKIP relation public.npi_with_state........................... [SKIP]
2020-10-12 16:39:56.282610 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-12 16:39:56.283018 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:39:56.283206 (Thread-1): 16:39:56 | 4 of 4 SKIP relation public.count_providers_by_state................. [SKIP]
2020-10-12 16:39:56.283368 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:39:56.363096 (MainThread): Using postgres connection "master".
2020-10-12 16:39:56.363563 (MainThread): On master: BEGIN
2020-10-12 16:39:56.364375 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:39:56.364803 (MainThread): On master: COMMIT
2020-10-12 16:39:56.365129 (MainThread): Using postgres connection "master".
2020-10-12 16:39:56.365432 (MainThread): On master: COMMIT
2020-10-12 16:39:56.366141 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:39:56.367280 (MainThread): 16:39:56 | 
2020-10-12 16:39:56.367775 (MainThread): 16:39:56 | Finished running 4 view models in 0.48s.
2020-10-12 16:39:56.368260 (MainThread): Connection 'master' was left open.
2020-10-12 16:39:56.368627 (MainThread): On master: Close
2020-10-12 16:39:56.369085 (MainThread): Connection 'model.ge_tutorials.stg_state_abbreviations' was left open.
2020-10-12 16:39:56.369403 (MainThread): On model.ge_tutorials.stg_state_abbreviations: Close
2020-10-12 16:39:56.406104 (MainThread): 
2020-10-12 16:39:56.406333 (MainThread): Completed with 2 errors and 0 warnings:
2020-10-12 16:39:56.406518 (MainThread): 
2020-10-12 16:39:56.406690 (MainThread): Database Error in model stg_npi (models/staging/stg_npi.sql)
2020-10-12 16:39:56.406861 (MainThread):   relation "public.npi_small" does not exist
2020-10-12 16:39:56.407031 (MainThread):   LINE 12:   from "airflow"."public"."npi_small"
2020-10-12 16:39:56.407198 (MainThread):                   ^
2020-10-12 16:39:56.407326 (MainThread):   compiled SQL at target/run/ge_tutorials/staging/stg_npi.sql
2020-10-12 16:39:56.407481 (MainThread): 
2020-10-12 16:39:56.407639 (MainThread): Database Error in model stg_state_abbreviations (models/staging/stg_state_abbreviations.sql)
2020-10-12 16:39:56.407795 (MainThread):   relation "public.state_abbreviations" does not exist
2020-10-12 16:39:56.407942 (MainThread):   LINE 7:   from "airflow"."public"."state_abbreviations"
2020-10-12 16:39:56.408072 (MainThread):                  ^
2020-10-12 16:39:56.408205 (MainThread):   compiled SQL at target/run/ge_tutorials/staging/stg_state_abbreviations.sql
2020-10-12 16:39:56.408354 (MainThread): 
Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
2020-10-12 16:39:56.408595 (MainThread): Flushing usage events
2020-10-12 16:45:20.235369 (MainThread): Got an exception trying to initialize tracking
2020-10-12 16:45:20.235520 (MainThread): Running with dbt=0.16.0
2020-10-12 16:45:20.335034 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 16:45:20.335403 (MainThread): Tracking: do not track
2020-10-12 16:45:20.370717 (MainThread): Partial parsing not enabled
2020-10-12 16:45:20.372797 (MainThread): Parsing macros/core.sql
2020-10-12 16:45:20.380985 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 16:45:20.396708 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 16:45:20.410170 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 16:45:20.439297 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 16:45:20.450439 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 16:45:20.464532 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 16:45:20.539107 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 16:45:20.571348 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 16:45:20.574695 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 16:45:20.586883 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 16:45:20.590526 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 16:45:20.635058 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 16:45:20.637143 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 16:45:20.640961 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 16:45:20.642501 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 16:45:20.644408 (MainThread): Parsing macros/etc/query.sql
2020-10-12 16:45:20.646210 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 16:45:20.649851 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 16:45:20.651650 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 16:45:20.669947 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 16:45:20.673682 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 16:45:20.676764 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 16:45:20.678468 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 16:45:20.826347 (MainThread): Parsing macros/relations.sql
2020-10-12 16:45:20.829404 (MainThread): Parsing macros/adapters.sql
2020-10-12 16:45:20.870703 (MainThread): Parsing macros/catalog.sql
2020-10-12 16:45:20.875723 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 16:45:20.906584 (MainThread): Partial parsing not enabled
2020-10-12 16:45:20.955800 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:20.955969 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:45:20.986878 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:20.987032 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:45:20.995462 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:20.995597 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:45:21.004445 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:21.004581 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:45:21.505029 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 16:45:21.510414 (MainThread): 
2020-10-12 16:45:21.510949 (MainThread): Acquiring new postgres connection "master".
2020-10-12 16:45:21.511088 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:45:21.541184 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-12 16:45:21.541519 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-12 16:45:21.704664 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-12 16:45:21.704845 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-12 16:45:21.710079 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2020-10-12 16:45:21.737302 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-12 16:45:21.737539 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-12 16:45:21.739811 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:45:21.739935 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-12 16:45:21.740317 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:21.740445 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:45:21.740541 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-12 16:45:21.743703 (ThreadPoolExecutor-1_0): SQL status: SELECT 27 in 0.00 seconds
2020-10-12 16:45:21.778524 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-12 16:45:21.806980 (MainThread): Using postgres connection "master".
2020-10-12 16:45:21.807138 (MainThread): On master: BEGIN
2020-10-12 16:45:21.810410 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:21.810552 (MainThread): Using postgres connection "master".
2020-10-12 16:45:21.810646 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-12 16:45:21.816323 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-10-12 16:45:21.817522 (MainThread): On master: ROLLBACK
2020-10-12 16:45:21.817848 (MainThread): Using postgres connection "master".
2020-10-12 16:45:21.817966 (MainThread): On master: BEGIN
2020-10-12 16:45:21.818381 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:21.818507 (MainThread): On master: COMMIT
2020-10-12 16:45:21.818605 (MainThread): Using postgres connection "master".
2020-10-12 16:45:21.818694 (MainThread): On master: COMMIT
2020-10-12 16:45:21.818987 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:45:21.819345 (MainThread): 16:45:21 | Concurrency: 1 threads (target='dev')
2020-10-12 16:45:21.819500 (MainThread): 16:45:21 | 
2020-10-12 16:45:21.825865 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-12 16:45:21.826155 (Thread-1): 16:45:21 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-12 16:45:21.826855 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:21.826991 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-12 16:45:21.827129 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-12 16:45:21.862925 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:45:21.863496 (Thread-1): finished collecting timing info
2020-10-12 16:45:21.921689 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:21.921861 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-12 16:45:21.922315 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:21.925366 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:21.925487 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 16:45:21.925813 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:21.927735 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:45:21.928057 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:21.928160 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-12 16:45:21.928384 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:21.928488 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:21.928576 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-12 16:45:21.929841 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:45:21.933031 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:21.933150 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-12 16:45:21.933499 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:45:21.934504 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-12 16:45:21.934612 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:21.934705 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-12 16:45:21.935801 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:45:21.938152 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:21.938269 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 16:45:21.938520 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:21.941655 (Thread-1): finished collecting timing info
2020-10-12 16:45:21.943718 (Thread-1): 16:45:21 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.12s]
2020-10-12 16:45:21.943876 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-12 16:45:21.944047 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:45:21.944348 (Thread-1): 16:45:21 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-12 16:45:21.944673 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:21.944770 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-12 16:45:21.944866 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:45:21.954250 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:45:21.954551 (Thread-1): finished collecting timing info
2020-10-12 16:45:21.965522 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:21.965688 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-12 16:45:21.966024 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:21.969145 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:21.969263 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 16:45:21.969526 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:21.971575 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:45:21.971976 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:21.972101 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-12 16:45:21.972418 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:21.972539 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:21.972636 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-12 16:45:21.973416 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:45:21.976855 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:21.977051 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-12 16:45:21.977869 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:45:21.979538 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-12 16:45:21.979717 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:21.979821 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-12 16:45:21.981001 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:45:21.983644 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:21.983762 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 16:45:21.984100 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:21.987418 (Thread-1): finished collecting timing info
2020-10-12 16:45:21.988238 (Thread-1): 16:45:21 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.04s]
2020-10-12 16:45:21.988392 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:45:21.988844 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-12 16:45:21.989009 (Thread-1): 16:45:21 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-12 16:45:21.989332 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:21.989433 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-12 16:45:21.989530 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-12 16:45:22.000890 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 16:45:22.001207 (Thread-1): finished collecting timing info
2020-10-12 16:45:22.012915 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:22.013082 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-12 16:45:22.013458 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:22.018044 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:22.018168 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 16:45:22.018480 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:22.020257 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 16:45:22.020584 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:22.020689 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-12 16:45:22.020946 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:22.021066 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:22.021163 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-12 16:45:22.022385 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:45:22.025897 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:22.026079 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-12 16:45:22.026550 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:45:22.027603 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-12 16:45:22.027716 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:22.027811 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-12 16:45:22.028891 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:45:22.031273 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:22.031386 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 16:45:22.031688 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:22.034854 (Thread-1): finished collecting timing info
2020-10-12 16:45:22.035691 (Thread-1): 16:45:22 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.05s]
2020-10-12 16:45:22.035847 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-12 16:45:22.036310 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:45:22.036474 (Thread-1): 16:45:22 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-12 16:45:22.036784 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:22.036899 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-12 16:45:22.036998 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-12 16:45:22.046313 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 16:45:22.046594 (Thread-1): finished collecting timing info
2020-10-12 16:45:22.057430 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:22.057591 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-12 16:45:22.058028 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:22.061516 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:22.061714 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 16:45:22.062168 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:22.064587 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 16:45:22.064961 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:22.065076 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-12 16:45:22.065396 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:22.065522 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:22.065620 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-12 16:45:22.066837 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:45:22.070461 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:22.070622 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-12 16:45:22.071107 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:45:22.072233 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-12 16:45:22.072345 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:22.072439 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-12 16:45:22.073461 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:45:22.075945 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:22.076059 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 16:45:22.076371 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:22.079788 (Thread-1): finished collecting timing info
2020-10-12 16:45:22.080662 (Thread-1): 16:45:22 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.04s]
2020-10-12 16:45:22.080823 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:45:22.126947 (MainThread): Using postgres connection "master".
2020-10-12 16:45:22.127149 (MainThread): On master: BEGIN
2020-10-12 16:45:22.127518 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:22.127683 (MainThread): On master: COMMIT
2020-10-12 16:45:22.127806 (MainThread): Using postgres connection "master".
2020-10-12 16:45:22.127921 (MainThread): On master: COMMIT
2020-10-12 16:45:22.128212 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:45:22.128642 (MainThread): 16:45:22 | 
2020-10-12 16:45:22.128831 (MainThread): 16:45:22 | Finished running 4 view models in 0.62s.
2020-10-12 16:45:22.128993 (MainThread): Connection 'master' was left open.
2020-10-12 16:45:22.129146 (MainThread): On master: Close
2020-10-12 16:45:22.129324 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-12 16:45:22.129474 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-12 16:45:22.150628 (MainThread): 
2020-10-12 16:45:22.150867 (MainThread): Completed successfully
2020-10-12 16:45:22.151049 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-12 16:45:22.151337 (MainThread): Flushing usage events
2020-10-12 16:45:55.102798 (MainThread): Got an exception trying to initialize tracking
2020-10-12 16:45:55.102962 (MainThread): Running with dbt=0.16.0
2020-10-12 16:45:55.197036 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 16:45:55.197390 (MainThread): Tracking: do not track
2020-10-12 16:45:55.230917 (MainThread): Partial parsing not enabled
2020-10-12 16:45:55.232899 (MainThread): Parsing macros/core.sql
2020-10-12 16:45:55.240636 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 16:45:55.255090 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 16:45:55.266716 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 16:45:55.290949 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 16:45:55.299390 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 16:45:55.311862 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 16:45:55.382234 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 16:45:55.409681 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 16:45:55.412304 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 16:45:55.422014 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 16:45:55.424756 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 16:45:55.459976 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 16:45:55.461577 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 16:45:55.464521 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 16:45:55.465714 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 16:45:55.467209 (MainThread): Parsing macros/etc/query.sql
2020-10-12 16:45:55.468622 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 16:45:55.471511 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 16:45:55.472941 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 16:45:55.487706 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 16:45:55.490615 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 16:45:55.492961 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 16:45:55.494269 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 16:45:55.570942 (MainThread): Parsing macros/relations.sql
2020-10-12 16:45:55.573381 (MainThread): Parsing macros/adapters.sql
2020-10-12 16:45:55.604098 (MainThread): Parsing macros/catalog.sql
2020-10-12 16:45:55.607886 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 16:45:55.632209 (MainThread): Partial parsing not enabled
2020-10-12 16:45:55.671294 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:55.671398 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:45:55.695237 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:55.695376 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:45:55.702592 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:55.702686 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:45:55.709523 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:55.709614 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:45:56.149778 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 16:45:56.154166 (MainThread): 
2020-10-12 16:45:56.154617 (MainThread): Acquiring new postgres connection "master".
2020-10-12 16:45:56.154729 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:45:56.180235 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-12 16:45:56.180524 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-12 16:45:56.326235 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-12 16:45:56.326391 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-12 16:45:56.330036 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-12 16:45:56.354686 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-12 16:45:56.354968 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-12 16:45:56.357116 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:45:56.357226 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-12 16:45:56.357595 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:56.357725 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:45:56.357818 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-12 16:45:56.359964 (ThreadPoolExecutor-1_0): SQL status: SELECT 31 in 0.00 seconds
2020-10-12 16:45:56.394226 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-12 16:45:56.421750 (MainThread): Using postgres connection "master".
2020-10-12 16:45:56.421916 (MainThread): On master: BEGIN
2020-10-12 16:45:56.425221 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:56.425399 (MainThread): Using postgres connection "master".
2020-10-12 16:45:56.425507 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-12 16:45:56.432016 (MainThread): SQL status: SELECT 5 in 0.01 seconds
2020-10-12 16:45:56.442861 (MainThread): On master: ROLLBACK
2020-10-12 16:45:56.443299 (MainThread): Using postgres connection "master".
2020-10-12 16:45:56.443445 (MainThread): On master: BEGIN
2020-10-12 16:45:56.443943 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:56.444096 (MainThread): On master: COMMIT
2020-10-12 16:45:56.444215 (MainThread): Using postgres connection "master".
2020-10-12 16:45:56.444322 (MainThread): On master: COMMIT
2020-10-12 16:45:56.444615 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:45:56.445051 (MainThread): 16:45:56 | Concurrency: 1 threads (target='dev')
2020-10-12 16:45:56.445232 (MainThread): 16:45:56 | 
2020-10-12 16:45:56.452976 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-12 16:45:56.453228 (Thread-1): 16:45:56 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-12 16:45:56.453665 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:56.453785 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-12 16:45:56.453909 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-12 16:45:56.483837 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:45:56.484214 (Thread-1): finished collecting timing info
2020-10-12 16:45:56.538722 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:56.538909 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-12 16:45:56.539508 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:56.542592 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:56.542703 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 16:45:56.543034 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:56.544863 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:45:56.545178 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:56.545280 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-12 16:45:56.545593 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:56.545717 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:56.545814 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-12 16:45:56.547079 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:45:56.552238 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:56.552357 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi" rename to "stg_npi__dbt_backup"
2020-10-12 16:45:56.552821 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:45:56.556924 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:56.557054 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-12 16:45:56.557536 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:45:56.558569 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-12 16:45:56.558678 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:56.558789 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-12 16:45:56.559970 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:45:56.562392 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:45:56.562518 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 16:45:56.564515 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:56.567664 (Thread-1): finished collecting timing info
2020-10-12 16:45:56.568458 (Thread-1): 16:45:56 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.11s]
2020-10-12 16:45:56.568615 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-12 16:45:56.568775 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:45:56.568930 (Thread-1): 16:45:56 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-12 16:45:56.569416 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:56.569657 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-12 16:45:56.569771 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:45:56.579090 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:45:56.579378 (Thread-1): finished collecting timing info
2020-10-12 16:45:56.589574 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:56.589754 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-12 16:45:56.590168 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:56.593330 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:56.593450 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 16:45:56.593757 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:56.595703 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:45:56.596056 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:56.596168 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-12 16:45:56.596468 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:56.596591 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:56.596689 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-12 16:45:56.597435 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:45:56.603367 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:56.603582 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations" rename to "stg_state_abbreviations__dbt_backup"
2020-10-12 16:45:56.604220 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:45:56.607642 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:56.607776 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-12 16:45:56.608201 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:45:56.609270 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-12 16:45:56.609382 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:56.609476 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-12 16:45:56.610398 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:45:56.612905 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:45:56.613019 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 16:45:56.614282 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:56.617661 (Thread-1): finished collecting timing info
2020-10-12 16:45:56.618463 (Thread-1): 16:45:56 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.05s]
2020-10-12 16:45:56.618624 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:45:56.619039 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-12 16:45:56.619203 (Thread-1): 16:45:56 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-12 16:45:56.619534 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:56.619633 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-12 16:45:56.619733 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-12 16:45:56.632228 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 16:45:56.632599 (Thread-1): finished collecting timing info
2020-10-12 16:45:56.643033 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:56.643181 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-12 16:45:56.643559 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:56.646556 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:56.646680 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 16:45:56.646994 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:56.648807 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 16:45:56.649120 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:56.649222 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-12 16:45:56.649464 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:56.649563 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:56.649650 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-12 16:45:56.650757 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:45:56.653714 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:56.653827 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-12 16:45:56.654264 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:45:56.655253 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-12 16:45:56.655362 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:56.655455 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-12 16:45:56.656560 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:45:56.658799 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:45:56.658907 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 16:45:56.659213 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:56.662196 (Thread-1): finished collecting timing info
2020-10-12 16:45:56.662973 (Thread-1): 16:45:56 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.04s]
2020-10-12 16:45:56.663127 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-12 16:45:56.663536 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:45:56.663694 (Thread-1): 16:45:56 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-12 16:45:56.663993 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:56.664090 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-12 16:45:56.664186 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-12 16:45:56.673188 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 16:45:56.673463 (Thread-1): finished collecting timing info
2020-10-12 16:45:56.682944 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:56.683122 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-12 16:45:56.683719 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:56.687399 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:56.687549 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 16:45:56.687933 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:56.689891 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 16:45:56.690226 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:56.690333 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-12 16:45:56.690560 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:56.690665 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:56.690772 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-12 16:45:56.691883 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:45:56.696964 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:56.697157 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-12 16:45:56.697848 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:45:56.699089 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-12 16:45:56.699223 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:56.699321 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-12 16:45:56.700371 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:45:56.702833 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:45:56.702946 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 16:45:56.703248 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:45:56.706358 (Thread-1): finished collecting timing info
2020-10-12 16:45:56.707159 (Thread-1): 16:45:56 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.04s]
2020-10-12 16:45:56.707314 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:45:56.754740 (MainThread): Using postgres connection "master".
2020-10-12 16:45:56.754910 (MainThread): On master: BEGIN
2020-10-12 16:45:56.755211 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:45:56.755321 (MainThread): On master: COMMIT
2020-10-12 16:45:56.755409 (MainThread): Using postgres connection "master".
2020-10-12 16:45:56.755494 (MainThread): On master: COMMIT
2020-10-12 16:45:56.755699 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:45:56.756020 (MainThread): 16:45:56 | 
2020-10-12 16:45:56.756152 (MainThread): 16:45:56 | Finished running 4 view models in 0.60s.
2020-10-12 16:45:56.756265 (MainThread): Connection 'master' was left open.
2020-10-12 16:45:56.756373 (MainThread): On master: Close
2020-10-12 16:45:56.756550 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-12 16:45:56.756656 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-12 16:45:56.772660 (MainThread): 
2020-10-12 16:45:56.772866 (MainThread): Completed successfully
2020-10-12 16:45:56.773016 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-12 16:45:56.773295 (MainThread): Flushing usage events
2020-10-12 16:46:50.292605 (MainThread): Got an exception trying to initialize tracking
2020-10-12 16:46:50.292749 (MainThread): Running with dbt=0.16.0
2020-10-12 16:46:50.375624 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 16:46:50.375972 (MainThread): Tracking: do not track
2020-10-12 16:46:50.411292 (MainThread): Partial parsing not enabled
2020-10-12 16:46:50.413353 (MainThread): Parsing macros/core.sql
2020-10-12 16:46:50.421457 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 16:46:50.437617 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 16:46:50.451483 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 16:46:50.479373 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 16:46:50.489195 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 16:46:50.502728 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 16:46:50.587592 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 16:46:50.622062 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 16:46:50.625320 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 16:46:50.637194 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 16:46:50.640682 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 16:46:50.683612 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 16:46:50.685643 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 16:46:50.689242 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 16:46:50.690750 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 16:46:50.692608 (MainThread): Parsing macros/etc/query.sql
2020-10-12 16:46:50.694409 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 16:46:50.698105 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 16:46:50.699988 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 16:46:50.718901 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 16:46:50.722675 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 16:46:50.725847 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 16:46:50.727628 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 16:46:50.818987 (MainThread): Parsing macros/relations.sql
2020-10-12 16:46:50.821585 (MainThread): Parsing macros/adapters.sql
2020-10-12 16:46:50.853759 (MainThread): Parsing macros/catalog.sql
2020-10-12 16:46:50.857802 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 16:46:50.883903 (MainThread): Partial parsing not enabled
2020-10-12 16:46:50.938705 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:46:50.938904 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:46:50.971507 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:46:50.971668 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:46:50.980268 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:46:50.980402 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:46:50.989166 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:46:50.989298 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:46:51.498312 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 16:46:51.503871 (MainThread): 
2020-10-12 16:46:51.504378 (MainThread): Acquiring new postgres connection "master".
2020-10-12 16:46:51.504522 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:46:51.530729 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-12 16:46:51.530911 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-12 16:46:51.668902 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-12 16:46:51.669073 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-12 16:46:51.673118 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-12 16:46:51.698605 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-12 16:46:51.698759 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-12 16:46:51.700905 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:46:51.701022 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-12 16:46:51.701369 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:46:51.701494 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:46:51.701589 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-12 16:46:51.703761 (ThreadPoolExecutor-1_0): SQL status: SELECT 31 in 0.00 seconds
2020-10-12 16:46:51.737102 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-12 16:46:51.761028 (MainThread): Using postgres connection "master".
2020-10-12 16:46:51.761132 (MainThread): On master: BEGIN
2020-10-12 16:46:51.763911 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:46:51.764029 (MainThread): Using postgres connection "master".
2020-10-12 16:46:51.764112 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-12 16:46:51.769100 (MainThread): SQL status: SELECT 5 in 0.00 seconds
2020-10-12 16:46:51.777228 (MainThread): On master: ROLLBACK
2020-10-12 16:46:51.777496 (MainThread): Using postgres connection "master".
2020-10-12 16:46:51.777596 (MainThread): On master: BEGIN
2020-10-12 16:46:51.778013 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:46:51.778129 (MainThread): On master: COMMIT
2020-10-12 16:46:51.778218 (MainThread): Using postgres connection "master".
2020-10-12 16:46:51.778298 (MainThread): On master: COMMIT
2020-10-12 16:46:51.778513 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:46:51.778804 (MainThread): 16:46:51 | Concurrency: 1 threads (target='dev')
2020-10-12 16:46:51.778935 (MainThread): 16:46:51 | 
2020-10-12 16:46:51.784518 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-12 16:46:51.784688 (Thread-1): 16:46:51 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-12 16:46:51.784989 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:46:51.785076 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-12 16:46:51.785170 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-12 16:46:51.807148 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:46:51.807466 (Thread-1): finished collecting timing info
2020-10-12 16:46:51.855792 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:46:51.855947 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-12 16:46:51.856522 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:46:51.859251 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:46:51.859350 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 16:46:51.859632 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:46:51.861287 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:46:51.861575 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:46:51.861667 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-12 16:46:51.861969 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:46:51.862075 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:46:51.862161 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-12 16:46:51.863405 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:46:51.867982 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:46:51.868082 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi" rename to "stg_npi__dbt_backup"
2020-10-12 16:46:51.868482 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:46:51.872065 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:46:51.872164 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-12 16:46:51.872550 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:46:51.873435 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-12 16:46:51.873532 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:46:51.873615 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-12 16:46:51.875014 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:46:51.877131 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:46:51.877233 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 16:46:51.879221 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:46:51.881936 (Thread-1): finished collecting timing info
2020-10-12 16:46:51.882633 (Thread-1): 16:46:51 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.10s]
2020-10-12 16:46:51.882786 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-12 16:46:51.882926 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:46:51.883063 (Thread-1): 16:46:51 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-12 16:46:51.883460 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:46:51.883551 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-12 16:46:51.883641 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:46:51.892507 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:46:51.892796 (Thread-1): finished collecting timing info
2020-10-12 16:46:51.903270 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:46:51.903454 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-12 16:46:51.903990 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:46:51.908025 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:46:51.908188 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 16:46:51.908590 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:46:51.910795 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:46:51.911204 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:46:51.911327 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-12 16:46:51.911636 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:46:51.911774 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:46:51.911877 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-12 16:46:51.912645 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:46:51.918668 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:46:51.918845 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations" rename to "stg_state_abbreviations__dbt_backup"
2020-10-12 16:46:51.919392 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:46:51.922718 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:46:51.922845 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-12 16:46:51.923258 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:46:51.924405 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-12 16:46:51.924519 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:46:51.924615 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-12 16:46:51.925595 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:46:51.928096 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:46:51.928208 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 16:46:51.929379 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:46:51.932688 (Thread-1): finished collecting timing info
2020-10-12 16:46:51.933481 (Thread-1): 16:46:51 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.05s]
2020-10-12 16:46:51.933639 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:46:51.934120 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-12 16:46:51.934288 (Thread-1): 16:46:51 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-12 16:46:51.934621 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:46:51.934723 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-12 16:46:51.934841 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-12 16:46:51.948432 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 16:46:51.948885 (Thread-1): finished collecting timing info
2020-10-12 16:46:51.959125 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:46:51.959281 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-12 16:46:51.959669 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:46:51.962781 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:46:51.962901 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 16:46:51.963220 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:46:51.965146 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 16:46:51.965452 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:46:51.965557 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-12 16:46:51.965781 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:46:51.965884 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:46:51.965974 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-12 16:46:51.967045 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:46:51.970203 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:46:51.970318 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-12 16:46:51.970723 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:46:51.971780 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-12 16:46:51.971891 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:46:51.971985 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-12 16:46:51.972989 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:46:51.975396 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:46:51.975509 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 16:46:51.975820 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:46:51.979023 (Thread-1): finished collecting timing info
2020-10-12 16:46:51.979830 (Thread-1): 16:46:51 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.05s]
2020-10-12 16:46:51.979990 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-12 16:46:51.980476 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:46:51.980643 (Thread-1): 16:46:51 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-12 16:46:51.980965 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:46:51.981072 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-12 16:46:51.981173 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-12 16:46:51.990390 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 16:46:51.990787 (Thread-1): finished collecting timing info
2020-10-12 16:46:52.001536 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:46:52.001759 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-12 16:46:52.002357 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:46:52.005861 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:46:52.006013 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 16:46:52.006418 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:46:52.008661 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 16:46:52.009026 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:46:52.009139 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-12 16:46:52.009435 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:46:52.009544 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:46:52.009635 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-12 16:46:52.010850 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:46:52.016545 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:46:52.016704 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-12 16:46:52.017208 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:46:52.018334 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-12 16:46:52.018449 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:46:52.018548 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-12 16:46:52.019623 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:46:52.022119 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:46:52.022232 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 16:46:52.022529 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:46:52.025759 (Thread-1): finished collecting timing info
2020-10-12 16:46:52.026560 (Thread-1): 16:46:52 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.05s]
2020-10-12 16:46:52.026720 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:46:52.091538 (MainThread): Using postgres connection "master".
2020-10-12 16:46:52.091803 (MainThread): On master: BEGIN
2020-10-12 16:46:52.092221 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:46:52.092427 (MainThread): On master: COMMIT
2020-10-12 16:46:52.092587 (MainThread): Using postgres connection "master".
2020-10-12 16:46:52.092738 (MainThread): On master: COMMIT
2020-10-12 16:46:52.093011 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:46:52.093529 (MainThread): 16:46:52 | 
2020-10-12 16:46:52.093755 (MainThread): 16:46:52 | Finished running 4 view models in 0.59s.
2020-10-12 16:46:52.093945 (MainThread): Connection 'master' was left open.
2020-10-12 16:46:52.094092 (MainThread): On master: Close
2020-10-12 16:46:52.094297 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-12 16:46:52.094445 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-12 16:46:52.134153 (MainThread): 
2020-10-12 16:46:52.134450 (MainThread): Completed successfully
2020-10-12 16:46:52.134672 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-12 16:46:52.134999 (MainThread): Flushing usage events
2020-10-12 16:48:49.585217 (MainThread): Got an exception trying to initialize tracking
2020-10-12 16:48:49.585395 (MainThread): Running with dbt=0.16.0
2020-10-12 16:48:49.691030 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 16:48:49.691470 (MainThread): Tracking: do not track
2020-10-12 16:48:49.730028 (MainThread): Partial parsing not enabled
2020-10-12 16:48:49.732206 (MainThread): Parsing macros/core.sql
2020-10-12 16:48:49.740853 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 16:48:49.757051 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 16:48:49.774090 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 16:48:49.806243 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 16:48:49.815904 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 16:48:49.828889 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 16:48:49.902152 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 16:48:49.933234 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 16:48:49.936289 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 16:48:49.947171 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 16:48:49.950335 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 16:48:49.989395 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 16:48:49.991235 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 16:48:49.994460 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 16:48:49.995777 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 16:48:49.997410 (MainThread): Parsing macros/etc/query.sql
2020-10-12 16:48:49.998966 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 16:48:50.002130 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 16:48:50.003696 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 16:48:50.020108 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 16:48:50.023371 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 16:48:50.025959 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 16:48:50.027411 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 16:48:50.133665 (MainThread): Parsing macros/relations.sql
2020-10-12 16:48:50.136617 (MainThread): Parsing macros/adapters.sql
2020-10-12 16:48:50.172943 (MainThread): Parsing macros/catalog.sql
2020-10-12 16:48:50.177395 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 16:48:50.205779 (MainThread): Partial parsing not enabled
2020-10-12 16:48:50.251020 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:48:50.251165 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:48:50.276957 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:48:50.277097 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:48:50.284987 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:48:50.285104 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:48:50.293112 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:48:50.293243 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:48:50.817663 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 16:48:50.822657 (MainThread): 
2020-10-12 16:48:50.823116 (MainThread): Acquiring new postgres connection "master".
2020-10-12 16:48:50.823239 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:48:50.848356 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-12 16:48:50.848519 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-12 16:48:50.976781 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-12 16:48:50.976922 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-12 16:48:50.980547 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-12 16:48:51.003382 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-12 16:48:51.003497 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-12 16:48:51.005518 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:48:51.005624 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-12 16:48:51.005929 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:48:51.006037 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:48:51.006123 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-12 16:48:51.008061 (ThreadPoolExecutor-1_0): SQL status: SELECT 31 in 0.00 seconds
2020-10-12 16:48:51.039332 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-12 16:48:51.062810 (MainThread): Using postgres connection "master".
2020-10-12 16:48:51.062908 (MainThread): On master: BEGIN
2020-10-12 16:48:51.065747 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:48:51.065857 (MainThread): Using postgres connection "master".
2020-10-12 16:48:51.065938 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-12 16:48:51.071175 (MainThread): SQL status: SELECT 5 in 0.01 seconds
2020-10-12 16:48:51.079354 (MainThread): On master: ROLLBACK
2020-10-12 16:48:51.079629 (MainThread): Using postgres connection "master".
2020-10-12 16:48:51.079734 (MainThread): On master: BEGIN
2020-10-12 16:48:51.080165 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:48:51.080280 (MainThread): On master: COMMIT
2020-10-12 16:48:51.080370 (MainThread): Using postgres connection "master".
2020-10-12 16:48:51.080452 (MainThread): On master: COMMIT
2020-10-12 16:48:51.080715 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:48:51.081020 (MainThread): 16:48:51 | Concurrency: 1 threads (target='dev')
2020-10-12 16:48:51.081158 (MainThread): 16:48:51 | 
2020-10-12 16:48:51.087028 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-12 16:48:51.087205 (Thread-1): 16:48:51 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-12 16:48:51.087528 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:48:51.087622 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-12 16:48:51.087723 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-12 16:48:51.112094 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:48:51.112478 (Thread-1): finished collecting timing info
2020-10-12 16:48:51.162776 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:48:51.162929 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-12 16:48:51.163478 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:48:51.166184 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:48:51.166279 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 16:48:51.166573 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:48:51.168225 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:48:51.168534 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:48:51.168625 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-12 16:48:51.168877 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:48:51.168986 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:48:51.169071 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-12 16:48:51.170374 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:48:51.175504 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:48:51.175619 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi" rename to "stg_npi__dbt_backup"
2020-10-12 16:48:51.176072 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:48:51.180052 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:48:51.180160 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-12 16:48:51.180570 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:48:51.181540 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-12 16:48:51.181645 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:48:51.181735 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-12 16:48:51.185523 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:48:51.188259 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:48:51.188399 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 16:48:51.190489 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:48:51.193661 (Thread-1): finished collecting timing info
2020-10-12 16:48:51.194429 (Thread-1): 16:48:51 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.11s]
2020-10-12 16:48:51.194582 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-12 16:48:51.194761 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:48:51.195057 (Thread-1): 16:48:51 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-12 16:48:51.195367 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:48:51.195463 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-12 16:48:51.195556 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:48:51.204906 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:48:51.205145 (Thread-1): finished collecting timing info
2020-10-12 16:48:51.215149 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:48:51.215521 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-12 16:48:51.216243 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:48:51.219560 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:48:51.219677 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 16:48:51.220007 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:48:51.221914 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:48:51.222189 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:48:51.222296 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-12 16:48:51.222573 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:48:51.222695 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:48:51.222807 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-12 16:48:51.223586 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:48:51.229440 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:48:51.229641 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations" rename to "stg_state_abbreviations__dbt_backup"
2020-10-12 16:48:51.230175 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:48:51.233554 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:48:51.233667 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-12 16:48:51.234095 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:48:51.235164 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-12 16:48:51.235277 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:48:51.235370 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-12 16:48:51.236959 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:48:51.239397 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:48:51.239506 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 16:48:51.241040 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:48:51.244286 (Thread-1): finished collecting timing info
2020-10-12 16:48:51.245069 (Thread-1): 16:48:51 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.05s]
2020-10-12 16:48:51.245229 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:48:51.245661 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-12 16:48:51.245820 (Thread-1): 16:48:51 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-12 16:48:51.246141 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:48:51.246241 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-12 16:48:51.246345 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-12 16:48:51.258890 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 16:48:51.259206 (Thread-1): finished collecting timing info
2020-10-12 16:48:51.269734 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:48:51.269892 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-12 16:48:51.270276 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:48:51.273366 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:48:51.273476 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 16:48:51.273801 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:48:51.275709 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 16:48:51.275992 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:48:51.276093 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-12 16:48:51.276351 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:48:51.276470 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:48:51.276567 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-12 16:48:51.277773 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:48:51.280810 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:48:51.280916 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-12 16:48:51.281324 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:48:51.282290 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-12 16:48:51.282394 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:48:51.282484 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-12 16:48:51.283722 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:48:51.285921 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:48:51.286025 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 16:48:51.286327 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:48:51.289328 (Thread-1): finished collecting timing info
2020-10-12 16:48:51.290099 (Thread-1): 16:48:51 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.04s]
2020-10-12 16:48:51.290260 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-12 16:48:51.290648 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:48:51.290812 (Thread-1): 16:48:51 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-12 16:48:51.291123 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:48:51.291221 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-12 16:48:51.291323 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-12 16:48:51.300536 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 16:48:51.300771 (Thread-1): finished collecting timing info
2020-10-12 16:48:51.310450 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:48:51.310614 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-12 16:48:51.311066 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:48:51.314712 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:48:51.314884 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 16:48:51.315269 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:48:51.317258 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 16:48:51.317533 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:48:51.317635 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-12 16:48:51.317884 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:48:51.318002 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:48:51.318098 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-12 16:48:51.319234 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:48:51.324204 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:48:51.324451 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-12 16:48:51.325043 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:48:51.326208 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-12 16:48:51.326331 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:48:51.326427 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-12 16:48:51.327795 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:48:51.330449 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:48:51.330569 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 16:48:51.330931 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:48:51.334093 (Thread-1): finished collecting timing info
2020-10-12 16:48:51.334885 (Thread-1): 16:48:51 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.04s]
2020-10-12 16:48:51.335043 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:48:51.392475 (MainThread): Using postgres connection "master".
2020-10-12 16:48:51.392939 (MainThread): On master: BEGIN
2020-10-12 16:48:51.393807 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:48:51.394234 (MainThread): On master: COMMIT
2020-10-12 16:48:51.394562 (MainThread): Using postgres connection "master".
2020-10-12 16:48:51.394911 (MainThread): On master: COMMIT
2020-10-12 16:48:51.395642 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:48:51.396720 (MainThread): 16:48:51 | 
2020-10-12 16:48:51.397186 (MainThread): 16:48:51 | Finished running 4 view models in 0.57s.
2020-10-12 16:48:51.397636 (MainThread): Connection 'master' was left open.
2020-10-12 16:48:51.398021 (MainThread): On master: Close
2020-10-12 16:48:51.398482 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-12 16:48:51.398830 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-12 16:48:51.438265 (MainThread): 
2020-10-12 16:48:51.438476 (MainThread): Completed successfully
2020-10-12 16:48:51.438654 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-12 16:48:51.438918 (MainThread): Flushing usage events
2020-10-12 16:50:42.359749 (MainThread): Got an exception trying to initialize tracking
2020-10-12 16:50:42.359897 (MainThread): Running with dbt=0.16.0
2020-10-12 16:50:42.444289 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 16:50:42.444633 (MainThread): Tracking: do not track
2020-10-12 16:50:42.478293 (MainThread): Partial parsing not enabled
2020-10-12 16:50:42.480360 (MainThread): Parsing macros/core.sql
2020-10-12 16:50:42.488468 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 16:50:42.503259 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 16:50:42.515327 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 16:50:42.538620 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 16:50:42.546508 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 16:50:42.556836 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 16:50:42.615035 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 16:50:42.644491 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 16:50:42.647804 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 16:50:42.659918 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 16:50:42.663577 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 16:50:42.710788 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 16:50:42.713585 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 16:50:42.718536 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 16:50:42.720623 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 16:50:42.723141 (MainThread): Parsing macros/etc/query.sql
2020-10-12 16:50:42.725469 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 16:50:42.730161 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 16:50:42.732550 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 16:50:42.756323 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 16:50:42.760919 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 16:50:42.764530 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 16:50:42.766505 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 16:50:42.865587 (MainThread): Parsing macros/relations.sql
2020-10-12 16:50:42.868577 (MainThread): Parsing macros/adapters.sql
2020-10-12 16:50:42.905977 (MainThread): Parsing macros/catalog.sql
2020-10-12 16:50:42.910669 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 16:50:42.941067 (MainThread): Partial parsing not enabled
2020-10-12 16:50:42.988859 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:50:42.989010 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:50:43.016760 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:50:43.016898 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:50:43.025103 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:50:43.025231 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:50:43.033464 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:50:43.033594 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:50:43.496866 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 16:50:43.501359 (MainThread): 
2020-10-12 16:50:43.501748 (MainThread): Acquiring new postgres connection "master".
2020-10-12 16:50:43.501857 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:50:43.526488 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-12 16:50:43.526771 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-12 16:50:43.763150 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-12 16:50:43.763309 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-12 16:50:43.767252 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-12 16:50:43.792923 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-12 16:50:43.793174 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-12 16:50:43.795308 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:50:43.795419 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-12 16:50:43.795765 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:50:43.795885 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:50:43.795977 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-12 16:50:43.798064 (ThreadPoolExecutor-1_0): SQL status: SELECT 31 in 0.00 seconds
2020-10-12 16:50:43.832390 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-12 16:50:43.857961 (MainThread): Using postgres connection "master".
2020-10-12 16:50:43.858099 (MainThread): On master: BEGIN
2020-10-12 16:50:43.861241 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:50:43.861384 (MainThread): Using postgres connection "master".
2020-10-12 16:50:43.861475 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-12 16:50:43.866900 (MainThread): SQL status: SELECT 5 in 0.01 seconds
2020-10-12 16:50:43.875593 (MainThread): On master: ROLLBACK
2020-10-12 16:50:43.875951 (MainThread): Using postgres connection "master".
2020-10-12 16:50:43.876066 (MainThread): On master: BEGIN
2020-10-12 16:50:43.876515 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:50:43.876636 (MainThread): On master: COMMIT
2020-10-12 16:50:43.876731 (MainThread): Using postgres connection "master".
2020-10-12 16:50:43.876816 (MainThread): On master: COMMIT
2020-10-12 16:50:43.877028 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:50:43.877331 (MainThread): 16:50:43 | Concurrency: 1 threads (target='dev')
2020-10-12 16:50:43.877465 (MainThread): 16:50:43 | 
2020-10-12 16:50:43.883498 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-12 16:50:43.883698 (Thread-1): 16:50:43 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-12 16:50:43.884084 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:50:43.884179 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-12 16:50:43.884281 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-12 16:50:43.908459 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:50:43.908836 (Thread-1): finished collecting timing info
2020-10-12 16:50:43.966543 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:50:43.966709 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-12 16:50:43.967285 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:50:43.970250 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:50:43.970358 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 16:50:43.970671 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:50:43.972487 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:50:43.972832 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:50:43.972929 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-12 16:50:43.973199 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:50:43.973316 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:50:43.973409 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-12 16:50:43.974743 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:50:43.979797 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:50:43.979911 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi" rename to "stg_npi__dbt_backup"
2020-10-12 16:50:43.980360 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:50:43.984310 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:50:43.984425 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-12 16:50:43.984823 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:50:43.985800 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-12 16:50:43.985907 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:50:43.985997 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-12 16:50:43.987134 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:50:43.989450 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:50:43.989561 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 16:50:43.991608 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:50:43.994477 (Thread-1): finished collecting timing info
2020-10-12 16:50:43.995226 (Thread-1): 16:50:43 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.11s]
2020-10-12 16:50:43.995372 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-12 16:50:43.995534 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:50:43.995691 (Thread-1): 16:50:43 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-12 16:50:43.996145 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:50:43.996244 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-12 16:50:43.996340 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:50:44.005103 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:50:44.005355 (Thread-1): finished collecting timing info
2020-10-12 16:50:44.014939 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:50:44.015240 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-12 16:50:44.015917 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:50:44.019273 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:50:44.019414 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 16:50:44.019786 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:50:44.021703 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:50:44.022022 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:50:44.022128 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-12 16:50:44.022369 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:50:44.022489 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:50:44.022589 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-12 16:50:44.023300 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:50:44.029051 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:50:44.029354 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations" rename to "stg_state_abbreviations__dbt_backup"
2020-10-12 16:50:44.030210 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:50:44.033808 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:50:44.033944 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-12 16:50:44.034379 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:50:44.035446 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-12 16:50:44.035559 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:50:44.035652 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-12 16:50:44.036854 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:50:44.039280 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:50:44.039394 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 16:50:44.040710 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:50:44.044009 (Thread-1): finished collecting timing info
2020-10-12 16:50:44.044788 (Thread-1): 16:50:44 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.05s]
2020-10-12 16:50:44.044940 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:50:44.045444 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-12 16:50:44.045608 (Thread-1): 16:50:44 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-12 16:50:44.045942 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:50:44.046044 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-12 16:50:44.046142 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-12 16:50:44.059276 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 16:50:44.059655 (Thread-1): finished collecting timing info
2020-10-12 16:50:44.069894 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:50:44.070047 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-12 16:50:44.070447 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:50:44.073490 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:50:44.073603 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 16:50:44.073956 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:50:44.075851 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 16:50:44.076164 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:50:44.076268 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-12 16:50:44.076531 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:50:44.076650 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:50:44.076746 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-12 16:50:44.077938 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:50:44.081056 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:50:44.081174 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-12 16:50:44.081622 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:50:44.082641 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-12 16:50:44.082764 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:50:44.082877 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-12 16:50:44.084168 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:50:44.086493 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:50:44.086606 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 16:50:44.087000 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:50:44.090000 (Thread-1): finished collecting timing info
2020-10-12 16:50:44.090770 (Thread-1): 16:50:44 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.04s]
2020-10-12 16:50:44.090920 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-12 16:50:44.091321 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:50:44.091483 (Thread-1): 16:50:44 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-12 16:50:44.091774 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:50:44.091884 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-12 16:50:44.091980 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-12 16:50:44.100924 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 16:50:44.101192 (Thread-1): finished collecting timing info
2020-10-12 16:50:44.111543 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:50:44.111718 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-12 16:50:44.112130 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:50:44.115837 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:50:44.115998 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 16:50:44.116373 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:50:44.118599 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 16:50:44.119007 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:50:44.119119 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-12 16:50:44.119371 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:50:44.119505 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:50:44.119604 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-12 16:50:44.120795 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:50:44.126277 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:50:44.126455 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-12 16:50:44.127181 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:50:44.128556 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-12 16:50:44.128704 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:50:44.128810 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-12 16:50:44.130085 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:50:44.136888 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:50:44.137138 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 16:50:44.137751 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:50:44.143696 (Thread-1): finished collecting timing info
2020-10-12 16:50:44.144987 (Thread-1): 16:50:44 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.05s]
2020-10-12 16:50:44.145199 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:50:44.187962 (MainThread): Using postgres connection "master".
2020-10-12 16:50:44.188168 (MainThread): On master: BEGIN
2020-10-12 16:50:44.188560 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:50:44.188721 (MainThread): On master: COMMIT
2020-10-12 16:50:44.188837 (MainThread): Using postgres connection "master".
2020-10-12 16:50:44.188946 (MainThread): On master: COMMIT
2020-10-12 16:50:44.189229 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:50:44.189651 (MainThread): 16:50:44 | 
2020-10-12 16:50:44.189824 (MainThread): 16:50:44 | Finished running 4 view models in 0.69s.
2020-10-12 16:50:44.189984 (MainThread): Connection 'master' was left open.
2020-10-12 16:50:44.190120 (MainThread): On master: Close
2020-10-12 16:50:44.190291 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-12 16:50:44.190403 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-12 16:50:44.211142 (MainThread): 
2020-10-12 16:50:44.211409 (MainThread): Completed successfully
2020-10-12 16:50:44.211603 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-12 16:50:44.211863 (MainThread): Flushing usage events
2020-10-12 16:51:12.853600 (MainThread): Got an exception trying to initialize tracking
2020-10-12 16:51:12.853745 (MainThread): Running with dbt=0.16.0
2020-10-12 16:51:12.942976 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['models.ge_tutorials.*'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 16:51:12.943472 (MainThread): Tracking: do not track
2020-10-12 16:51:12.982270 (MainThread): Partial parsing not enabled
2020-10-12 16:51:12.984480 (MainThread): Parsing macros/core.sql
2020-10-12 16:51:12.993285 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 16:51:13.011194 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 16:51:13.028421 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 16:51:13.062974 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 16:51:13.073737 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 16:51:13.087177 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 16:51:13.160362 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 16:51:13.194183 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 16:51:13.197573 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 16:51:13.209670 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 16:51:13.213241 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 16:51:13.258214 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 16:51:13.260306 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 16:51:13.263976 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 16:51:13.265458 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 16:51:13.267260 (MainThread): Parsing macros/etc/query.sql
2020-10-12 16:51:13.268968 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 16:51:13.272449 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 16:51:13.274161 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 16:51:13.291605 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 16:51:13.295090 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 16:51:13.297854 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 16:51:13.299389 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 16:51:13.383830 (MainThread): Parsing macros/relations.sql
2020-10-12 16:51:13.386438 (MainThread): Parsing macros/adapters.sql
2020-10-12 16:51:13.427783 (MainThread): Parsing macros/catalog.sql
2020-10-12 16:51:13.433493 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 16:51:13.466462 (MainThread): Partial parsing not enabled
2020-10-12 16:51:13.513961 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:51:13.514115 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:51:13.541211 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:51:13.541362 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:51:13.549447 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:51:13.549563 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:51:13.557836 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:51:13.557968 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:51:14.072747 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 16:51:14.076860 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-10-12 16:51:14.077099 (MainThread): Flushing usage events
2020-10-12 16:51:14.077266 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-12 16:52:51.279750 (MainThread): Got an exception trying to initialize tracking
2020-10-12 16:52:51.279907 (MainThread): Running with dbt=0.16.0
2020-10-12 16:52:51.363355 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['models.ge_tutorials.*'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 16:52:51.363684 (MainThread): Tracking: do not track
2020-10-12 16:52:51.396395 (MainThread): Partial parsing not enabled
2020-10-12 16:52:51.398352 (MainThread): Parsing macros/core.sql
2020-10-12 16:52:51.405901 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 16:52:51.419642 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 16:52:51.430933 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 16:52:51.453195 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 16:52:51.460804 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 16:52:51.470985 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 16:52:51.529004 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 16:52:51.555267 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 16:52:51.557800 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 16:52:51.567243 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 16:52:51.569978 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 16:52:51.605157 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 16:52:51.606761 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 16:52:51.609692 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 16:52:51.610888 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 16:52:51.612375 (MainThread): Parsing macros/etc/query.sql
2020-10-12 16:52:51.613787 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 16:52:51.616674 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 16:52:51.618094 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 16:52:51.632906 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 16:52:51.635800 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 16:52:51.638138 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 16:52:51.639448 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 16:52:51.716436 (MainThread): Parsing macros/relations.sql
2020-10-12 16:52:51.718770 (MainThread): Parsing macros/adapters.sql
2020-10-12 16:52:51.748375 (MainThread): Parsing macros/catalog.sql
2020-10-12 16:52:51.752035 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 16:52:51.775724 (MainThread): Partial parsing not enabled
2020-10-12 16:52:51.814701 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:52:51.814817 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:52:51.837471 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:52:51.837598 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:52:51.844936 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:52:51.845034 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:52:51.852314 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:52:51.852405 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:52:52.332638 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 16:52:52.336820 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-10-12 16:52:52.337051 (MainThread): Flushing usage events
2020-10-12 16:52:52.337205 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-12 16:56:49.772814 (MainThread): Got an exception trying to initialize tracking
2020-10-12 16:56:49.772957 (MainThread): Running with dbt=0.16.0
2020-10-12 16:56:49.855198 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 16:56:49.855531 (MainThread): Tracking: do not track
2020-10-12 16:56:49.888206 (MainThread): Partial parsing not enabled
2020-10-12 16:56:49.890154 (MainThread): Parsing macros/core.sql
2020-10-12 16:56:49.897583 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 16:56:49.911280 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 16:56:49.922328 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 16:56:49.944838 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 16:56:49.952481 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 16:56:49.962698 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 16:56:50.020803 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 16:56:50.047138 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 16:56:50.049674 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 16:56:50.059185 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 16:56:50.061925 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 16:56:50.103210 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 16:56:50.105318 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 16:56:50.109132 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 16:56:50.110722 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 16:56:50.112694 (MainThread): Parsing macros/etc/query.sql
2020-10-12 16:56:50.114583 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 16:56:50.118417 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 16:56:50.120401 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 16:56:50.140403 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 16:56:50.144700 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 16:56:50.148470 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 16:56:50.150715 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 16:56:50.258210 (MainThread): Parsing macros/relations.sql
2020-10-12 16:56:50.261218 (MainThread): Parsing macros/adapters.sql
2020-10-12 16:56:50.298552 (MainThread): Parsing macros/catalog.sql
2020-10-12 16:56:50.303074 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 16:56:50.332903 (MainThread): Partial parsing not enabled
2020-10-12 16:56:50.382203 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:56:50.382369 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:56:50.409512 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:56:50.409658 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:56:50.417821 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:56:50.417947 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:56:50.425919 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:56:50.426048 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:56:50.887961 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 16:56:50.892390 (MainThread): 
2020-10-12 16:56:50.892820 (MainThread): Acquiring new postgres connection "master".
2020-10-12 16:56:50.892931 (MainThread): Opening a new connection, currently in state init
2020-10-12 16:56:50.918338 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-12 16:56:50.918510 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-12 16:56:51.128416 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-12 16:56:51.128602 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-12 16:56:51.133079 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-12 16:56:51.161196 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-12 16:56:51.161502 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-12 16:56:51.163811 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:56:51.163933 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-12 16:56:51.164303 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:56:51.164440 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 16:56:51.164539 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-12 16:56:51.166707 (ThreadPoolExecutor-1_0): SQL status: SELECT 31 in 0.00 seconds
2020-10-12 16:56:51.203904 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-12 16:56:51.230521 (MainThread): Using postgres connection "master".
2020-10-12 16:56:51.230662 (MainThread): On master: BEGIN
2020-10-12 16:56:51.233704 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:56:51.233835 (MainThread): Using postgres connection "master".
2020-10-12 16:56:51.233924 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-12 16:56:51.239239 (MainThread): SQL status: SELECT 5 in 0.01 seconds
2020-10-12 16:56:51.247544 (MainThread): On master: ROLLBACK
2020-10-12 16:56:51.247837 (MainThread): Using postgres connection "master".
2020-10-12 16:56:51.247940 (MainThread): On master: BEGIN
2020-10-12 16:56:51.248387 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:56:51.248501 (MainThread): On master: COMMIT
2020-10-12 16:56:51.248592 (MainThread): Using postgres connection "master".
2020-10-12 16:56:51.248673 (MainThread): On master: COMMIT
2020-10-12 16:56:51.248929 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:56:51.249239 (MainThread): 16:56:51 | Concurrency: 1 threads (target='dev')
2020-10-12 16:56:51.249378 (MainThread): 16:56:51 | 
2020-10-12 16:56:51.255195 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-12 16:56:51.255382 (Thread-1): 16:56:51 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-12 16:56:51.255731 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:56:51.255824 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-12 16:56:51.255920 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-12 16:56:51.279881 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:56:51.280202 (Thread-1): finished collecting timing info
2020-10-12 16:56:51.332593 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:56:51.332777 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-12 16:56:51.333396 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:56:51.336619 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:56:51.336743 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 16:56:51.337078 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:56:51.338991 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 16:56:51.339306 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:56:51.339410 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-12 16:56:51.339696 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:56:51.339821 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:56:51.339919 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-12 16:56:51.341356 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:56:51.346637 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:56:51.346768 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi" rename to "stg_npi__dbt_backup"
2020-10-12 16:56:51.347249 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:56:51.351423 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:56:51.351537 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-12 16:56:51.351965 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:56:51.352977 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-12 16:56:51.353087 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:56:51.353182 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-12 16:56:51.354359 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:56:51.356725 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 16:56:51.356845 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 16:56:51.358892 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:56:51.361896 (Thread-1): finished collecting timing info
2020-10-12 16:56:51.362662 (Thread-1): 16:56:51 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.11s]
2020-10-12 16:56:51.362830 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-12 16:56:51.363007 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:56:51.363302 (Thread-1): 16:56:51 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-12 16:56:51.363616 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:56:51.363719 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-12 16:56:51.363815 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:56:51.373300 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:56:51.373569 (Thread-1): finished collecting timing info
2020-10-12 16:56:51.384474 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:56:51.384649 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-12 16:56:51.385046 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:56:51.388178 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:56:51.388287 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 16:56:51.388597 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:56:51.390612 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 16:56:51.391002 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:56:51.391126 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-12 16:56:51.391384 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:56:51.391501 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:56:51.391596 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-12 16:56:51.392334 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:56:51.398405 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:56:51.398587 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations" rename to "stg_state_abbreviations__dbt_backup"
2020-10-12 16:56:51.399095 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:56:51.402439 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:56:51.402550 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-12 16:56:51.402972 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:56:51.404026 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-12 16:56:51.404137 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:56:51.404232 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-12 16:56:51.405398 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:56:51.407830 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 16:56:51.407949 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 16:56:51.409363 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:56:51.412676 (Thread-1): finished collecting timing info
2020-10-12 16:56:51.413479 (Thread-1): 16:56:51 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.05s]
2020-10-12 16:56:51.413635 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 16:56:51.414147 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-12 16:56:51.414314 (Thread-1): 16:56:51 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-12 16:56:51.414656 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:56:51.414769 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-12 16:56:51.414872 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-12 16:56:51.427793 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 16:56:51.428308 (Thread-1): finished collecting timing info
2020-10-12 16:56:51.438860 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:56:51.439019 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-12 16:56:51.439413 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:56:51.442505 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:56:51.442617 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 16:56:51.442941 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:56:51.444836 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 16:56:51.445158 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:56:51.445263 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-12 16:56:51.445524 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:56:51.445644 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:56:51.445741 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-12 16:56:51.446904 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:56:51.449899 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:56:51.450005 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-12 16:56:51.450424 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:56:51.451417 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-12 16:56:51.451526 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:56:51.451618 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-12 16:56:51.452857 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:56:51.455089 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 16:56:51.455196 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 16:56:51.455492 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:56:51.458486 (Thread-1): finished collecting timing info
2020-10-12 16:56:51.459271 (Thread-1): 16:56:51 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.04s]
2020-10-12 16:56:51.459428 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-12 16:56:51.459955 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:56:51.460124 (Thread-1): 16:56:51 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-12 16:56:51.460441 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:56:51.460543 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-12 16:56:51.460638 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-12 16:56:51.469710 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 16:56:51.469963 (Thread-1): finished collecting timing info
2020-10-12 16:56:51.480711 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:56:51.480922 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-12 16:56:51.481640 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:56:51.485176 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:56:51.485324 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 16:56:51.485705 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:56:51.487897 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 16:56:51.488280 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:56:51.488387 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-12 16:56:51.488669 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:56:51.488790 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:56:51.488887 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-12 16:56:51.490033 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 16:56:51.495212 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:56:51.495383 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-12 16:56:51.496109 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 16:56:51.497343 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-12 16:56:51.497471 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:56:51.497568 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-12 16:56:51.498806 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:56:51.501230 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 16:56:51.501341 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 16:56:51.501664 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 16:56:51.504831 (Thread-1): finished collecting timing info
2020-10-12 16:56:51.505617 (Thread-1): 16:56:51 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.05s]
2020-10-12 16:56:51.505775 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-12 16:56:51.561016 (MainThread): Using postgres connection "master".
2020-10-12 16:56:51.561289 (MainThread): On master: BEGIN
2020-10-12 16:56:51.561780 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 16:56:51.562004 (MainThread): On master: COMMIT
2020-10-12 16:56:51.562171 (MainThread): Using postgres connection "master".
2020-10-12 16:56:51.562326 (MainThread): On master: COMMIT
2020-10-12 16:56:51.562692 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 16:56:51.563270 (MainThread): 16:56:51 | 
2020-10-12 16:56:51.563504 (MainThread): 16:56:51 | Finished running 4 view models in 0.67s.
2020-10-12 16:56:51.563721 (MainThread): Connection 'master' was left open.
2020-10-12 16:56:51.563913 (MainThread): On master: Close
2020-10-12 16:56:51.564146 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-12 16:56:51.564303 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-12 16:56:51.596507 (MainThread): 
2020-10-12 16:56:51.596831 (MainThread): Completed successfully
2020-10-12 16:56:51.597204 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-12 16:56:51.597672 (MainThread): Flushing usage events
2020-10-12 17:09:20.301922 (MainThread): Got an exception trying to initialize tracking
2020-10-12 17:09:20.302074 (MainThread): Running with dbt=0.16.0
2020-10-12 17:09:20.387983 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['models.ge_tutorials.*'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 17:09:20.388344 (MainThread): Tracking: do not track
2020-10-12 17:09:20.421314 (MainThread): Partial parsing not enabled
2020-10-12 17:09:20.423298 (MainThread): Parsing macros/core.sql
2020-10-12 17:09:20.430811 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 17:09:20.444904 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 17:09:20.456226 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 17:09:20.478515 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 17:09:20.486262 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 17:09:20.496632 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 17:09:20.554683 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 17:09:20.581099 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 17:09:20.583658 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 17:09:20.593213 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 17:09:20.595966 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 17:09:20.631331 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 17:09:20.632938 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 17:09:20.635884 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 17:09:20.637080 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 17:09:20.638599 (MainThread): Parsing macros/etc/query.sql
2020-10-12 17:09:20.640026 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 17:09:20.642931 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 17:09:20.644358 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 17:09:20.659188 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 17:09:20.662113 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 17:09:20.664468 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 17:09:20.665779 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 17:09:20.742947 (MainThread): Parsing macros/relations.sql
2020-10-12 17:09:20.745295 (MainThread): Parsing macros/adapters.sql
2020-10-12 17:09:20.774952 (MainThread): Parsing macros/catalog.sql
2020-10-12 17:09:20.778591 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 17:09:20.802071 (MainThread): Partial parsing not enabled
2020-10-12 17:09:20.840130 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 17:09:20.840236 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:09:20.862025 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 17:09:20.862183 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:09:20.870208 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 17:09:20.870341 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:09:20.878692 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 17:09:20.878844 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:09:21.363864 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 17:09:21.368100 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-10-12 17:09:21.368350 (MainThread): Flushing usage events
2020-10-12 17:09:21.368526 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-12 17:09:52.072993 (MainThread): Got an exception trying to initialize tracking
2020-10-12 17:09:52.073145 (MainThread): Running with dbt=0.16.0
2020-10-12 17:09:52.159183 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=True, log_cache_events=False, log_format='default', models=['models/ge_tutorials/count_providers_by_state.sql', 'models/ge_tutorials/npi_with_state.sql', 'models/ge_tutorials/sources.yml', 'models/ge_tutorials/staging'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 17:09:52.159546 (MainThread): Tracking: do not track
2020-10-12 17:09:52.214227 (MainThread): Partial parsing not enabled
2020-10-12 17:09:52.217771 (MainThread): Parsing macros/core.sql
2020-10-12 17:09:52.230935 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 17:09:52.256267 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 17:09:52.279071 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 17:09:52.315151 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 17:09:52.325682 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 17:09:52.339139 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 17:09:52.408950 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 17:09:52.437231 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 17:09:52.439961 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 17:09:52.449775 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 17:09:52.452707 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 17:09:52.491463 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 17:09:52.493411 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 17:09:52.496948 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 17:09:52.498390 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 17:09:52.500212 (MainThread): Parsing macros/etc/query.sql
2020-10-12 17:09:52.501915 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 17:09:52.505521 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 17:09:52.507392 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 17:09:52.526097 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 17:09:52.529732 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 17:09:52.532663 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 17:09:52.534290 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 17:09:52.614652 (MainThread): Parsing macros/relations.sql
2020-10-12 17:09:52.616977 (MainThread): Parsing macros/adapters.sql
2020-10-12 17:09:52.646608 (MainThread): Parsing macros/catalog.sql
2020-10-12 17:09:52.650266 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 17:09:52.674119 (MainThread): Partial parsing not enabled
2020-10-12 17:09:52.713026 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 17:09:52.713131 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:09:52.735063 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 17:09:52.735160 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:09:52.741754 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 17:09:52.741843 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:09:52.748553 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 17:09:52.748656 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:09:53.151023 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 17:09:53.156172 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-10-12 17:09:53.156499 (MainThread): Flushing usage events
2020-10-12 17:09:53.156698 (MainThread): Connection 'model.ge_tutorials.stg_npi' was properly closed.
2020-10-12 17:14:06.907775 (MainThread): Got an exception trying to initialize tracking
2020-10-12 17:14:06.907921 (MainThread): Running with dbt=0.16.0
2020-10-12 17:14:06.989165 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 17:14:06.989479 (MainThread): Tracking: do not track
2020-10-12 17:14:07.021963 (MainThread): Partial parsing not enabled
2020-10-12 17:14:07.023927 (MainThread): Parsing macros/core.sql
2020-10-12 17:14:07.031881 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 17:14:07.045933 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 17:14:07.057328 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 17:14:07.079894 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 17:14:07.087517 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 17:14:07.097698 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 17:14:07.155708 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 17:14:07.182783 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 17:14:07.185373 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 17:14:07.194821 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 17:14:07.197558 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 17:14:07.232714 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 17:14:07.234319 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 17:14:07.237261 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 17:14:07.238462 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 17:14:07.239957 (MainThread): Parsing macros/etc/query.sql
2020-10-12 17:14:07.241368 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 17:14:07.244253 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 17:14:07.245668 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 17:14:07.260454 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 17:14:07.263367 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 17:14:07.265702 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 17:14:07.267015 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 17:14:07.345421 (MainThread): Parsing macros/relations.sql
2020-10-12 17:14:07.347753 (MainThread): Parsing macros/adapters.sql
2020-10-12 17:14:07.377913 (MainThread): Parsing macros/catalog.sql
2020-10-12 17:14:07.381555 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 17:14:07.404877 (MainThread): Partial parsing not enabled
2020-10-12 17:14:07.448237 (MainThread): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 17:14:07.448375 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:14:07.476171 (MainThread): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 17:14:07.476329 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:14:07.485301 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 17:14:07.485474 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:14:07.495005 (MainThread): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 17:14:07.495187 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:14:07.979694 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 17:14:07.984892 (MainThread): 
2020-10-12 17:14:07.985373 (MainThread): Acquiring new postgres connection "master".
2020-10-12 17:14:07.985502 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:14:08.011410 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-12 17:14:08.011581 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-12 17:14:08.147546 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-12 17:14:08.147685 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-12 17:14:08.151173 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-12 17:14:08.174704 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-12 17:14:08.174876 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-12 17:14:08.177270 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 17:14:08.177392 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-12 17:14:08.177741 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:14:08.177863 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 17:14:08.177952 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-12 17:14:08.179952 (ThreadPoolExecutor-1_0): SQL status: SELECT 31 in 0.00 seconds
2020-10-12 17:14:08.212551 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-12 17:14:08.237709 (MainThread): Using postgres connection "master".
2020-10-12 17:14:08.237857 (MainThread): On master: BEGIN
2020-10-12 17:14:08.240917 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:14:08.241064 (MainThread): Using postgres connection "master".
2020-10-12 17:14:08.241151 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-12 17:14:08.246453 (MainThread): SQL status: SELECT 5 in 0.01 seconds
2020-10-12 17:14:08.254896 (MainThread): On master: ROLLBACK
2020-10-12 17:14:08.255272 (MainThread): Using postgres connection "master".
2020-10-12 17:14:08.255384 (MainThread): On master: BEGIN
2020-10-12 17:14:08.255856 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:14:08.255985 (MainThread): On master: COMMIT
2020-10-12 17:14:08.256083 (MainThread): Using postgres connection "master".
2020-10-12 17:14:08.256168 (MainThread): On master: COMMIT
2020-10-12 17:14:08.256447 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:14:08.256779 (MainThread): 17:14:08 | Concurrency: 1 threads (target='dev')
2020-10-12 17:14:08.256920 (MainThread): 17:14:08 | 
2020-10-12 17:14:08.262950 (Thread-1): Began running node model.ge_tutorials.stg_npi
2020-10-12 17:14:08.263148 (Thread-1): 17:14:08 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-12 17:14:08.263520 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 17:14:08.263617 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-12 17:14:08.263723 (Thread-1): Compiling model.ge_tutorials.stg_npi
2020-10-12 17:14:08.287954 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 17:14:08.288271 (Thread-1): finished collecting timing info
2020-10-12 17:14:08.344187 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 17:14:08.344462 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-12 17:14:08.345137 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:14:08.350614 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 17:14:08.350825 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 17:14:08.351278 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:14:08.354581 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_npi"
2020-10-12 17:14:08.355105 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 17:14:08.355279 (Thread-1): On model.ge_tutorials.stg_npi: BEGIN
2020-10-12 17:14:08.355612 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:14:08.355800 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 17:14:08.355966 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-12 17:14:08.358123 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:14:08.367291 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 17:14:08.367554 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi" rename to "stg_npi__dbt_backup"
2020-10-12 17:14:08.368205 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:14:08.375408 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 17:14:08.375612 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-12 17:14:08.376324 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:14:08.378077 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-12 17:14:08.378247 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 17:14:08.378399 (Thread-1): On model.ge_tutorials.stg_npi: COMMIT
2020-10-12 17:14:08.379580 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:14:08.383690 (Thread-1): Using postgres connection "model.ge_tutorials.stg_npi".
2020-10-12 17:14:08.383875 (Thread-1): On model.ge_tutorials.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 17:14:08.386545 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:14:08.391759 (Thread-1): finished collecting timing info
2020-10-12 17:14:08.393015 (Thread-1): 17:14:08 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.13s]
2020-10-12 17:14:08.393786 (Thread-1): Finished running node model.ge_tutorials.stg_npi
2020-10-12 17:14:08.394084 (Thread-1): Began running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 17:14:08.394472 (Thread-1): 17:14:08 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-12 17:14:08.395329 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 17:14:08.395487 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_npi).
2020-10-12 17:14:08.395647 (Thread-1): Compiling model.ge_tutorials.stg_state_abbreviations
2020-10-12 17:14:08.412003 (Thread-1): Writing injected SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 17:14:08.412586 (Thread-1): finished collecting timing info
2020-10-12 17:14:08.431081 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 17:14:08.431371 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-12 17:14:08.431936 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:14:08.437681 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 17:14:08.437938 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 17:14:08.438487 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:14:08.442146 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.stg_state_abbreviations"
2020-10-12 17:14:08.442762 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 17:14:08.442953 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: BEGIN
2020-10-12 17:14:08.443339 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:14:08.443528 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 17:14:08.443692 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-12 17:14:08.444977 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:14:08.454253 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 17:14:08.454518 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations" rename to "stg_state_abbreviations__dbt_backup"
2020-10-12 17:14:08.455261 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:14:08.461275 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 17:14:08.461531 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-12 17:14:08.462244 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:14:08.464236 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-12 17:14:08.464428 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 17:14:08.464588 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: COMMIT
2020-10-12 17:14:08.465752 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:14:08.470425 (Thread-1): Using postgres connection "model.ge_tutorials.stg_state_abbreviations".
2020-10-12 17:14:08.470711 (Thread-1): On model.ge_tutorials.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 17:14:08.472286 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:14:08.475936 (Thread-1): finished collecting timing info
2020-10-12 17:14:08.476820 (Thread-1): 17:14:08 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.08s]
2020-10-12 17:14:08.476996 (Thread-1): Finished running node model.ge_tutorials.stg_state_abbreviations
2020-10-12 17:14:08.477436 (Thread-1): Began running node model.ge_tutorials.npi_with_state
2020-10-12 17:14:08.477623 (Thread-1): 17:14:08 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-12 17:14:08.478004 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 17:14:08.478112 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.stg_state_abbreviations).
2020-10-12 17:14:08.478218 (Thread-1): Compiling model.ge_tutorials.npi_with_state
2020-10-12 17:14:08.493432 (Thread-1): Writing injected SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 17:14:08.493790 (Thread-1): finished collecting timing info
2020-10-12 17:14:08.505107 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 17:14:08.505280 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-12 17:14:08.505725 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:14:08.509307 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 17:14:08.509469 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 17:14:08.509931 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:14:08.512513 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.npi_with_state"
2020-10-12 17:14:08.512902 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 17:14:08.513020 (Thread-1): On model.ge_tutorials.npi_with_state: BEGIN
2020-10-12 17:14:08.513339 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:14:08.513472 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 17:14:08.513595 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-12 17:14:08.514836 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:14:08.518309 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 17:14:08.518441 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-12 17:14:08.518973 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:14:08.520126 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-12 17:14:08.520249 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 17:14:08.520354 (Thread-1): On model.ge_tutorials.npi_with_state: COMMIT
2020-10-12 17:14:08.521431 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:14:08.524001 (Thread-1): Using postgres connection "model.ge_tutorials.npi_with_state".
2020-10-12 17:14:08.524124 (Thread-1): On model.ge_tutorials.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 17:14:08.524424 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:14:08.527739 (Thread-1): finished collecting timing info
2020-10-12 17:14:08.528567 (Thread-1): 17:14:08 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.05s]
2020-10-12 17:14:08.528736 (Thread-1): Finished running node model.ge_tutorials.npi_with_state
2020-10-12 17:14:08.529157 (Thread-1): Began running node model.ge_tutorials.count_providers_by_state
2020-10-12 17:14:08.529328 (Thread-1): 17:14:08 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-12 17:14:08.529671 (Thread-1): Acquiring new postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 17:14:08.529774 (Thread-1): Re-using an available connection from the pool (formerly model.ge_tutorials.npi_with_state).
2020-10-12 17:14:08.529876 (Thread-1): Compiling model.ge_tutorials.count_providers_by_state
2020-10-12 17:14:08.539603 (Thread-1): Writing injected SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 17:14:08.539982 (Thread-1): finished collecting timing info
2020-10-12 17:14:08.550336 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 17:14:08.550492 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-12 17:14:08.550847 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:14:08.553920 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 17:14:08.554033 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 17:14:08.554289 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:14:08.556244 (Thread-1): Writing runtime SQL for node "model.ge_tutorials.count_providers_by_state"
2020-10-12 17:14:08.556568 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 17:14:08.556675 (Thread-1): On model.ge_tutorials.count_providers_by_state: BEGIN
2020-10-12 17:14:08.556855 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:14:08.556961 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 17:14:08.557050 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-12 17:14:08.558091 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:14:08.562587 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 17:14:08.562717 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-12 17:14:08.563076 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:14:08.564062 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-12 17:14:08.564170 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 17:14:08.564262 (Thread-1): On model.ge_tutorials.count_providers_by_state: COMMIT
2020-10-12 17:14:08.565279 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:14:08.567602 (Thread-1): Using postgres connection "model.ge_tutorials.count_providers_by_state".
2020-10-12 17:14:08.567713 (Thread-1): On model.ge_tutorials.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.ge_tutorials.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 17:14:08.567966 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:14:08.571026 (Thread-1): finished collecting timing info
2020-10-12 17:14:08.571799 (Thread-1): 17:14:08 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.04s]
2020-10-12 17:14:08.571957 (Thread-1): Finished running node model.ge_tutorials.count_providers_by_state
2020-10-12 17:14:08.672881 (MainThread): Using postgres connection "master".
2020-10-12 17:14:08.673037 (MainThread): On master: BEGIN
2020-10-12 17:14:08.673370 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:14:08.673494 (MainThread): On master: COMMIT
2020-10-12 17:14:08.673586 (MainThread): Using postgres connection "master".
2020-10-12 17:14:08.673670 (MainThread): On master: COMMIT
2020-10-12 17:14:08.673933 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:14:08.674286 (MainThread): 17:14:08 | 
2020-10-12 17:14:08.674460 (MainThread): 17:14:08 | Finished running 4 view models in 0.69s.
2020-10-12 17:14:08.674621 (MainThread): Connection 'master' was left open.
2020-10-12 17:14:08.674744 (MainThread): On master: Close
2020-10-12 17:14:08.674884 (MainThread): Connection 'model.ge_tutorials.count_providers_by_state' was left open.
2020-10-12 17:14:08.674974 (MainThread): On model.ge_tutorials.count_providers_by_state: Close
2020-10-12 17:14:08.695709 (MainThread): 
2020-10-12 17:14:08.695946 (MainThread): Completed successfully
2020-10-12 17:14:08.696127 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-12 17:14:08.696426 (MainThread): Flushing usage events
2020-10-12 17:18:16.075115 (MainThread): Got an exception trying to initialize tracking
2020-10-12 17:18:16.075277 (MainThread): Running with dbt=0.16.0
2020-10-12 17:18:16.161323 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 17:18:16.161676 (MainThread): Tracking: do not track
2020-10-12 17:18:16.196770 (MainThread): Partial parsing not enabled
2020-10-12 17:18:16.198923 (MainThread): Parsing macros/core.sql
2020-10-12 17:18:16.207081 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 17:18:16.222371 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 17:18:16.235230 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 17:18:16.262208 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 17:18:16.272755 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 17:18:16.287976 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 17:18:16.367946 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 17:18:16.397774 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 17:18:16.400636 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 17:18:16.411243 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 17:18:16.414255 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 17:18:16.452809 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 17:18:16.454616 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 17:18:16.457822 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 17:18:16.459134 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 17:18:16.460759 (MainThread): Parsing macros/etc/query.sql
2020-10-12 17:18:16.462299 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 17:18:16.465432 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 17:18:16.466921 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 17:18:16.482111 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 17:18:16.485098 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 17:18:16.487518 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 17:18:16.488864 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 17:18:16.568644 (MainThread): Parsing macros/relations.sql
2020-10-12 17:18:16.571246 (MainThread): Parsing macros/adapters.sql
2020-10-12 17:18:16.603693 (MainThread): Parsing macros/catalog.sql
2020-10-12 17:18:16.607946 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 17:18:16.635816 (MainThread): Partial parsing not enabled
2020-10-12 17:18:16.709965 (MainThread): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:18:16.710187 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:18:16.756803 (MainThread): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:18:16.757124 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:18:16.779761 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:18:16.779906 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:18:16.788877 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:18:16.789024 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:18:16.963880 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ge_tutorials

2020-10-12 17:18:17.237236 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 17:18:17.242232 (MainThread): 
2020-10-12 17:18:17.242654 (MainThread): Acquiring new postgres connection "master".
2020-10-12 17:18:17.242787 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:18:17.268875 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-12 17:18:17.269036 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-12 17:18:17.397016 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-12 17:18:17.397240 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-12 17:18:17.401184 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-12 17:18:17.424661 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-12 17:18:17.424779 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-12 17:18:17.426815 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 17:18:17.426921 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-12 17:18:17.427233 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:18:17.427347 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 17:18:17.427433 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-12 17:18:17.429400 (ThreadPoolExecutor-1_0): SQL status: SELECT 31 in 0.00 seconds
2020-10-12 17:18:17.461047 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-12 17:18:17.484833 (MainThread): Using postgres connection "master".
2020-10-12 17:18:17.484939 (MainThread): On master: BEGIN
2020-10-12 17:18:17.487793 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:18:17.487913 (MainThread): Using postgres connection "master".
2020-10-12 17:18:17.487999 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-12 17:18:17.493160 (MainThread): SQL status: SELECT 5 in 0.01 seconds
2020-10-12 17:18:17.501394 (MainThread): On master: ROLLBACK
2020-10-12 17:18:17.501677 (MainThread): Using postgres connection "master".
2020-10-12 17:18:17.501780 (MainThread): On master: BEGIN
2020-10-12 17:18:17.502199 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:18:17.502324 (MainThread): On master: COMMIT
2020-10-12 17:18:17.502418 (MainThread): Using postgres connection "master".
2020-10-12 17:18:17.502500 (MainThread): On master: COMMIT
2020-10-12 17:18:17.502702 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:18:17.503007 (MainThread): 17:18:17 | Concurrency: 1 threads (target='dev')
2020-10-12 17:18:17.503138 (MainThread): 17:18:17 | 
2020-10-12 17:18:17.509142 (Thread-1): Began running node model.airflow_dbt.stg_npi
2020-10-12 17:18:17.509318 (Thread-1): 17:18:17 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-12 17:18:17.509648 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:18:17.509740 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-12 17:18:17.509838 (Thread-1): Compiling model.airflow_dbt.stg_npi
2020-10-12 17:18:17.533230 (Thread-1): Writing injected SQL for node "model.airflow_dbt.stg_npi"
2020-10-12 17:18:17.533600 (Thread-1): finished collecting timing info
2020-10-12 17:18:17.583574 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:18:17.583728 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-12 17:18:17.584294 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:18:17.588116 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:18:17.588265 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 17:18:17.588596 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:18:17.590833 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.stg_npi"
2020-10-12 17:18:17.591140 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:18:17.591234 (Thread-1): On model.airflow_dbt.stg_npi: BEGIN
2020-10-12 17:18:17.591525 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:18:17.591632 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:18:17.591718 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-12 17:18:17.593048 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:18:17.597957 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:18:17.598067 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
alter table "airflow"."public"."stg_npi" rename to "stg_npi__dbt_backup"
2020-10-12 17:18:17.598494 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:18:17.602244 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:18:17.602348 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-12 17:18:17.602760 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:18:17.603691 (Thread-1): On model.airflow_dbt.stg_npi: COMMIT
2020-10-12 17:18:17.603793 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:18:17.603880 (Thread-1): On model.airflow_dbt.stg_npi: COMMIT
2020-10-12 17:18:17.607851 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:18:17.610531 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:18:17.610678 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 17:18:17.613132 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:18:17.616312 (Thread-1): finished collecting timing info
2020-10-12 17:18:17.617089 (Thread-1): 17:18:17 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.11s]
2020-10-12 17:18:17.617239 (Thread-1): Finished running node model.airflow_dbt.stg_npi
2020-10-12 17:18:17.617386 (Thread-1): Began running node model.airflow_dbt.stg_state_abbreviations
2020-10-12 17:18:17.617550 (Thread-1): 17:18:17 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-12 17:18:17.618007 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:18:17.618109 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.stg_npi).
2020-10-12 17:18:17.618207 (Thread-1): Compiling model.airflow_dbt.stg_state_abbreviations
2020-10-12 17:18:17.627571 (Thread-1): Writing injected SQL for node "model.airflow_dbt.stg_state_abbreviations"
2020-10-12 17:18:17.627811 (Thread-1): finished collecting timing info
2020-10-12 17:18:17.638169 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:18:17.638346 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-12 17:18:17.638799 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:18:17.642040 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:18:17.642205 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 17:18:17.642705 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:18:17.644961 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.stg_state_abbreviations"
2020-10-12 17:18:17.645346 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:18:17.645461 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: BEGIN
2020-10-12 17:18:17.645795 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:18:17.645919 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:18:17.646016 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-12 17:18:17.646841 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:18:17.652502 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:18:17.652662 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations" rename to "stg_state_abbreviations__dbt_backup"
2020-10-12 17:18:17.653182 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:18:17.656513 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:18:17.656626 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-12 17:18:17.657040 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:18:17.658110 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: COMMIT
2020-10-12 17:18:17.658221 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:18:17.658315 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: COMMIT
2020-10-12 17:18:17.659708 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:18:17.662369 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:18:17.662485 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 17:18:17.664098 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:18:17.667399 (Thread-1): finished collecting timing info
2020-10-12 17:18:17.668168 (Thread-1): 17:18:17 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.05s]
2020-10-12 17:18:17.668320 (Thread-1): Finished running node model.airflow_dbt.stg_state_abbreviations
2020-10-12 17:18:17.668760 (Thread-1): Began running node model.airflow_dbt.npi_with_state
2020-10-12 17:18:17.668922 (Thread-1): 17:18:17 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-12 17:18:17.669234 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:18:17.669334 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.stg_state_abbreviations).
2020-10-12 17:18:17.669431 (Thread-1): Compiling model.airflow_dbt.npi_with_state
2020-10-12 17:18:17.682844 (Thread-1): Writing injected SQL for node "model.airflow_dbt.npi_with_state"
2020-10-12 17:18:17.683378 (Thread-1): finished collecting timing info
2020-10-12 17:18:17.693505 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:18:17.693657 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-12 17:18:17.694052 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:18:17.697104 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:18:17.697214 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 17:18:17.697523 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:18:17.699420 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.npi_with_state"
2020-10-12 17:18:17.699697 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:18:17.699800 (Thread-1): On model.airflow_dbt.npi_with_state: BEGIN
2020-10-12 17:18:17.700059 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:18:17.700178 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:18:17.700274 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-12 17:18:17.701435 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:18:17.704503 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:18:17.704614 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-12 17:18:17.705073 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:18:17.706074 (Thread-1): On model.airflow_dbt.npi_with_state: COMMIT
2020-10-12 17:18:17.706180 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:18:17.706270 (Thread-1): On model.airflow_dbt.npi_with_state: COMMIT
2020-10-12 17:18:17.707593 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:18:17.709807 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:18:17.709912 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 17:18:17.710208 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:18:17.713192 (Thread-1): finished collecting timing info
2020-10-12 17:18:17.713953 (Thread-1): 17:18:17 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.04s]
2020-10-12 17:18:17.714105 (Thread-1): Finished running node model.airflow_dbt.npi_with_state
2020-10-12 17:18:17.714530 (Thread-1): Began running node model.airflow_dbt.count_providers_by_state
2020-10-12 17:18:17.714680 (Thread-1): 17:18:17 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-12 17:18:17.714983 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:18:17.715078 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.npi_with_state).
2020-10-12 17:18:17.715182 (Thread-1): Compiling model.airflow_dbt.count_providers_by_state
2020-10-12 17:18:17.724127 (Thread-1): Writing injected SQL for node "model.airflow_dbt.count_providers_by_state"
2020-10-12 17:18:17.724353 (Thread-1): finished collecting timing info
2020-10-12 17:18:17.735068 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:18:17.735269 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-12 17:18:17.735896 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:18:17.739391 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:18:17.739515 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 17:18:17.739871 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:18:17.741822 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.count_providers_by_state"
2020-10-12 17:18:17.742123 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:18:17.742259 (Thread-1): On model.airflow_dbt.count_providers_by_state: BEGIN
2020-10-12 17:18:17.742571 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:18:17.742678 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:18:17.742786 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-12 17:18:17.744114 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:18:17.749114 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:18:17.749285 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-12 17:18:17.749809 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:18:17.750935 (Thread-1): On model.airflow_dbt.count_providers_by_state: COMMIT
2020-10-12 17:18:17.751046 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:18:17.751140 (Thread-1): On model.airflow_dbt.count_providers_by_state: COMMIT
2020-10-12 17:18:17.752555 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:18:17.755013 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:18:17.755123 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 17:18:17.755429 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:18:17.758592 (Thread-1): finished collecting timing info
2020-10-12 17:18:17.759493 (Thread-1): 17:18:17 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.04s]
2020-10-12 17:18:17.759675 (Thread-1): Finished running node model.airflow_dbt.count_providers_by_state
2020-10-12 17:18:17.815126 (MainThread): Using postgres connection "master".
2020-10-12 17:18:17.815316 (MainThread): On master: BEGIN
2020-10-12 17:18:17.815662 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:18:17.815802 (MainThread): On master: COMMIT
2020-10-12 17:18:17.815906 (MainThread): Using postgres connection "master".
2020-10-12 17:18:17.816002 (MainThread): On master: COMMIT
2020-10-12 17:18:17.816258 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:18:17.816650 (MainThread): 17:18:17 | 
2020-10-12 17:18:17.816806 (MainThread): 17:18:17 | Finished running 4 view models in 0.57s.
2020-10-12 17:18:17.816969 (MainThread): Connection 'master' was left open.
2020-10-12 17:18:17.817101 (MainThread): On master: Close
2020-10-12 17:18:17.817258 (MainThread): Connection 'model.airflow_dbt.count_providers_by_state' was left open.
2020-10-12 17:18:17.817357 (MainThread): On model.airflow_dbt.count_providers_by_state: Close
2020-10-12 17:18:17.836279 (MainThread): 
2020-10-12 17:18:17.836671 (MainThread): Completed successfully
2020-10-12 17:18:17.836974 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-12 17:18:17.837323 (MainThread): Flushing usage events
2020-10-12 17:23:14.922131 (MainThread): Got an exception trying to initialize tracking
2020-10-12 17:23:14.922286 (MainThread): Running with dbt=0.16.0
2020-10-12 17:23:15.014894 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 17:23:15.015415 (MainThread): Tracking: do not track
2020-10-12 17:23:15.057491 (MainThread): Partial parsing not enabled
2020-10-12 17:23:15.060217 (MainThread): Parsing macros/core.sql
2020-10-12 17:23:15.074145 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 17:23:15.099784 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 17:23:15.122188 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 17:23:15.153461 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 17:23:15.161959 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 17:23:15.173589 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 17:23:15.237834 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 17:23:15.273922 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 17:23:15.277537 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 17:23:15.290598 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 17:23:15.294727 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 17:23:15.347825 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 17:23:15.350432 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 17:23:15.354969 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 17:23:15.356816 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 17:23:15.359035 (MainThread): Parsing macros/etc/query.sql
2020-10-12 17:23:15.361046 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 17:23:15.365097 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 17:23:15.367027 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 17:23:15.386120 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 17:23:15.389791 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 17:23:15.392747 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 17:23:15.394410 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 17:23:15.483762 (MainThread): Parsing macros/relations.sql
2020-10-12 17:23:15.486332 (MainThread): Parsing macros/adapters.sql
2020-10-12 17:23:15.518916 (MainThread): Parsing macros/catalog.sql
2020-10-12 17:23:15.522996 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 17:23:15.550336 (MainThread): Partial parsing not enabled
2020-10-12 17:23:15.594408 (MainThread): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:23:15.594552 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:23:15.619302 (MainThread): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:23:15.619445 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:23:15.627099 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:23:15.627222 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:23:15.635264 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:23:15.635394 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:23:15.881943 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ge_tutorials

2020-10-12 17:23:16.161495 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 17:23:16.167945 (MainThread): 
2020-10-12 17:23:16.168493 (MainThread): Acquiring new postgres connection "master".
2020-10-12 17:23:16.168658 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:23:16.199302 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-12 17:23:16.199465 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-12 17:23:16.322490 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-12 17:23:16.322626 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-12 17:23:16.326253 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-12 17:23:16.347987 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-12 17:23:16.348096 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-12 17:23:16.350014 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 17:23:16.350115 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-12 17:23:16.350400 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:23:16.350514 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 17:23:16.350600 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-12 17:23:16.352456 (ThreadPoolExecutor-1_0): SQL status: SELECT 31 in 0.00 seconds
2020-10-12 17:23:16.381934 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-12 17:23:16.404529 (MainThread): Using postgres connection "master".
2020-10-12 17:23:16.404628 (MainThread): On master: BEGIN
2020-10-12 17:23:16.407466 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:23:16.407579 (MainThread): Using postgres connection "master".
2020-10-12 17:23:16.407660 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-12 17:23:16.412740 (MainThread): SQL status: SELECT 5 in 0.00 seconds
2020-10-12 17:23:16.420634 (MainThread): On master: ROLLBACK
2020-10-12 17:23:16.420911 (MainThread): Using postgres connection "master".
2020-10-12 17:23:16.421012 (MainThread): On master: BEGIN
2020-10-12 17:23:16.421451 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:23:16.421563 (MainThread): On master: COMMIT
2020-10-12 17:23:16.421652 (MainThread): Using postgres connection "master".
2020-10-12 17:23:16.421732 (MainThread): On master: COMMIT
2020-10-12 17:23:16.421982 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:23:16.422302 (MainThread): 17:23:16 | Concurrency: 1 threads (target='dev')
2020-10-12 17:23:16.422436 (MainThread): 17:23:16 | 
2020-10-12 17:23:16.428198 (Thread-1): Began running node model.airflow_dbt.stg_npi
2020-10-12 17:23:16.428364 (Thread-1): 17:23:16 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-12 17:23:16.428677 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:23:16.428766 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-12 17:23:16.428859 (Thread-1): Compiling model.airflow_dbt.stg_npi
2020-10-12 17:23:16.451656 (Thread-1): Writing injected SQL for node "model.airflow_dbt.stg_npi"
2020-10-12 17:23:16.452025 (Thread-1): finished collecting timing info
2020-10-12 17:23:16.501430 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:23:16.501589 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-12 17:23:16.502155 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:23:16.504900 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:23:16.505000 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 17:23:16.505292 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:23:16.506974 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.stg_npi"
2020-10-12 17:23:16.507287 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:23:16.507380 (Thread-1): On model.airflow_dbt.stg_npi: BEGIN
2020-10-12 17:23:16.507635 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:23:16.507745 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:23:16.507832 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-12 17:23:16.509021 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:23:16.513578 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:23:16.513683 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
alter table "airflow"."public"."stg_npi" rename to "stg_npi__dbt_backup"
2020-10-12 17:23:16.514083 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:23:16.517691 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:23:16.517791 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-12 17:23:16.518177 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:23:16.519068 (Thread-1): On model.airflow_dbt.stg_npi: COMMIT
2020-10-12 17:23:16.519165 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:23:16.519248 (Thread-1): On model.airflow_dbt.stg_npi: COMMIT
2020-10-12 17:23:16.522766 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:23:16.525408 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:23:16.525527 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 17:23:16.527945 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:23:16.531334 (Thread-1): finished collecting timing info
2020-10-12 17:23:16.532124 (Thread-1): 17:23:16 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.10s]
2020-10-12 17:23:16.532277 (Thread-1): Finished running node model.airflow_dbt.stg_npi
2020-10-12 17:23:16.532447 (Thread-1): Began running node model.airflow_dbt.stg_state_abbreviations
2020-10-12 17:23:16.532604 (Thread-1): 17:23:16 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-12 17:23:16.533085 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:23:16.533190 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.stg_npi).
2020-10-12 17:23:16.533298 (Thread-1): Compiling model.airflow_dbt.stg_state_abbreviations
2020-10-12 17:23:16.542913 (Thread-1): Writing injected SQL for node "model.airflow_dbt.stg_state_abbreviations"
2020-10-12 17:23:16.543159 (Thread-1): finished collecting timing info
2020-10-12 17:23:16.554150 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:23:16.554319 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-12 17:23:16.554701 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:23:16.557822 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:23:16.557936 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 17:23:16.558250 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:23:16.560475 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.stg_state_abbreviations"
2020-10-12 17:23:16.560775 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:23:16.560883 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: BEGIN
2020-10-12 17:23:16.561194 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:23:16.561344 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:23:16.561476 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-12 17:23:16.562257 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:23:16.568108 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:23:16.568274 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations" rename to "stg_state_abbreviations__dbt_backup"
2020-10-12 17:23:16.568788 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:23:16.572124 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:23:16.572257 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-12 17:23:16.572689 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:23:16.573737 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: COMMIT
2020-10-12 17:23:16.573849 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:23:16.573944 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: COMMIT
2020-10-12 17:23:16.575172 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:23:16.577599 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:23:16.577743 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 17:23:16.579105 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:23:16.587268 (Thread-1): finished collecting timing info
2020-10-12 17:23:16.588878 (Thread-1): 17:23:16 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.06s]
2020-10-12 17:23:16.589125 (Thread-1): Finished running node model.airflow_dbt.stg_state_abbreviations
2020-10-12 17:23:16.589834 (Thread-1): Began running node model.airflow_dbt.npi_with_state
2020-10-12 17:23:16.590107 (Thread-1): 17:23:16 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-12 17:23:16.590614 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:23:16.590804 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.stg_state_abbreviations).
2020-10-12 17:23:16.590987 (Thread-1): Compiling model.airflow_dbt.npi_with_state
2020-10-12 17:23:16.608254 (Thread-1): Writing injected SQL for node "model.airflow_dbt.npi_with_state"
2020-10-12 17:23:16.608540 (Thread-1): finished collecting timing info
2020-10-12 17:23:16.618115 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:23:16.618236 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-12 17:23:16.618600 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:23:16.621629 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:23:16.621743 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 17:23:16.622007 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:23:16.624699 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.npi_with_state"
2020-10-12 17:23:16.625111 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:23:16.625254 (Thread-1): On model.airflow_dbt.npi_with_state: BEGIN
2020-10-12 17:23:16.625603 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:23:16.625746 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:23:16.625868 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-12 17:23:16.627221 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:23:16.630659 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:23:16.630835 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-12 17:23:16.631453 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:23:16.632879 (Thread-1): On model.airflow_dbt.npi_with_state: COMMIT
2020-10-12 17:23:16.633049 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:23:16.633149 (Thread-1): On model.airflow_dbt.npi_with_state: COMMIT
2020-10-12 17:23:16.634458 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:23:16.636941 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:23:16.637054 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 17:23:16.637374 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:23:16.640623 (Thread-1): finished collecting timing info
2020-10-12 17:23:16.641408 (Thread-1): 17:23:16 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.05s]
2020-10-12 17:23:16.641563 (Thread-1): Finished running node model.airflow_dbt.npi_with_state
2020-10-12 17:23:16.641984 (Thread-1): Began running node model.airflow_dbt.count_providers_by_state
2020-10-12 17:23:16.642167 (Thread-1): 17:23:16 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-12 17:23:16.642500 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:23:16.642605 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.npi_with_state).
2020-10-12 17:23:16.642713 (Thread-1): Compiling model.airflow_dbt.count_providers_by_state
2020-10-12 17:23:16.653395 (Thread-1): Writing injected SQL for node "model.airflow_dbt.count_providers_by_state"
2020-10-12 17:23:16.653881 (Thread-1): finished collecting timing info
2020-10-12 17:23:16.667157 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:23:16.667362 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-12 17:23:16.667820 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:23:16.671767 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:23:16.671949 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 17:23:16.672423 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:23:16.674948 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.count_providers_by_state"
2020-10-12 17:23:16.675328 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:23:16.675461 (Thread-1): On model.airflow_dbt.count_providers_by_state: BEGIN
2020-10-12 17:23:16.675793 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:23:16.675941 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:23:16.676059 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-12 17:23:16.677482 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:23:16.683409 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:23:16.683626 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-12 17:23:16.684290 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:23:16.685681 (Thread-1): On model.airflow_dbt.count_providers_by_state: COMMIT
2020-10-12 17:23:16.685828 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:23:16.685946 (Thread-1): On model.airflow_dbt.count_providers_by_state: COMMIT
2020-10-12 17:23:16.687076 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:23:16.690119 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:23:16.690271 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 17:23:16.690653 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:23:16.694774 (Thread-1): finished collecting timing info
2020-10-12 17:23:16.695954 (Thread-1): 17:23:16 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.05s]
2020-10-12 17:23:16.696163 (Thread-1): Finished running node model.airflow_dbt.count_providers_by_state
2020-10-12 17:23:16.732078 (MainThread): Using postgres connection "master".
2020-10-12 17:23:16.732366 (MainThread): On master: BEGIN
2020-10-12 17:23:16.732824 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:23:16.733053 (MainThread): On master: COMMIT
2020-10-12 17:23:16.733242 (MainThread): Using postgres connection "master".
2020-10-12 17:23:16.733423 (MainThread): On master: COMMIT
2020-10-12 17:23:16.733773 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:23:16.734384 (MainThread): 17:23:16 | 
2020-10-12 17:23:16.734643 (MainThread): 17:23:16 | Finished running 4 view models in 0.57s.
2020-10-12 17:23:16.734885 (MainThread): Connection 'master' was left open.
2020-10-12 17:23:16.735063 (MainThread): On master: Close
2020-10-12 17:23:16.735318 (MainThread): Connection 'model.airflow_dbt.count_providers_by_state' was left open.
2020-10-12 17:23:16.735494 (MainThread): On model.airflow_dbt.count_providers_by_state: Close
2020-10-12 17:23:16.764079 (MainThread): 
2020-10-12 17:23:16.764415 (MainThread): Completed successfully
2020-10-12 17:23:16.764669 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-12 17:23:16.765016 (MainThread): Flushing usage events
2020-10-12 17:54:11.332505 (MainThread): Got an exception trying to initialize tracking
2020-10-12 17:54:11.332677 (MainThread): Running with dbt=0.16.0
2020-10-12 17:54:11.419109 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 17:54:11.419414 (MainThread): Tracking: do not track
2020-10-12 17:54:11.451894 (MainThread): Partial parsing not enabled
2020-10-12 17:54:11.453844 (MainThread): Parsing macros/core.sql
2020-10-12 17:54:11.461431 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 17:54:11.475293 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 17:54:11.486597 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 17:54:11.509237 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 17:54:11.516999 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 17:54:11.528388 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 17:54:11.588579 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 17:54:11.615034 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 17:54:11.617581 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 17:54:11.627104 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 17:54:11.629868 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 17:54:11.665306 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 17:54:11.666932 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 17:54:11.669892 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 17:54:11.671096 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 17:54:11.672599 (MainThread): Parsing macros/etc/query.sql
2020-10-12 17:54:11.674021 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 17:54:11.676933 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 17:54:11.678366 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 17:54:11.693239 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 17:54:11.696178 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 17:54:11.698535 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 17:54:11.699847 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 17:54:11.779889 (MainThread): Parsing macros/relations.sql
2020-10-12 17:54:11.782475 (MainThread): Parsing macros/adapters.sql
2020-10-12 17:54:11.813162 (MainThread): Parsing macros/catalog.sql
2020-10-12 17:54:11.816833 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 17:54:11.841149 (MainThread): Partial parsing not enabled
2020-10-12 17:54:11.879356 (MainThread): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:54:11.879462 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:54:11.901490 (MainThread): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:54:11.901622 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:54:11.908840 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:54:11.908938 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:54:11.916090 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:54:11.916184 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:54:12.090246 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airflow_dbt.ge_tutorials

2020-10-12 17:54:12.396884 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-12 17:54:12.401772 (MainThread): 
2020-10-12 17:54:12.402248 (MainThread): Acquiring new postgres connection "master".
2020-10-12 17:54:12.402379 (MainThread): Opening a new connection, currently in state init
2020-10-12 17:54:12.433797 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-12 17:54:12.434110 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-12 17:54:12.583990 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-12 17:54:12.584146 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-12 17:54:12.588085 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-12 17:54:12.612738 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-12 17:54:12.612887 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-12 17:54:12.615112 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 17:54:12.615240 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-12 17:54:12.615613 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:54:12.615750 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-12 17:54:12.615847 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-12 17:54:12.617966 (ThreadPoolExecutor-1_0): SQL status: SELECT 31 in 0.00 seconds
2020-10-12 17:54:12.652507 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-12 17:54:12.677989 (MainThread): Using postgres connection "master".
2020-10-12 17:54:12.678117 (MainThread): On master: BEGIN
2020-10-12 17:54:12.681015 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:54:12.681137 (MainThread): Using postgres connection "master".
2020-10-12 17:54:12.681222 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-12 17:54:12.686633 (MainThread): SQL status: SELECT 5 in 0.01 seconds
2020-10-12 17:54:12.695117 (MainThread): On master: ROLLBACK
2020-10-12 17:54:12.695441 (MainThread): Using postgres connection "master".
2020-10-12 17:54:12.695554 (MainThread): On master: BEGIN
2020-10-12 17:54:12.696045 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:54:12.696167 (MainThread): On master: COMMIT
2020-10-12 17:54:12.696262 (MainThread): Using postgres connection "master".
2020-10-12 17:54:12.696357 (MainThread): On master: COMMIT
2020-10-12 17:54:12.696623 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:54:12.696945 (MainThread): 17:54:12 | Concurrency: 1 threads (target='dev')
2020-10-12 17:54:12.697085 (MainThread): 17:54:12 | 
2020-10-12 17:54:12.703232 (Thread-1): Began running node model.airflow_dbt.stg_npi
2020-10-12 17:54:12.703413 (Thread-1): 17:54:12 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-12 17:54:12.703751 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:54:12.703844 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-12 17:54:12.703944 (Thread-1): Compiling model.airflow_dbt.stg_npi
2020-10-12 17:54:12.727328 (Thread-1): Writing injected SQL for node "model.airflow_dbt.stg_npi"
2020-10-12 17:54:12.727682 (Thread-1): finished collecting timing info
2020-10-12 17:54:12.780174 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:54:12.780364 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-12 17:54:12.780904 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:54:12.784201 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:54:12.784334 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 17:54:12.784651 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:54:12.786504 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.stg_npi"
2020-10-12 17:54:12.786824 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:54:12.786930 (Thread-1): On model.airflow_dbt.stg_npi: BEGIN
2020-10-12 17:54:12.787165 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:54:12.787282 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:54:12.787372 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-12 17:54:12.788574 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:54:12.793737 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:54:12.793869 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
alter table "airflow"."public"."stg_npi" rename to "stg_npi__dbt_backup"
2020-10-12 17:54:12.794291 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:54:12.798402 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:54:12.798520 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-12 17:54:12.798908 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:54:12.799909 (Thread-1): On model.airflow_dbt.stg_npi: COMMIT
2020-10-12 17:54:12.800017 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:54:12.800108 (Thread-1): On model.airflow_dbt.stg_npi: COMMIT
2020-10-12 17:54:12.801339 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:54:12.803765 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-12 17:54:12.803887 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-12 17:54:12.805705 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:54:12.808922 (Thread-1): finished collecting timing info
2020-10-12 17:54:12.809756 (Thread-1): 17:54:12 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.11s]
2020-10-12 17:54:12.809915 (Thread-1): Finished running node model.airflow_dbt.stg_npi
2020-10-12 17:54:12.810074 (Thread-1): Began running node model.airflow_dbt.stg_state_abbreviations
2020-10-12 17:54:12.810362 (Thread-1): 17:54:12 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-12 17:54:12.810699 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:54:12.810816 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.stg_npi).
2020-10-12 17:54:12.810915 (Thread-1): Compiling model.airflow_dbt.stg_state_abbreviations
2020-10-12 17:54:12.820481 (Thread-1): Writing injected SQL for node "model.airflow_dbt.stg_state_abbreviations"
2020-10-12 17:54:12.820789 (Thread-1): finished collecting timing info
2020-10-12 17:54:12.832088 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:54:12.832258 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-12 17:54:12.832610 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:54:12.835737 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:54:12.835857 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 17:54:12.836122 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:54:12.838316 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.stg_state_abbreviations"
2020-10-12 17:54:12.838657 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:54:12.838791 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: BEGIN
2020-10-12 17:54:12.839055 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:54:12.839168 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:54:12.839260 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-12 17:54:12.839967 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:54:12.846149 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:54:12.846337 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations" rename to "stg_state_abbreviations__dbt_backup"
2020-10-12 17:54:12.846927 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:54:12.850444 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:54:12.850569 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-12 17:54:12.850958 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:54:12.852054 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: COMMIT
2020-10-12 17:54:12.852171 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:54:12.852270 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: COMMIT
2020-10-12 17:54:12.853182 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:54:12.855656 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-12 17:54:12.855775 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-12 17:54:12.856970 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:54:12.862204 (Thread-1): finished collecting timing info
2020-10-12 17:54:12.863707 (Thread-1): 17:54:12 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.05s]
2020-10-12 17:54:12.864523 (Thread-1): Finished running node model.airflow_dbt.stg_state_abbreviations
2020-10-12 17:54:12.865131 (Thread-1): Began running node model.airflow_dbt.npi_with_state
2020-10-12 17:54:12.865403 (Thread-1): 17:54:12 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-12 17:54:12.866370 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:54:12.866546 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.stg_state_abbreviations).
2020-10-12 17:54:12.866721 (Thread-1): Compiling model.airflow_dbt.npi_with_state
2020-10-12 17:54:12.890163 (Thread-1): Writing injected SQL for node "model.airflow_dbt.npi_with_state"
2020-10-12 17:54:12.890824 (Thread-1): finished collecting timing info
2020-10-12 17:54:12.908239 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:54:12.908572 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-12 17:54:12.909034 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:54:12.914701 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:54:12.914951 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 17:54:12.915393 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:54:12.918989 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.npi_with_state"
2020-10-12 17:54:12.919545 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:54:12.919725 (Thread-1): On model.airflow_dbt.npi_with_state: BEGIN
2020-10-12 17:54:12.920060 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:54:12.920251 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:54:12.920418 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-12 17:54:12.921570 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:54:12.927501 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:54:12.927744 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-12 17:54:12.928324 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:54:12.930264 (Thread-1): On model.airflow_dbt.npi_with_state: COMMIT
2020-10-12 17:54:12.930454 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:54:12.930616 (Thread-1): On model.airflow_dbt.npi_with_state: COMMIT
2020-10-12 17:54:12.931728 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:54:12.936055 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-12 17:54:12.936270 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-12 17:54:12.936748 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:54:12.942453 (Thread-1): finished collecting timing info
2020-10-12 17:54:12.943913 (Thread-1): 17:54:12 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.08s]
2020-10-12 17:54:12.944699 (Thread-1): Finished running node model.airflow_dbt.npi_with_state
2020-10-12 17:54:12.945244 (Thread-1): Began running node model.airflow_dbt.count_providers_by_state
2020-10-12 17:54:12.945507 (Thread-1): 17:54:12 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-12 17:54:12.946447 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:54:12.946622 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.npi_with_state).
2020-10-12 17:54:12.946803 (Thread-1): Compiling model.airflow_dbt.count_providers_by_state
2020-10-12 17:54:12.963388 (Thread-1): Writing injected SQL for node "model.airflow_dbt.count_providers_by_state"
2020-10-12 17:54:12.963961 (Thread-1): finished collecting timing info
2020-10-12 17:54:12.983798 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:54:12.984079 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-12 17:54:12.984654 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:54:12.990612 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:54:12.990938 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 17:54:12.991447 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:54:12.994381 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.count_providers_by_state"
2020-10-12 17:54:12.994722 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:54:12.994849 (Thread-1): On model.airflow_dbt.count_providers_by_state: BEGIN
2020-10-12 17:54:12.995142 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:54:12.995264 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:54:12.995361 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-12 17:54:12.996504 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-12 17:54:13.001290 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:54:13.001429 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-12 17:54:13.001914 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-12 17:54:13.003000 (Thread-1): On model.airflow_dbt.count_providers_by_state: COMMIT
2020-10-12 17:54:13.003117 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:54:13.003214 (Thread-1): On model.airflow_dbt.count_providers_by_state: COMMIT
2020-10-12 17:54:13.004319 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:54:13.006898 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-12 17:54:13.007039 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-12 17:54:13.007372 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-12 17:54:13.010634 (Thread-1): finished collecting timing info
2020-10-12 17:54:13.011514 (Thread-1): 17:54:13 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.07s]
2020-10-12 17:54:13.011757 (Thread-1): Finished running node model.airflow_dbt.count_providers_by_state
2020-10-12 17:54:13.112449 (MainThread): Using postgres connection "master".
2020-10-12 17:54:13.112619 (MainThread): On master: BEGIN
2020-10-12 17:54:13.112957 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-12 17:54:13.113082 (MainThread): On master: COMMIT
2020-10-12 17:54:13.113176 (MainThread): Using postgres connection "master".
2020-10-12 17:54:13.113263 (MainThread): On master: COMMIT
2020-10-12 17:54:13.113521 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-12 17:54:13.113847 (MainThread): 17:54:13 | 
2020-10-12 17:54:13.113985 (MainThread): 17:54:13 | Finished running 4 view models in 0.71s.
2020-10-12 17:54:13.114129 (MainThread): Connection 'master' was left open.
2020-10-12 17:54:13.114233 (MainThread): On master: Close
2020-10-12 17:54:13.114373 (MainThread): Connection 'model.airflow_dbt.count_providers_by_state' was left open.
2020-10-12 17:54:13.114463 (MainThread): On model.airflow_dbt.count_providers_by_state: Close
2020-10-12 17:54:13.130694 (MainThread): 
2020-10-12 17:54:13.130912 (MainThread): Completed successfully
2020-10-12 17:54:13.131081 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-12 17:54:13.131306 (MainThread): Flushing usage events
2020-10-12 18:00:43.001552 (MainThread): Got an exception trying to initialize tracking
2020-10-12 18:00:43.001699 (MainThread): Running with dbt=0.16.0
2020-10-12 18:00:43.087575 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir='.', record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-12 18:00:43.087934 (MainThread): Tracking: do not track
2020-10-12 18:00:43.131313 (MainThread): Partial parsing not enabled
2020-10-12 18:00:43.134921 (MainThread): Parsing macros/core.sql
2020-10-12 18:00:43.148878 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-12 18:00:43.176345 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-12 18:00:43.200719 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-12 18:00:43.248602 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-12 18:00:43.264655 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-12 18:00:43.279363 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-12 18:00:43.349286 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-12 18:00:43.377482 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-12 18:00:43.380129 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-12 18:00:43.389875 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-12 18:00:43.392719 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-12 18:00:43.429304 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-12 18:00:43.431069 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-12 18:00:43.434174 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-12 18:00:43.435437 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-12 18:00:43.437013 (MainThread): Parsing macros/etc/query.sql
2020-10-12 18:00:43.438513 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-12 18:00:43.441589 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-12 18:00:43.443103 (MainThread): Parsing macros/etc/datetime.sql
2020-10-12 18:00:43.459937 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-12 18:00:43.463395 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-12 18:00:43.466198 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-12 18:00:43.467791 (MainThread): Parsing macros/adapters/common.sql
2020-10-12 18:00:43.554353 (MainThread): Parsing macros/relations.sql
2020-10-12 18:00:43.556784 (MainThread): Parsing macros/adapters.sql
2020-10-12 18:00:43.586562 (MainThread): Parsing macros/catalog.sql
2020-10-12 18:00:43.590200 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-12 18:00:43.613374 (MainThread): Partial parsing not enabled
2020-10-12 18:00:43.755140 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airflow_dbt.ge_tutorials

2020-10-12 18:00:43.991857 (MainThread): Found 0 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2020-10-12 18:00:43.992395 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-10-12 18:00:43.992659 (MainThread): Flushing usage events
2020-10-13 01:45:25.925489 (MainThread): Got an exception trying to initialize tracking
2020-10-13 01:45:25.925636 (MainThread): Running with dbt=0.16.0
2020-10-13 01:45:26.019816 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['models/ge_tutorials/*'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-13 01:45:26.020243 (MainThread): Tracking: do not track
2020-10-13 01:45:26.057085 (MainThread): Partial parsing not enabled
2020-10-13 01:45:26.060317 (MainThread): Parsing macros/core.sql
2020-10-13 01:45:26.067993 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 01:45:26.082535 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 01:45:26.094272 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 01:45:26.117226 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 01:45:26.125000 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 01:45:26.135321 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 01:45:26.195821 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 01:45:26.223805 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 01:45:26.226541 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 01:45:26.237384 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 01:45:26.241197 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 01:45:26.286065 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 01:45:26.288313 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 01:45:26.292185 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 01:45:26.293860 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 01:45:26.295864 (MainThread): Parsing macros/etc/query.sql
2020-10-13 01:45:26.297764 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 01:45:26.301555 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 01:45:26.303515 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 01:45:26.322346 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 01:45:26.326204 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 01:45:26.329358 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 01:45:26.331183 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 01:45:26.426141 (MainThread): Parsing macros/relations.sql
2020-10-13 01:45:26.429347 (MainThread): Parsing macros/adapters.sql
2020-10-13 01:45:26.469225 (MainThread): Parsing macros/catalog.sql
2020-10-13 01:45:26.474206 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 01:45:26.507578 (MainThread): Partial parsing not enabled
2020-10-13 01:45:26.679563 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airflow_dbt.ge_tutorials

2020-10-13 01:45:26.936768 (MainThread): Found 0 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 0 sources
2020-10-13 01:45:26.937218 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-10-13 01:45:26.937460 (MainThread): Flushing usage events
2020-10-13 01:46:16.152068 (MainThread): Got an exception trying to initialize tracking
2020-10-13 01:46:16.152214 (MainThread): Running with dbt=0.16.0
2020-10-13 01:46:16.236751 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['models/ge_tutorials/*'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-13 01:46:16.237083 (MainThread): Tracking: do not track
2020-10-13 01:46:16.270718 (MainThread): Partial parsing not enabled
2020-10-13 01:46:16.272636 (MainThread): Parsing macros/core.sql
2020-10-13 01:46:16.280155 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 01:46:16.293839 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 01:46:16.304917 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 01:46:16.327276 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 01:46:16.334937 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 01:46:16.345167 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 01:46:16.403261 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 01:46:16.429593 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 01:46:16.432154 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 01:46:16.441670 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 01:46:16.444440 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 01:46:16.479823 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 01:46:16.481426 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 01:46:16.484375 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 01:46:16.485566 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 01:46:16.487065 (MainThread): Parsing macros/etc/query.sql
2020-10-13 01:46:16.488478 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 01:46:16.491375 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 01:46:16.492805 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 01:46:16.507649 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 01:46:16.510562 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 01:46:16.512927 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 01:46:16.514232 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 01:46:16.591395 (MainThread): Parsing macros/relations.sql
2020-10-13 01:46:16.593707 (MainThread): Parsing macros/adapters.sql
2020-10-13 01:46:16.623466 (MainThread): Parsing macros/catalog.sql
2020-10-13 01:46:16.627123 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 01:46:16.650603 (MainThread): Partial parsing not enabled
2020-10-13 01:46:16.698950 (MainThread): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:46:16.699097 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:46:16.724689 (MainThread): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:46:16.724798 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:46:16.732058 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:46:16.732151 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:46:16.739330 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:46:16.739421 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:46:17.223034 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 01:46:17.227409 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-10-13 01:46:17.227674 (MainThread): Flushing usage events
2020-10-13 01:46:17.227844 (MainThread): Connection 'model.airflow_dbt.stg_npi' was properly closed.
2020-10-13 01:46:27.925550 (MainThread): Got an exception trying to initialize tracking
2020-10-13 01:46:27.925812 (MainThread): Running with dbt=0.16.0
2020-10-13 01:46:28.059140 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['ge_tutorials/*'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-13 01:46:28.059449 (MainThread): Tracking: do not track
2020-10-13 01:46:28.092994 (MainThread): Partial parsing not enabled
2020-10-13 01:46:28.094941 (MainThread): Parsing macros/core.sql
2020-10-13 01:46:28.102530 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 01:46:28.116766 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 01:46:28.129888 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 01:46:28.154523 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 01:46:28.162901 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 01:46:28.174926 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 01:46:28.244581 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 01:46:28.273036 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 01:46:28.275750 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 01:46:28.286092 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 01:46:28.289167 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 01:46:28.328968 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 01:46:28.330738 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 01:46:28.333965 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 01:46:28.335287 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 01:46:28.336925 (MainThread): Parsing macros/etc/query.sql
2020-10-13 01:46:28.338496 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 01:46:28.341668 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 01:46:28.343242 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 01:46:28.359725 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 01:46:28.362930 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 01:46:28.365505 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 01:46:28.366940 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 01:46:28.451891 (MainThread): Parsing macros/relations.sql
2020-10-13 01:46:28.454462 (MainThread): Parsing macros/adapters.sql
2020-10-13 01:46:28.487343 (MainThread): Parsing macros/catalog.sql
2020-10-13 01:46:28.491332 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 01:46:28.516569 (MainThread): Partial parsing not enabled
2020-10-13 01:46:28.558232 (MainThread): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:46:28.558368 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:46:28.582305 (MainThread): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:46:28.582437 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:46:28.589412 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:46:28.589503 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:46:28.596652 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:46:28.596747 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:46:29.023065 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 01:46:29.027235 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-10-13 01:46:29.027501 (MainThread): Flushing usage events
2020-10-13 01:46:29.027688 (MainThread): Connection 'model.airflow_dbt.stg_npi' was properly closed.
2020-10-13 01:47:02.481972 (MainThread): Got an exception trying to initialize tracking
2020-10-13 01:47:02.482117 (MainThread): Running with dbt=0.16.0
2020-10-13 01:47:02.561838 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['airflow_dbt.models.*'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-13 01:47:02.562145 (MainThread): Tracking: do not track
2020-10-13 01:47:02.594934 (MainThread): Partial parsing not enabled
2020-10-13 01:47:02.596844 (MainThread): Parsing macros/core.sql
2020-10-13 01:47:02.604386 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 01:47:02.618326 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 01:47:02.629739 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 01:47:02.652123 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 01:47:02.659770 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 01:47:02.669984 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 01:47:02.727980 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 01:47:02.754316 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 01:47:02.756881 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 01:47:02.766371 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 01:47:02.769128 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 01:47:02.804414 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 01:47:02.806026 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 01:47:02.808981 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 01:47:02.810174 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 01:47:02.811676 (MainThread): Parsing macros/etc/query.sql
2020-10-13 01:47:02.813091 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 01:47:02.815990 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 01:47:02.817414 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 01:47:02.832231 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 01:47:02.835162 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 01:47:02.837515 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 01:47:02.838821 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 01:47:02.915548 (MainThread): Parsing macros/relations.sql
2020-10-13 01:47:02.917859 (MainThread): Parsing macros/adapters.sql
2020-10-13 01:47:02.947500 (MainThread): Parsing macros/catalog.sql
2020-10-13 01:47:02.951160 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 01:47:02.974378 (MainThread): Partial parsing not enabled
2020-10-13 01:47:03.012495 (MainThread): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:47:03.012600 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:47:03.035155 (MainThread): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:47:03.035280 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:47:03.042081 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:47:03.042172 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:47:03.048845 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:47:03.048941 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:47:03.208774 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airflow_dbt.ge_tutorials

2020-10-13 01:47:03.506960 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 01:47:03.511490 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-10-13 01:47:03.511760 (MainThread): Flushing usage events
2020-10-13 01:47:03.511939 (MainThread): Connection 'model.airflow_dbt.stg_npi' was properly closed.
2020-10-13 01:47:24.665536 (MainThread): Got an exception trying to initialize tracking
2020-10-13 01:47:24.665678 (MainThread): Running with dbt=0.16.0
2020-10-13 01:47:24.747611 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-13 01:47:24.747947 (MainThread): Tracking: do not track
2020-10-13 01:47:24.786149 (MainThread): Partial parsing not enabled
2020-10-13 01:47:24.788340 (MainThread): Parsing macros/core.sql
2020-10-13 01:47:24.796973 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 01:47:24.812643 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 01:47:24.825190 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 01:47:24.849734 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 01:47:24.857430 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 01:47:24.868405 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 01:47:24.932512 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 01:47:24.961399 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 01:47:24.964190 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 01:47:24.974558 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 01:47:24.977575 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 01:47:25.016573 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 01:47:25.018338 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 01:47:25.021567 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 01:47:25.022880 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 01:47:25.024501 (MainThread): Parsing macros/etc/query.sql
2020-10-13 01:47:25.026011 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 01:47:25.029082 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 01:47:25.030613 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 01:47:25.046931 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 01:47:25.050171 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 01:47:25.052772 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 01:47:25.054221 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 01:47:25.139118 (MainThread): Parsing macros/relations.sql
2020-10-13 01:47:25.141620 (MainThread): Parsing macros/adapters.sql
2020-10-13 01:47:25.175367 (MainThread): Parsing macros/catalog.sql
2020-10-13 01:47:25.179804 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 01:47:25.205979 (MainThread): Partial parsing not enabled
2020-10-13 01:47:25.246726 (MainThread): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:47:25.246859 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:47:25.270202 (MainThread): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:47:25.270302 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:47:25.277268 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:47:25.277362 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:47:25.284396 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:47:25.284490 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:47:25.463244 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airflow_dbt.ge_tutorials

2020-10-13 01:47:25.767853 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 01:47:25.772383 (MainThread): 
2020-10-13 01:47:25.772807 (MainThread): Acquiring new postgres connection "master".
2020-10-13 01:47:25.772925 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:47:25.797783 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-13 01:47:25.797953 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-13 01:47:25.932320 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-13 01:47:25.932465 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-13 01:47:25.936261 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-13 01:47:25.961524 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-13 01:47:25.961671 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-13 01:47:25.963699 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-13 01:47:25.963810 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-13 01:47:25.964171 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-13 01:47:25.964286 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-13 01:47:25.964375 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-13 01:47:25.967995 (ThreadPoolExecutor-1_0): SQL status: SELECT 31 in 0.00 seconds
2020-10-13 01:47:26.000648 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-13 01:47:26.025703 (MainThread): Using postgres connection "master".
2020-10-13 01:47:26.025829 (MainThread): On master: BEGIN
2020-10-13 01:47:26.028841 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 01:47:26.028969 (MainThread): Using postgres connection "master".
2020-10-13 01:47:26.029057 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-13 01:47:26.034138 (MainThread): SQL status: SELECT 5 in 0.00 seconds
2020-10-13 01:47:26.042180 (MainThread): On master: ROLLBACK
2020-10-13 01:47:26.042459 (MainThread): Using postgres connection "master".
2020-10-13 01:47:26.042560 (MainThread): On master: BEGIN
2020-10-13 01:47:26.042972 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 01:47:26.043088 (MainThread): On master: COMMIT
2020-10-13 01:47:26.043177 (MainThread): Using postgres connection "master".
2020-10-13 01:47:26.043256 (MainThread): On master: COMMIT
2020-10-13 01:47:26.043521 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-13 01:47:26.043821 (MainThread): 01:47:26 | Concurrency: 1 threads (target='dev')
2020-10-13 01:47:26.043956 (MainThread): 01:47:26 | 
2020-10-13 01:47:26.049892 (Thread-1): Began running node model.airflow_dbt.stg_npi
2020-10-13 01:47:26.050066 (Thread-1): 01:47:26 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-13 01:47:26.050378 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:47:26.050466 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-13 01:47:26.050561 (Thread-1): Compiling model.airflow_dbt.stg_npi
2020-10-13 01:47:26.073526 (Thread-1): Writing injected SQL for node "model.airflow_dbt.stg_npi"
2020-10-13 01:47:26.074355 (Thread-1): finished collecting timing info
2020-10-13 01:47:26.125120 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:47:26.125287 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-13 01:47:26.125875 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 01:47:26.128889 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:47:26.129020 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-13 01:47:26.129390 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 01:47:26.131197 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.stg_npi"
2020-10-13 01:47:26.131810 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:47:26.131917 (Thread-1): On model.airflow_dbt.stg_npi: BEGIN
2020-10-13 01:47:26.132189 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 01:47:26.132290 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:47:26.132375 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-13 01:47:26.133613 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 01:47:26.138570 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:47:26.138695 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
alter table "airflow"."public"."stg_npi" rename to "stg_npi__dbt_backup"
2020-10-13 01:47:26.139138 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 01:47:26.143029 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:47:26.143164 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-13 01:47:26.143638 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 01:47:26.144705 (Thread-1): On model.airflow_dbt.stg_npi: COMMIT
2020-10-13 01:47:26.144815 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:47:26.144906 (Thread-1): On model.airflow_dbt.stg_npi: COMMIT
2020-10-13 01:47:26.146067 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 01:47:26.148480 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:47:26.148597 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-13 01:47:26.150430 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 01:47:26.153616 (Thread-1): finished collecting timing info
2020-10-13 01:47:26.154459 (Thread-1): 01:47:26 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.10s]
2020-10-13 01:47:26.154621 (Thread-1): Finished running node model.airflow_dbt.stg_npi
2020-10-13 01:47:26.154804 (Thread-1): Began running node model.airflow_dbt.stg_state_abbreviations
2020-10-13 01:47:26.155140 (Thread-1): 01:47:26 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-13 01:47:26.155485 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:47:26.155592 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.stg_npi).
2020-10-13 01:47:26.155698 (Thread-1): Compiling model.airflow_dbt.stg_state_abbreviations
2020-10-13 01:47:26.166465 (Thread-1): Writing injected SQL for node "model.airflow_dbt.stg_state_abbreviations"
2020-10-13 01:47:26.166838 (Thread-1): finished collecting timing info
2020-10-13 01:47:26.182153 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:47:26.182406 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-13 01:47:26.182929 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 01:47:26.187025 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:47:26.187230 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-13 01:47:26.187864 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 01:47:26.190657 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.stg_state_abbreviations"
2020-10-13 01:47:26.191135 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:47:26.191321 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: BEGIN
2020-10-13 01:47:26.191703 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 01:47:26.191885 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:47:26.192036 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-13 01:47:26.192978 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 01:47:26.199808 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:47:26.199993 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations" rename to "stg_state_abbreviations__dbt_backup"
2020-10-13 01:47:26.200555 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 01:47:26.204597 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:47:26.204755 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-13 01:47:26.205244 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 01:47:26.206603 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: COMMIT
2020-10-13 01:47:26.206769 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:47:26.206901 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: COMMIT
2020-10-13 01:47:26.208026 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 01:47:26.211178 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:47:26.211320 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-13 01:47:26.212672 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 01:47:26.216696 (Thread-1): finished collecting timing info
2020-10-13 01:47:26.217680 (Thread-1): 01:47:26 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.06s]
2020-10-13 01:47:26.217872 (Thread-1): Finished running node model.airflow_dbt.stg_state_abbreviations
2020-10-13 01:47:26.218399 (Thread-1): Began running node model.airflow_dbt.npi_with_state
2020-10-13 01:47:26.218597 (Thread-1): 01:47:26 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-13 01:47:26.219023 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:47:26.219154 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.stg_state_abbreviations).
2020-10-13 01:47:26.219279 (Thread-1): Compiling model.airflow_dbt.npi_with_state
2020-10-13 01:47:26.235586 (Thread-1): Writing injected SQL for node "model.airflow_dbt.npi_with_state"
2020-10-13 01:47:26.235950 (Thread-1): finished collecting timing info
2020-10-13 01:47:26.248370 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:47:26.248550 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-13 01:47:26.248971 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 01:47:26.252932 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:47:26.253118 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-13 01:47:26.253538 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 01:47:26.255860 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.npi_with_state"
2020-10-13 01:47:26.256172 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:47:26.256292 (Thread-1): On model.airflow_dbt.npi_with_state: BEGIN
2020-10-13 01:47:26.256571 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 01:47:26.256707 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:47:26.256818 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-13 01:47:26.258056 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 01:47:26.261946 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:47:26.262118 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-13 01:47:26.262677 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 01:47:26.263880 (Thread-1): On model.airflow_dbt.npi_with_state: COMMIT
2020-10-13 01:47:26.264005 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:47:26.264112 (Thread-1): On model.airflow_dbt.npi_with_state: COMMIT
2020-10-13 01:47:26.265223 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 01:47:26.267816 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:47:26.267941 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-13 01:47:26.268295 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 01:47:26.271696 (Thread-1): finished collecting timing info
2020-10-13 01:47:26.272588 (Thread-1): 01:47:26 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.05s]
2020-10-13 01:47:26.272763 (Thread-1): Finished running node model.airflow_dbt.npi_with_state
2020-10-13 01:47:26.273245 (Thread-1): Began running node model.airflow_dbt.count_providers_by_state
2020-10-13 01:47:26.273439 (Thread-1): 01:47:26 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-13 01:47:26.273776 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:47:26.273881 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.npi_with_state).
2020-10-13 01:47:26.273983 (Thread-1): Compiling model.airflow_dbt.count_providers_by_state
2020-10-13 01:47:26.285035 (Thread-1): Writing injected SQL for node "model.airflow_dbt.count_providers_by_state"
2020-10-13 01:47:26.285535 (Thread-1): finished collecting timing info
2020-10-13 01:47:26.300264 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:47:26.300541 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-13 01:47:26.301118 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 01:47:26.306750 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:47:26.306950 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-13 01:47:26.307374 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 01:47:26.310893 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.count_providers_by_state"
2020-10-13 01:47:26.311358 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:47:26.311537 (Thread-1): On model.airflow_dbt.count_providers_by_state: BEGIN
2020-10-13 01:47:26.311831 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 01:47:26.312012 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:47:26.312170 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-13 01:47:26.314141 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 01:47:26.322093 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:47:26.322312 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-13 01:47:26.323021 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 01:47:26.324901 (Thread-1): On model.airflow_dbt.count_providers_by_state: COMMIT
2020-10-13 01:47:26.325086 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:47:26.325254 (Thread-1): On model.airflow_dbt.count_providers_by_state: COMMIT
2020-10-13 01:47:26.326431 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 01:47:26.330632 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:47:26.330820 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "ge_tutorials", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-13 01:47:26.331233 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 01:47:26.336660 (Thread-1): finished collecting timing info
2020-10-13 01:47:26.337997 (Thread-1): 01:47:26 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.06s]
2020-10-13 01:47:26.338427 (Thread-1): Finished running node model.airflow_dbt.count_providers_by_state
2020-10-13 01:47:26.356980 (MainThread): Using postgres connection "master".
2020-10-13 01:47:26.357282 (MainThread): On master: BEGIN
2020-10-13 01:47:26.357787 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 01:47:26.357990 (MainThread): On master: COMMIT
2020-10-13 01:47:26.358152 (MainThread): Using postgres connection "master".
2020-10-13 01:47:26.358330 (MainThread): On master: COMMIT
2020-10-13 01:47:26.358643 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-13 01:47:26.359300 (MainThread): 01:47:26 | 
2020-10-13 01:47:26.359553 (MainThread): 01:47:26 | Finished running 4 view models in 0.59s.
2020-10-13 01:47:26.359777 (MainThread): Connection 'master' was left open.
2020-10-13 01:47:26.359966 (MainThread): On master: Close
2020-10-13 01:47:26.360222 (MainThread): Connection 'model.airflow_dbt.count_providers_by_state' was left open.
2020-10-13 01:47:26.360386 (MainThread): On model.airflow_dbt.count_providers_by_state: Close
2020-10-13 01:47:26.408441 (MainThread): 
2020-10-13 01:47:26.409421 (MainThread): Completed successfully
2020-10-13 01:47:26.409662 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-13 01:47:26.410046 (MainThread): Flushing usage events
2020-10-13 01:49:17.186995 (MainThread): Got an exception trying to initialize tracking
2020-10-13 01:49:17.187200 (MainThread): Running with dbt=0.16.0
2020-10-13 01:49:17.273384 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['ge_tutorials'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-13 01:49:17.273714 (MainThread): Tracking: do not track
2020-10-13 01:49:17.309305 (MainThread): Partial parsing not enabled
2020-10-13 01:49:17.311782 (MainThread): Parsing macros/core.sql
2020-10-13 01:49:17.322054 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 01:49:17.341729 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 01:49:17.358232 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 01:49:17.389059 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 01:49:17.398763 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 01:49:17.411486 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 01:49:17.504132 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 01:49:17.560706 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 01:49:17.563574 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 01:49:17.573915 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 01:49:17.576904 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 01:49:17.616377 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 01:49:17.618255 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 01:49:17.621618 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 01:49:17.622954 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 01:49:17.624614 (MainThread): Parsing macros/etc/query.sql
2020-10-13 01:49:17.626193 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 01:49:17.629424 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 01:49:17.631016 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 01:49:17.647941 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 01:49:17.651218 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 01:49:17.653852 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 01:49:17.655463 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 01:49:17.746631 (MainThread): Parsing macros/relations.sql
2020-10-13 01:49:17.749356 (MainThread): Parsing macros/adapters.sql
2020-10-13 01:49:17.780975 (MainThread): Parsing macros/catalog.sql
2020-10-13 01:49:17.784908 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 01:49:17.810375 (MainThread): Partial parsing not enabled
2020-10-13 01:49:17.851932 (MainThread): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:49:17.852060 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:49:17.876732 (MainThread): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:49:17.876866 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:49:17.883926 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:49:17.884017 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:49:17.891019 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:49:17.891110 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:49:18.045894 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airflow_dbt.ge_tutorials

2020-10-13 01:49:18.307834 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 01:49:18.312298 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-10-13 01:49:18.312538 (MainThread): Flushing usage events
2020-10-13 01:49:18.312713 (MainThread): Connection 'model.airflow_dbt.stg_npi' was properly closed.
2020-10-13 01:49:41.264256 (MainThread): Got an exception trying to initialize tracking
2020-10-13 01:49:41.264407 (MainThread): Running with dbt=0.16.0
2020-10-13 01:49:41.350721 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['airflow_dbt/ge_tutorials'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-13 01:49:41.351082 (MainThread): Tracking: do not track
2020-10-13 01:49:41.386698 (MainThread): Partial parsing not enabled
2020-10-13 01:49:41.388767 (MainThread): Parsing macros/core.sql
2020-10-13 01:49:41.396998 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 01:49:41.412536 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 01:49:41.425486 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 01:49:41.451206 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 01:49:41.459701 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 01:49:41.470864 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 01:49:41.532104 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 01:49:41.560859 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 01:49:41.563781 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 01:49:41.574524 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 01:49:41.578031 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 01:49:41.630168 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 01:49:41.632772 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 01:49:41.637227 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 01:49:41.638968 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 01:49:41.641129 (MainThread): Parsing macros/etc/query.sql
2020-10-13 01:49:41.643223 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 01:49:41.647608 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 01:49:41.649749 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 01:49:41.670726 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 01:49:41.674774 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 01:49:41.678007 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 01:49:41.679964 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 01:49:41.825637 (MainThread): Parsing macros/relations.sql
2020-10-13 01:49:41.830280 (MainThread): Parsing macros/adapters.sql
2020-10-13 01:49:41.863889 (MainThread): Parsing macros/catalog.sql
2020-10-13 01:49:41.868066 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 01:49:41.896317 (MainThread): Partial parsing not enabled
2020-10-13 01:49:41.939153 (MainThread): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:49:41.939316 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:49:41.964668 (MainThread): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:49:41.964919 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:49:41.973521 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:49:41.973668 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:49:41.982062 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:49:41.982197 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:49:42.150552 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airflow_dbt.ge_tutorials

2020-10-13 01:49:42.412818 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 01:49:42.417398 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-10-13 01:49:42.417648 (MainThread): Flushing usage events
2020-10-13 01:49:42.417821 (MainThread): Connection 'model.airflow_dbt.stg_npi' was properly closed.
2020-10-13 01:52:32.848824 (MainThread): Got an exception trying to initialize tracking
2020-10-13 01:52:32.848981 (MainThread): Running with dbt=0.16.0
2020-10-13 01:52:32.928896 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.list.ListTask'>, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, output='selector', partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, resource_types=[], rpc_method=None, select=None, single_threaded=True, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='list', write_json=True)
2020-10-13 01:52:32.929259 (MainThread): Tracking: do not track
2020-10-13 01:52:32.963113 (MainThread): Partial parsing not enabled
2020-10-13 01:52:32.965158 (MainThread): Parsing macros/core.sql
2020-10-13 01:52:32.973253 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 01:52:32.988589 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 01:52:33.001191 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 01:52:33.027363 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 01:52:33.035958 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 01:52:33.047090 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 01:52:33.107305 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 01:52:33.135094 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 01:52:33.137908 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 01:52:33.148088 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 01:52:33.151092 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 01:52:33.191688 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 01:52:33.194077 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 01:52:33.198263 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 01:52:33.200093 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 01:52:33.202220 (MainThread): Parsing macros/etc/query.sql
2020-10-13 01:52:33.204255 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 01:52:33.208489 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 01:52:33.210622 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 01:52:33.233592 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 01:52:33.238186 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 01:52:33.241802 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 01:52:33.243758 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 01:52:33.381221 (MainThread): Parsing macros/relations.sql
2020-10-13 01:52:33.385821 (MainThread): Parsing macros/adapters.sql
2020-10-13 01:52:33.433321 (MainThread): Parsing macros/catalog.sql
2020-10-13 01:52:33.437511 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 01:52:33.461817 (MainThread): Partial parsing not enabled
2020-10-13 01:52:33.505103 (MainThread): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 01:52:33.505231 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:52:33.529300 (MainThread): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 01:52:33.529442 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:52:33.537420 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 01:52:33.537550 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:52:33.545418 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 01:52:33.545536 (MainThread): Opening a new connection, currently in state init
2020-10-13 01:52:33.705857 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airflow_dbt_pg.ge_tutorials

2020-10-13 01:52:33.952743 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 01:52:33.956847 (MainThread): Flushing usage events
2020-10-13 01:52:33.957032 (MainThread): Connection 'model.airflow_dbt.stg_npi' was properly closed.
2020-10-13 02:17:50.193231 (MainThread): Got an exception trying to initialize tracking
2020-10-13 02:17:50.193380 (MainThread): Running with dbt=0.16.0
2020-10-13 02:17:50.278294 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['airflow_dbt.airflow_dbt_pg.ge_tutorials.*'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-13 02:17:50.278639 (MainThread): Tracking: do not track
2020-10-13 02:17:50.311725 (MainThread): Partial parsing not enabled
2020-10-13 02:17:50.313687 (MainThread): Parsing macros/core.sql
2020-10-13 02:17:50.321366 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 02:17:50.335479 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 02:17:50.346743 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 02:17:50.369405 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 02:17:50.377153 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 02:17:50.387315 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 02:17:50.445118 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 02:17:50.471344 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 02:17:50.473899 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 02:17:50.483344 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 02:17:50.486073 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 02:17:50.521175 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 02:17:50.522787 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 02:17:50.525720 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 02:17:50.526913 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 02:17:50.528397 (MainThread): Parsing macros/etc/query.sql
2020-10-13 02:17:50.529803 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 02:17:50.532840 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 02:17:50.534472 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 02:17:50.552956 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 02:17:50.556685 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 02:17:50.559727 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 02:17:50.561429 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 02:17:50.654937 (MainThread): Parsing macros/relations.sql
2020-10-13 02:17:50.657783 (MainThread): Parsing macros/adapters.sql
2020-10-13 02:17:50.693524 (MainThread): Parsing macros/catalog.sql
2020-10-13 02:17:50.698147 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 02:17:50.727504 (MainThread): Partial parsing not enabled
2020-10-13 02:17:50.776338 (MainThread): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 02:17:50.776502 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:17:50.804893 (MainThread): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 02:17:50.805047 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:17:50.814133 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 02:17:50.814298 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:17:50.824268 (MainThread): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 02:17:50.824445 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:17:51.007867 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airflow_dbt_pg.ge_tutorials

2020-10-13 02:17:51.290792 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 02:17:51.295239 (MainThread): 
2020-10-13 02:17:51.295692 (MainThread): Acquiring new postgres connection "master".
2020-10-13 02:17:51.295807 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:17:51.321294 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-13 02:17:51.321462 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-13 02:17:51.504236 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-13 02:17:51.504474 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-13 02:17:51.509961 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2020-10-13 02:17:51.549055 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-13 02:17:51.549376 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-13 02:17:51.552930 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-13 02:17:51.553097 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-13 02:17:51.553557 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:17:51.553741 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-13 02:17:51.553904 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-13 02:17:51.557462 (ThreadPoolExecutor-1_0): SQL status: SELECT 31 in 0.00 seconds
2020-10-13 02:17:51.605110 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-13 02:17:51.631271 (MainThread): Using postgres connection "master".
2020-10-13 02:17:51.631404 (MainThread): On master: BEGIN
2020-10-13 02:17:51.634323 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:17:51.634453 (MainThread): Using postgres connection "master".
2020-10-13 02:17:51.634542 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-13 02:17:51.639841 (MainThread): SQL status: SELECT 5 in 0.01 seconds
2020-10-13 02:17:51.648061 (MainThread): On master: ROLLBACK
2020-10-13 02:17:51.648362 (MainThread): Using postgres connection "master".
2020-10-13 02:17:51.648468 (MainThread): On master: BEGIN
2020-10-13 02:17:51.648926 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:17:51.649042 (MainThread): On master: COMMIT
2020-10-13 02:17:51.649132 (MainThread): Using postgres connection "master".
2020-10-13 02:17:51.649214 (MainThread): On master: COMMIT
2020-10-13 02:17:51.649415 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-13 02:17:51.649703 (MainThread): 02:17:51 | Concurrency: 1 threads (target='dev')
2020-10-13 02:17:51.649833 (MainThread): 02:17:51 | 
2020-10-13 02:17:51.655627 (Thread-1): Began running node model.airflow_dbt.stg_npi
2020-10-13 02:17:51.655805 (Thread-1): 02:17:51 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-13 02:17:51.656115 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 02:17:51.656201 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-13 02:17:51.656296 (Thread-1): Compiling model.airflow_dbt.stg_npi
2020-10-13 02:17:51.679594 (Thread-1): Writing injected SQL for node "model.airflow_dbt.stg_npi"
2020-10-13 02:17:51.679996 (Thread-1): finished collecting timing info
2020-10-13 02:17:51.730898 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 02:17:51.731067 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-13 02:17:51.731637 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:17:51.734754 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 02:17:51.734871 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-13 02:17:51.735175 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:17:51.737006 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.stg_npi"
2020-10-13 02:17:51.737373 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 02:17:51.737473 (Thread-1): On model.airflow_dbt.stg_npi: BEGIN
2020-10-13 02:17:51.737733 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:17:51.737853 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 02:17:51.737946 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-13 02:17:51.739370 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 02:17:51.744572 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 02:17:51.744696 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
alter table "airflow"."public"."stg_npi" rename to "stg_npi__dbt_backup"
2020-10-13 02:17:51.745149 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 02:17:51.749283 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 02:17:51.749409 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-13 02:17:51.749927 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 02:17:51.751268 (Thread-1): On model.airflow_dbt.stg_npi: COMMIT
2020-10-13 02:17:51.751392 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 02:17:51.751489 (Thread-1): On model.airflow_dbt.stg_npi: COMMIT
2020-10-13 02:17:51.752625 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 02:17:51.755197 (Thread-1): Using postgres connection "model.airflow_dbt.stg_npi".
2020-10-13 02:17:51.755326 (Thread-1): On model.airflow_dbt.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-13 02:17:51.757401 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:17:51.760780 (Thread-1): finished collecting timing info
2020-10-13 02:17:51.761623 (Thread-1): 02:17:51 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.11s]
2020-10-13 02:17:51.761783 (Thread-1): Finished running node model.airflow_dbt.stg_npi
2020-10-13 02:17:51.761941 (Thread-1): Began running node model.airflow_dbt.stg_state_abbreviations
2020-10-13 02:17:51.762089 (Thread-1): 02:17:51 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-13 02:17:51.762512 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 02:17:51.762621 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.stg_npi).
2020-10-13 02:17:51.762723 (Thread-1): Compiling model.airflow_dbt.stg_state_abbreviations
2020-10-13 02:17:51.772776 (Thread-1): Writing injected SQL for node "model.airflow_dbt.stg_state_abbreviations"
2020-10-13 02:17:51.773030 (Thread-1): finished collecting timing info
2020-10-13 02:17:51.784200 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 02:17:51.784365 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-13 02:17:51.784757 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:17:51.787875 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 02:17:51.787987 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-13 02:17:51.788288 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:17:51.790466 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.stg_state_abbreviations"
2020-10-13 02:17:51.790781 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 02:17:51.790890 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: BEGIN
2020-10-13 02:17:51.791195 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:17:51.791317 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 02:17:51.791411 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-13 02:17:51.792172 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 02:17:51.798273 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 02:17:51.798445 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations" rename to "stg_state_abbreviations__dbt_backup"
2020-10-13 02:17:51.799304 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 02:17:51.803040 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 02:17:51.803185 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-13 02:17:51.803653 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 02:17:51.804751 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: COMMIT
2020-10-13 02:17:51.804866 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 02:17:51.804963 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: COMMIT
2020-10-13 02:17:51.806141 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 02:17:51.808676 (Thread-1): Using postgres connection "model.airflow_dbt.stg_state_abbreviations".
2020-10-13 02:17:51.808785 (Thread-1): On model.airflow_dbt.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-13 02:17:51.810174 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:17:51.813535 (Thread-1): finished collecting timing info
2020-10-13 02:17:51.814324 (Thread-1): 02:17:51 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.05s]
2020-10-13 02:17:51.814474 (Thread-1): Finished running node model.airflow_dbt.stg_state_abbreviations
2020-10-13 02:17:51.814897 (Thread-1): Began running node model.airflow_dbt.npi_with_state
2020-10-13 02:17:51.815060 (Thread-1): 02:17:51 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-13 02:17:51.815358 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 02:17:51.815455 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.stg_state_abbreviations).
2020-10-13 02:17:51.815552 (Thread-1): Compiling model.airflow_dbt.npi_with_state
2020-10-13 02:17:51.828902 (Thread-1): Writing injected SQL for node "model.airflow_dbt.npi_with_state"
2020-10-13 02:17:51.829265 (Thread-1): finished collecting timing info
2020-10-13 02:17:51.842109 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 02:17:51.842262 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-13 02:17:51.842637 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:17:51.845739 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 02:17:51.845852 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-13 02:17:51.846159 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:17:51.848101 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.npi_with_state"
2020-10-13 02:17:51.848381 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 02:17:51.848484 (Thread-1): On model.airflow_dbt.npi_with_state: BEGIN
2020-10-13 02:17:51.848753 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:17:51.848871 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 02:17:51.848967 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-13 02:17:51.850225 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 02:17:51.853325 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 02:17:51.853437 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-13 02:17:51.853882 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 02:17:51.854913 (Thread-1): On model.airflow_dbt.npi_with_state: COMMIT
2020-10-13 02:17:51.855020 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 02:17:51.855111 (Thread-1): On model.airflow_dbt.npi_with_state: COMMIT
2020-10-13 02:17:51.856281 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 02:17:51.858508 (Thread-1): Using postgres connection "model.airflow_dbt.npi_with_state".
2020-10-13 02:17:51.858611 (Thread-1): On model.airflow_dbt.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-13 02:17:51.858911 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:17:51.861900 (Thread-1): finished collecting timing info
2020-10-13 02:17:51.862660 (Thread-1): 02:17:51 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.05s]
2020-10-13 02:17:51.862818 (Thread-1): Finished running node model.airflow_dbt.npi_with_state
2020-10-13 02:17:51.863234 (Thread-1): Began running node model.airflow_dbt.count_providers_by_state
2020-10-13 02:17:51.863392 (Thread-1): 02:17:51 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-13 02:17:51.863668 (Thread-1): Acquiring new postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 02:17:51.863759 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt.npi_with_state).
2020-10-13 02:17:51.863859 (Thread-1): Compiling model.airflow_dbt.count_providers_by_state
2020-10-13 02:17:51.872794 (Thread-1): Writing injected SQL for node "model.airflow_dbt.count_providers_by_state"
2020-10-13 02:17:51.873023 (Thread-1): finished collecting timing info
2020-10-13 02:17:51.883918 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 02:17:51.884078 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-13 02:17:51.884492 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:17:51.888161 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 02:17:51.888320 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-13 02:17:51.888686 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:17:51.890796 (Thread-1): Writing runtime SQL for node "model.airflow_dbt.count_providers_by_state"
2020-10-13 02:17:51.891165 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 02:17:51.891285 (Thread-1): On model.airflow_dbt.count_providers_by_state: BEGIN
2020-10-13 02:17:51.891592 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:17:51.891710 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 02:17:51.891806 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-13 02:17:51.892968 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 02:17:51.898209 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 02:17:51.898396 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-13 02:17:51.899130 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 02:17:51.900471 (Thread-1): On model.airflow_dbt.count_providers_by_state: COMMIT
2020-10-13 02:17:51.900607 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 02:17:51.900705 (Thread-1): On model.airflow_dbt.count_providers_by_state: COMMIT
2020-10-13 02:17:51.902041 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 02:17:51.908823 (Thread-1): Using postgres connection "model.airflow_dbt.count_providers_by_state".
2020-10-13 02:17:51.909070 (Thread-1): On model.airflow_dbt.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-13 02:17:51.909710 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:17:51.915715 (Thread-1): finished collecting timing info
2020-10-13 02:17:51.917005 (Thread-1): 02:17:51 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.05s]
2020-10-13 02:17:51.917227 (Thread-1): Finished running node model.airflow_dbt.count_providers_by_state
2020-10-13 02:17:51.956827 (MainThread): Using postgres connection "master".
2020-10-13 02:17:51.957034 (MainThread): On master: BEGIN
2020-10-13 02:17:51.957417 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:17:51.957574 (MainThread): On master: COMMIT
2020-10-13 02:17:51.957708 (MainThread): Using postgres connection "master".
2020-10-13 02:17:51.957831 (MainThread): On master: COMMIT
2020-10-13 02:17:51.958158 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-13 02:17:51.958628 (MainThread): 02:17:51 | 
2020-10-13 02:17:51.958850 (MainThread): 02:17:51 | Finished running 4 view models in 0.66s.
2020-10-13 02:17:51.959050 (MainThread): Connection 'master' was left open.
2020-10-13 02:17:51.959206 (MainThread): On master: Close
2020-10-13 02:17:51.959400 (MainThread): Connection 'model.airflow_dbt.count_providers_by_state' was left open.
2020-10-13 02:17:51.959528 (MainThread): On model.airflow_dbt.count_providers_by_state: Close
2020-10-13 02:17:51.986572 (MainThread): 
2020-10-13 02:17:51.986882 (MainThread): Completed successfully
2020-10-13 02:17:51.987125 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-13 02:17:51.987492 (MainThread): Flushing usage events
2020-10-13 02:18:41.515606 (MainThread): Got an exception trying to initialize tracking
2020-10-13 02:18:41.515764 (MainThread): Running with dbt=0.16.0
2020-10-13 02:18:41.594978 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.list.ListTask'>, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, output='selector', partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, resource_types=[], rpc_method=None, select=None, single_threaded=True, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='list', write_json=True)
2020-10-13 02:18:41.595317 (MainThread): Tracking: do not track
2020-10-13 02:18:41.628760 (MainThread): Partial parsing not enabled
2020-10-13 02:18:41.630832 (MainThread): Parsing macros/core.sql
2020-10-13 02:18:41.638952 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 02:18:41.654255 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 02:18:41.667012 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 02:18:41.692815 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 02:18:41.701460 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 02:18:41.712605 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 02:18:41.774479 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 02:18:41.801508 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 02:18:41.804171 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 02:18:41.813891 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 02:18:41.816722 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 02:18:41.853562 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 02:18:41.855321 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 02:18:41.858390 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 02:18:41.859661 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 02:18:41.861211 (MainThread): Parsing macros/etc/query.sql
2020-10-13 02:18:41.862681 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 02:18:41.865870 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 02:18:41.867446 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 02:18:41.883971 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 02:18:41.887920 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 02:18:41.891083 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 02:18:41.892922 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 02:18:42.000886 (MainThread): Parsing macros/relations.sql
2020-10-13 02:18:42.005712 (MainThread): Parsing macros/adapters.sql
2020-10-13 02:18:42.073108 (MainThread): Parsing macros/catalog.sql
2020-10-13 02:18:42.080155 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 02:18:42.127687 (MainThread): Partial parsing not enabled
2020-10-13 02:18:42.172420 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 02:18:42.172559 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:18:42.196483 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 02:18:42.196603 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:18:42.203448 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 02:18:42.203542 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:18:42.210604 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 02:18:42.210719 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:18:42.373298 (MainThread): WARNING: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airflow_dbt_pg.ge_tutorials

2020-10-13 02:18:42.625621 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 02:18:42.629743 (MainThread): Flushing usage events
2020-10-13 02:18:42.629958 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-13 02:20:36.056761 (MainThread): Got an exception trying to initialize tracking
2020-10-13 02:20:36.056912 (MainThread): Running with dbt=0.16.0
2020-10-13 02:20:36.139392 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.list.ListTask'>, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, output='selector', partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, resource_types=[], rpc_method=None, select=None, single_threaded=True, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='list', write_json=True)
2020-10-13 02:20:36.139794 (MainThread): Tracking: do not track
2020-10-13 02:20:36.175362 (MainThread): Partial parsing not enabled
2020-10-13 02:20:36.177500 (MainThread): Parsing macros/core.sql
2020-10-13 02:20:36.186037 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 02:20:36.201803 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 02:20:36.215441 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 02:20:36.242897 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 02:20:36.252105 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 02:20:36.264558 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 02:20:36.336865 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 02:20:36.370289 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 02:20:36.373809 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 02:20:36.386653 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 02:20:36.390691 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 02:20:36.440927 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 02:20:36.443063 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 02:20:36.446719 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 02:20:36.448234 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 02:20:36.450104 (MainThread): Parsing macros/etc/query.sql
2020-10-13 02:20:36.451895 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 02:20:36.455516 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 02:20:36.457306 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 02:20:36.475583 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 02:20:36.479103 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 02:20:36.481936 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 02:20:36.483531 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 02:20:36.566918 (MainThread): Parsing macros/relations.sql
2020-10-13 02:20:36.569435 (MainThread): Parsing macros/adapters.sql
2020-10-13 02:20:36.601111 (MainThread): Parsing macros/catalog.sql
2020-10-13 02:20:36.605055 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 02:20:36.630005 (MainThread): Partial parsing not enabled
2020-10-13 02:20:36.672206 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 02:20:36.672347 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:20:36.696498 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 02:20:36.696644 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:20:36.703955 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 02:20:36.704054 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:20:36.711101 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 02:20:36.711195 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:20:37.228285 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 02:20:37.232211 (MainThread): Flushing usage events
2020-10-13 02:20:37.232397 (MainThread): Connection 'model.airflow_dbt_pg.stg_npi' was properly closed.
2020-10-13 02:20:57.633183 (MainThread): Got an exception trying to initialize tracking
2020-10-13 02:20:57.633332 (MainThread): Running with dbt=0.16.0
2020-10-13 02:20:57.719274 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=['airflow_dbt_pg.ge_tutorials.*'], partial_parse=None, profile=None, profiles_dir='/usr/local/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-10-13 02:20:57.719598 (MainThread): Tracking: do not track
2020-10-13 02:20:57.752439 (MainThread): Partial parsing not enabled
2020-10-13 02:20:57.754353 (MainThread): Parsing macros/core.sql
2020-10-13 02:20:57.761782 (MainThread): Parsing macros/materializations/helpers.sql
2020-10-13 02:20:57.775602 (MainThread): Parsing macros/materializations/table/table.sql
2020-10-13 02:20:57.786679 (MainThread): Parsing macros/materializations/common/merge.sql
2020-10-13 02:20:57.809058 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-10-13 02:20:57.816773 (MainThread): Parsing macros/materializations/view/view.sql
2020-10-13 02:20:57.827098 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-10-13 02:20:57.885418 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-10-13 02:20:57.912013 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-10-13 02:20:57.914571 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-10-13 02:20:57.924158 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-10-13 02:20:57.926948 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-10-13 02:20:57.962532 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-10-13 02:20:57.964174 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-10-13 02:20:57.967146 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-10-13 02:20:57.968350 (MainThread): Parsing macros/schema_tests/unique.sql
2020-10-13 02:20:57.969859 (MainThread): Parsing macros/etc/query.sql
2020-10-13 02:20:57.971310 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-10-13 02:20:57.974219 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-10-13 02:20:57.975663 (MainThread): Parsing macros/etc/datetime.sql
2020-10-13 02:20:57.990581 (MainThread): Parsing macros/etc/get_relation_comment.sql
2020-10-13 02:20:57.993526 (MainThread): Parsing macros/etc/is_incremental.sql
2020-10-13 02:20:57.995897 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-10-13 02:20:57.997211 (MainThread): Parsing macros/adapters/common.sql
2020-10-13 02:20:58.074250 (MainThread): Parsing macros/relations.sql
2020-10-13 02:20:58.076587 (MainThread): Parsing macros/adapters.sql
2020-10-13 02:20:58.106413 (MainThread): Parsing macros/catalog.sql
2020-10-13 02:20:58.110096 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-10-13 02:20:58.133586 (MainThread): Partial parsing not enabled
2020-10-13 02:20:58.172176 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 02:20:58.172318 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:20:58.197635 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 02:20:58.197772 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:20:58.205431 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 02:20:58.205531 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:20:58.212901 (MainThread): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 02:20:58.212995 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:20:58.699696 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 127 macros, 0 operations, 0 seed files, 2 sources
2020-10-13 02:20:58.704342 (MainThread): 
2020-10-13 02:20:58.704761 (MainThread): Acquiring new postgres connection "master".
2020-10-13 02:20:58.704877 (MainThread): Opening a new connection, currently in state init
2020-10-13 02:20:58.730746 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_airflow".
2020-10-13 02:20:58.730922 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-10-13 02:20:58.869877 (ThreadPoolExecutor-0_0): Using postgres connection "list_airflow".
2020-10-13 02:20:58.870032 (ThreadPoolExecutor-0_0): On list_airflow: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
2020-10-13 02:20:58.874049 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2020-10-13 02:20:58.898599 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_airflow_public".
2020-10-13 02:20:58.898756 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_airflow).
2020-10-13 02:20:58.900897 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-13 02:20:58.901006 (ThreadPoolExecutor-1_0): On list_airflow_public: BEGIN
2020-10-13 02:20:58.901394 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:20:58.901513 (ThreadPoolExecutor-1_0): Using postgres connection "list_airflow_public".
2020-10-13 02:20:58.901603 (ThreadPoolExecutor-1_0): On list_airflow_public: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-10-13 02:20:58.903732 (ThreadPoolExecutor-1_0): SQL status: SELECT 31 in 0.00 seconds
2020-10-13 02:20:58.938367 (ThreadPoolExecutor-1_0): On list_airflow_public: ROLLBACK
2020-10-13 02:20:58.964268 (MainThread): Using postgres connection "master".
2020-10-13 02:20:58.964396 (MainThread): On master: BEGIN
2020-10-13 02:20:58.967267 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:20:58.967393 (MainThread): Using postgres connection "master".
2020-10-13 02:20:58.967480 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-10-13 02:20:58.972714 (MainThread): SQL status: SELECT 5 in 0.01 seconds
2020-10-13 02:20:58.980895 (MainThread): On master: ROLLBACK
2020-10-13 02:20:58.981180 (MainThread): Using postgres connection "master".
2020-10-13 02:20:58.981282 (MainThread): On master: BEGIN
2020-10-13 02:20:58.981737 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:20:58.981868 (MainThread): On master: COMMIT
2020-10-13 02:20:58.981960 (MainThread): Using postgres connection "master".
2020-10-13 02:20:58.982043 (MainThread): On master: COMMIT
2020-10-13 02:20:58.982282 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-13 02:20:58.982575 (MainThread): 02:20:58 | Concurrency: 1 threads (target='dev')
2020-10-13 02:20:58.982707 (MainThread): 02:20:58 | 
2020-10-13 02:20:58.988577 (Thread-1): Began running node model.airflow_dbt_pg.stg_npi
2020-10-13 02:20:58.988751 (Thread-1): 02:20:58 | 1 of 4 START view model public.stg_npi............................... [RUN]
2020-10-13 02:20:58.989076 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 02:20:58.989176 (Thread-1): Re-using an available connection from the pool (formerly list_airflow_public).
2020-10-13 02:20:58.989272 (Thread-1): Compiling model.airflow_dbt_pg.stg_npi
2020-10-13 02:20:59.012394 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-13 02:20:59.012788 (Thread-1): finished collecting timing info
2020-10-13 02:20:59.063914 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 02:20:59.064082 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_tmp" cascade
2020-10-13 02:20:59.064510 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:20:59.067535 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 02:20:59.067665 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-13 02:20:59.067947 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:20:59.069782 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.stg_npi"
2020-10-13 02:20:59.070155 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 02:20:59.070255 (Thread-1): On model.airflow_dbt_pg.stg_npi: BEGIN
2020-10-13 02:20:59.070478 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:20:59.070595 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 02:20:59.070683 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */

  create view "airflow"."public"."stg_npi__dbt_tmp" as (
    select 
	npi as npi,
	entity_type_code as entity_type_code,
	organization_name as organization_name,
	last_name as last_name,
	first_name as first_name,
	state as state_abbreviation,
	taxonomy_code as taxonomy_code
  from "airflow"."public"."npi_small"
  );

2020-10-13 02:20:59.071833 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 02:20:59.076975 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 02:20:59.077101 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
alter table "airflow"."public"."stg_npi" rename to "stg_npi__dbt_backup"
2020-10-13 02:20:59.077496 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 02:20:59.081488 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 02:20:59.081612 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
alter table "airflow"."public"."stg_npi__dbt_tmp" rename to "stg_npi"
2020-10-13 02:20:59.082013 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 02:20:59.083046 (Thread-1): On model.airflow_dbt_pg.stg_npi: COMMIT
2020-10-13 02:20:59.083155 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 02:20:59.083244 (Thread-1): On model.airflow_dbt_pg.stg_npi: COMMIT
2020-10-13 02:20:59.086169 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 02:20:59.088748 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_npi".
2020-10-13 02:20:59.088879 (Thread-1): On model.airflow_dbt_pg.stg_npi: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_npi"} */
drop view if exists "airflow"."public"."stg_npi__dbt_backup" cascade
2020-10-13 02:20:59.090669 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:20:59.093859 (Thread-1): finished collecting timing info
2020-10-13 02:20:59.094639 (Thread-1): 02:20:59 | 1 of 4 OK created view model public.stg_npi.......................... [CREATE VIEW in 0.11s]
2020-10-13 02:20:59.094798 (Thread-1): Finished running node model.airflow_dbt_pg.stg_npi
2020-10-13 02:20:59.094958 (Thread-1): Began running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 02:20:59.095265 (Thread-1): 02:20:59 | 2 of 4 START view model public.stg_state_abbreviations............... [RUN]
2020-10-13 02:20:59.095585 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 02:20:59.095682 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt_pg.stg_npi).
2020-10-13 02:20:59.095778 (Thread-1): Compiling model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 02:20:59.105649 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-13 02:20:59.105962 (Thread-1): finished collecting timing info
2020-10-13 02:20:59.117707 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 02:20:59.117948 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_tmp" cascade
2020-10-13 02:20:59.118423 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:20:59.122433 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 02:20:59.122621 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-13 02:20:59.123033 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:20:59.125597 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.stg_state_abbreviations"
2020-10-13 02:20:59.126023 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 02:20:59.126163 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: BEGIN
2020-10-13 02:20:59.126477 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:20:59.126612 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 02:20:59.126721 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */

  create view "airflow"."public"."stg_state_abbreviations__dbt_tmp" as (
    select 
	name as state_name,
	abbreviation as state_abbreviation
  from "airflow"."public"."state_abbreviations"
  );

2020-10-13 02:20:59.127612 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 02:20:59.134605 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 02:20:59.134811 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations" rename to "stg_state_abbreviations__dbt_backup"
2020-10-13 02:20:59.135483 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 02:20:59.139872 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 02:20:59.140059 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
alter table "airflow"."public"."stg_state_abbreviations__dbt_tmp" rename to "stg_state_abbreviations"
2020-10-13 02:20:59.140595 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 02:20:59.141959 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: COMMIT
2020-10-13 02:20:59.142096 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 02:20:59.142211 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: COMMIT
2020-10-13 02:20:59.143269 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 02:20:59.146367 (Thread-1): Using postgres connection "model.airflow_dbt_pg.stg_state_abbreviations".
2020-10-13 02:20:59.146513 (Thread-1): On model.airflow_dbt_pg.stg_state_abbreviations: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.stg_state_abbreviations"} */
drop view if exists "airflow"."public"."stg_state_abbreviations__dbt_backup" cascade
2020-10-13 02:20:59.147965 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:20:59.152076 (Thread-1): finished collecting timing info
2020-10-13 02:20:59.153072 (Thread-1): 02:20:59 | 2 of 4 OK created view model public.stg_state_abbreviations.......... [CREATE VIEW in 0.06s]
2020-10-13 02:20:59.153265 (Thread-1): Finished running node model.airflow_dbt_pg.stg_state_abbreviations
2020-10-13 02:20:59.153791 (Thread-1): Began running node model.airflow_dbt_pg.npi_with_state
2020-10-13 02:20:59.153984 (Thread-1): 02:20:59 | 3 of 4 START view model public.npi_with_state........................ [RUN]
2020-10-13 02:20:59.154381 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 02:20:59.154512 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt_pg.stg_state_abbreviations).
2020-10-13 02:20:59.154640 (Thread-1): Compiling model.airflow_dbt_pg.npi_with_state
2020-10-13 02:20:59.170487 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-13 02:20:59.170984 (Thread-1): finished collecting timing info
2020-10-13 02:20:59.183978 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 02:20:59.184173 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_tmp" cascade
2020-10-13 02:20:59.184604 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:20:59.188830 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 02:20:59.189038 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-13 02:20:59.189432 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:20:59.191863 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.npi_with_state"
2020-10-13 02:20:59.192194 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 02:20:59.192320 (Thread-1): On model.airflow_dbt_pg.npi_with_state: BEGIN
2020-10-13 02:20:59.192540 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:20:59.192667 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 02:20:59.192774 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */

  create view "airflow"."public"."npi_with_state__dbt_tmp" as (
    select 
	n.npi,
	n.entity_type_code,
	n.organization_name,
	n.last_name,
	n.first_name,
	n.taxonomy_code,
	n.state_abbreviation,
	s.state_name
from "airflow"."public"."stg_npi" n
-- due to the nature of the data some state abbreviations are not valid
-- which results in state names being null  - in this case,
-- switch to inner join
inner join "airflow"."public"."stg_state_abbreviations" s
	on n.state_abbreviation = s.state_abbreviation
  );

2020-10-13 02:20:59.194002 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 02:20:59.197849 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 02:20:59.197990 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
alter table "airflow"."public"."npi_with_state__dbt_tmp" rename to "npi_with_state"
2020-10-13 02:20:59.198439 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 02:20:59.199707 (Thread-1): On model.airflow_dbt_pg.npi_with_state: COMMIT
2020-10-13 02:20:59.199837 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 02:20:59.199947 (Thread-1): On model.airflow_dbt_pg.npi_with_state: COMMIT
2020-10-13 02:20:59.201013 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 02:20:59.203810 (Thread-1): Using postgres connection "model.airflow_dbt_pg.npi_with_state".
2020-10-13 02:20:59.203935 (Thread-1): On model.airflow_dbt_pg.npi_with_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.npi_with_state"} */
drop view if exists "airflow"."public"."npi_with_state__dbt_backup" cascade
2020-10-13 02:20:59.204219 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:20:59.207766 (Thread-1): finished collecting timing info
2020-10-13 02:20:59.208622 (Thread-1): 02:20:59 | 3 of 4 OK created view model public.npi_with_state................... [CREATE VIEW in 0.05s]
2020-10-13 02:20:59.208793 (Thread-1): Finished running node model.airflow_dbt_pg.npi_with_state
2020-10-13 02:20:59.209239 (Thread-1): Began running node model.airflow_dbt_pg.count_providers_by_state
2020-10-13 02:20:59.209416 (Thread-1): 02:20:59 | 4 of 4 START view model public.count_providers_by_state.............. [RUN]
2020-10-13 02:20:59.209753 (Thread-1): Acquiring new postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 02:20:59.209866 (Thread-1): Re-using an available connection from the pool (formerly model.airflow_dbt_pg.npi_with_state).
2020-10-13 02:20:59.209972 (Thread-1): Compiling model.airflow_dbt_pg.count_providers_by_state
2020-10-13 02:20:59.221463 (Thread-1): Writing injected SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-13 02:20:59.221776 (Thread-1): finished collecting timing info
2020-10-13 02:20:59.233601 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 02:20:59.233777 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_tmp" cascade
2020-10-13 02:20:59.234084 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:20:59.239433 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 02:20:59.239675 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-13 02:20:59.240082 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:20:59.243913 (Thread-1): Writing runtime SQL for node "model.airflow_dbt_pg.count_providers_by_state"
2020-10-13 02:20:59.244390 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 02:20:59.244568 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: BEGIN
2020-10-13 02:20:59.244860 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:20:59.245049 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 02:20:59.245216 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */

  create view "airflow"."public"."count_providers_by_state__dbt_tmp" as (
    select 
	state_name,
	count(distinct npi) as count_providers
from "airflow"."public"."npi_with_state" n
group by state_name
  );

2020-10-13 02:20:59.246370 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-10-13 02:20:59.254682 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 02:20:59.254904 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
alter table "airflow"."public"."count_providers_by_state__dbt_tmp" rename to "count_providers_by_state"
2020-10-13 02:20:59.255403 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-10-13 02:20:59.257322 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: COMMIT
2020-10-13 02:20:59.257513 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 02:20:59.257684 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: COMMIT
2020-10-13 02:20:59.258809 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-10-13 02:20:59.263136 (Thread-1): Using postgres connection "model.airflow_dbt_pg.count_providers_by_state".
2020-10-13 02:20:59.263325 (Thread-1): On model.airflow_dbt_pg.count_providers_by_state: /* {"app": "dbt", "dbt_version": "0.16.0", "profile_name": "airflow_dbt_pg", "target_name": "dev", "node_id": "model.airflow_dbt_pg.count_providers_by_state"} */
drop view if exists "airflow"."public"."count_providers_by_state__dbt_backup" cascade
2020-10-13 02:20:59.263751 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-10-13 02:20:59.269448 (Thread-1): finished collecting timing info
2020-10-13 02:20:59.270848 (Thread-1): 02:20:59 | 4 of 4 OK created view model public.count_providers_by_state......... [CREATE VIEW in 0.06s]
2020-10-13 02:20:59.271635 (Thread-1): Finished running node model.airflow_dbt_pg.count_providers_by_state
2020-10-13 02:20:59.290327 (MainThread): Using postgres connection "master".
2020-10-13 02:20:59.290595 (MainThread): On master: BEGIN
2020-10-13 02:20:59.291039 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-10-13 02:20:59.291260 (MainThread): On master: COMMIT
2020-10-13 02:20:59.291417 (MainThread): Using postgres connection "master".
2020-10-13 02:20:59.291561 (MainThread): On master: COMMIT
2020-10-13 02:20:59.291876 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-10-13 02:20:59.292477 (MainThread): 02:20:59 | 
2020-10-13 02:20:59.293342 (MainThread): 02:20:59 | Finished running 4 view models in 0.59s.
2020-10-13 02:20:59.294009 (MainThread): Connection 'master' was left open.
2020-10-13 02:20:59.294202 (MainThread): On master: Close
2020-10-13 02:20:59.298659 (MainThread): Connection 'model.airflow_dbt_pg.count_providers_by_state' was left open.
2020-10-13 02:20:59.298942 (MainThread): On model.airflow_dbt_pg.count_providers_by_state: Close
2020-10-13 02:20:59.340679 (MainThread): 
2020-10-13 02:20:59.341410 (MainThread): Completed successfully
2020-10-13 02:20:59.342103 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-10-13 02:20:59.343122 (MainThread): Flushing usage events
