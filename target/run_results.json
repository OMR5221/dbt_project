{"results": [{"node": {"raw_sql": "select \n\tnpi as npi,\n\tentity_type_code as entity_type_code,\n\torganization_name as organization_name,\n\tlast_name as last_name,\n\tfirst_name as first_name,\n\tstate as state_abbreviation,\n\ttaxonomy_code as taxonomy_code\n  from {{ source('source', 'npi_small') }}", "database": "airflow", "schema": "public", "fqn": ["airflow_dbt_pg", "ge_tutorials", "staging", "stg_npi"], "unique_id": "model.airflow_dbt_pg.stg_npi", "package_name": "airflow_dbt_pg", "root_path": "/usr/local/airflow/dbt", "path": "ge_tutorials/staging/stg_npi.sql", "original_file_path": "models/ge_tutorials/staging/stg_npi.sql", "name": "stg_npi", "resource_type": "model", "alias": "stg_npi", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [], "sources": [["source", "npi_small"]], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.drop_relation_if_exists"], "nodes": ["source.airflow_dbt_pg.source.npi_small"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/run/airflow_dbt_pg/ge_tutorials/staging/stg_npi.sql", "compiled": true, "compiled_sql": "select \n\tnpi as npi,\n\tentity_type_code as entity_type_code,\n\torganization_name as organization_name,\n\tlast_name as last_name,\n\tfirst_name as first_name,\n\tstate as state_abbreviation,\n\ttaxonomy_code as taxonomy_code\n  from \"airflow\".\"public\".\"npi_small\"", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select \n\tnpi as npi,\n\tentity_type_code as entity_type_code,\n\torganization_name as organization_name,\n\tlast_name as last_name,\n\tfirst_name as first_name,\n\tstate as state_abbreviation,\n\ttaxonomy_code as taxonomy_code\n  from \"airflow\".\"public\".\"npi_small\"", "wrapped_sql": null}, "error": null, "status": "CREATE VIEW", "execution_time": 0.10543942451477051, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-10-13T02:20:58.989248Z", "completed_at": "2020-10-13T02:20:59.012744Z"}, {"name": "execute", "started_at": "2020-10-13T02:20:59.013073Z", "completed_at": "2020-10-13T02:20:59.093818Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select \n\tname as state_name,\n\tabbreviation as state_abbreviation\n  from {{ source('source', 'state_abbreviations') }}", "database": "airflow", "schema": "public", "fqn": ["airflow_dbt_pg", "ge_tutorials", "staging", "stg_state_abbreviations"], "unique_id": "model.airflow_dbt_pg.stg_state_abbreviations", "package_name": "airflow_dbt_pg", "root_path": "/usr/local/airflow/dbt", "path": "ge_tutorials/staging/stg_state_abbreviations.sql", "original_file_path": "models/ge_tutorials/staging/stg_state_abbreviations.sql", "name": "stg_state_abbreviations", "resource_type": "model", "alias": "stg_state_abbreviations", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [], "sources": [["source", "state_abbreviations"]], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.drop_relation_if_exists"], "nodes": ["source.airflow_dbt_pg.source.state_abbreviations"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/run/airflow_dbt_pg/ge_tutorials/staging/stg_state_abbreviations.sql", "compiled": true, "compiled_sql": "select \n\tname as state_name,\n\tabbreviation as state_abbreviation\n  from \"airflow\".\"public\".\"state_abbreviations\"", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select \n\tname as state_name,\n\tabbreviation as state_abbreviation\n  from \"airflow\".\"public\".\"state_abbreviations\"", "wrapped_sql": null}, "error": null, "status": "CREATE VIEW", "execution_time": 0.05723905563354492, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-10-13T02:20:59.095754Z", "completed_at": "2020-10-13T02:20:59.105918Z"}, {"name": "execute", "started_at": "2020-10-13T02:20:59.106236Z", "completed_at": "2020-10-13T02:20:59.152026Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select \n\tn.npi,\n\tn.entity_type_code,\n\tn.organization_name,\n\tn.last_name,\n\tn.first_name,\n\tn.taxonomy_code,\n\tn.state_abbreviation,\n\ts.state_name\nfrom {{ ref('stg_npi') }} n\n-- due to the nature of the data some state abbreviations are not valid\n-- which results in state names being null  - in this case,\n-- switch to inner join\ninner join {{ ref('stg_state_abbreviations') }} s\n\ton n.state_abbreviation = s.state_abbreviation", "database": "airflow", "schema": "public", "fqn": ["airflow_dbt_pg", "ge_tutorials", "npi_with_state"], "unique_id": "model.airflow_dbt_pg.npi_with_state", "package_name": "airflow_dbt_pg", "root_path": "/usr/local/airflow/dbt", "path": "ge_tutorials/npi_with_state.sql", "original_file_path": "models/ge_tutorials/npi_with_state.sql", "name": "npi_with_state", "resource_type": "model", "alias": "npi_with_state", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["stg_npi"], ["stg_state_abbreviations"]], "sources": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.drop_relation_if_exists"], "nodes": ["model.airflow_dbt_pg.stg_npi", "model.airflow_dbt_pg.stg_state_abbreviations"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/run/airflow_dbt_pg/ge_tutorials/npi_with_state.sql", "compiled": true, "compiled_sql": "select \n\tn.npi,\n\tn.entity_type_code,\n\tn.organization_name,\n\tn.last_name,\n\tn.first_name,\n\tn.taxonomy_code,\n\tn.state_abbreviation,\n\ts.state_name\nfrom \"airflow\".\"public\".\"stg_npi\" n\n-- due to the nature of the data some state abbreviations are not valid\n-- which results in state names being null  - in this case,\n-- switch to inner join\ninner join \"airflow\".\"public\".\"stg_state_abbreviations\" s\n\ton n.state_abbreviation = s.state_abbreviation", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select \n\tn.npi,\n\tn.entity_type_code,\n\tn.organization_name,\n\tn.last_name,\n\tn.first_name,\n\tn.taxonomy_code,\n\tn.state_abbreviation,\n\ts.state_name\nfrom \"airflow\".\"public\".\"stg_npi\" n\n-- due to the nature of the data some state abbreviations are not valid\n-- which results in state names being null  - in this case,\n-- switch to inner join\ninner join \"airflow\".\"public\".\"stg_state_abbreviations\" s\n\ton n.state_abbreviation = s.state_abbreviation", "wrapped_sql": null}, "error": null, "status": "CREATE VIEW", "execution_time": 0.05412101745605469, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-10-13T02:20:59.154608Z", "completed_at": "2020-10-13T02:20:59.170917Z"}, {"name": "execute", "started_at": "2020-10-13T02:20:59.171550Z", "completed_at": "2020-10-13T02:20:59.207723Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "select \n\tstate_name,\n\tcount(distinct npi) as count_providers\nfrom {{ ref('npi_with_state') }} n\ngroup by state_name", "database": "airflow", "schema": "public", "fqn": ["airflow_dbt_pg", "ge_tutorials", "count_providers_by_state"], "unique_id": "model.airflow_dbt_pg.count_providers_by_state", "package_name": "airflow_dbt_pg", "root_path": "/usr/local/airflow/dbt", "path": "ge_tutorials/count_providers_by_state.sql", "original_file_path": "models/ge_tutorials/count_providers_by_state.sql", "name": "count_providers_by_state", "resource_type": "model", "alias": "count_providers_by_state", "config": {"enabled": true, "materialized": "view", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": []}, "tags": [], "refs": [["npi_with_state"]], "sources": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.drop_relation_if_exists"], "nodes": ["model.airflow_dbt_pg.npi_with_state"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/run/airflow_dbt_pg/ge_tutorials/count_providers_by_state.sql", "compiled": true, "compiled_sql": "select \n\tstate_name,\n\tcount(distinct npi) as count_providers\nfrom \"airflow\".\"public\".\"npi_with_state\" n\ngroup by state_name", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "select \n\tstate_name,\n\tcount(distinct npi) as count_providers\nfrom \"airflow\".\"public\".\"npi_with_state\" n\ngroup by state_name", "wrapped_sql": null}, "error": null, "status": "CREATE VIEW", "execution_time": 0.0606837272644043, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-10-13T02:20:59.209945Z", "completed_at": "2020-10-13T02:20:59.221731Z"}, {"name": "execute", "started_at": "2020-10-13T02:20:59.222079Z", "completed_at": "2020-10-13T02:20:59.269376Z"}], "fail": null, "warn": null, "skip": false}], "generated_at": "2020-10-13T02:20:59.308406Z", "elapsed_time": 0.5878300666809082}